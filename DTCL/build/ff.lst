ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 1


   1              		.cpu cortex-m4
   2              		.arch armv7e-m
   3              		.fpu fpv4-sp-d16
   4              		.eabi_attribute 27, 1
   5              		.eabi_attribute 28, 1
   6              		.eabi_attribute 20, 1
   7              		.eabi_attribute 21, 1
   8              		.eabi_attribute 23, 3
   9              		.eabi_attribute 24, 1
  10              		.eabi_attribute 25, 1
  11              		.eabi_attribute 26, 1
  12              		.eabi_attribute 30, 1
  13              		.eabi_attribute 34, 1
  14              		.eabi_attribute 18, 4
  15              		.file	"ff.c"
  16              		.text
  17              	.Ltext0:
  18              		.cfi_sections	.debug_frame
  19              		.section	.text.ld_word,"ax",%progbits
  20              		.align	1
  21              		.syntax unified
  22              		.thumb
  23              		.thumb_func
  25              	ld_word:
  26              	.LVL0:
  27              	.LFB0:
  28              		.file 1 "Core/Src/FAT/ff.c"
   1:Core/Src/FAT/ff.c **** /*----------------------------------------------------------------------------/
   2:Core/Src/FAT/ff.c **** /  FatFs - Generic FAT Filesystem Module  R0.15 w/patch1                      /
   3:Core/Src/FAT/ff.c **** /-----------------------------------------------------------------------------/
   4:Core/Src/FAT/ff.c **** /
   5:Core/Src/FAT/ff.c **** / Copyright (C) 2022, ChaN, all right reserved.
   6:Core/Src/FAT/ff.c **** /
   7:Core/Src/FAT/ff.c **** / FatFs module is an open source software. Redistribution and use of FatFs in
   8:Core/Src/FAT/ff.c **** / source and binary forms, with or without modification, are permitted provided
   9:Core/Src/FAT/ff.c **** / that the following condition is met:
  10:Core/Src/FAT/ff.c **** /
  11:Core/Src/FAT/ff.c **** / 1. Redistributions of source code must retain the above copyright notice,
  12:Core/Src/FAT/ff.c **** /    this condition and the following disclaimer.
  13:Core/Src/FAT/ff.c **** /
  14:Core/Src/FAT/ff.c **** / This software is provided by the copyright holder and contributors "AS IS"
  15:Core/Src/FAT/ff.c **** / and any warranties related to this software are DISCLAIMED.
  16:Core/Src/FAT/ff.c **** / The copyright owner or contributors be NOT LIABLE for any damages caused
  17:Core/Src/FAT/ff.c **** / by use of this software.
  18:Core/Src/FAT/ff.c **** /
  19:Core/Src/FAT/ff.c **** /----------------------------------------------------------------------------*/
  20:Core/Src/FAT/ff.c **** 
  21:Core/Src/FAT/ff.c **** 
  22:Core/Src/FAT/ff.c **** #include <string.h>
  23:Core/Src/FAT/ff.c **** #include "ff.h"			/* Declarations of FatFs API */
  24:Core/Src/FAT/ff.c **** #include "diskio.h"		/* Declarations of device I/O functions */
  25:Core/Src/FAT/ff.c **** 
  26:Core/Src/FAT/ff.c **** 
  27:Core/Src/FAT/ff.c **** /*--------------------------------------------------------------------------
  28:Core/Src/FAT/ff.c **** 
  29:Core/Src/FAT/ff.c ****    Module Private Definitions
  30:Core/Src/FAT/ff.c **** 
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 2


  31:Core/Src/FAT/ff.c **** ---------------------------------------------------------------------------*/
  32:Core/Src/FAT/ff.c **** 
  33:Core/Src/FAT/ff.c **** #if FF_DEFINED != 80286	/* Revision ID */
  34:Core/Src/FAT/ff.c **** #error Wrong include file (ff.h).
  35:Core/Src/FAT/ff.c **** #endif
  36:Core/Src/FAT/ff.c **** 
  37:Core/Src/FAT/ff.c **** 
  38:Core/Src/FAT/ff.c **** /* Limits and boundaries */
  39:Core/Src/FAT/ff.c **** #define MAX_DIR		0x200000		/* Max size of FAT directory */
  40:Core/Src/FAT/ff.c **** #define MAX_DIR_EX	0x10000000		/* Max size of exFAT directory */
  41:Core/Src/FAT/ff.c **** #define MAX_FAT12	0xFF5			/* Max FAT12 clusters (differs from specs, but right for real DOS/Windows
  42:Core/Src/FAT/ff.c **** #define MAX_FAT16	0xFFF5			/* Max FAT16 clusters (differs from specs, but right for real DOS/Window
  43:Core/Src/FAT/ff.c **** #define MAX_FAT32	0x0FFFFFF5		/* Max FAT32 clusters (not specified, practical limit) */
  44:Core/Src/FAT/ff.c **** #define MAX_EXFAT	0x7FFFFFFD		/* Max exFAT clusters (differs from specs, implementation limit) */
  45:Core/Src/FAT/ff.c **** 
  46:Core/Src/FAT/ff.c **** 
  47:Core/Src/FAT/ff.c **** /* Character code support macros */
  48:Core/Src/FAT/ff.c **** #define IsUpper(c)		((c) >= 'A' && (c) <= 'Z')
  49:Core/Src/FAT/ff.c **** #define IsLower(c)		((c) >= 'a' && (c) <= 'z')
  50:Core/Src/FAT/ff.c **** #define IsDigit(c)		((c) >= '0' && (c) <= '9')
  51:Core/Src/FAT/ff.c **** #define IsSeparator(c)	((c) == '/' || (c) == '\\')
  52:Core/Src/FAT/ff.c **** #define IsTerminator(c)	((UINT)(c) < (FF_USE_LFN ? ' ' : '!'))
  53:Core/Src/FAT/ff.c **** #define IsSurrogate(c)	((c) >= 0xD800 && (c) <= 0xDFFF)
  54:Core/Src/FAT/ff.c **** #define IsSurrogateH(c)	((c) >= 0xD800 && (c) <= 0xDBFF)
  55:Core/Src/FAT/ff.c **** #define IsSurrogateL(c)	((c) >= 0xDC00 && (c) <= 0xDFFF)
  56:Core/Src/FAT/ff.c **** 
  57:Core/Src/FAT/ff.c **** 
  58:Core/Src/FAT/ff.c **** /* Additional file access control and file status flags for internal use */
  59:Core/Src/FAT/ff.c **** #define FA_SEEKEND	0x20	/* Seek to end of the file on file open */
  60:Core/Src/FAT/ff.c **** #define FA_MODIFIED	0x40	/* File has been modified */
  61:Core/Src/FAT/ff.c **** #define FA_DIRTY	0x80	/* FIL.buf[] needs to be written-back */
  62:Core/Src/FAT/ff.c **** 
  63:Core/Src/FAT/ff.c **** 
  64:Core/Src/FAT/ff.c **** /* Additional file attribute bits for internal use */
  65:Core/Src/FAT/ff.c **** #define AM_VOL		0x08	/* Volume label */
  66:Core/Src/FAT/ff.c **** #define AM_LFN		0x0F	/* LFN entry */
  67:Core/Src/FAT/ff.c **** #define AM_MASK		0x3F	/* Mask of defined bits in FAT */
  68:Core/Src/FAT/ff.c **** #define AM_MASKX	0x37	/* Mask of defined bits in exFAT */
  69:Core/Src/FAT/ff.c **** 
  70:Core/Src/FAT/ff.c **** 
  71:Core/Src/FAT/ff.c **** /* Name status flags in fn[11] */
  72:Core/Src/FAT/ff.c **** #define NSFLAG		11		/* Index of the name status byte */
  73:Core/Src/FAT/ff.c **** #define NS_LOSS		0x01	/* Out of 8.3 format */
  74:Core/Src/FAT/ff.c **** #define NS_LFN		0x02	/* Force to create LFN entry */
  75:Core/Src/FAT/ff.c **** #define NS_LAST		0x04	/* Last segment */
  76:Core/Src/FAT/ff.c **** #define NS_BODY		0x08	/* Lower case flag (body) */
  77:Core/Src/FAT/ff.c **** #define NS_EXT		0x10	/* Lower case flag (ext) */
  78:Core/Src/FAT/ff.c **** #define NS_DOT		0x20	/* Dot entry */
  79:Core/Src/FAT/ff.c **** #define NS_NOLFN	0x40	/* Do not find LFN */
  80:Core/Src/FAT/ff.c **** #define NS_NONAME	0x80	/* Not followed */
  81:Core/Src/FAT/ff.c **** 
  82:Core/Src/FAT/ff.c **** 
  83:Core/Src/FAT/ff.c **** /* exFAT directory entry types */
  84:Core/Src/FAT/ff.c **** #define	ET_BITMAP	0x81	/* Allocation bitmap */
  85:Core/Src/FAT/ff.c **** #define	ET_UPCASE	0x82	/* Up-case table */
  86:Core/Src/FAT/ff.c **** #define	ET_VLABEL	0x83	/* Volume label */
  87:Core/Src/FAT/ff.c **** #define	ET_FILEDIR	0x85	/* File and directory */
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 3


  88:Core/Src/FAT/ff.c **** #define	ET_STREAM	0xC0	/* Stream extension */
  89:Core/Src/FAT/ff.c **** #define	ET_FILENAME	0xC1	/* Name extension */
  90:Core/Src/FAT/ff.c **** 
  91:Core/Src/FAT/ff.c **** 
  92:Core/Src/FAT/ff.c **** /* FatFs refers the FAT structure as simple byte array instead of structure member
  93:Core/Src/FAT/ff.c **** / because the C structure is not binary compatible between different platforms */
  94:Core/Src/FAT/ff.c **** 
  95:Core/Src/FAT/ff.c **** #define BS_JmpBoot			0		/* x86 jump instruction (3-byte) */
  96:Core/Src/FAT/ff.c **** #define BS_OEMName			3		/* OEM name (8-byte) */
  97:Core/Src/FAT/ff.c **** #define BPB_BytsPerSec		11		/* Sector size [byte] (WORD) */
  98:Core/Src/FAT/ff.c **** #define BPB_SecPerClus		13		/* Cluster size [sector] (BYTE) */
  99:Core/Src/FAT/ff.c **** #define BPB_RsvdSecCnt		14		/* Size of reserved area [sector] (WORD) */
 100:Core/Src/FAT/ff.c **** #define BPB_NumFATs			16		/* Number of FATs (BYTE) */
 101:Core/Src/FAT/ff.c **** #define BPB_RootEntCnt		17		/* Size of root directory area for FAT [entry] (WORD) */
 102:Core/Src/FAT/ff.c **** #define BPB_TotSec16		19		/* Volume size (16-bit) [sector] (WORD) */
 103:Core/Src/FAT/ff.c **** #define BPB_Media			21		/* Media descriptor byte (BYTE) */
 104:Core/Src/FAT/ff.c **** #define BPB_FATSz16			22		/* FAT size (16-bit) [sector] (WORD) */
 105:Core/Src/FAT/ff.c **** #define BPB_SecPerTrk		24		/* Number of sectors per track for int13h [sector] (WORD) */
 106:Core/Src/FAT/ff.c **** #define BPB_NumHeads		26		/* Number of heads for int13h (WORD) */
 107:Core/Src/FAT/ff.c **** #define BPB_HiddSec			28		/* Volume offset from top of the drive (DWORD) */
 108:Core/Src/FAT/ff.c **** #define BPB_TotSec32		32		/* Volume size (32-bit) [sector] (DWORD) */
 109:Core/Src/FAT/ff.c **** #define BS_DrvNum			36		/* Physical drive number for int13h (BYTE) */
 110:Core/Src/FAT/ff.c **** #define BS_NTres			37		/* WindowsNT error flag (BYTE) */
 111:Core/Src/FAT/ff.c **** #define BS_BootSig			38		/* Extended boot signature (BYTE) */
 112:Core/Src/FAT/ff.c **** #define BS_VolID			39		/* Volume serial number (DWORD) */
 113:Core/Src/FAT/ff.c **** #define BS_VolLab			43		/* Volume label string (8-byte) */
 114:Core/Src/FAT/ff.c **** #define BS_FilSysType		54		/* Filesystem type string (8-byte) */
 115:Core/Src/FAT/ff.c **** #define BS_BootCode			62		/* Boot code (448-byte) */
 116:Core/Src/FAT/ff.c **** #define BS_55AA				510		/* Signature word (WORD) */
 117:Core/Src/FAT/ff.c **** 
 118:Core/Src/FAT/ff.c **** #define BPB_FATSz32			36		/* FAT32: FAT size [sector] (DWORD) */
 119:Core/Src/FAT/ff.c **** #define BPB_ExtFlags32		40		/* FAT32: Extended flags (WORD) */
 120:Core/Src/FAT/ff.c **** #define BPB_FSVer32			42		/* FAT32: Filesystem version (WORD) */
 121:Core/Src/FAT/ff.c **** #define BPB_RootClus32		44		/* FAT32: Root directory cluster (DWORD) */
 122:Core/Src/FAT/ff.c **** #define BPB_FSInfo32		48		/* FAT32: Offset of FSINFO sector (WORD) */
 123:Core/Src/FAT/ff.c **** #define BPB_BkBootSec32		50		/* FAT32: Offset of backup boot sector (WORD) */
 124:Core/Src/FAT/ff.c **** #define BS_DrvNum32			64		/* FAT32: Physical drive number for int13h (BYTE) */
 125:Core/Src/FAT/ff.c **** #define BS_NTres32			65		/* FAT32: Error flag (BYTE) */
 126:Core/Src/FAT/ff.c **** #define BS_BootSig32		66		/* FAT32: Extended boot signature (BYTE) */
 127:Core/Src/FAT/ff.c **** #define BS_VolID32			67		/* FAT32: Volume serial number (DWORD) */
 128:Core/Src/FAT/ff.c **** #define BS_VolLab32			71		/* FAT32: Volume label string (8-byte) */
 129:Core/Src/FAT/ff.c **** #define BS_FilSysType32		82		/* FAT32: Filesystem type string (8-byte) */
 130:Core/Src/FAT/ff.c **** #define BS_BootCode32		90		/* FAT32: Boot code (420-byte) */
 131:Core/Src/FAT/ff.c **** 
 132:Core/Src/FAT/ff.c **** #define BPB_ZeroedEx		11		/* exFAT: MBZ field (53-byte) */
 133:Core/Src/FAT/ff.c **** #define BPB_VolOfsEx		64		/* exFAT: Volume offset from top of the drive [sector] (QWORD) */
 134:Core/Src/FAT/ff.c **** #define BPB_TotSecEx		72		/* exFAT: Volume size [sector] (QWORD) */
 135:Core/Src/FAT/ff.c **** #define BPB_FatOfsEx		80		/* exFAT: FAT offset from top of the volume [sector] (DWORD) */
 136:Core/Src/FAT/ff.c **** #define BPB_FatSzEx			84		/* exFAT: FAT size [sector] (DWORD) */
 137:Core/Src/FAT/ff.c **** #define BPB_DataOfsEx		88		/* exFAT: Data offset from top of the volume [sector] (DWORD) */
 138:Core/Src/FAT/ff.c **** #define BPB_NumClusEx		92		/* exFAT: Number of clusters (DWORD) */
 139:Core/Src/FAT/ff.c **** #define BPB_RootClusEx		96		/* exFAT: Root directory start cluster (DWORD) */
 140:Core/Src/FAT/ff.c **** #define BPB_VolIDEx			100		/* exFAT: Volume serial number (DWORD) */
 141:Core/Src/FAT/ff.c **** #define BPB_FSVerEx			104		/* exFAT: Filesystem version (WORD) */
 142:Core/Src/FAT/ff.c **** #define BPB_VolFlagEx		106		/* exFAT: Volume flags (WORD) */
 143:Core/Src/FAT/ff.c **** #define BPB_BytsPerSecEx	108		/* exFAT: Log2 of sector size in unit of byte (BYTE) */
 144:Core/Src/FAT/ff.c **** #define BPB_SecPerClusEx	109		/* exFAT: Log2 of cluster size in unit of sector (BYTE) */
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 4


 145:Core/Src/FAT/ff.c **** #define BPB_NumFATsEx		110		/* exFAT: Number of FATs (BYTE) */
 146:Core/Src/FAT/ff.c **** #define BPB_DrvNumEx		111		/* exFAT: Physical drive number for int13h (BYTE) */
 147:Core/Src/FAT/ff.c **** #define BPB_PercInUseEx		112		/* exFAT: Percent in use (BYTE) */
 148:Core/Src/FAT/ff.c **** #define BPB_RsvdEx			113		/* exFAT: Reserved (7-byte) */
 149:Core/Src/FAT/ff.c **** #define BS_BootCodeEx		120		/* exFAT: Boot code (390-byte) */
 150:Core/Src/FAT/ff.c **** 
 151:Core/Src/FAT/ff.c **** #define DIR_Name			0		/* Short file name (11-byte) */
 152:Core/Src/FAT/ff.c **** #define DIR_Attr			11		/* Attribute (BYTE) */
 153:Core/Src/FAT/ff.c **** #define DIR_NTres			12		/* Lower case flag (BYTE) */
 154:Core/Src/FAT/ff.c **** #define DIR_CrtTime10		13		/* Created time sub-second (BYTE) */
 155:Core/Src/FAT/ff.c **** #define DIR_CrtTime			14		/* Created time (DWORD) */
 156:Core/Src/FAT/ff.c **** #define DIR_LstAccDate		18		/* Last accessed date (WORD) */
 157:Core/Src/FAT/ff.c **** #define DIR_FstClusHI		20		/* Higher 16-bit of first cluster (WORD) */
 158:Core/Src/FAT/ff.c **** #define DIR_ModTime			22		/* Modified time (DWORD) */
 159:Core/Src/FAT/ff.c **** #define DIR_FstClusLO		26		/* Lower 16-bit of first cluster (WORD) */
 160:Core/Src/FAT/ff.c **** #define DIR_FileSize		28		/* File size (DWORD) */
 161:Core/Src/FAT/ff.c **** #define LDIR_Ord			0		/* LFN: LFN order and LLE flag (BYTE) */
 162:Core/Src/FAT/ff.c **** #define LDIR_Attr			11		/* LFN: LFN attribute (BYTE) */
 163:Core/Src/FAT/ff.c **** #define LDIR_Type			12		/* LFN: Entry type (BYTE) */
 164:Core/Src/FAT/ff.c **** #define LDIR_Chksum			13		/* LFN: Checksum of the SFN (BYTE) */
 165:Core/Src/FAT/ff.c **** #define LDIR_FstClusLO		26		/* LFN: MBZ field (WORD) */
 166:Core/Src/FAT/ff.c **** #define XDIR_Type			0		/* exFAT: Type of exFAT directory entry (BYTE) */
 167:Core/Src/FAT/ff.c **** #define XDIR_NumLabel		1		/* exFAT: Number of volume label characters (BYTE) */
 168:Core/Src/FAT/ff.c **** #define XDIR_Label			2		/* exFAT: Volume label (11-WORD) */
 169:Core/Src/FAT/ff.c **** #define XDIR_CaseSum		4		/* exFAT: Sum of case conversion table (DWORD) */
 170:Core/Src/FAT/ff.c **** #define XDIR_NumSec			1		/* exFAT: Number of secondary entries (BYTE) */
 171:Core/Src/FAT/ff.c **** #define XDIR_SetSum			2		/* exFAT: Sum of the set of directory entries (WORD) */
 172:Core/Src/FAT/ff.c **** #define XDIR_Attr			4		/* exFAT: File attribute (WORD) */
 173:Core/Src/FAT/ff.c **** #define XDIR_CrtTime		8		/* exFAT: Created time (DWORD) */
 174:Core/Src/FAT/ff.c **** #define XDIR_ModTime		12		/* exFAT: Modified time (DWORD) */
 175:Core/Src/FAT/ff.c **** #define XDIR_AccTime		16		/* exFAT: Last accessed time (DWORD) */
 176:Core/Src/FAT/ff.c **** #define XDIR_CrtTime10		20		/* exFAT: Created time subsecond (BYTE) */
 177:Core/Src/FAT/ff.c **** #define XDIR_ModTime10		21		/* exFAT: Modified time subsecond (BYTE) */
 178:Core/Src/FAT/ff.c **** #define XDIR_CrtTZ			22		/* exFAT: Created timezone (BYTE) */
 179:Core/Src/FAT/ff.c **** #define XDIR_ModTZ			23		/* exFAT: Modified timezone (BYTE) */
 180:Core/Src/FAT/ff.c **** #define XDIR_AccTZ			24		/* exFAT: Last accessed timezone (BYTE) */
 181:Core/Src/FAT/ff.c **** #define XDIR_GenFlags		33		/* exFAT: General secondary flags (BYTE) */
 182:Core/Src/FAT/ff.c **** #define XDIR_NumName		35		/* exFAT: Number of file name characters (BYTE) */
 183:Core/Src/FAT/ff.c **** #define XDIR_NameHash		36		/* exFAT: Hash of file name (WORD) */
 184:Core/Src/FAT/ff.c **** #define XDIR_ValidFileSize	40		/* exFAT: Valid file size (QWORD) */
 185:Core/Src/FAT/ff.c **** #define XDIR_FstClus		52		/* exFAT: First cluster of the file data (DWORD) */
 186:Core/Src/FAT/ff.c **** #define XDIR_FileSize		56		/* exFAT: File/Directory size (QWORD) */
 187:Core/Src/FAT/ff.c **** 
 188:Core/Src/FAT/ff.c **** #define SZDIRE				32		/* Size of a directory entry */
 189:Core/Src/FAT/ff.c **** #define DDEM				0xE5	/* Deleted directory entry mark set to DIR_Name[0] */
 190:Core/Src/FAT/ff.c **** #define RDDEM				0x05	/* Replacement of the character collides with DDEM */
 191:Core/Src/FAT/ff.c **** #define LLEF				0x40	/* Last long entry flag in LDIR_Ord */
 192:Core/Src/FAT/ff.c **** 
 193:Core/Src/FAT/ff.c **** #define FSI_LeadSig			0		/* FAT32 FSI: Leading signature (DWORD) */
 194:Core/Src/FAT/ff.c **** #define FSI_StrucSig		484		/* FAT32 FSI: Structure signature (DWORD) */
 195:Core/Src/FAT/ff.c **** #define FSI_Free_Count		488		/* FAT32 FSI: Number of free clusters (DWORD) */
 196:Core/Src/FAT/ff.c **** #define FSI_Nxt_Free		492		/* FAT32 FSI: Last allocated cluster (DWORD) */
 197:Core/Src/FAT/ff.c **** 
 198:Core/Src/FAT/ff.c **** #define MBR_Table			446		/* MBR: Offset of partition table in the MBR */
 199:Core/Src/FAT/ff.c **** #define SZ_PTE				16		/* MBR: Size of a partition table entry */
 200:Core/Src/FAT/ff.c **** #define PTE_Boot			0		/* MBR PTE: Boot indicator */
 201:Core/Src/FAT/ff.c **** #define PTE_StHead			1		/* MBR PTE: Start head */
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 5


 202:Core/Src/FAT/ff.c **** #define PTE_StSec			2		/* MBR PTE: Start sector */
 203:Core/Src/FAT/ff.c **** #define PTE_StCyl			3		/* MBR PTE: Start cylinder */
 204:Core/Src/FAT/ff.c **** #define PTE_System			4		/* MBR PTE: System ID */
 205:Core/Src/FAT/ff.c **** #define PTE_EdHead			5		/* MBR PTE: End head */
 206:Core/Src/FAT/ff.c **** #define PTE_EdSec			6		/* MBR PTE: End sector */
 207:Core/Src/FAT/ff.c **** #define PTE_EdCyl			7		/* MBR PTE: End cylinder */
 208:Core/Src/FAT/ff.c **** #define PTE_StLba			8		/* MBR PTE: Start in LBA */
 209:Core/Src/FAT/ff.c **** #define PTE_SizLba			12		/* MBR PTE: Size in LBA */
 210:Core/Src/FAT/ff.c **** 
 211:Core/Src/FAT/ff.c **** #define GPTH_Sign			0		/* GPT HDR: Signature (8-byte) */
 212:Core/Src/FAT/ff.c **** #define GPTH_Rev			8		/* GPT HDR: Revision (DWORD) */
 213:Core/Src/FAT/ff.c **** #define GPTH_Size			12		/* GPT HDR: Header size (DWORD) */
 214:Core/Src/FAT/ff.c **** #define GPTH_Bcc			16		/* GPT HDR: Header BCC (DWORD) */
 215:Core/Src/FAT/ff.c **** #define GPTH_CurLba			24		/* GPT HDR: This header LBA (QWORD) */
 216:Core/Src/FAT/ff.c **** #define GPTH_BakLba			32		/* GPT HDR: Another header LBA (QWORD) */
 217:Core/Src/FAT/ff.c **** #define GPTH_FstLba			40		/* GPT HDR: First LBA for partition data (QWORD) */
 218:Core/Src/FAT/ff.c **** #define GPTH_LstLba			48		/* GPT HDR: Last LBA for partition data (QWORD) */
 219:Core/Src/FAT/ff.c **** #define GPTH_DskGuid		56		/* GPT HDR: Disk GUID (16-byte) */
 220:Core/Src/FAT/ff.c **** #define GPTH_PtOfs			72		/* GPT HDR: Partition table LBA (QWORD) */
 221:Core/Src/FAT/ff.c **** #define GPTH_PtNum			80		/* GPT HDR: Number of table entries (DWORD) */
 222:Core/Src/FAT/ff.c **** #define GPTH_PteSize		84		/* GPT HDR: Size of table entry (DWORD) */
 223:Core/Src/FAT/ff.c **** #define GPTH_PtBcc			88		/* GPT HDR: Partition table BCC (DWORD) */
 224:Core/Src/FAT/ff.c **** #define SZ_GPTE				128		/* GPT PTE: Size of partition table entry */
 225:Core/Src/FAT/ff.c **** #define GPTE_PtGuid			0		/* GPT PTE: Partition type GUID (16-byte) */
 226:Core/Src/FAT/ff.c **** #define GPTE_UpGuid			16		/* GPT PTE: Partition unique GUID (16-byte) */
 227:Core/Src/FAT/ff.c **** #define GPTE_FstLba			32		/* GPT PTE: First LBA of partition (QWORD) */
 228:Core/Src/FAT/ff.c **** #define GPTE_LstLba			40		/* GPT PTE: Last LBA of partition (QWORD) */
 229:Core/Src/FAT/ff.c **** #define GPTE_Flags			48		/* GPT PTE: Partition flags (QWORD) */
 230:Core/Src/FAT/ff.c **** #define GPTE_Name			56		/* GPT PTE: Partition name */
 231:Core/Src/FAT/ff.c **** 
 232:Core/Src/FAT/ff.c **** 
 233:Core/Src/FAT/ff.c **** /* Post process on fatal error in the file operations */
 234:Core/Src/FAT/ff.c **** #define ABORT(fs, res)		{ fp->err = (BYTE)(res); LEAVE_FF(fs, res); }
 235:Core/Src/FAT/ff.c **** 
 236:Core/Src/FAT/ff.c **** 
 237:Core/Src/FAT/ff.c **** /* Re-entrancy related */
 238:Core/Src/FAT/ff.c **** #if FF_FS_REENTRANT
 239:Core/Src/FAT/ff.c **** #if FF_USE_LFN == 1
 240:Core/Src/FAT/ff.c **** #error Static LFN work area cannot be used in thread-safe configuration
 241:Core/Src/FAT/ff.c **** #endif
 242:Core/Src/FAT/ff.c **** #define LEAVE_FF(fs, res)	{ unlock_volume(fs, res); return res; }
 243:Core/Src/FAT/ff.c **** #else
 244:Core/Src/FAT/ff.c **** #define LEAVE_FF(fs, res)	return res
 245:Core/Src/FAT/ff.c **** #endif
 246:Core/Src/FAT/ff.c **** 
 247:Core/Src/FAT/ff.c **** 
 248:Core/Src/FAT/ff.c **** /* Definitions of logical drive - physical location conversion */
 249:Core/Src/FAT/ff.c **** #if FF_MULTI_PARTITION
 250:Core/Src/FAT/ff.c **** #define LD2PD(vol) VolToPart[vol].pd	/* Get physical drive number */
 251:Core/Src/FAT/ff.c **** #define LD2PT(vol) VolToPart[vol].pt	/* Get partition number (0:auto search, 1..:forced partition n
 252:Core/Src/FAT/ff.c **** #else
 253:Core/Src/FAT/ff.c **** #define LD2PD(vol) (BYTE)(vol)	/* Each logical drive is associated with the same physical drive num
 254:Core/Src/FAT/ff.c **** #define LD2PT(vol) 0			/* Auto partition search */
 255:Core/Src/FAT/ff.c **** #endif
 256:Core/Src/FAT/ff.c **** 
 257:Core/Src/FAT/ff.c **** 
 258:Core/Src/FAT/ff.c **** /* Definitions of sector size */
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 6


 259:Core/Src/FAT/ff.c **** #if (FF_MAX_SS < FF_MIN_SS) || (FF_MAX_SS != 512 && FF_MAX_SS != 1024 && FF_MAX_SS != 2048 && FF_MA
 260:Core/Src/FAT/ff.c **** #error Wrong sector size configuration
 261:Core/Src/FAT/ff.c **** #endif
 262:Core/Src/FAT/ff.c **** #if FF_MAX_SS == FF_MIN_SS
 263:Core/Src/FAT/ff.c **** #define SS(fs)	((UINT)FF_MAX_SS)	/* Fixed sector size */
 264:Core/Src/FAT/ff.c **** #else
 265:Core/Src/FAT/ff.c **** #define SS(fs)	((fs)->ssize)	/* Variable sector size */
 266:Core/Src/FAT/ff.c **** #endif
 267:Core/Src/FAT/ff.c **** 
 268:Core/Src/FAT/ff.c **** 
 269:Core/Src/FAT/ff.c **** /* Timestamp */
 270:Core/Src/FAT/ff.c **** #if FF_FS_NORTC == 1
 271:Core/Src/FAT/ff.c **** #if FF_NORTC_YEAR < 1980 || FF_NORTC_YEAR > 2107 || FF_NORTC_MON < 1 || FF_NORTC_MON > 12 || FF_NOR
 272:Core/Src/FAT/ff.c **** #error Invalid FF_FS_NORTC settings
 273:Core/Src/FAT/ff.c **** #endif
 274:Core/Src/FAT/ff.c **** #define GET_FATTIME()	((DWORD)(FF_NORTC_YEAR - 1980) << 25 | (DWORD)FF_NORTC_MON << 21 | (DWORD)FF_
 275:Core/Src/FAT/ff.c **** #else
 276:Core/Src/FAT/ff.c **** #define GET_FATTIME()	get_fattime()
 277:Core/Src/FAT/ff.c **** #endif
 278:Core/Src/FAT/ff.c **** 
 279:Core/Src/FAT/ff.c **** 
 280:Core/Src/FAT/ff.c **** /* File lock controls */
 281:Core/Src/FAT/ff.c **** #if FF_FS_LOCK
 282:Core/Src/FAT/ff.c **** #if FF_FS_READONLY
 283:Core/Src/FAT/ff.c **** #error FF_FS_LOCK must be 0 at read-only configuration
 284:Core/Src/FAT/ff.c **** #endif
 285:Core/Src/FAT/ff.c **** typedef struct {
 286:Core/Src/FAT/ff.c **** 	FATFS* fs;		/* Object ID 1, volume (NULL:blank entry) */
 287:Core/Src/FAT/ff.c **** 	DWORD clu;		/* Object ID 2, containing directory (0:root) */
 288:Core/Src/FAT/ff.c **** 	DWORD ofs;		/* Object ID 3, offset in the directory */
 289:Core/Src/FAT/ff.c **** 	UINT ctr;		/* Object open counter, 0:none, 0x01..0xFF:read mode open count, 0x100:write mode */
 290:Core/Src/FAT/ff.c **** } FILESEM;
 291:Core/Src/FAT/ff.c **** #endif
 292:Core/Src/FAT/ff.c **** 
 293:Core/Src/FAT/ff.c **** 
 294:Core/Src/FAT/ff.c **** /* SBCS up-case tables (\x80-\xFF) */
 295:Core/Src/FAT/ff.c **** #define TBL_CT437  {0x80,0x9A,0x45,0x41,0x8E,0x41,0x8F,0x80,0x45,0x45,0x45,0x49,0x49,0x49,0x8E,0x8F
 296:Core/Src/FAT/ff.c **** 					0x90,0x92,0x92,0x4F,0x99,0x4F,0x55,0x55,0x59,0x99,0x9A,0x9B,0x9C,0x9D,0x9E,0x9F, \
 297:Core/Src/FAT/ff.c **** 					0x41,0x49,0x4F,0x55,0xA5,0xA5,0xA6,0xA7,0xA8,0xA9,0xAA,0xAB,0xAC,0xAD,0xAE,0xAF, \
 298:Core/Src/FAT/ff.c **** 					0xB0,0xB1,0xB2,0xB3,0xB4,0xB5,0xB6,0xB7,0xB8,0xB9,0xBA,0xBB,0xBC,0xBD,0xBE,0xBF, \
 299:Core/Src/FAT/ff.c **** 					0xC0,0xC1,0xC2,0xC3,0xC4,0xC5,0xC6,0xC7,0xC8,0xC9,0xCA,0xCB,0xCC,0xCD,0xCE,0xCF, \
 300:Core/Src/FAT/ff.c **** 					0xD0,0xD1,0xD2,0xD3,0xD4,0xD5,0xD6,0xD7,0xD8,0xD9,0xDA,0xDB,0xDC,0xDD,0xDE,0xDF, \
 301:Core/Src/FAT/ff.c **** 					0xE0,0xE1,0xE2,0xE3,0xE4,0xE5,0xE6,0xE7,0xE8,0xE9,0xEA,0xEB,0xEC,0xED,0xEE,0xEF, \
 302:Core/Src/FAT/ff.c **** 					0xF0,0xF1,0xF2,0xF3,0xF4,0xF5,0xF6,0xF7,0xF8,0xF9,0xFA,0xFB,0xFC,0xFD,0xFE,0xFF}
 303:Core/Src/FAT/ff.c **** #define TBL_CT720  {0x80,0x81,0x82,0x83,0x84,0x85,0x86,0x87,0x88,0x89,0x8A,0x8B,0x8C,0x8D,0x8E,0x8F
 304:Core/Src/FAT/ff.c **** 					0x90,0x91,0x92,0x93,0x94,0x95,0x96,0x97,0x98,0x99,0x9A,0x9B,0x9C,0x9D,0x9E,0x9F, \
 305:Core/Src/FAT/ff.c **** 					0xA0,0xA1,0xA2,0xA3,0xA4,0xA5,0xA6,0xA7,0xA8,0xA9,0xAA,0xAB,0xAC,0xAD,0xAE,0xAF, \
 306:Core/Src/FAT/ff.c **** 					0xB0,0xB1,0xB2,0xB3,0xB4,0xB5,0xB6,0xB7,0xB8,0xB9,0xBA,0xBB,0xBC,0xBD,0xBE,0xBF, \
 307:Core/Src/FAT/ff.c **** 					0xC0,0xC1,0xC2,0xC3,0xC4,0xC5,0xC6,0xC7,0xC8,0xC9,0xCA,0xCB,0xCC,0xCD,0xCE,0xCF, \
 308:Core/Src/FAT/ff.c **** 					0xD0,0xD1,0xD2,0xD3,0xD4,0xD5,0xD6,0xD7,0xD8,0xD9,0xDA,0xDB,0xDC,0xDD,0xDE,0xDF, \
 309:Core/Src/FAT/ff.c **** 					0xE0,0xE1,0xE2,0xE3,0xE4,0xE5,0xE6,0xE7,0xE8,0xE9,0xEA,0xEB,0xEC,0xED,0xEE,0xEF, \
 310:Core/Src/FAT/ff.c **** 					0xF0,0xF1,0xF2,0xF3,0xF4,0xF5,0xF6,0xF7,0xF8,0xF9,0xFA,0xFB,0xFC,0xFD,0xFE,0xFF}
 311:Core/Src/FAT/ff.c **** #define TBL_CT737  {0x80,0x81,0x82,0x83,0x84,0x85,0x86,0x87,0x88,0x89,0x8A,0x8B,0x8C,0x8D,0x8E,0x8F
 312:Core/Src/FAT/ff.c **** 					0x90,0x92,0x92,0x93,0x94,0x95,0x96,0x97,0x80,0x81,0x82,0x83,0x84,0x85,0x86,0x87, \
 313:Core/Src/FAT/ff.c **** 					0x88,0x89,0x8A,0x8B,0x8C,0x8D,0x8E,0x8F,0x90,0x91,0xAA,0x92,0x93,0x94,0x95,0x96, \
 314:Core/Src/FAT/ff.c **** 					0xB0,0xB1,0xB2,0xB3,0xB4,0xB5,0xB6,0xB7,0xB8,0xB9,0xBA,0xBB,0xBC,0xBD,0xBE,0xBF, \
 315:Core/Src/FAT/ff.c **** 					0xC0,0xC1,0xC2,0xC3,0xC4,0xC5,0xC6,0xC7,0xC8,0xC9,0xCA,0xCB,0xCC,0xCD,0xCE,0xCF, \
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 7


 316:Core/Src/FAT/ff.c **** 					0xD0,0xD1,0xD2,0xD3,0xD4,0xD5,0xD6,0xD7,0xD8,0xD9,0xDA,0xDB,0xDC,0xDD,0xDE,0xDF, \
 317:Core/Src/FAT/ff.c **** 					0x97,0xEA,0xEB,0xEC,0xE4,0xED,0xEE,0xEF,0xF5,0xF0,0xEA,0xEB,0xEC,0xED,0xEE,0xEF, \
 318:Core/Src/FAT/ff.c **** 					0xF0,0xF1,0xF2,0xF3,0xF4,0xF5,0xF6,0xF7,0xF8,0xF9,0xFA,0xFB,0xFC,0xFD,0xFE,0xFF}
 319:Core/Src/FAT/ff.c **** #define TBL_CT771  {0x80,0x81,0x82,0x83,0x84,0x85,0x86,0x87,0x88,0x89,0x8A,0x8B,0x8C,0x8D,0x8E,0x8F
 320:Core/Src/FAT/ff.c **** 					0x90,0x91,0x92,0x93,0x94,0x95,0x96,0x97,0x98,0x99,0x9A,0x9B,0x9C,0x9D,0x9E,0x9F, \
 321:Core/Src/FAT/ff.c **** 					0x80,0x81,0x82,0x83,0x84,0x85,0x86,0x87,0x88,0x89,0x8A,0x8B,0x8C,0x8D,0x8E,0x8F, \
 322:Core/Src/FAT/ff.c **** 					0xB0,0xB1,0xB2,0xB3,0xB4,0xB5,0xB6,0xB7,0xB8,0xB9,0xBA,0xBB,0xBC,0xBD,0xBE,0xBF, \
 323:Core/Src/FAT/ff.c **** 					0xC0,0xC1,0xC2,0xC3,0xC4,0xC5,0xC6,0xC7,0xC8,0xC9,0xCA,0xCB,0xCC,0xCD,0xCE,0xCF, \
 324:Core/Src/FAT/ff.c **** 					0xD0,0xD1,0xD2,0xD3,0xD4,0xD5,0xD6,0xD7,0xD8,0xD9,0xDA,0xDB,0xDC,0xDC,0xDE,0xDE, \
 325:Core/Src/FAT/ff.c **** 					0x90,0x91,0x92,0x93,0x94,0x95,0x96,0x97,0x98,0x99,0x9A,0x9B,0x9C,0x9D,0x9E,0x9F, \
 326:Core/Src/FAT/ff.c **** 					0xF0,0xF0,0xF2,0xF2,0xF4,0xF4,0xF6,0xF6,0xF8,0xF8,0xFA,0xFA,0xFC,0xFC,0xFE,0xFF}
 327:Core/Src/FAT/ff.c **** #define TBL_CT775  {0x80,0x9A,0x91,0xA0,0x8E,0x95,0x8F,0x80,0xAD,0xED,0x8A,0x8A,0xA1,0x8D,0x8E,0x8F
 328:Core/Src/FAT/ff.c **** 					0x90,0x92,0x92,0xE2,0x99,0x95,0x96,0x97,0x97,0x99,0x9A,0x9D,0x9C,0x9D,0x9E,0x9F, \
 329:Core/Src/FAT/ff.c **** 					0xA0,0xA1,0xE0,0xA3,0xA3,0xA5,0xA6,0xA7,0xA8,0xA9,0xAA,0xAB,0xAC,0xAD,0xAE,0xAF, \
 330:Core/Src/FAT/ff.c **** 					0xB0,0xB1,0xB2,0xB3,0xB4,0xB5,0xB6,0xB7,0xB8,0xB9,0xBA,0xBB,0xBC,0xBD,0xBE,0xBF, \
 331:Core/Src/FAT/ff.c **** 					0xC0,0xC1,0xC2,0xC3,0xC4,0xC5,0xC6,0xC7,0xC8,0xC9,0xCA,0xCB,0xCC,0xCD,0xCE,0xCF, \
 332:Core/Src/FAT/ff.c **** 					0xB5,0xB6,0xB7,0xB8,0xBD,0xBE,0xC6,0xC7,0xA5,0xD9,0xDA,0xDB,0xDC,0xDD,0xDE,0xDF, \
 333:Core/Src/FAT/ff.c **** 					0xE0,0xE1,0xE2,0xE3,0xE5,0xE5,0xE6,0xE3,0xE8,0xE8,0xEA,0xEA,0xEE,0xED,0xEE,0xEF, \
 334:Core/Src/FAT/ff.c **** 					0xF0,0xF1,0xF2,0xF3,0xF4,0xF5,0xF6,0xF7,0xF8,0xF9,0xFA,0xFB,0xFC,0xFD,0xFE,0xFF}
 335:Core/Src/FAT/ff.c **** #define TBL_CT850  {0x43,0x55,0x45,0x41,0x41,0x41,0x41,0x43,0x45,0x45,0x45,0x49,0x49,0x49,0x41,0x41
 336:Core/Src/FAT/ff.c **** 					0x45,0x92,0x92,0x4F,0x4F,0x4F,0x55,0x55,0x59,0x4F,0x55,0x4F,0x9C,0x4F,0x9E,0x9F, \
 337:Core/Src/FAT/ff.c **** 					0x41,0x49,0x4F,0x55,0xA5,0xA5,0xA6,0xA7,0xA8,0xA9,0xAA,0xAB,0xAC,0xAD,0xAE,0xAF, \
 338:Core/Src/FAT/ff.c **** 					0xB0,0xB1,0xB2,0xB3,0xB4,0x41,0x41,0x41,0xB8,0xB9,0xBA,0xBB,0xBC,0xBD,0xBE,0xBF, \
 339:Core/Src/FAT/ff.c **** 					0xC0,0xC1,0xC2,0xC3,0xC4,0xC5,0x41,0x41,0xC8,0xC9,0xCA,0xCB,0xCC,0xCD,0xCE,0xCF, \
 340:Core/Src/FAT/ff.c **** 					0xD1,0xD1,0x45,0x45,0x45,0x49,0x49,0x49,0x49,0xD9,0xDA,0xDB,0xDC,0xDD,0x49,0xDF, \
 341:Core/Src/FAT/ff.c **** 					0x4F,0xE1,0x4F,0x4F,0x4F,0x4F,0xE6,0xE8,0xE8,0x55,0x55,0x55,0x59,0x59,0xEE,0xEF, \
 342:Core/Src/FAT/ff.c **** 					0xF0,0xF1,0xF2,0xF3,0xF4,0xF5,0xF6,0xF7,0xF8,0xF9,0xFA,0xFB,0xFC,0xFD,0xFE,0xFF}
 343:Core/Src/FAT/ff.c **** #define TBL_CT852  {0x80,0x9A,0x90,0xB6,0x8E,0xDE,0x8F,0x80,0x9D,0xD3,0x8A,0x8A,0xD7,0x8D,0x8E,0x8F
 344:Core/Src/FAT/ff.c **** 					0x90,0x91,0x91,0xE2,0x99,0x95,0x95,0x97,0x97,0x99,0x9A,0x9B,0x9B,0x9D,0x9E,0xAC, \
 345:Core/Src/FAT/ff.c **** 					0xB5,0xD6,0xE0,0xE9,0xA4,0xA4,0xA6,0xA6,0xA8,0xA8,0xAA,0x8D,0xAC,0xB8,0xAE,0xAF, \
 346:Core/Src/FAT/ff.c **** 					0xB0,0xB1,0xB2,0xB3,0xB4,0xB5,0xB6,0xB7,0xB8,0xB9,0xBA,0xBB,0xBC,0xBD,0xBD,0xBF, \
 347:Core/Src/FAT/ff.c **** 					0xC0,0xC1,0xC2,0xC3,0xC4,0xC5,0xC6,0xC6,0xC8,0xC9,0xCA,0xCB,0xCC,0xCD,0xCE,0xCF, \
 348:Core/Src/FAT/ff.c **** 					0xD1,0xD1,0xD2,0xD3,0xD2,0xD5,0xD6,0xD7,0xB7,0xD9,0xDA,0xDB,0xDC,0xDD,0xDE,0xDF, \
 349:Core/Src/FAT/ff.c **** 					0xE0,0xE1,0xE2,0xE3,0xE3,0xD5,0xE6,0xE6,0xE8,0xE9,0xE8,0xEB,0xED,0xED,0xDD,0xEF, \
 350:Core/Src/FAT/ff.c **** 					0xF0,0xF1,0xF2,0xF3,0xF4,0xF5,0xF6,0xF7,0xF8,0xF9,0xFA,0xEB,0xFC,0xFC,0xFE,0xFF}
 351:Core/Src/FAT/ff.c **** #define TBL_CT855  {0x81,0x81,0x83,0x83,0x85,0x85,0x87,0x87,0x89,0x89,0x8B,0x8B,0x8D,0x8D,0x8F,0x8F
 352:Core/Src/FAT/ff.c **** 					0x91,0x91,0x93,0x93,0x95,0x95,0x97,0x97,0x99,0x99,0x9B,0x9B,0x9D,0x9D,0x9F,0x9F, \
 353:Core/Src/FAT/ff.c **** 					0xA1,0xA1,0xA3,0xA3,0xA5,0xA5,0xA7,0xA7,0xA9,0xA9,0xAB,0xAB,0xAD,0xAD,0xAE,0xAF, \
 354:Core/Src/FAT/ff.c **** 					0xB0,0xB1,0xB2,0xB3,0xB4,0xB6,0xB6,0xB8,0xB8,0xB9,0xBA,0xBB,0xBC,0xBE,0xBE,0xBF, \
 355:Core/Src/FAT/ff.c **** 					0xC0,0xC1,0xC2,0xC3,0xC4,0xC5,0xC7,0xC7,0xC8,0xC9,0xCA,0xCB,0xCC,0xCD,0xCE,0xCF, \
 356:Core/Src/FAT/ff.c **** 					0xD1,0xD1,0xD3,0xD3,0xD5,0xD5,0xD7,0xD7,0xDD,0xD9,0xDA,0xDB,0xDC,0xDD,0xE0,0xDF, \
 357:Core/Src/FAT/ff.c **** 					0xE0,0xE2,0xE2,0xE4,0xE4,0xE6,0xE6,0xE8,0xE8,0xEA,0xEA,0xEC,0xEC,0xEE,0xEE,0xEF, \
 358:Core/Src/FAT/ff.c **** 					0xF0,0xF2,0xF2,0xF4,0xF4,0xF6,0xF6,0xF8,0xF8,0xFA,0xFA,0xFC,0xFC,0xFD,0xFE,0xFF}
 359:Core/Src/FAT/ff.c **** #define TBL_CT857  {0x80,0x9A,0x90,0xB6,0x8E,0xB7,0x8F,0x80,0xD2,0xD3,0xD4,0xD8,0xD7,0x49,0x8E,0x8F
 360:Core/Src/FAT/ff.c **** 					0x90,0x92,0x92,0xE2,0x99,0xE3,0xEA,0xEB,0x98,0x99,0x9A,0x9D,0x9C,0x9D,0x9E,0x9E, \
 361:Core/Src/FAT/ff.c **** 					0xB5,0xD6,0xE0,0xE9,0xA5,0xA5,0xA6,0xA6,0xA8,0xA9,0xAA,0xAB,0xAC,0xAD,0xAE,0xAF, \
 362:Core/Src/FAT/ff.c **** 					0xB0,0xB1,0xB2,0xB3,0xB4,0xB5,0xB6,0xB7,0xB8,0xB9,0xBA,0xBB,0xBC,0xBD,0xBE,0xBF, \
 363:Core/Src/FAT/ff.c **** 					0xC0,0xC1,0xC2,0xC3,0xC4,0xC5,0xC7,0xC7,0xC8,0xC9,0xCA,0xCB,0xCC,0xCD,0xCE,0xCF, \
 364:Core/Src/FAT/ff.c **** 					0xD0,0xD1,0xD2,0xD3,0xD4,0x49,0xD6,0xD7,0xD8,0xD9,0xDA,0xDB,0xDC,0xDD,0xDE,0xDF, \
 365:Core/Src/FAT/ff.c **** 					0xE0,0xE1,0xE2,0xE3,0xE5,0xE5,0xE6,0xE7,0xE8,0xE9,0xEA,0xEB,0xDE,0xED,0xEE,0xEF, \
 366:Core/Src/FAT/ff.c **** 					0xF0,0xF1,0xF2,0xF3,0xF4,0xF5,0xF6,0xF7,0xF8,0xF9,0xFA,0xFB,0xFC,0xFD,0xFE,0xFF}
 367:Core/Src/FAT/ff.c **** #define TBL_CT860  {0x80,0x9A,0x90,0x8F,0x8E,0x91,0x86,0x80,0x89,0x89,0x92,0x8B,0x8C,0x98,0x8E,0x8F
 368:Core/Src/FAT/ff.c **** 					0x90,0x91,0x92,0x8C,0x99,0xA9,0x96,0x9D,0x98,0x99,0x9A,0x9B,0x9C,0x9D,0x9E,0x9F, \
 369:Core/Src/FAT/ff.c **** 					0x86,0x8B,0x9F,0x96,0xA5,0xA5,0xA6,0xA7,0xA8,0xA9,0xAA,0xAB,0xAC,0xAD,0xAE,0xAF, \
 370:Core/Src/FAT/ff.c **** 					0xB0,0xB1,0xB2,0xB3,0xB4,0xB5,0xB6,0xB7,0xB8,0xB9,0xBA,0xBB,0xBC,0xBD,0xBE,0xBF, \
 371:Core/Src/FAT/ff.c **** 					0xC0,0xC1,0xC2,0xC3,0xC4,0xC5,0xC6,0xC7,0xC8,0xC9,0xCA,0xCB,0xCC,0xCD,0xCE,0xCF, \
 372:Core/Src/FAT/ff.c **** 					0xD0,0xD1,0xD2,0xD3,0xD4,0xD5,0xD6,0xD7,0xD8,0xD9,0xDA,0xDB,0xDC,0xDD,0xDE,0xDF, \
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 8


 373:Core/Src/FAT/ff.c **** 					0xE0,0xE1,0xE2,0xE3,0xE4,0xE5,0xE6,0xE7,0xE8,0xE9,0xEA,0xEB,0xEC,0xED,0xEE,0xEF, \
 374:Core/Src/FAT/ff.c **** 					0xF0,0xF1,0xF2,0xF3,0xF4,0xF5,0xF6,0xF7,0xF8,0xF9,0xFA,0xFB,0xFC,0xFD,0xFE,0xFF}
 375:Core/Src/FAT/ff.c **** #define TBL_CT861  {0x80,0x9A,0x90,0x41,0x8E,0x41,0x8F,0x80,0x45,0x45,0x45,0x8B,0x8B,0x8D,0x8E,0x8F
 376:Core/Src/FAT/ff.c **** 					0x90,0x92,0x92,0x4F,0x99,0x8D,0x55,0x97,0x97,0x99,0x9A,0x9D,0x9C,0x9D,0x9E,0x9F, \
 377:Core/Src/FAT/ff.c **** 					0xA4,0xA5,0xA6,0xA7,0xA4,0xA5,0xA6,0xA7,0xA8,0xA9,0xAA,0xAB,0xAC,0xAD,0xAE,0xAF, \
 378:Core/Src/FAT/ff.c **** 					0xB0,0xB1,0xB2,0xB3,0xB4,0xB5,0xB6,0xB7,0xB8,0xB9,0xBA,0xBB,0xBC,0xBD,0xBE,0xBF, \
 379:Core/Src/FAT/ff.c **** 					0xC0,0xC1,0xC2,0xC3,0xC4,0xC5,0xC6,0xC7,0xC8,0xC9,0xCA,0xCB,0xCC,0xCD,0xCE,0xCF, \
 380:Core/Src/FAT/ff.c **** 					0xD0,0xD1,0xD2,0xD3,0xD4,0xD5,0xD6,0xD7,0xD8,0xD9,0xDA,0xDB,0xDC,0xDD,0xDE,0xDF, \
 381:Core/Src/FAT/ff.c **** 					0xE0,0xE1,0xE2,0xE3,0xE4,0xE5,0xE6,0xE7,0xE8,0xE9,0xEA,0xEB,0xEC,0xED,0xEE,0xEF, \
 382:Core/Src/FAT/ff.c **** 					0xF0,0xF1,0xF2,0xF3,0xF4,0xF5,0xF6,0xF7,0xF8,0xF9,0xFA,0xFB,0xFC,0xFD,0xFE,0xFF}
 383:Core/Src/FAT/ff.c **** #define TBL_CT862  {0x80,0x81,0x82,0x83,0x84,0x85,0x86,0x87,0x88,0x89,0x8A,0x8B,0x8C,0x8D,0x8E,0x8F
 384:Core/Src/FAT/ff.c **** 					0x90,0x91,0x92,0x93,0x94,0x95,0x96,0x97,0x98,0x99,0x9A,0x9B,0x9C,0x9D,0x9E,0x9F, \
 385:Core/Src/FAT/ff.c **** 					0x41,0x49,0x4F,0x55,0xA5,0xA5,0xA6,0xA7,0xA8,0xA9,0xAA,0xAB,0xAC,0xAD,0xAE,0xAF, \
 386:Core/Src/FAT/ff.c **** 					0xB0,0xB1,0xB2,0xB3,0xB4,0xB5,0xB6,0xB7,0xB8,0xB9,0xBA,0xBB,0xBC,0xBD,0xBE,0xBF, \
 387:Core/Src/FAT/ff.c **** 					0xC0,0xC1,0xC2,0xC3,0xC4,0xC5,0xC6,0xC7,0xC8,0xC9,0xCA,0xCB,0xCC,0xCD,0xCE,0xCF, \
 388:Core/Src/FAT/ff.c **** 					0xD0,0xD1,0xD2,0xD3,0xD4,0xD5,0xD6,0xD7,0xD8,0xD9,0xDA,0xDB,0xDC,0xDD,0xDE,0xDF, \
 389:Core/Src/FAT/ff.c **** 					0xE0,0xE1,0xE2,0xE3,0xE4,0xE5,0xE6,0xE7,0xE8,0xE9,0xEA,0xEB,0xEC,0xED,0xEE,0xEF, \
 390:Core/Src/FAT/ff.c **** 					0xF0,0xF1,0xF2,0xF3,0xF4,0xF5,0xF6,0xF7,0xF8,0xF9,0xFA,0xFB,0xFC,0xFD,0xFE,0xFF}
 391:Core/Src/FAT/ff.c **** #define TBL_CT863  {0x43,0x55,0x45,0x41,0x41,0x41,0x86,0x43,0x45,0x45,0x45,0x49,0x49,0x8D,0x41,0x8F
 392:Core/Src/FAT/ff.c **** 					0x45,0x45,0x45,0x4F,0x45,0x49,0x55,0x55,0x98,0x4F,0x55,0x9B,0x9C,0x55,0x55,0x9F, \
 393:Core/Src/FAT/ff.c **** 					0xA0,0xA1,0x4F,0x55,0xA4,0xA5,0xA6,0xA7,0x49,0xA9,0xAA,0xAB,0xAC,0xAD,0xAE,0xAF, \
 394:Core/Src/FAT/ff.c **** 					0xB0,0xB1,0xB2,0xB3,0xB4,0xB5,0xB6,0xB7,0xB8,0xB9,0xBA,0xBB,0xBC,0xBD,0xBE,0xBF, \
 395:Core/Src/FAT/ff.c **** 					0xC0,0xC1,0xC2,0xC3,0xC4,0xC5,0xC6,0xC7,0xC8,0xC9,0xCA,0xCB,0xCC,0xCD,0xCE,0xCF, \
 396:Core/Src/FAT/ff.c **** 					0xD0,0xD1,0xD2,0xD3,0xD4,0xD5,0xD6,0xD7,0xD8,0xD9,0xDA,0xDB,0xDC,0xDD,0xDE,0xDF, \
 397:Core/Src/FAT/ff.c **** 					0xE0,0xE1,0xE2,0xE3,0xE4,0xE5,0xE6,0xE7,0xE8,0xE9,0xEA,0xEB,0xEC,0xED,0xEE,0xEF, \
 398:Core/Src/FAT/ff.c **** 					0xF0,0xF1,0xF2,0xF3,0xF4,0xF5,0xF6,0xF7,0xF8,0xF9,0xFA,0xFB,0xFC,0xFD,0xFE,0xFF}
 399:Core/Src/FAT/ff.c **** #define TBL_CT864  {0x80,0x9A,0x45,0x41,0x8E,0x41,0x8F,0x80,0x45,0x45,0x45,0x49,0x49,0x49,0x8E,0x8F
 400:Core/Src/FAT/ff.c **** 					0x90,0x92,0x92,0x4F,0x99,0x4F,0x55,0x55,0x59,0x99,0x9A,0x9B,0x9C,0x9D,0x9E,0x9F, \
 401:Core/Src/FAT/ff.c **** 					0x41,0x49,0x4F,0x55,0xA5,0xA5,0xA6,0xA7,0xA8,0xA9,0xAA,0xAB,0xAC,0xAD,0xAE,0xAF, \
 402:Core/Src/FAT/ff.c **** 					0xB0,0xB1,0xB2,0xB3,0xB4,0xB5,0xB6,0xB7,0xB8,0xB9,0xBA,0xBB,0xBC,0xBD,0xBE,0xBF, \
 403:Core/Src/FAT/ff.c **** 					0xC0,0xC1,0xC2,0xC3,0xC4,0xC5,0xC6,0xC7,0xC8,0xC9,0xCA,0xCB,0xCC,0xCD,0xCE,0xCF, \
 404:Core/Src/FAT/ff.c **** 					0xD0,0xD1,0xD2,0xD3,0xD4,0xD5,0xD6,0xD7,0xD8,0xD9,0xDA,0xDB,0xDC,0xDD,0xDE,0xDF, \
 405:Core/Src/FAT/ff.c **** 					0xE0,0xE1,0xE2,0xE3,0xE4,0xE5,0xE6,0xE7,0xE8,0xE9,0xEA,0xEB,0xEC,0xED,0xEE,0xEF, \
 406:Core/Src/FAT/ff.c **** 					0xF0,0xF1,0xF2,0xF3,0xF4,0xF5,0xF6,0xF7,0xF8,0xF9,0xFA,0xFB,0xFC,0xFD,0xFE,0xFF}
 407:Core/Src/FAT/ff.c **** #define TBL_CT865  {0x80,0x9A,0x90,0x41,0x8E,0x41,0x8F,0x80,0x45,0x45,0x45,0x49,0x49,0x49,0x8E,0x8F
 408:Core/Src/FAT/ff.c **** 					0x90,0x92,0x92,0x4F,0x99,0x4F,0x55,0x55,0x59,0x99,0x9A,0x9B,0x9C,0x9D,0x9E,0x9F, \
 409:Core/Src/FAT/ff.c **** 					0x41,0x49,0x4F,0x55,0xA5,0xA5,0xA6,0xA7,0xA8,0xA9,0xAA,0xAB,0xAC,0xAD,0xAE,0xAF, \
 410:Core/Src/FAT/ff.c **** 					0xB0,0xB1,0xB2,0xB3,0xB4,0xB5,0xB6,0xB7,0xB8,0xB9,0xBA,0xBB,0xBC,0xBD,0xBE,0xBF, \
 411:Core/Src/FAT/ff.c **** 					0xC0,0xC1,0xC2,0xC3,0xC4,0xC5,0xC6,0xC7,0xC8,0xC9,0xCA,0xCB,0xCC,0xCD,0xCE,0xCF, \
 412:Core/Src/FAT/ff.c **** 					0xD0,0xD1,0xD2,0xD3,0xD4,0xD5,0xD6,0xD7,0xD8,0xD9,0xDA,0xDB,0xDC,0xDD,0xDE,0xDF, \
 413:Core/Src/FAT/ff.c **** 					0xE0,0xE1,0xE2,0xE3,0xE4,0xE5,0xE6,0xE7,0xE8,0xE9,0xEA,0xEB,0xEC,0xED,0xEE,0xEF, \
 414:Core/Src/FAT/ff.c **** 					0xF0,0xF1,0xF2,0xF3,0xF4,0xF5,0xF6,0xF7,0xF8,0xF9,0xFA,0xFB,0xFC,0xFD,0xFE,0xFF}
 415:Core/Src/FAT/ff.c **** #define TBL_CT866  {0x80,0x81,0x82,0x83,0x84,0x85,0x86,0x87,0x88,0x89,0x8A,0x8B,0x8C,0x8D,0x8E,0x8F
 416:Core/Src/FAT/ff.c **** 					0x90,0x91,0x92,0x93,0x94,0x95,0x96,0x97,0x98,0x99,0x9A,0x9B,0x9C,0x9D,0x9E,0x9F, \
 417:Core/Src/FAT/ff.c **** 					0x80,0x81,0x82,0x83,0x84,0x85,0x86,0x87,0x88,0x89,0x8A,0x8B,0x8C,0x8D,0x8E,0x8F, \
 418:Core/Src/FAT/ff.c **** 					0xB0,0xB1,0xB2,0xB3,0xB4,0xB5,0xB6,0xB7,0xB8,0xB9,0xBA,0xBB,0xBC,0xBD,0xBE,0xBF, \
 419:Core/Src/FAT/ff.c **** 					0xC0,0xC1,0xC2,0xC3,0xC4,0xC5,0xC6,0xC7,0xC8,0xC9,0xCA,0xCB,0xCC,0xCD,0xCE,0xCF, \
 420:Core/Src/FAT/ff.c **** 					0xD0,0xD1,0xD2,0xD3,0xD4,0xD5,0xD6,0xD7,0xD8,0xD9,0xDA,0xDB,0xDC,0xDD,0xDE,0xDF, \
 421:Core/Src/FAT/ff.c **** 					0x90,0x91,0x92,0x93,0x94,0x95,0x96,0x97,0x98,0x99,0x9A,0x9B,0x9C,0x9D,0x9E,0x9F, \
 422:Core/Src/FAT/ff.c **** 					0xF0,0xF0,0xF2,0xF2,0xF4,0xF4,0xF6,0xF6,0xF8,0xF9,0xFA,0xFB,0xFC,0xFD,0xFE,0xFF}
 423:Core/Src/FAT/ff.c **** #define TBL_CT869  {0x80,0x81,0x82,0x83,0x84,0x85,0x86,0x87,0x88,0x89,0x8A,0x8B,0x8C,0x8D,0x8E,0x8F
 424:Core/Src/FAT/ff.c **** 					0x90,0x91,0x92,0x93,0x94,0x95,0x96,0x97,0x98,0x99,0x9A,0x86,0x9C,0x8D,0x8F,0x90, \
 425:Core/Src/FAT/ff.c **** 					0x91,0x90,0x92,0x95,0xA4,0xA5,0xA6,0xA7,0xA8,0xA9,0xAA,0xAB,0xAC,0xAD,0xAE,0xAF, \
 426:Core/Src/FAT/ff.c **** 					0xB0,0xB1,0xB2,0xB3,0xB4,0xB5,0xB6,0xB7,0xB8,0xB9,0xBA,0xBB,0xBC,0xBD,0xBE,0xBF, \
 427:Core/Src/FAT/ff.c **** 					0xC0,0xC1,0xC2,0xC3,0xC4,0xC5,0xC6,0xC7,0xC8,0xC9,0xCA,0xCB,0xCC,0xCD,0xCE,0xCF, \
 428:Core/Src/FAT/ff.c **** 					0xD0,0xD1,0xD2,0xD3,0xD4,0xD5,0xA4,0xA5,0xA6,0xD9,0xDA,0xDB,0xDC,0xA7,0xA8,0xDF, \
 429:Core/Src/FAT/ff.c **** 					0xA9,0xAA,0xAC,0xAD,0xB5,0xB6,0xB7,0xB8,0xBD,0xBE,0xC6,0xC7,0xCF,0xCF,0xD0,0xEF, \
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 9


 430:Core/Src/FAT/ff.c **** 					0xF0,0xF1,0xD1,0xD2,0xD3,0xF5,0xD4,0xF7,0xF8,0xF9,0xD5,0x96,0x95,0x98,0xFE,0xFF}
 431:Core/Src/FAT/ff.c **** 
 432:Core/Src/FAT/ff.c **** 
 433:Core/Src/FAT/ff.c **** /* DBCS code range |----- 1st byte -----|  |----------- 2nd byte -----------| */
 434:Core/Src/FAT/ff.c **** /*                  <------>    <------>    <------>    <------>    <------>  */
 435:Core/Src/FAT/ff.c **** #define TBL_DC932 {0x81, 0x9F, 0xE0, 0xFC, 0x40, 0x7E, 0x80, 0xFC, 0x00, 0x00}
 436:Core/Src/FAT/ff.c **** #define TBL_DC936 {0x81, 0xFE, 0x00, 0x00, 0x40, 0x7E, 0x80, 0xFE, 0x00, 0x00}
 437:Core/Src/FAT/ff.c **** #define TBL_DC949 {0x81, 0xFE, 0x00, 0x00, 0x41, 0x5A, 0x61, 0x7A, 0x81, 0xFE}
 438:Core/Src/FAT/ff.c **** #define TBL_DC950 {0x81, 0xFE, 0x00, 0x00, 0x40, 0x7E, 0xA1, 0xFE, 0x00, 0x00}
 439:Core/Src/FAT/ff.c **** 
 440:Core/Src/FAT/ff.c **** 
 441:Core/Src/FAT/ff.c **** /* Macros for table definitions */
 442:Core/Src/FAT/ff.c **** #define MERGE_2STR(a, b) a ## b
 443:Core/Src/FAT/ff.c **** #define MKCVTBL(hd, cp) MERGE_2STR(hd, cp)
 444:Core/Src/FAT/ff.c **** 
 445:Core/Src/FAT/ff.c **** 
 446:Core/Src/FAT/ff.c **** 
 447:Core/Src/FAT/ff.c **** 
 448:Core/Src/FAT/ff.c **** /*--------------------------------------------------------------------------
 449:Core/Src/FAT/ff.c **** 
 450:Core/Src/FAT/ff.c ****    Module Private Work Area
 451:Core/Src/FAT/ff.c **** 
 452:Core/Src/FAT/ff.c **** ---------------------------------------------------------------------------*/
 453:Core/Src/FAT/ff.c **** /* Remark: Variables defined here without initial value shall be guaranteed
 454:Core/Src/FAT/ff.c **** /  zero/null at start-up. If not, the linker option or start-up routine is
 455:Core/Src/FAT/ff.c **** /  not compliance with C standard. */
 456:Core/Src/FAT/ff.c **** 
 457:Core/Src/FAT/ff.c **** /*--------------------------------*/
 458:Core/Src/FAT/ff.c **** /* File/Volume controls           */
 459:Core/Src/FAT/ff.c **** /*--------------------------------*/
 460:Core/Src/FAT/ff.c **** 
 461:Core/Src/FAT/ff.c **** #if FF_VOLUMES < 1 || FF_VOLUMES > 10
 462:Core/Src/FAT/ff.c **** #error Wrong FF_VOLUMES setting
 463:Core/Src/FAT/ff.c **** #endif
 464:Core/Src/FAT/ff.c **** static FATFS *FatFs[FF_VOLUMES];	/* Pointer to the filesystem objects (logical drives) */
 465:Core/Src/FAT/ff.c **** static WORD Fsid;					/* Filesystem mount ID */
 466:Core/Src/FAT/ff.c **** 
 467:Core/Src/FAT/ff.c **** #if FF_FS_RPATH != 0
 468:Core/Src/FAT/ff.c **** static BYTE CurrVol;				/* Current drive set by f_chdrive() */
 469:Core/Src/FAT/ff.c **** #endif
 470:Core/Src/FAT/ff.c **** 
 471:Core/Src/FAT/ff.c **** #if FF_FS_LOCK != 0
 472:Core/Src/FAT/ff.c **** static FILESEM Files[FF_FS_LOCK];	/* Open object lock semaphores */
 473:Core/Src/FAT/ff.c **** #if FF_FS_REENTRANT
 474:Core/Src/FAT/ff.c **** static BYTE SysLock;				/* System lock flag (0:no mutex, 1:unlocked, 2:locked) */
 475:Core/Src/FAT/ff.c **** #endif
 476:Core/Src/FAT/ff.c **** #endif
 477:Core/Src/FAT/ff.c **** 
 478:Core/Src/FAT/ff.c **** #if FF_STR_VOLUME_ID
 479:Core/Src/FAT/ff.c **** #ifdef FF_VOLUME_STRS
 480:Core/Src/FAT/ff.c **** static const char *const VolumeStr[FF_VOLUMES] = {FF_VOLUME_STRS};	/* Pre-defined volume ID */
 481:Core/Src/FAT/ff.c **** #endif
 482:Core/Src/FAT/ff.c **** #endif
 483:Core/Src/FAT/ff.c **** 
 484:Core/Src/FAT/ff.c **** #if FF_LBA64
 485:Core/Src/FAT/ff.c **** #if FF_MIN_GPT > 0x100000000
 486:Core/Src/FAT/ff.c **** #error Wrong FF_MIN_GPT setting
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 10


 487:Core/Src/FAT/ff.c **** #endif
 488:Core/Src/FAT/ff.c **** static const BYTE GUID_MS_Basic[16] = {0xA2,0xA0,0xD0,0xEB,0xE5,0xB9,0x33,0x44,0x87,0xC0,0x68,0xB6,
 489:Core/Src/FAT/ff.c **** #endif
 490:Core/Src/FAT/ff.c **** 
 491:Core/Src/FAT/ff.c **** 
 492:Core/Src/FAT/ff.c **** 
 493:Core/Src/FAT/ff.c **** /*--------------------------------*/
 494:Core/Src/FAT/ff.c **** /* LFN/Directory working buffer   */
 495:Core/Src/FAT/ff.c **** /*--------------------------------*/
 496:Core/Src/FAT/ff.c **** 
 497:Core/Src/FAT/ff.c **** #if FF_USE_LFN == 0		/* Non-LFN configuration */
 498:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT
 499:Core/Src/FAT/ff.c **** #error LFN must be enabled when enable exFAT
 500:Core/Src/FAT/ff.c **** #endif
 501:Core/Src/FAT/ff.c **** #define DEF_NAMBUF
 502:Core/Src/FAT/ff.c **** #define INIT_NAMBUF(fs)
 503:Core/Src/FAT/ff.c **** #define FREE_NAMBUF()
 504:Core/Src/FAT/ff.c **** #define LEAVE_MKFS(res)	return res
 505:Core/Src/FAT/ff.c **** 
 506:Core/Src/FAT/ff.c **** #else					/* LFN configurations */
 507:Core/Src/FAT/ff.c **** #if FF_MAX_LFN < 12 || FF_MAX_LFN > 255
 508:Core/Src/FAT/ff.c **** #error Wrong setting of FF_MAX_LFN
 509:Core/Src/FAT/ff.c **** #endif
 510:Core/Src/FAT/ff.c **** #if FF_LFN_BUF < FF_SFN_BUF || FF_SFN_BUF < 12
 511:Core/Src/FAT/ff.c **** #error Wrong setting of FF_LFN_BUF or FF_SFN_BUF
 512:Core/Src/FAT/ff.c **** #endif
 513:Core/Src/FAT/ff.c **** #if FF_LFN_UNICODE < 0 || FF_LFN_UNICODE > 3
 514:Core/Src/FAT/ff.c **** #error Wrong setting of FF_LFN_UNICODE
 515:Core/Src/FAT/ff.c **** #endif
 516:Core/Src/FAT/ff.c **** static const BYTE LfnOfs[] = {1,3,5,7,9,14,16,18,20,22,24,28,30};	/* FAT: Offset of LFN characters 
 517:Core/Src/FAT/ff.c **** #define MAXDIRB(nc)	((nc + 44U) / 15 * SZDIRE)	/* exFAT: Size of directory entry block scratchpad b
 518:Core/Src/FAT/ff.c **** 
 519:Core/Src/FAT/ff.c **** #if FF_USE_LFN == 1		/* LFN enabled with static working buffer */
 520:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT
 521:Core/Src/FAT/ff.c **** static BYTE	DirBuf[MAXDIRB(FF_MAX_LFN)];	/* Directory entry block scratchpad buffer */
 522:Core/Src/FAT/ff.c **** #endif
 523:Core/Src/FAT/ff.c **** static WCHAR LfnBuf[FF_MAX_LFN + 1];		/* LFN working buffer */
 524:Core/Src/FAT/ff.c **** #define DEF_NAMBUF
 525:Core/Src/FAT/ff.c **** #define INIT_NAMBUF(fs)
 526:Core/Src/FAT/ff.c **** #define FREE_NAMBUF()
 527:Core/Src/FAT/ff.c **** #define LEAVE_MKFS(res)	return res
 528:Core/Src/FAT/ff.c **** 
 529:Core/Src/FAT/ff.c **** #elif FF_USE_LFN == 2 	/* LFN enabled with dynamic working buffer on the stack */
 530:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT
 531:Core/Src/FAT/ff.c **** #define DEF_NAMBUF		WCHAR lbuf[FF_MAX_LFN+1]; BYTE dbuf[MAXDIRB(FF_MAX_LFN)];	/* LFN working buffer
 532:Core/Src/FAT/ff.c **** #define INIT_NAMBUF(fs)	{ (fs)->lfnbuf = lbuf; (fs)->dirbuf = dbuf; }
 533:Core/Src/FAT/ff.c **** #define FREE_NAMBUF()
 534:Core/Src/FAT/ff.c **** #else
 535:Core/Src/FAT/ff.c **** #define DEF_NAMBUF		WCHAR lbuf[FF_MAX_LFN+1];	/* LFN working buffer */
 536:Core/Src/FAT/ff.c **** #define INIT_NAMBUF(fs)	{ (fs)->lfnbuf = lbuf; }
 537:Core/Src/FAT/ff.c **** #define FREE_NAMBUF()
 538:Core/Src/FAT/ff.c **** #endif
 539:Core/Src/FAT/ff.c **** #define LEAVE_MKFS(res)	return res
 540:Core/Src/FAT/ff.c **** 
 541:Core/Src/FAT/ff.c **** #elif FF_USE_LFN == 3 	/* LFN enabled with dynamic working buffer on the heap */
 542:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT
 543:Core/Src/FAT/ff.c **** #define DEF_NAMBUF		WCHAR *lfn;	/* Pointer to LFN working buffer and directory entry block scratchp
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 11


 544:Core/Src/FAT/ff.c **** #define INIT_NAMBUF(fs)	{ lfn = ff_memalloc((FF_MAX_LFN+1)*2 + MAXDIRB(FF_MAX_LFN)); if (!lfn) LEAV
 545:Core/Src/FAT/ff.c **** #define FREE_NAMBUF()	ff_memfree(lfn)
 546:Core/Src/FAT/ff.c **** #else
 547:Core/Src/FAT/ff.c **** #define DEF_NAMBUF		WCHAR *lfn;	/* Pointer to LFN working buffer */
 548:Core/Src/FAT/ff.c **** #define INIT_NAMBUF(fs)	{ lfn = ff_memalloc((FF_MAX_LFN+1)*2); if (!lfn) LEAVE_FF(fs, FR_NOT_ENOUGH
 549:Core/Src/FAT/ff.c **** #define FREE_NAMBUF()	ff_memfree(lfn)
 550:Core/Src/FAT/ff.c **** #endif
 551:Core/Src/FAT/ff.c **** #define LEAVE_MKFS(res)	{ if (!work) ff_memfree(buf); return res; }
 552:Core/Src/FAT/ff.c **** #define MAX_MALLOC	0x8000	/* Must be >=FF_MAX_SS */
 553:Core/Src/FAT/ff.c **** 
 554:Core/Src/FAT/ff.c **** #else
 555:Core/Src/FAT/ff.c **** #error Wrong setting of FF_USE_LFN
 556:Core/Src/FAT/ff.c **** 
 557:Core/Src/FAT/ff.c **** #endif	/* FF_USE_LFN == 1 */
 558:Core/Src/FAT/ff.c **** #endif	/* FF_USE_LFN == 0 */
 559:Core/Src/FAT/ff.c **** 
 560:Core/Src/FAT/ff.c **** 
 561:Core/Src/FAT/ff.c **** 
 562:Core/Src/FAT/ff.c **** /*--------------------------------*/
 563:Core/Src/FAT/ff.c **** /* Code conversion tables         */
 564:Core/Src/FAT/ff.c **** /*--------------------------------*/
 565:Core/Src/FAT/ff.c **** 
 566:Core/Src/FAT/ff.c **** #if FF_CODE_PAGE == 0	/* Run-time code page configuration */
 567:Core/Src/FAT/ff.c **** #define CODEPAGE CodePage
 568:Core/Src/FAT/ff.c **** static WORD CodePage;	/* Current code page */
 569:Core/Src/FAT/ff.c **** static const BYTE* ExCvt;	/* Ptr to SBCS up-case table Ct???[] (null:not used) */
 570:Core/Src/FAT/ff.c **** static const BYTE* DbcTbl;	/* Ptr to DBCS code range table Dc???[] (null:not used) */
 571:Core/Src/FAT/ff.c **** 
 572:Core/Src/FAT/ff.c **** static const BYTE Ct437[] = TBL_CT437;
 573:Core/Src/FAT/ff.c **** static const BYTE Ct720[] = TBL_CT720;
 574:Core/Src/FAT/ff.c **** static const BYTE Ct737[] = TBL_CT737;
 575:Core/Src/FAT/ff.c **** static const BYTE Ct771[] = TBL_CT771;
 576:Core/Src/FAT/ff.c **** static const BYTE Ct775[] = TBL_CT775;
 577:Core/Src/FAT/ff.c **** static const BYTE Ct850[] = TBL_CT850;
 578:Core/Src/FAT/ff.c **** static const BYTE Ct852[] = TBL_CT852;
 579:Core/Src/FAT/ff.c **** static const BYTE Ct855[] = TBL_CT855;
 580:Core/Src/FAT/ff.c **** static const BYTE Ct857[] = TBL_CT857;
 581:Core/Src/FAT/ff.c **** static const BYTE Ct860[] = TBL_CT860;
 582:Core/Src/FAT/ff.c **** static const BYTE Ct861[] = TBL_CT861;
 583:Core/Src/FAT/ff.c **** static const BYTE Ct862[] = TBL_CT862;
 584:Core/Src/FAT/ff.c **** static const BYTE Ct863[] = TBL_CT863;
 585:Core/Src/FAT/ff.c **** static const BYTE Ct864[] = TBL_CT864;
 586:Core/Src/FAT/ff.c **** static const BYTE Ct865[] = TBL_CT865;
 587:Core/Src/FAT/ff.c **** static const BYTE Ct866[] = TBL_CT866;
 588:Core/Src/FAT/ff.c **** static const BYTE Ct869[] = TBL_CT869;
 589:Core/Src/FAT/ff.c **** static const BYTE Dc932[] = TBL_DC932;
 590:Core/Src/FAT/ff.c **** static const BYTE Dc936[] = TBL_DC936;
 591:Core/Src/FAT/ff.c **** static const BYTE Dc949[] = TBL_DC949;
 592:Core/Src/FAT/ff.c **** static const BYTE Dc950[] = TBL_DC950;
 593:Core/Src/FAT/ff.c **** 
 594:Core/Src/FAT/ff.c **** #elif FF_CODE_PAGE < 900	/* Static code page configuration (SBCS) */
 595:Core/Src/FAT/ff.c **** #define CODEPAGE FF_CODE_PAGE
 596:Core/Src/FAT/ff.c **** static const BYTE ExCvt[] = MKCVTBL(TBL_CT, FF_CODE_PAGE);
 597:Core/Src/FAT/ff.c **** 
 598:Core/Src/FAT/ff.c **** #else					/* Static code page configuration (DBCS) */
 599:Core/Src/FAT/ff.c **** #define CODEPAGE FF_CODE_PAGE
 600:Core/Src/FAT/ff.c **** static const BYTE DbcTbl[] = MKCVTBL(TBL_DC, FF_CODE_PAGE);
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 12


 601:Core/Src/FAT/ff.c **** 
 602:Core/Src/FAT/ff.c **** #endif
 603:Core/Src/FAT/ff.c **** 
 604:Core/Src/FAT/ff.c **** 
 605:Core/Src/FAT/ff.c **** 
 606:Core/Src/FAT/ff.c **** 
 607:Core/Src/FAT/ff.c **** /*--------------------------------------------------------------------------
 608:Core/Src/FAT/ff.c **** 
 609:Core/Src/FAT/ff.c ****    Module Private Functions
 610:Core/Src/FAT/ff.c **** 
 611:Core/Src/FAT/ff.c **** ---------------------------------------------------------------------------*/
 612:Core/Src/FAT/ff.c **** 
 613:Core/Src/FAT/ff.c **** 
 614:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
 615:Core/Src/FAT/ff.c **** /* Load/Store multi-byte word in the FAT structure                       */
 616:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
 617:Core/Src/FAT/ff.c **** 
 618:Core/Src/FAT/ff.c **** static WORD ld_word (const BYTE* ptr)	/*	 Load a 2-byte little-endian word */
 619:Core/Src/FAT/ff.c **** {
  29              		.loc 1 619 1 view -0
  30              		.cfi_startproc
  31              		@ args = 0, pretend = 0, frame = 0
  32              		@ frame_needed = 0, uses_anonymous_args = 0
  33              		@ link register save eliminated.
 620:Core/Src/FAT/ff.c **** 	WORD rv;
  34              		.loc 1 620 2 view .LVU1
 621:Core/Src/FAT/ff.c **** 
 622:Core/Src/FAT/ff.c **** 	rv = ptr[1];
  35              		.loc 1 622 2 view .LVU2
  36              		.loc 1 622 10 is_stmt 0 view .LVU3
  37 0000 4278     		ldrb	r2, [r0, #1]	@ zero_extendqisi2
  38              	.LVL1:
 623:Core/Src/FAT/ff.c **** 	rv = rv << 8 | ptr[0];
  39              		.loc 1 623 2 is_stmt 1 view .LVU4
  40              		.loc 1 623 20 is_stmt 0 view .LVU5
  41 0002 0078     		ldrb	r0, [r0]	@ zero_extendqisi2
  42              	.LVL2:
 624:Core/Src/FAT/ff.c **** 	return rv;
  43              		.loc 1 624 2 is_stmt 1 view .LVU6
 625:Core/Src/FAT/ff.c **** }
  44              		.loc 1 625 1 is_stmt 0 view .LVU7
  45 0004 40EA0220 		orr	r0, r0, r2, lsl #8
  46              	.LVL3:
  47              		.loc 1 625 1 view .LVU8
  48 0008 7047     		bx	lr
  49              		.cfi_endproc
  50              	.LFE0:
  52              		.section	.text.ld_dword,"ax",%progbits
  53              		.align	1
  54              		.syntax unified
  55              		.thumb
  56              		.thumb_func
  58              	ld_dword:
  59              	.LVL4:
  60              	.LFB1:
 626:Core/Src/FAT/ff.c **** 
 627:Core/Src/FAT/ff.c **** static DWORD ld_dword (const BYTE* ptr)	/* Load a 4-byte little-endian word */
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 13


 628:Core/Src/FAT/ff.c **** {
  61              		.loc 1 628 1 is_stmt 1 view -0
  62              		.cfi_startproc
  63              		@ args = 0, pretend = 0, frame = 0
  64              		@ frame_needed = 0, uses_anonymous_args = 0
  65              		@ link register save eliminated.
 629:Core/Src/FAT/ff.c **** 	DWORD rv;
  66              		.loc 1 629 2 view .LVU10
 630:Core/Src/FAT/ff.c **** 
 631:Core/Src/FAT/ff.c **** 	rv = ptr[3];
  67              		.loc 1 631 2 view .LVU11
  68              		.loc 1 631 10 is_stmt 0 view .LVU12
  69 0000 C278     		ldrb	r2, [r0, #3]	@ zero_extendqisi2
  70              	.LVL5:
 632:Core/Src/FAT/ff.c **** 	rv = rv << 8 | ptr[2];
  71              		.loc 1 632 2 is_stmt 1 view .LVU13
  72              		.loc 1 632 20 is_stmt 0 view .LVU14
  73 0002 8378     		ldrb	r3, [r0, #2]	@ zero_extendqisi2
  74              		.loc 1 632 5 view .LVU15
  75 0004 43EA0222 		orr	r2, r3, r2, lsl #8
  76              	.LVL6:
 633:Core/Src/FAT/ff.c **** 	rv = rv << 8 | ptr[1];
  77              		.loc 1 633 2 is_stmt 1 view .LVU16
  78              		.loc 1 633 20 is_stmt 0 view .LVU17
  79 0008 4378     		ldrb	r3, [r0, #1]	@ zero_extendqisi2
  80              		.loc 1 633 5 view .LVU18
  81 000a 43EA0223 		orr	r3, r3, r2, lsl #8
  82              	.LVL7:
 634:Core/Src/FAT/ff.c **** 	rv = rv << 8 | ptr[0];
  83              		.loc 1 634 2 is_stmt 1 view .LVU19
  84              		.loc 1 634 20 is_stmt 0 view .LVU20
  85 000e 0078     		ldrb	r0, [r0]	@ zero_extendqisi2
  86              	.LVL8:
 635:Core/Src/FAT/ff.c **** 	return rv;
  87              		.loc 1 635 2 is_stmt 1 view .LVU21
 636:Core/Src/FAT/ff.c **** }
  88              		.loc 1 636 1 is_stmt 0 view .LVU22
  89 0010 40EA0320 		orr	r0, r0, r3, lsl #8
  90              	.LVL9:
  91              		.loc 1 636 1 view .LVU23
  92 0014 7047     		bx	lr
  93              		.cfi_endproc
  94              	.LFE1:
  96              		.section	.text.st_word,"ax",%progbits
  97              		.align	1
  98              		.syntax unified
  99              		.thumb
 100              		.thumb_func
 102              	st_word:
 103              	.LVL10:
 104              	.LFB2:
 637:Core/Src/FAT/ff.c **** 
 638:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT
 639:Core/Src/FAT/ff.c **** static QWORD ld_qword (const BYTE* ptr)	/* Load an 8-byte little-endian word */
 640:Core/Src/FAT/ff.c **** {
 641:Core/Src/FAT/ff.c **** 	QWORD rv;
 642:Core/Src/FAT/ff.c **** 
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 14


 643:Core/Src/FAT/ff.c **** 	rv = ptr[7];
 644:Core/Src/FAT/ff.c **** 	rv = rv << 8 | ptr[6];
 645:Core/Src/FAT/ff.c **** 	rv = rv << 8 | ptr[5];
 646:Core/Src/FAT/ff.c **** 	rv = rv << 8 | ptr[4];
 647:Core/Src/FAT/ff.c **** 	rv = rv << 8 | ptr[3];
 648:Core/Src/FAT/ff.c **** 	rv = rv << 8 | ptr[2];
 649:Core/Src/FAT/ff.c **** 	rv = rv << 8 | ptr[1];
 650:Core/Src/FAT/ff.c **** 	rv = rv << 8 | ptr[0];
 651:Core/Src/FAT/ff.c **** 	return rv;
 652:Core/Src/FAT/ff.c **** }
 653:Core/Src/FAT/ff.c **** #endif
 654:Core/Src/FAT/ff.c **** 
 655:Core/Src/FAT/ff.c **** #if !FF_FS_READONLY
 656:Core/Src/FAT/ff.c **** static void st_word (BYTE* ptr, WORD val)	/* Store a 2-byte word in little-endian */
 657:Core/Src/FAT/ff.c **** {
 105              		.loc 1 657 1 is_stmt 1 view -0
 106              		.cfi_startproc
 107              		@ args = 0, pretend = 0, frame = 0
 108              		@ frame_needed = 0, uses_anonymous_args = 0
 109              		@ link register save eliminated.
 658:Core/Src/FAT/ff.c **** 	*ptr++ = (BYTE)val; val >>= 8;
 110              		.loc 1 658 2 view .LVU25
 111              		.loc 1 658 9 is_stmt 0 view .LVU26
 112 0000 0170     		strb	r1, [r0]
 113              		.loc 1 658 22 is_stmt 1 view .LVU27
 114              	.LVL11:
 659:Core/Src/FAT/ff.c **** 	*ptr++ = (BYTE)val;
 115              		.loc 1 659 2 view .LVU28
 116              		.loc 1 659 11 is_stmt 0 view .LVU29
 117 0002 090A     		lsrs	r1, r1, #8
 118              	.LVL12:
 119              		.loc 1 659 9 view .LVU30
 120 0004 4170     		strb	r1, [r0, #1]
 660:Core/Src/FAT/ff.c **** }
 121              		.loc 1 660 1 view .LVU31
 122 0006 7047     		bx	lr
 123              		.cfi_endproc
 124              	.LFE2:
 126              		.section	.text.st_dword,"ax",%progbits
 127              		.align	1
 128              		.syntax unified
 129              		.thumb
 130              		.thumb_func
 132              	st_dword:
 133              	.LVL13:
 134              	.LFB3:
 661:Core/Src/FAT/ff.c **** 
 662:Core/Src/FAT/ff.c **** static void st_dword (BYTE* ptr, DWORD val)	/* Store a 4-byte word in little-endian */
 663:Core/Src/FAT/ff.c **** {
 135              		.loc 1 663 1 is_stmt 1 view -0
 136              		.cfi_startproc
 137              		@ args = 0, pretend = 0, frame = 0
 138              		@ frame_needed = 0, uses_anonymous_args = 0
 139              		@ link register save eliminated.
 664:Core/Src/FAT/ff.c **** 	*ptr++ = (BYTE)val; val >>= 8;
 140              		.loc 1 664 2 view .LVU33
 141              		.loc 1 664 9 is_stmt 0 view .LVU34
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 15


 142 0000 0170     		strb	r1, [r0]
 143              		.loc 1 664 22 is_stmt 1 view .LVU35
 144              	.LVL14:
 665:Core/Src/FAT/ff.c **** 	*ptr++ = (BYTE)val; val >>= 8;
 145              		.loc 1 665 2 view .LVU36
 146              		.loc 1 665 11 is_stmt 0 view .LVU37
 147 0002 C1F30723 		ubfx	r3, r1, #8, #8
 148              		.loc 1 665 9 view .LVU38
 149 0006 4370     		strb	r3, [r0, #1]
 150              		.loc 1 665 22 is_stmt 1 view .LVU39
 151              	.LVL15:
 666:Core/Src/FAT/ff.c **** 	*ptr++ = (BYTE)val; val >>= 8;
 152              		.loc 1 666 2 view .LVU40
 153              		.loc 1 666 11 is_stmt 0 view .LVU41
 154 0008 C1F30743 		ubfx	r3, r1, #16, #8
 155              		.loc 1 666 9 view .LVU42
 156 000c 8370     		strb	r3, [r0, #2]
 157              		.loc 1 666 22 is_stmt 1 view .LVU43
 158              	.LVL16:
 667:Core/Src/FAT/ff.c **** 	*ptr++ = (BYTE)val;
 159              		.loc 1 667 2 view .LVU44
 160              		.loc 1 667 11 is_stmt 0 view .LVU45
 161 000e 090E     		lsrs	r1, r1, #24
 162              	.LVL17:
 163              		.loc 1 667 9 view .LVU46
 164 0010 C170     		strb	r1, [r0, #3]
 668:Core/Src/FAT/ff.c **** }
 165              		.loc 1 668 1 view .LVU47
 166 0012 7047     		bx	lr
 167              		.cfi_endproc
 168              	.LFE3:
 170              		.section	.text.dbc_1st,"ax",%progbits
 171              		.align	1
 172              		.syntax unified
 173              		.thumb
 174              		.thumb_func
 176              	dbc_1st:
 177              	.LVL18:
 178              	.LFB4:
 669:Core/Src/FAT/ff.c **** 
 670:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT
 671:Core/Src/FAT/ff.c **** static void st_qword (BYTE* ptr, QWORD val)	/* Store an 8-byte word in little-endian */
 672:Core/Src/FAT/ff.c **** {
 673:Core/Src/FAT/ff.c **** 	*ptr++ = (BYTE)val; val >>= 8;
 674:Core/Src/FAT/ff.c **** 	*ptr++ = (BYTE)val; val >>= 8;
 675:Core/Src/FAT/ff.c **** 	*ptr++ = (BYTE)val; val >>= 8;
 676:Core/Src/FAT/ff.c **** 	*ptr++ = (BYTE)val; val >>= 8;
 677:Core/Src/FAT/ff.c **** 	*ptr++ = (BYTE)val; val >>= 8;
 678:Core/Src/FAT/ff.c **** 	*ptr++ = (BYTE)val; val >>= 8;
 679:Core/Src/FAT/ff.c **** 	*ptr++ = (BYTE)val; val >>= 8;
 680:Core/Src/FAT/ff.c **** 	*ptr++ = (BYTE)val;
 681:Core/Src/FAT/ff.c **** }
 682:Core/Src/FAT/ff.c **** #endif
 683:Core/Src/FAT/ff.c **** #endif	/* !FF_FS_READONLY */
 684:Core/Src/FAT/ff.c **** 
 685:Core/Src/FAT/ff.c **** 
 686:Core/Src/FAT/ff.c **** 
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 16


 687:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
 688:Core/Src/FAT/ff.c **** /* String functions                                                      */
 689:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
 690:Core/Src/FAT/ff.c **** 
 691:Core/Src/FAT/ff.c **** /* Test if the byte is DBC 1st byte */
 692:Core/Src/FAT/ff.c **** static int dbc_1st (BYTE c)
 693:Core/Src/FAT/ff.c **** {
 179              		.loc 1 693 1 is_stmt 1 view -0
 180              		.cfi_startproc
 181              		@ args = 0, pretend = 0, frame = 0
 182              		@ frame_needed = 0, uses_anonymous_args = 0
 183              		@ link register save eliminated.
 694:Core/Src/FAT/ff.c **** #if FF_CODE_PAGE == 0		/* Variable code page */
 695:Core/Src/FAT/ff.c **** 	if (DbcTbl && c >= DbcTbl[0]) {
 696:Core/Src/FAT/ff.c **** 		if (c <= DbcTbl[1]) return 1;					/* 1st byte range 1 */
 697:Core/Src/FAT/ff.c **** 		if (c >= DbcTbl[2] && c <= DbcTbl[3]) return 1;	/* 1st byte range 2 */
 698:Core/Src/FAT/ff.c **** 	}
 699:Core/Src/FAT/ff.c **** #elif FF_CODE_PAGE >= 900	/* DBCS fixed code page */
 700:Core/Src/FAT/ff.c **** 	if (c >= DbcTbl[0]) {
 184              		.loc 1 700 2 view .LVU49
 185              		.loc 1 700 5 is_stmt 0 view .LVU50
 186 0000 8028     		cmp	r0, #128
 187 0002 07D9     		bls	.L7
 701:Core/Src/FAT/ff.c **** 		if (c <= DbcTbl[1]) return 1;
 188              		.loc 1 701 3 is_stmt 1 view .LVU51
 189              		.loc 1 701 6 is_stmt 0 view .LVU52
 190 0004 9F28     		cmp	r0, #159
 191 0006 07D9     		bls	.L8
 702:Core/Src/FAT/ff.c **** 		if (c >= DbcTbl[2] && c <= DbcTbl[3]) return 1;
 192              		.loc 1 702 3 is_stmt 1 view .LVU53
 193              		.loc 1 702 6 is_stmt 0 view .LVU54
 194 0008 DF28     		cmp	r0, #223
 195 000a 07D9     		bls	.L9
 196              		.loc 1 702 22 discriminator 1 view .LVU55
 197 000c FC28     		cmp	r0, #252
 198 000e 07D9     		bls	.L10
 703:Core/Src/FAT/ff.c **** 	}
 704:Core/Src/FAT/ff.c **** #else						/* SBCS fixed code page */
 705:Core/Src/FAT/ff.c **** 	if (c != 0) return 0;	/* Always false */
 706:Core/Src/FAT/ff.c **** #endif
 707:Core/Src/FAT/ff.c **** 	return 0;
 199              		.loc 1 707 9 view .LVU56
 200 0010 0020     		movs	r0, #0
 201              	.LVL19:
 202              		.loc 1 707 9 view .LVU57
 203 0012 7047     		bx	lr
 204              	.LVL20:
 205              	.L7:
 206              		.loc 1 707 9 view .LVU58
 207 0014 0020     		movs	r0, #0
 208              	.LVL21:
 209              		.loc 1 707 9 view .LVU59
 210 0016 7047     		bx	lr
 211              	.LVL22:
 212              	.L8:
 701:Core/Src/FAT/ff.c **** 		if (c >= DbcTbl[2] && c <= DbcTbl[3]) return 1;
 213              		.loc 1 701 30 view .LVU60
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 17


 214 0018 0120     		movs	r0, #1
 215              	.LVL23:
 701:Core/Src/FAT/ff.c **** 		if (c >= DbcTbl[2] && c <= DbcTbl[3]) return 1;
 216              		.loc 1 701 30 view .LVU61
 217 001a 7047     		bx	lr
 218              	.LVL24:
 219              	.L9:
 220              		.loc 1 707 9 view .LVU62
 221 001c 0020     		movs	r0, #0
 222              	.LVL25:
 223              		.loc 1 707 9 view .LVU63
 224 001e 7047     		bx	lr
 225              	.LVL26:
 226              	.L10:
 702:Core/Src/FAT/ff.c **** 		if (c >= DbcTbl[2] && c <= DbcTbl[3]) return 1;
 227              		.loc 1 702 48 view .LVU64
 228 0020 0120     		movs	r0, #1
 229              	.LVL27:
 708:Core/Src/FAT/ff.c **** }
 230              		.loc 1 708 1 view .LVU65
 231 0022 7047     		bx	lr
 232              		.cfi_endproc
 233              	.LFE4:
 235              		.section	.text.dbc_2nd,"ax",%progbits
 236              		.align	1
 237              		.syntax unified
 238              		.thumb
 239              		.thumb_func
 241              	dbc_2nd:
 242              	.LVL28:
 243              	.LFB5:
 709:Core/Src/FAT/ff.c **** 
 710:Core/Src/FAT/ff.c **** 
 711:Core/Src/FAT/ff.c **** /* Test if the byte is DBC 2nd byte */
 712:Core/Src/FAT/ff.c **** static int dbc_2nd (BYTE c)
 713:Core/Src/FAT/ff.c **** {
 244              		.loc 1 713 1 is_stmt 1 view -0
 245              		.cfi_startproc
 246              		@ args = 0, pretend = 0, frame = 0
 247              		@ frame_needed = 0, uses_anonymous_args = 0
 248              		@ link register save eliminated.
 714:Core/Src/FAT/ff.c **** #if FF_CODE_PAGE == 0		/* Variable code page */
 715:Core/Src/FAT/ff.c **** 	if (DbcTbl && c >= DbcTbl[4]) {
 716:Core/Src/FAT/ff.c **** 		if (c <= DbcTbl[5]) return 1;					/* 2nd byte range 1 */
 717:Core/Src/FAT/ff.c **** 		if (c >= DbcTbl[6] && c <= DbcTbl[7]) return 1;	/* 2nd byte range 2 */
 718:Core/Src/FAT/ff.c **** 		if (c >= DbcTbl[8] && c <= DbcTbl[9]) return 1;	/* 2nd byte range 3 */
 719:Core/Src/FAT/ff.c **** 	}
 720:Core/Src/FAT/ff.c **** #elif FF_CODE_PAGE >= 900	/* DBCS fixed code page */
 721:Core/Src/FAT/ff.c **** 	if (c >= DbcTbl[4]) {
 249              		.loc 1 721 2 view .LVU67
 250              		.loc 1 721 5 is_stmt 0 view .LVU68
 251 0000 3F28     		cmp	r0, #63
 252 0002 0BD9     		bls	.L14
 722:Core/Src/FAT/ff.c **** 		if (c <= DbcTbl[5]) return 1;
 253              		.loc 1 722 3 is_stmt 1 view .LVU69
 254              		.loc 1 722 6 is_stmt 0 view .LVU70
 255 0004 7E28     		cmp	r0, #126
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 18


 256 0006 0BD9     		bls	.L15
 723:Core/Src/FAT/ff.c **** 		if (c >= DbcTbl[6] && c <= DbcTbl[7]) return 1;
 257              		.loc 1 723 3 is_stmt 1 view .LVU71
 258              		.loc 1 723 6 is_stmt 0 view .LVU72
 259 0008 10F0800F 		tst	r0, #128
 260 000c 02D1     		bne	.L18
 261              	.L13:
 724:Core/Src/FAT/ff.c **** 		if (c >= DbcTbl[8] && c <= DbcTbl[9]) return 1;
 262              		.loc 1 724 3 is_stmt 1 discriminator 1 view .LVU73
 263              		.loc 1 724 22 is_stmt 0 discriminator 1 view .LVU74
 264 000e 48B1     		cbz	r0, .L17
 725:Core/Src/FAT/ff.c **** 	}
 726:Core/Src/FAT/ff.c **** #else						/* SBCS fixed code page */
 727:Core/Src/FAT/ff.c **** 	if (c != 0) return 0;	/* Always false */
 728:Core/Src/FAT/ff.c **** #endif
 729:Core/Src/FAT/ff.c **** 	return 0;
 265              		.loc 1 729 9 view .LVU75
 266 0010 0020     		movs	r0, #0
 267              	.LVL29:
 268              		.loc 1 729 9 view .LVU76
 269 0012 7047     		bx	lr
 270              	.LVL30:
 271              	.L18:
 723:Core/Src/FAT/ff.c **** 		if (c >= DbcTbl[8] && c <= DbcTbl[9]) return 1;
 272              		.loc 1 723 22 discriminator 1 view .LVU77
 273 0014 FC28     		cmp	r0, #252
 274 0016 FAD8     		bhi	.L13
 723:Core/Src/FAT/ff.c **** 		if (c >= DbcTbl[8] && c <= DbcTbl[9]) return 1;
 275              		.loc 1 723 48 view .LVU78
 276 0018 0120     		movs	r0, #1
 277              	.LVL31:
 723:Core/Src/FAT/ff.c **** 		if (c >= DbcTbl[8] && c <= DbcTbl[9]) return 1;
 278              		.loc 1 723 48 view .LVU79
 279 001a 7047     		bx	lr
 280              	.LVL32:
 281              	.L14:
 282              		.loc 1 729 9 view .LVU80
 283 001c 0020     		movs	r0, #0
 284              	.LVL33:
 285              		.loc 1 729 9 view .LVU81
 286 001e 7047     		bx	lr
 287              	.LVL34:
 288              	.L15:
 722:Core/Src/FAT/ff.c **** 		if (c >= DbcTbl[6] && c <= DbcTbl[7]) return 1;
 289              		.loc 1 722 30 view .LVU82
 290 0020 0120     		movs	r0, #1
 291              	.LVL35:
 722:Core/Src/FAT/ff.c **** 		if (c >= DbcTbl[6] && c <= DbcTbl[7]) return 1;
 292              		.loc 1 722 30 view .LVU83
 293 0022 7047     		bx	lr
 294              	.LVL36:
 295              	.L17:
 724:Core/Src/FAT/ff.c **** 	}
 296              		.loc 1 724 48 view .LVU84
 297 0024 0120     		movs	r0, #1
 298              	.LVL37:
 730:Core/Src/FAT/ff.c **** }
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 19


 299              		.loc 1 730 1 view .LVU85
 300 0026 7047     		bx	lr
 301              		.cfi_endproc
 302              	.LFE5:
 304              		.section	.text.clst2sect,"ax",%progbits
 305              		.align	1
 306              		.syntax unified
 307              		.thumb
 308              		.thumb_func
 310              	clst2sect:
 311              	.LVL38:
 312              	.LFB9:
 731:Core/Src/FAT/ff.c **** 
 732:Core/Src/FAT/ff.c **** 
 733:Core/Src/FAT/ff.c **** #if FF_USE_LFN
 734:Core/Src/FAT/ff.c **** 
 735:Core/Src/FAT/ff.c **** /* Get a Unicode code point from the TCHAR string in defined API encodeing */
 736:Core/Src/FAT/ff.c **** static DWORD tchar2uni (	/* Returns a character in UTF-16 encoding (>=0x10000 on surrogate pair, 0x
 737:Core/Src/FAT/ff.c **** 	const TCHAR** str		/* Pointer to pointer to TCHAR string in configured encoding */
 738:Core/Src/FAT/ff.c **** )
 739:Core/Src/FAT/ff.c **** {
 740:Core/Src/FAT/ff.c **** 	DWORD uc;
 741:Core/Src/FAT/ff.c **** 	const TCHAR *p = *str;
 742:Core/Src/FAT/ff.c **** 
 743:Core/Src/FAT/ff.c **** #if FF_LFN_UNICODE == 1		/* UTF-16 input */
 744:Core/Src/FAT/ff.c **** 	WCHAR wc;
 745:Core/Src/FAT/ff.c **** 
 746:Core/Src/FAT/ff.c **** 	uc = *p++;	/* Get a unit */
 747:Core/Src/FAT/ff.c **** 	if (IsSurrogate(uc)) {	/* Surrogate? */
 748:Core/Src/FAT/ff.c **** 		wc = *p++;		/* Get low surrogate */
 749:Core/Src/FAT/ff.c **** 		if (!IsSurrogateH(uc) || !IsSurrogateL(wc)) return 0xFFFFFFFF;	/* Wrong surrogate? */
 750:Core/Src/FAT/ff.c **** 		uc = uc << 16 | wc;
 751:Core/Src/FAT/ff.c **** 	}
 752:Core/Src/FAT/ff.c **** 
 753:Core/Src/FAT/ff.c **** #elif FF_LFN_UNICODE == 2	/* UTF-8 input */
 754:Core/Src/FAT/ff.c **** 	BYTE b;
 755:Core/Src/FAT/ff.c **** 	int nf;
 756:Core/Src/FAT/ff.c **** 
 757:Core/Src/FAT/ff.c **** 	uc = (BYTE)*p++;	/* Get an encoding unit */
 758:Core/Src/FAT/ff.c **** 	if (uc & 0x80) {	/* Multiple byte code? */
 759:Core/Src/FAT/ff.c **** 		if        ((uc & 0xE0) == 0xC0) {	/* 2-byte sequence? */
 760:Core/Src/FAT/ff.c **** 			uc &= 0x1F; nf = 1;
 761:Core/Src/FAT/ff.c **** 		} else if ((uc & 0xF0) == 0xE0) {	/* 3-byte sequence? */
 762:Core/Src/FAT/ff.c **** 			uc &= 0x0F; nf = 2;
 763:Core/Src/FAT/ff.c **** 		} else if ((uc & 0xF8) == 0xF0) {	/* 4-byte sequence? */
 764:Core/Src/FAT/ff.c **** 			uc &= 0x07; nf = 3;
 765:Core/Src/FAT/ff.c **** 		} else {							/* Wrong sequence */
 766:Core/Src/FAT/ff.c **** 			return 0xFFFFFFFF;
 767:Core/Src/FAT/ff.c **** 		}
 768:Core/Src/FAT/ff.c **** 		do {	/* Get trailing bytes */
 769:Core/Src/FAT/ff.c **** 			b = (BYTE)*p++;
 770:Core/Src/FAT/ff.c **** 			if ((b & 0xC0) != 0x80) return 0xFFFFFFFF;	/* Wrong sequence? */
 771:Core/Src/FAT/ff.c **** 			uc = uc << 6 | (b & 0x3F);
 772:Core/Src/FAT/ff.c **** 		} while (--nf != 0);
 773:Core/Src/FAT/ff.c **** 		if (uc < 0x80 || IsSurrogate(uc) || uc >= 0x110000) return 0xFFFFFFFF;	/* Wrong code? */
 774:Core/Src/FAT/ff.c **** 		if (uc >= 0x010000) uc = 0xD800DC00 | ((uc - 0x10000) << 6 & 0x3FF0000) | (uc & 0x3FF);	/* Make a
 775:Core/Src/FAT/ff.c **** 	}
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 20


 776:Core/Src/FAT/ff.c **** 
 777:Core/Src/FAT/ff.c **** #elif FF_LFN_UNICODE == 3	/* UTF-32 input */
 778:Core/Src/FAT/ff.c **** 	uc = (TCHAR)*p++;	/* Get a unit */
 779:Core/Src/FAT/ff.c **** 	if (uc >= 0x110000 || IsSurrogate(uc)) return 0xFFFFFFFF;	/* Wrong code? */
 780:Core/Src/FAT/ff.c **** 	if (uc >= 0x010000) uc = 0xD800DC00 | ((uc - 0x10000) << 6 & 0x3FF0000) | (uc & 0x3FF);	/* Make a 
 781:Core/Src/FAT/ff.c **** 
 782:Core/Src/FAT/ff.c **** #else		/* ANSI/OEM input */
 783:Core/Src/FAT/ff.c **** 	BYTE b;
 784:Core/Src/FAT/ff.c **** 	WCHAR wc;
 785:Core/Src/FAT/ff.c **** 
 786:Core/Src/FAT/ff.c **** 	wc = (BYTE)*p++;			/* Get a byte */
 787:Core/Src/FAT/ff.c **** 	if (dbc_1st((BYTE)wc)) {	/* Is it a DBC 1st byte? */
 788:Core/Src/FAT/ff.c **** 		b = (BYTE)*p++;			/* Get 2nd byte */
 789:Core/Src/FAT/ff.c **** 		if (!dbc_2nd(b)) return 0xFFFFFFFF;	/* Invalid code? */
 790:Core/Src/FAT/ff.c **** 		wc = (wc << 8) + b;		/* Make a DBC */
 791:Core/Src/FAT/ff.c **** 	}
 792:Core/Src/FAT/ff.c **** 	if (wc != 0) {
 793:Core/Src/FAT/ff.c **** 		wc = ff_oem2uni(wc, CODEPAGE);	/* ANSI/OEM ==> Unicode */
 794:Core/Src/FAT/ff.c **** 		if (wc == 0) return 0xFFFFFFFF;	/* Invalid code? */
 795:Core/Src/FAT/ff.c **** 	}
 796:Core/Src/FAT/ff.c **** 	uc = wc;
 797:Core/Src/FAT/ff.c **** 
 798:Core/Src/FAT/ff.c **** #endif
 799:Core/Src/FAT/ff.c **** 	*str = p;	/* Next read pointer */
 800:Core/Src/FAT/ff.c **** 	return uc;
 801:Core/Src/FAT/ff.c **** }
 802:Core/Src/FAT/ff.c **** 
 803:Core/Src/FAT/ff.c **** 
 804:Core/Src/FAT/ff.c **** /* Store a Unicode char in defined API encoding */
 805:Core/Src/FAT/ff.c **** static UINT put_utf (	/* Returns number of encoding units written (0:buffer overflow or wrong encod
 806:Core/Src/FAT/ff.c **** 	DWORD chr,	/* UTF-16 encoded character (Surrogate pair if >=0x10000) */
 807:Core/Src/FAT/ff.c **** 	TCHAR* buf,	/* Output buffer */
 808:Core/Src/FAT/ff.c **** 	UINT szb	/* Size of the buffer */
 809:Core/Src/FAT/ff.c **** )
 810:Core/Src/FAT/ff.c **** {
 811:Core/Src/FAT/ff.c **** #if FF_LFN_UNICODE == 1	/* UTF-16 output */
 812:Core/Src/FAT/ff.c **** 	WCHAR hs, wc;
 813:Core/Src/FAT/ff.c **** 
 814:Core/Src/FAT/ff.c **** 	hs = (WCHAR)(chr >> 16);
 815:Core/Src/FAT/ff.c **** 	wc = (WCHAR)chr;
 816:Core/Src/FAT/ff.c **** 	if (hs == 0) {	/* Single encoding unit? */
 817:Core/Src/FAT/ff.c **** 		if (szb < 1 || IsSurrogate(wc)) return 0;	/* Buffer overflow or wrong code? */
 818:Core/Src/FAT/ff.c **** 		*buf = wc;
 819:Core/Src/FAT/ff.c **** 		return 1;
 820:Core/Src/FAT/ff.c **** 	}
 821:Core/Src/FAT/ff.c **** 	if (szb < 2 || !IsSurrogateH(hs) || !IsSurrogateL(wc)) return 0;	/* Buffer overflow or wrong surro
 822:Core/Src/FAT/ff.c **** 	*buf++ = hs;
 823:Core/Src/FAT/ff.c **** 	*buf++ = wc;
 824:Core/Src/FAT/ff.c **** 	return 2;
 825:Core/Src/FAT/ff.c **** 
 826:Core/Src/FAT/ff.c **** #elif FF_LFN_UNICODE == 2	/* UTF-8 output */
 827:Core/Src/FAT/ff.c **** 	DWORD hc;
 828:Core/Src/FAT/ff.c **** 
 829:Core/Src/FAT/ff.c **** 	if (chr < 0x80) {	/* Single byte code? */
 830:Core/Src/FAT/ff.c **** 		if (szb < 1) return 0;	/* Buffer overflow? */
 831:Core/Src/FAT/ff.c **** 		*buf = (TCHAR)chr;
 832:Core/Src/FAT/ff.c **** 		return 1;
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 21


 833:Core/Src/FAT/ff.c **** 	}
 834:Core/Src/FAT/ff.c **** 	if (chr < 0x800) {	/* 2-byte sequence? */
 835:Core/Src/FAT/ff.c **** 		if (szb < 2) return 0;	/* Buffer overflow? */
 836:Core/Src/FAT/ff.c **** 		*buf++ = (TCHAR)(0xC0 | (chr >> 6 & 0x1F));
 837:Core/Src/FAT/ff.c **** 		*buf++ = (TCHAR)(0x80 | (chr >> 0 & 0x3F));
 838:Core/Src/FAT/ff.c **** 		return 2;
 839:Core/Src/FAT/ff.c **** 	}
 840:Core/Src/FAT/ff.c **** 	if (chr < 0x10000) {	/* 3-byte sequence? */
 841:Core/Src/FAT/ff.c **** 		if (szb < 3 || IsSurrogate(chr)) return 0;	/* Buffer overflow or wrong code? */
 842:Core/Src/FAT/ff.c **** 		*buf++ = (TCHAR)(0xE0 | (chr >> 12 & 0x0F));
 843:Core/Src/FAT/ff.c **** 		*buf++ = (TCHAR)(0x80 | (chr >> 6 & 0x3F));
 844:Core/Src/FAT/ff.c **** 		*buf++ = (TCHAR)(0x80 | (chr >> 0 & 0x3F));
 845:Core/Src/FAT/ff.c **** 		return 3;
 846:Core/Src/FAT/ff.c **** 	}
 847:Core/Src/FAT/ff.c **** 	/* 4-byte sequence */
 848:Core/Src/FAT/ff.c **** 	if (szb < 4) return 0;	/* Buffer overflow? */
 849:Core/Src/FAT/ff.c **** 	hc = ((chr & 0xFFFF0000) - 0xD8000000) >> 6;	/* Get high 10 bits */
 850:Core/Src/FAT/ff.c **** 	chr = (chr & 0xFFFF) - 0xDC00;					/* Get low 10 bits */
 851:Core/Src/FAT/ff.c **** 	if (hc >= 0x100000 || chr >= 0x400) return 0;	/* Wrong surrogate? */
 852:Core/Src/FAT/ff.c **** 	chr = (hc | chr) + 0x10000;
 853:Core/Src/FAT/ff.c **** 	*buf++ = (TCHAR)(0xF0 | (chr >> 18 & 0x07));
 854:Core/Src/FAT/ff.c **** 	*buf++ = (TCHAR)(0x80 | (chr >> 12 & 0x3F));
 855:Core/Src/FAT/ff.c **** 	*buf++ = (TCHAR)(0x80 | (chr >> 6 & 0x3F));
 856:Core/Src/FAT/ff.c **** 	*buf++ = (TCHAR)(0x80 | (chr >> 0 & 0x3F));
 857:Core/Src/FAT/ff.c **** 	return 4;
 858:Core/Src/FAT/ff.c **** 
 859:Core/Src/FAT/ff.c **** #elif FF_LFN_UNICODE == 3	/* UTF-32 output */
 860:Core/Src/FAT/ff.c **** 	DWORD hc;
 861:Core/Src/FAT/ff.c **** 
 862:Core/Src/FAT/ff.c **** 	if (szb < 1) return 0;	/* Buffer overflow? */
 863:Core/Src/FAT/ff.c **** 	if (chr >= 0x10000) {	/* Out of BMP? */
 864:Core/Src/FAT/ff.c **** 		hc = ((chr & 0xFFFF0000) - 0xD8000000) >> 6;	/* Get high 10 bits */
 865:Core/Src/FAT/ff.c **** 		chr = (chr & 0xFFFF) - 0xDC00;					/* Get low 10 bits */
 866:Core/Src/FAT/ff.c **** 		if (hc >= 0x100000 || chr >= 0x400) return 0;	/* Wrong surrogate? */
 867:Core/Src/FAT/ff.c **** 		chr = (hc | chr) + 0x10000;
 868:Core/Src/FAT/ff.c **** 	}
 869:Core/Src/FAT/ff.c **** 	*buf++ = (TCHAR)chr;
 870:Core/Src/FAT/ff.c **** 	return 1;
 871:Core/Src/FAT/ff.c **** 
 872:Core/Src/FAT/ff.c **** #else						/* ANSI/OEM output */
 873:Core/Src/FAT/ff.c **** 	WCHAR wc;
 874:Core/Src/FAT/ff.c **** 
 875:Core/Src/FAT/ff.c **** 	wc = ff_uni2oem(chr, CODEPAGE);
 876:Core/Src/FAT/ff.c **** 	if (wc >= 0x100) {	/* Is this a DBC? */
 877:Core/Src/FAT/ff.c **** 		if (szb < 2) return 0;
 878:Core/Src/FAT/ff.c **** 		*buf++ = (char)(wc >> 8);	/* Store DBC 1st byte */
 879:Core/Src/FAT/ff.c **** 		*buf++ = (TCHAR)wc;			/* Store DBC 2nd byte */
 880:Core/Src/FAT/ff.c **** 		return 2;
 881:Core/Src/FAT/ff.c **** 	}
 882:Core/Src/FAT/ff.c **** 	if (wc == 0 || szb < 1) return 0;	/* Invalid char or buffer overflow? */
 883:Core/Src/FAT/ff.c **** 	*buf++ = (TCHAR)wc;					/* Store the character */
 884:Core/Src/FAT/ff.c **** 	return 1;
 885:Core/Src/FAT/ff.c **** #endif
 886:Core/Src/FAT/ff.c **** }
 887:Core/Src/FAT/ff.c **** #endif	/* FF_USE_LFN */
 888:Core/Src/FAT/ff.c **** 
 889:Core/Src/FAT/ff.c **** 
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 22


 890:Core/Src/FAT/ff.c **** #if FF_FS_REENTRANT
 891:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
 892:Core/Src/FAT/ff.c **** /* Request/Release grant to access the volume                            */
 893:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
 894:Core/Src/FAT/ff.c **** 
 895:Core/Src/FAT/ff.c **** static int lock_volume (	/* 1:Ok, 0:timeout */
 896:Core/Src/FAT/ff.c **** 	FATFS* fs,				/* Filesystem object to lock */
 897:Core/Src/FAT/ff.c **** 	int syslock				/* System lock required */
 898:Core/Src/FAT/ff.c **** )
 899:Core/Src/FAT/ff.c **** {
 900:Core/Src/FAT/ff.c **** 	int rv;
 901:Core/Src/FAT/ff.c **** 
 902:Core/Src/FAT/ff.c **** 
 903:Core/Src/FAT/ff.c **** #if FF_FS_LOCK
 904:Core/Src/FAT/ff.c **** 	rv = ff_mutex_take(fs->ldrv);	/* Lock the volume */
 905:Core/Src/FAT/ff.c **** 	if (rv && syslock) {			/* System lock reqiered? */
 906:Core/Src/FAT/ff.c **** 		rv = ff_mutex_take(FF_VOLUMES);	/* Lock the system */
 907:Core/Src/FAT/ff.c **** 		if (rv) {
 908:Core/Src/FAT/ff.c **** 			SysLock = 2;				/* System lock succeeded */
 909:Core/Src/FAT/ff.c **** 		} else {
 910:Core/Src/FAT/ff.c **** 			ff_mutex_give(fs->ldrv);	/* Failed system lock */
 911:Core/Src/FAT/ff.c **** 		}
 912:Core/Src/FAT/ff.c **** 	}
 913:Core/Src/FAT/ff.c **** #else
 914:Core/Src/FAT/ff.c **** 	rv = syslock ? ff_mutex_take(fs->ldrv) : ff_mutex_take(fs->ldrv);	/* Lock the volume (this is to p
 915:Core/Src/FAT/ff.c **** #endif
 916:Core/Src/FAT/ff.c **** 	return rv;
 917:Core/Src/FAT/ff.c **** }
 918:Core/Src/FAT/ff.c **** 
 919:Core/Src/FAT/ff.c **** 
 920:Core/Src/FAT/ff.c **** static void unlock_volume (
 921:Core/Src/FAT/ff.c **** 	FATFS* fs,		/* Filesystem object */
 922:Core/Src/FAT/ff.c **** 	FRESULT res		/* Result code to be returned */
 923:Core/Src/FAT/ff.c **** )
 924:Core/Src/FAT/ff.c **** {
 925:Core/Src/FAT/ff.c **** 	if (fs && res != FR_NOT_ENABLED && res != FR_INVALID_DRIVE && res != FR_TIMEOUT) {
 926:Core/Src/FAT/ff.c **** #if FF_FS_LOCK
 927:Core/Src/FAT/ff.c **** 		if (SysLock == 2) {	/* Is the system locked? */
 928:Core/Src/FAT/ff.c **** 			SysLock = 1;
 929:Core/Src/FAT/ff.c **** 			ff_mutex_give(FF_VOLUMES);
 930:Core/Src/FAT/ff.c **** 		}
 931:Core/Src/FAT/ff.c **** #endif
 932:Core/Src/FAT/ff.c **** 		ff_mutex_give(fs->ldrv);	/* Unlock the volume */
 933:Core/Src/FAT/ff.c **** 	}
 934:Core/Src/FAT/ff.c **** }
 935:Core/Src/FAT/ff.c **** 
 936:Core/Src/FAT/ff.c **** #endif
 937:Core/Src/FAT/ff.c **** 
 938:Core/Src/FAT/ff.c **** 
 939:Core/Src/FAT/ff.c **** 
 940:Core/Src/FAT/ff.c **** #if FF_FS_LOCK
 941:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
 942:Core/Src/FAT/ff.c **** /* File shareing control functions                                       */
 943:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
 944:Core/Src/FAT/ff.c **** 
 945:Core/Src/FAT/ff.c **** static FRESULT chk_share (	/* Check if the file can be accessed */
 946:Core/Src/FAT/ff.c **** 	DIR* dp,		/* Directory object pointing the file to be checked */
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 23


 947:Core/Src/FAT/ff.c **** 	int acc			/* Desired access type (0:Read mode open, 1:Write mode open, 2:Delete or rename) */
 948:Core/Src/FAT/ff.c **** )
 949:Core/Src/FAT/ff.c **** {
 950:Core/Src/FAT/ff.c **** 	UINT i, be;
 951:Core/Src/FAT/ff.c **** 
 952:Core/Src/FAT/ff.c **** 	/* Search open object table for the object */
 953:Core/Src/FAT/ff.c **** 	be = 0;
 954:Core/Src/FAT/ff.c **** 	for (i = 0; i < FF_FS_LOCK; i++) {
 955:Core/Src/FAT/ff.c **** 		if (Files[i].fs) {	/* Existing entry */
 956:Core/Src/FAT/ff.c **** 			if (Files[i].fs == dp->obj.fs &&	 	/* Check if the object matches with an open object */
 957:Core/Src/FAT/ff.c **** 				Files[i].clu == dp->obj.sclust &&
 958:Core/Src/FAT/ff.c **** 				Files[i].ofs == dp->dptr) break;
 959:Core/Src/FAT/ff.c **** 		} else {			/* Blank entry */
 960:Core/Src/FAT/ff.c **** 			be = 1;
 961:Core/Src/FAT/ff.c **** 		}
 962:Core/Src/FAT/ff.c **** 	}
 963:Core/Src/FAT/ff.c **** 	if (i == FF_FS_LOCK) {	/* The object has not been opened */
 964:Core/Src/FAT/ff.c **** 		return (!be && acc != 2) ? FR_TOO_MANY_OPEN_FILES : FR_OK;	/* Is there a blank entry for new obje
 965:Core/Src/FAT/ff.c **** 	}
 966:Core/Src/FAT/ff.c **** 
 967:Core/Src/FAT/ff.c **** 	/* The object was opened. Reject any open against writing file and all write mode open */
 968:Core/Src/FAT/ff.c **** 	return (acc != 0 || Files[i].ctr == 0x100) ? FR_LOCKED : FR_OK;
 969:Core/Src/FAT/ff.c **** }
 970:Core/Src/FAT/ff.c **** 
 971:Core/Src/FAT/ff.c **** 
 972:Core/Src/FAT/ff.c **** static int enq_share (void)	/* Check if an entry is available for a new object */
 973:Core/Src/FAT/ff.c **** {
 974:Core/Src/FAT/ff.c **** 	UINT i;
 975:Core/Src/FAT/ff.c **** 
 976:Core/Src/FAT/ff.c **** 	for (i = 0; i < FF_FS_LOCK && Files[i].fs; i++) ;	/* Find a free entry */
 977:Core/Src/FAT/ff.c **** 	return (i == FF_FS_LOCK) ? 0 : 1;
 978:Core/Src/FAT/ff.c **** }
 979:Core/Src/FAT/ff.c **** 
 980:Core/Src/FAT/ff.c **** 
 981:Core/Src/FAT/ff.c **** static UINT inc_share (	/* Increment object open counter and returns its index (0:Internal error) *
 982:Core/Src/FAT/ff.c **** 	DIR* dp,	/* Directory object pointing the file to register or increment */
 983:Core/Src/FAT/ff.c **** 	int acc		/* Desired access (0:Read, 1:Write, 2:Delete/Rename) */
 984:Core/Src/FAT/ff.c **** )
 985:Core/Src/FAT/ff.c **** {
 986:Core/Src/FAT/ff.c **** 	UINT i;
 987:Core/Src/FAT/ff.c **** 
 988:Core/Src/FAT/ff.c **** 
 989:Core/Src/FAT/ff.c **** 	for (i = 0; i < FF_FS_LOCK; i++) {	/* Find the object */
 990:Core/Src/FAT/ff.c **** 		if (Files[i].fs == dp->obj.fs
 991:Core/Src/FAT/ff.c **** 		 && Files[i].clu == dp->obj.sclust
 992:Core/Src/FAT/ff.c **** 		 && Files[i].ofs == dp->dptr) break;
 993:Core/Src/FAT/ff.c **** 	}
 994:Core/Src/FAT/ff.c **** 
 995:Core/Src/FAT/ff.c **** 	if (i == FF_FS_LOCK) {			/* Not opened. Register it as new. */
 996:Core/Src/FAT/ff.c **** 		for (i = 0; i < FF_FS_LOCK && Files[i].fs; i++) ;	/* Find a free entry */
 997:Core/Src/FAT/ff.c **** 		if (i == FF_FS_LOCK) return 0;	/* No free entry to register (int err) */
 998:Core/Src/FAT/ff.c **** 		Files[i].fs = dp->obj.fs;
 999:Core/Src/FAT/ff.c **** 		Files[i].clu = dp->obj.sclust;
1000:Core/Src/FAT/ff.c **** 		Files[i].ofs = dp->dptr;
1001:Core/Src/FAT/ff.c **** 		Files[i].ctr = 0;
1002:Core/Src/FAT/ff.c **** 	}
1003:Core/Src/FAT/ff.c **** 
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 24


1004:Core/Src/FAT/ff.c **** 	if (acc >= 1 && Files[i].ctr) return 0;	/* Access violation (int err) */
1005:Core/Src/FAT/ff.c **** 
1006:Core/Src/FAT/ff.c **** 	Files[i].ctr = acc ? 0x100 : Files[i].ctr + 1;	/* Set semaphore value */
1007:Core/Src/FAT/ff.c **** 
1008:Core/Src/FAT/ff.c **** 	return i + 1;	/* Index number origin from 1 */
1009:Core/Src/FAT/ff.c **** }
1010:Core/Src/FAT/ff.c **** 
1011:Core/Src/FAT/ff.c **** 
1012:Core/Src/FAT/ff.c **** static FRESULT dec_share (	/* Decrement object open counter */
1013:Core/Src/FAT/ff.c **** 	UINT i			/* Semaphore index (1..) */
1014:Core/Src/FAT/ff.c **** )
1015:Core/Src/FAT/ff.c **** {
1016:Core/Src/FAT/ff.c **** 	UINT n;
1017:Core/Src/FAT/ff.c **** 	FRESULT res;
1018:Core/Src/FAT/ff.c **** 
1019:Core/Src/FAT/ff.c **** 
1020:Core/Src/FAT/ff.c **** 	if (--i < FF_FS_LOCK) {	/* Index number origin from 0 */
1021:Core/Src/FAT/ff.c **** 		n = Files[i].ctr;
1022:Core/Src/FAT/ff.c **** 		if (n == 0x100) n = 0;	/* If write mode open, delete the object semaphore */
1023:Core/Src/FAT/ff.c **** 		if (n > 0) n--;			/* Decrement read mode open count */
1024:Core/Src/FAT/ff.c **** 		Files[i].ctr = n;
1025:Core/Src/FAT/ff.c **** 		if (n == 0) {			/* Delete the object semaphore if open count becomes zero */
1026:Core/Src/FAT/ff.c **** 			Files[i].fs = 0;	/* Free the entry <<<If this memory write operation is not in atomic, FF_FS_REE
1027:Core/Src/FAT/ff.c **** 		}
1028:Core/Src/FAT/ff.c **** 		res = FR_OK;
1029:Core/Src/FAT/ff.c **** 	} else {
1030:Core/Src/FAT/ff.c **** 		res = FR_INT_ERR;		/* Invalid index number */
1031:Core/Src/FAT/ff.c **** 	}
1032:Core/Src/FAT/ff.c **** 	return res;
1033:Core/Src/FAT/ff.c **** }
1034:Core/Src/FAT/ff.c **** 
1035:Core/Src/FAT/ff.c **** 
1036:Core/Src/FAT/ff.c **** static void clear_share (	/* Clear all lock entries of the volume */
1037:Core/Src/FAT/ff.c **** 	FATFS* fs
1038:Core/Src/FAT/ff.c **** )
1039:Core/Src/FAT/ff.c **** {
1040:Core/Src/FAT/ff.c **** 	UINT i;
1041:Core/Src/FAT/ff.c **** 
1042:Core/Src/FAT/ff.c **** 	for (i = 0; i < FF_FS_LOCK; i++) {
1043:Core/Src/FAT/ff.c **** 		if (Files[i].fs == fs) Files[i].fs = 0;
1044:Core/Src/FAT/ff.c **** 	}
1045:Core/Src/FAT/ff.c **** }
1046:Core/Src/FAT/ff.c **** 
1047:Core/Src/FAT/ff.c **** #endif	/* FF_FS_LOCK */
1048:Core/Src/FAT/ff.c **** 
1049:Core/Src/FAT/ff.c **** 
1050:Core/Src/FAT/ff.c **** 
1051:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
1052:Core/Src/FAT/ff.c **** /* Move/Flush disk access window in the filesystem object                */
1053:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
1054:Core/Src/FAT/ff.c **** #if !FF_FS_READONLY
1055:Core/Src/FAT/ff.c **** static FRESULT sync_window (	/* Returns FR_OK or FR_DISK_ERR */
1056:Core/Src/FAT/ff.c **** 	FATFS* fs			/* Filesystem object */
1057:Core/Src/FAT/ff.c **** )
1058:Core/Src/FAT/ff.c **** {
1059:Core/Src/FAT/ff.c **** 	FRESULT res = FR_OK;
1060:Core/Src/FAT/ff.c **** 
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 25


1061:Core/Src/FAT/ff.c **** 
1062:Core/Src/FAT/ff.c **** 	if (fs->wflag) {	/* Is the disk access window dirty? */
1063:Core/Src/FAT/ff.c **** 		if (disk_write(fs->pdrv, fs->win, fs->winsect, 1) == RES_OK) {	/* Write it back into the volume *
1064:Core/Src/FAT/ff.c **** 			fs->wflag = 0;	/* Clear window dirty flag */
1065:Core/Src/FAT/ff.c **** 			if (fs->winsect - fs->fatbase < fs->fsize) {	/* Is it in the 1st FAT? */
1066:Core/Src/FAT/ff.c **** 				if (fs->n_fats == 2) disk_write(fs->pdrv, fs->win, fs->winsect + fs->fsize, 1);	/* Reflect it t
1067:Core/Src/FAT/ff.c **** 			}
1068:Core/Src/FAT/ff.c **** 		} else {
1069:Core/Src/FAT/ff.c **** 			res = FR_DISK_ERR;
1070:Core/Src/FAT/ff.c **** 		}
1071:Core/Src/FAT/ff.c **** 	}
1072:Core/Src/FAT/ff.c **** 	return res;
1073:Core/Src/FAT/ff.c **** }
1074:Core/Src/FAT/ff.c **** #endif
1075:Core/Src/FAT/ff.c **** 
1076:Core/Src/FAT/ff.c **** 
1077:Core/Src/FAT/ff.c **** static FRESULT move_window (	/* Returns FR_OK or FR_DISK_ERR */
1078:Core/Src/FAT/ff.c **** 	FATFS* fs,		/* Filesystem object */
1079:Core/Src/FAT/ff.c **** 	LBA_t sect		/* Sector LBA to make appearance in the fs->win[] */
1080:Core/Src/FAT/ff.c **** )
1081:Core/Src/FAT/ff.c **** {
1082:Core/Src/FAT/ff.c **** 	FRESULT res = FR_OK;
1083:Core/Src/FAT/ff.c **** 
1084:Core/Src/FAT/ff.c **** 
1085:Core/Src/FAT/ff.c **** 	if (sect != fs->winsect) {	/* Window offset changed? */
1086:Core/Src/FAT/ff.c **** #if !FF_FS_READONLY
1087:Core/Src/FAT/ff.c **** 		res = sync_window(fs);		/* Flush the window */
1088:Core/Src/FAT/ff.c **** #endif
1089:Core/Src/FAT/ff.c **** 		if (res == FR_OK) {			/* Fill sector window with new data */
1090:Core/Src/FAT/ff.c **** 			if (disk_read(fs->pdrv, fs->win, sect, 1) != RES_OK) {
1091:Core/Src/FAT/ff.c **** 				sect = (LBA_t)0 - 1;	/* Invalidate window if read data is not valid */
1092:Core/Src/FAT/ff.c **** 				res = FR_DISK_ERR;
1093:Core/Src/FAT/ff.c **** 			}
1094:Core/Src/FAT/ff.c **** 			fs->winsect = sect;
1095:Core/Src/FAT/ff.c **** 		}
1096:Core/Src/FAT/ff.c **** 	}
1097:Core/Src/FAT/ff.c **** 	return res;
1098:Core/Src/FAT/ff.c **** }
1099:Core/Src/FAT/ff.c **** 
1100:Core/Src/FAT/ff.c **** 
1101:Core/Src/FAT/ff.c **** 
1102:Core/Src/FAT/ff.c **** 
1103:Core/Src/FAT/ff.c **** #if !FF_FS_READONLY
1104:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
1105:Core/Src/FAT/ff.c **** /* Synchronize filesystem and data on the storage                        */
1106:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
1107:Core/Src/FAT/ff.c **** 
1108:Core/Src/FAT/ff.c **** static FRESULT sync_fs (	/* Returns FR_OK or FR_DISK_ERR */
1109:Core/Src/FAT/ff.c **** 	FATFS* fs		/* Filesystem object */
1110:Core/Src/FAT/ff.c **** )
1111:Core/Src/FAT/ff.c **** {
1112:Core/Src/FAT/ff.c **** 	FRESULT res;
1113:Core/Src/FAT/ff.c **** 
1114:Core/Src/FAT/ff.c **** 
1115:Core/Src/FAT/ff.c **** 	res = sync_window(fs);
1116:Core/Src/FAT/ff.c **** 	if (res == FR_OK) {
1117:Core/Src/FAT/ff.c **** 		if (fs->fs_type == FS_FAT32 && fs->fsi_flag == 1) {	/* FAT32: Update FSInfo sector if needed */
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 26


1118:Core/Src/FAT/ff.c **** 			/* Create FSInfo structure */
1119:Core/Src/FAT/ff.c **** 			memset(fs->win, 0, sizeof fs->win);
1120:Core/Src/FAT/ff.c **** 			st_word(fs->win + BS_55AA, 0xAA55);					/* Boot signature */
1121:Core/Src/FAT/ff.c **** 			st_dword(fs->win + FSI_LeadSig, 0x41615252);		/* Leading signature */
1122:Core/Src/FAT/ff.c **** 			st_dword(fs->win + FSI_StrucSig, 0x61417272);		/* Structure signature */
1123:Core/Src/FAT/ff.c **** 			st_dword(fs->win + FSI_Free_Count, fs->free_clst);	/* Number of free clusters */
1124:Core/Src/FAT/ff.c **** 			st_dword(fs->win + FSI_Nxt_Free, fs->last_clst);	/* Last allocated culuster */
1125:Core/Src/FAT/ff.c **** 			fs->winsect = fs->volbase + 1;						/* Write it into the FSInfo sector (Next to VBR) */
1126:Core/Src/FAT/ff.c **** 			disk_write(fs->pdrv, fs->win, fs->winsect, 1);
1127:Core/Src/FAT/ff.c **** 			fs->fsi_flag = 0;
1128:Core/Src/FAT/ff.c **** 		}
1129:Core/Src/FAT/ff.c **** 		/* Make sure that no pending write process in the lower layer */
1130:Core/Src/FAT/ff.c **** 		if (disk_ioctl(fs->pdrv, CTRL_SYNC, 0) != RES_OK) res = FR_DISK_ERR;
1131:Core/Src/FAT/ff.c **** 	}
1132:Core/Src/FAT/ff.c **** 
1133:Core/Src/FAT/ff.c **** 	return res;
1134:Core/Src/FAT/ff.c **** }
1135:Core/Src/FAT/ff.c **** 
1136:Core/Src/FAT/ff.c **** #endif
1137:Core/Src/FAT/ff.c **** 
1138:Core/Src/FAT/ff.c **** 
1139:Core/Src/FAT/ff.c **** 
1140:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
1141:Core/Src/FAT/ff.c **** /* Get physical sector number from cluster number                        */
1142:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
1143:Core/Src/FAT/ff.c **** 
1144:Core/Src/FAT/ff.c **** static LBA_t clst2sect (	/* !=0:Sector number, 0:Failed (invalid cluster#) */
1145:Core/Src/FAT/ff.c **** 	FATFS* fs,		/* Filesystem object */
1146:Core/Src/FAT/ff.c **** 	DWORD clst		/* Cluster# to be converted */
1147:Core/Src/FAT/ff.c **** )
1148:Core/Src/FAT/ff.c **** {
 313              		.loc 1 1148 1 is_stmt 1 view -0
 314              		.cfi_startproc
 315              		@ args = 0, pretend = 0, frame = 0
 316              		@ frame_needed = 0, uses_anonymous_args = 0
 317              		@ link register save eliminated.
1149:Core/Src/FAT/ff.c **** 	clst -= 2;		/* Cluster number is origin from 2 */
 318              		.loc 1 1149 2 view .LVU87
 319              		.loc 1 1149 7 is_stmt 0 view .LVU88
 320 0000 0239     		subs	r1, r1, #2
 321              	.LVL39:
1150:Core/Src/FAT/ff.c **** 	if (clst >= fs->n_fatent - 2) return 0;		/* Is it invalid cluster number? */
 322              		.loc 1 1150 2 is_stmt 1 view .LVU89
 323              		.loc 1 1150 16 is_stmt 0 view .LVU90
 324 0002 4369     		ldr	r3, [r0, #20]
 325              		.loc 1 1150 27 view .LVU91
 326 0004 023B     		subs	r3, r3, #2
 327              		.loc 1 1150 5 view .LVU92
 328 0006 8B42     		cmp	r3, r1
 329 0008 04D9     		bls	.L21
1151:Core/Src/FAT/ff.c **** 	return fs->database + (LBA_t)fs->csize * clst;	/* Start sector number of the cluster */
 330              		.loc 1 1151 2 is_stmt 1 view .LVU93
 331              		.loc 1 1151 11 is_stmt 0 view .LVU94
 332 000a 836A     		ldr	r3, [r0, #40]
 333              		.loc 1 1151 33 view .LVU95
 334 000c 4089     		ldrh	r0, [r0, #10]
 335              	.LVL40:
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 27


 336              		.loc 1 1151 22 view .LVU96
 337 000e 01FB0030 		mla	r0, r1, r0, r3
 338 0012 7047     		bx	lr
 339              	.LVL41:
 340              	.L21:
1150:Core/Src/FAT/ff.c **** 	if (clst >= fs->n_fatent - 2) return 0;		/* Is it invalid cluster number? */
 341              		.loc 1 1150 39 view .LVU97
 342 0014 0020     		movs	r0, #0
 343              	.LVL42:
1152:Core/Src/FAT/ff.c **** }
 344              		.loc 1 1152 1 view .LVU98
 345 0016 7047     		bx	lr
 346              		.cfi_endproc
 347              	.LFE9:
 349              		.section	.text.ld_clust,"ax",%progbits
 350              		.align	1
 351              		.syntax unified
 352              		.thumb
 353              		.thumb_func
 355              	ld_clust:
 356              	.LVL43:
 357              	.LFB18:
1153:Core/Src/FAT/ff.c **** 
1154:Core/Src/FAT/ff.c **** 
1155:Core/Src/FAT/ff.c **** 
1156:Core/Src/FAT/ff.c **** 
1157:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
1158:Core/Src/FAT/ff.c **** /* FAT access - Read value of an FAT entry                               */
1159:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
1160:Core/Src/FAT/ff.c **** 
1161:Core/Src/FAT/ff.c **** static DWORD get_fat (		/* 0xFFFFFFFF:Disk error, 1:Internal error, 2..0x7FFFFFFF:Cluster status */
1162:Core/Src/FAT/ff.c **** 	FFOBJID* obj,	/* Corresponding object */
1163:Core/Src/FAT/ff.c **** 	DWORD clst		/* Cluster number to get the value */
1164:Core/Src/FAT/ff.c **** )
1165:Core/Src/FAT/ff.c **** {
1166:Core/Src/FAT/ff.c **** 	UINT wc, bc;
1167:Core/Src/FAT/ff.c **** 	DWORD val;
1168:Core/Src/FAT/ff.c **** 	FATFS *fs = obj->fs;
1169:Core/Src/FAT/ff.c **** 
1170:Core/Src/FAT/ff.c **** 
1171:Core/Src/FAT/ff.c **** 	if (clst < 2 || clst >= fs->n_fatent) {	/* Check if in valid range */
1172:Core/Src/FAT/ff.c **** 		val = 1;	/* Internal error */
1173:Core/Src/FAT/ff.c **** 
1174:Core/Src/FAT/ff.c **** 	} else {
1175:Core/Src/FAT/ff.c **** 		val = 0xFFFFFFFF;	/* Default value falls on disk error */
1176:Core/Src/FAT/ff.c **** 
1177:Core/Src/FAT/ff.c **** 		switch (fs->fs_type) {
1178:Core/Src/FAT/ff.c **** 		case FS_FAT12 :
1179:Core/Src/FAT/ff.c **** 			bc = (UINT)clst; bc += bc / 2;
1180:Core/Src/FAT/ff.c **** 			if (move_window(fs, fs->fatbase + (bc / SS(fs))) != FR_OK) break;
1181:Core/Src/FAT/ff.c **** 			wc = fs->win[bc++ % SS(fs)];		/* Get 1st byte of the entry */
1182:Core/Src/FAT/ff.c **** 			if (move_window(fs, fs->fatbase + (bc / SS(fs))) != FR_OK) break;
1183:Core/Src/FAT/ff.c **** 			wc |= fs->win[bc % SS(fs)] << 8;	/* Merge 2nd byte of the entry */
1184:Core/Src/FAT/ff.c **** 			val = (clst & 1) ? (wc >> 4) : (wc & 0xFFF);	/* Adjust bit position */
1185:Core/Src/FAT/ff.c **** 			break;
1186:Core/Src/FAT/ff.c **** 
1187:Core/Src/FAT/ff.c **** 		case FS_FAT16 :
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 28


1188:Core/Src/FAT/ff.c **** 			if (move_window(fs, fs->fatbase + (clst / (SS(fs) / 2))) != FR_OK) break;
1189:Core/Src/FAT/ff.c **** 			val = ld_word(fs->win + clst * 2 % SS(fs));		/* Simple WORD array */
1190:Core/Src/FAT/ff.c **** 			break;
1191:Core/Src/FAT/ff.c **** 
1192:Core/Src/FAT/ff.c **** 		case FS_FAT32 :
1193:Core/Src/FAT/ff.c **** 			if (move_window(fs, fs->fatbase + (clst / (SS(fs) / 4))) != FR_OK) break;
1194:Core/Src/FAT/ff.c **** 			val = ld_dword(fs->win + clst * 4 % SS(fs)) & 0x0FFFFFFF;	/* Simple DWORD array but mask out upp
1195:Core/Src/FAT/ff.c **** 			break;
1196:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT
1197:Core/Src/FAT/ff.c **** 		case FS_EXFAT :
1198:Core/Src/FAT/ff.c **** 			if ((obj->objsize != 0 && obj->sclust != 0) || obj->stat == 0) {	/* Object except root dir must 
1199:Core/Src/FAT/ff.c **** 				DWORD cofs = clst - obj->sclust;	/* Offset from start cluster */
1200:Core/Src/FAT/ff.c **** 				DWORD clen = (DWORD)((LBA_t)((obj->objsize - 1) / SS(fs)) / fs->csize);	/* Number of clusters -
1201:Core/Src/FAT/ff.c **** 
1202:Core/Src/FAT/ff.c **** 				if (obj->stat == 2 && cofs <= clen) {	/* Is it a contiguous chain? */
1203:Core/Src/FAT/ff.c **** 					val = (cofs == clen) ? 0x7FFFFFFF : clst + 1;	/* No data on the FAT, generate the value */
1204:Core/Src/FAT/ff.c **** 					break;
1205:Core/Src/FAT/ff.c **** 				}
1206:Core/Src/FAT/ff.c **** 				if (obj->stat == 3 && cofs < obj->n_cont) {	/* Is it in the 1st fragment? */
1207:Core/Src/FAT/ff.c **** 					val = clst + 1; 	/* Generate the value */
1208:Core/Src/FAT/ff.c **** 					break;
1209:Core/Src/FAT/ff.c **** 				}
1210:Core/Src/FAT/ff.c **** 				if (obj->stat != 2) {	/* Get value from FAT if FAT chain is valid */
1211:Core/Src/FAT/ff.c **** 					if (obj->n_frag != 0) {	/* Is it on the growing edge? */
1212:Core/Src/FAT/ff.c **** 						val = 0x7FFFFFFF;	/* Generate EOC */
1213:Core/Src/FAT/ff.c **** 					} else {
1214:Core/Src/FAT/ff.c **** 						if (move_window(fs, fs->fatbase + (clst / (SS(fs) / 4))) != FR_OK) break;
1215:Core/Src/FAT/ff.c **** 						val = ld_dword(fs->win + clst * 4 % SS(fs)) & 0x7FFFFFFF;
1216:Core/Src/FAT/ff.c **** 					}
1217:Core/Src/FAT/ff.c **** 					break;
1218:Core/Src/FAT/ff.c **** 				}
1219:Core/Src/FAT/ff.c **** 			}
1220:Core/Src/FAT/ff.c **** 			val = 1;	/* Internal error */
1221:Core/Src/FAT/ff.c **** 			break;
1222:Core/Src/FAT/ff.c **** #endif
1223:Core/Src/FAT/ff.c **** 		default:
1224:Core/Src/FAT/ff.c **** 			val = 1;	/* Internal error */
1225:Core/Src/FAT/ff.c **** 		}
1226:Core/Src/FAT/ff.c **** 	}
1227:Core/Src/FAT/ff.c **** 
1228:Core/Src/FAT/ff.c **** 	return val;
1229:Core/Src/FAT/ff.c **** }
1230:Core/Src/FAT/ff.c **** 
1231:Core/Src/FAT/ff.c **** 
1232:Core/Src/FAT/ff.c **** 
1233:Core/Src/FAT/ff.c **** 
1234:Core/Src/FAT/ff.c **** #if !FF_FS_READONLY
1235:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
1236:Core/Src/FAT/ff.c **** /* FAT access - Change value of an FAT entry                             */
1237:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
1238:Core/Src/FAT/ff.c **** 
1239:Core/Src/FAT/ff.c **** static FRESULT put_fat (	/* FR_OK(0):succeeded, !=0:error */
1240:Core/Src/FAT/ff.c **** 	FATFS* fs,		/* Corresponding filesystem object */
1241:Core/Src/FAT/ff.c **** 	DWORD clst,		/* FAT index number (cluster number) to be changed */
1242:Core/Src/FAT/ff.c **** 	DWORD val		/* New value to be set to the entry */
1243:Core/Src/FAT/ff.c **** )
1244:Core/Src/FAT/ff.c **** {
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 29


1245:Core/Src/FAT/ff.c **** 	UINT bc;
1246:Core/Src/FAT/ff.c **** 	BYTE *p;
1247:Core/Src/FAT/ff.c **** 	FRESULT res = FR_INT_ERR;
1248:Core/Src/FAT/ff.c **** 
1249:Core/Src/FAT/ff.c **** 
1250:Core/Src/FAT/ff.c **** 	if (clst >= 2 && clst < fs->n_fatent) {	/* Check if in valid range */
1251:Core/Src/FAT/ff.c **** 		switch (fs->fs_type) {
1252:Core/Src/FAT/ff.c **** 		case FS_FAT12:
1253:Core/Src/FAT/ff.c **** 			bc = (UINT)clst; bc += bc / 2;	/* bc: byte offset of the entry */
1254:Core/Src/FAT/ff.c **** 			res = move_window(fs, fs->fatbase + (bc / SS(fs)));
1255:Core/Src/FAT/ff.c **** 			if (res != FR_OK) break;
1256:Core/Src/FAT/ff.c **** 			p = fs->win + bc++ % SS(fs);
1257:Core/Src/FAT/ff.c **** 			*p = (clst & 1) ? ((*p & 0x0F) | ((BYTE)val << 4)) : (BYTE)val;	/* Update 1st byte */
1258:Core/Src/FAT/ff.c **** 			fs->wflag = 1;
1259:Core/Src/FAT/ff.c **** 			res = move_window(fs, fs->fatbase + (bc / SS(fs)));
1260:Core/Src/FAT/ff.c **** 			if (res != FR_OK) break;
1261:Core/Src/FAT/ff.c **** 			p = fs->win + bc % SS(fs);
1262:Core/Src/FAT/ff.c **** 			*p = (clst & 1) ? (BYTE)(val >> 4) : ((*p & 0xF0) | ((BYTE)(val >> 8) & 0x0F));	/* Update 2nd by
1263:Core/Src/FAT/ff.c **** 			fs->wflag = 1;
1264:Core/Src/FAT/ff.c **** 			break;
1265:Core/Src/FAT/ff.c **** 
1266:Core/Src/FAT/ff.c **** 		case FS_FAT16:
1267:Core/Src/FAT/ff.c **** 			res = move_window(fs, fs->fatbase + (clst / (SS(fs) / 2)));
1268:Core/Src/FAT/ff.c **** 			if (res != FR_OK) break;
1269:Core/Src/FAT/ff.c **** 			st_word(fs->win + clst * 2 % SS(fs), (WORD)val);	/* Simple WORD array */
1270:Core/Src/FAT/ff.c **** 			fs->wflag = 1;
1271:Core/Src/FAT/ff.c **** 			break;
1272:Core/Src/FAT/ff.c **** 
1273:Core/Src/FAT/ff.c **** 		case FS_FAT32:
1274:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT
1275:Core/Src/FAT/ff.c **** 		case FS_EXFAT:
1276:Core/Src/FAT/ff.c **** #endif
1277:Core/Src/FAT/ff.c **** 			res = move_window(fs, fs->fatbase + (clst / (SS(fs) / 4)));
1278:Core/Src/FAT/ff.c **** 			if (res != FR_OK) break;
1279:Core/Src/FAT/ff.c **** 			if (!FF_FS_EXFAT || fs->fs_type != FS_EXFAT) {
1280:Core/Src/FAT/ff.c **** 				val = (val & 0x0FFFFFFF) | (ld_dword(fs->win + clst * 4 % SS(fs)) & 0xF0000000);
1281:Core/Src/FAT/ff.c **** 			}
1282:Core/Src/FAT/ff.c **** 			st_dword(fs->win + clst * 4 % SS(fs), val);
1283:Core/Src/FAT/ff.c **** 			fs->wflag = 1;
1284:Core/Src/FAT/ff.c **** 			break;
1285:Core/Src/FAT/ff.c **** 		}
1286:Core/Src/FAT/ff.c **** 	}
1287:Core/Src/FAT/ff.c **** 	return res;
1288:Core/Src/FAT/ff.c **** }
1289:Core/Src/FAT/ff.c **** 
1290:Core/Src/FAT/ff.c **** #endif /* !FF_FS_READONLY */
1291:Core/Src/FAT/ff.c **** 
1292:Core/Src/FAT/ff.c **** 
1293:Core/Src/FAT/ff.c **** 
1294:Core/Src/FAT/ff.c **** 
1295:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT && !FF_FS_READONLY
1296:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
1297:Core/Src/FAT/ff.c **** /* exFAT: Accessing FAT and Allocation Bitmap                            */
1298:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
1299:Core/Src/FAT/ff.c **** 
1300:Core/Src/FAT/ff.c **** /*--------------------------------------*/
1301:Core/Src/FAT/ff.c **** /* Find a contiguous free cluster block */
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 30


1302:Core/Src/FAT/ff.c **** /*--------------------------------------*/
1303:Core/Src/FAT/ff.c **** 
1304:Core/Src/FAT/ff.c **** static DWORD find_bitmap (	/* 0:Not found, 2..:Cluster block found, 0xFFFFFFFF:Disk error */
1305:Core/Src/FAT/ff.c **** 	FATFS* fs,	/* Filesystem object */
1306:Core/Src/FAT/ff.c **** 	DWORD clst,	/* Cluster number to scan from */
1307:Core/Src/FAT/ff.c **** 	DWORD ncl	/* Number of contiguous clusters to find (1..) */
1308:Core/Src/FAT/ff.c **** )
1309:Core/Src/FAT/ff.c **** {
1310:Core/Src/FAT/ff.c **** 	BYTE bm, bv;
1311:Core/Src/FAT/ff.c **** 	UINT i;
1312:Core/Src/FAT/ff.c **** 	DWORD val, scl, ctr;
1313:Core/Src/FAT/ff.c **** 
1314:Core/Src/FAT/ff.c **** 
1315:Core/Src/FAT/ff.c **** 	clst -= 2;	/* The first bit in the bitmap corresponds to cluster #2 */
1316:Core/Src/FAT/ff.c **** 	if (clst >= fs->n_fatent - 2) clst = 0;
1317:Core/Src/FAT/ff.c **** 	scl = val = clst; ctr = 0;
1318:Core/Src/FAT/ff.c **** 	for (;;) {
1319:Core/Src/FAT/ff.c **** 		if (move_window(fs, fs->bitbase + val / 8 / SS(fs)) != FR_OK) return 0xFFFFFFFF;
1320:Core/Src/FAT/ff.c **** 		i = val / 8 % SS(fs); bm = 1 << (val % 8);
1321:Core/Src/FAT/ff.c **** 		do {
1322:Core/Src/FAT/ff.c **** 			do {
1323:Core/Src/FAT/ff.c **** 				bv = fs->win[i] & bm; bm <<= 1;		/* Get bit value */
1324:Core/Src/FAT/ff.c **** 				if (++val >= fs->n_fatent - 2) {	/* Next cluster (with wrap-around) */
1325:Core/Src/FAT/ff.c **** 					val = 0; bm = 0; i = SS(fs);
1326:Core/Src/FAT/ff.c **** 				}
1327:Core/Src/FAT/ff.c **** 				if (bv == 0) {	/* Is it a free cluster? */
1328:Core/Src/FAT/ff.c **** 					if (++ctr == ncl) return scl + 2;	/* Check if run length is sufficient for required */
1329:Core/Src/FAT/ff.c **** 				} else {
1330:Core/Src/FAT/ff.c **** 					scl = val; ctr = 0;		/* Encountered a cluster in-use, restart to scan */
1331:Core/Src/FAT/ff.c **** 				}
1332:Core/Src/FAT/ff.c **** 				if (val == clst) return 0;	/* All cluster scanned? */
1333:Core/Src/FAT/ff.c **** 			} while (bm != 0);
1334:Core/Src/FAT/ff.c **** 			bm = 1;
1335:Core/Src/FAT/ff.c **** 		} while (++i < SS(fs));
1336:Core/Src/FAT/ff.c **** 	}
1337:Core/Src/FAT/ff.c **** }
1338:Core/Src/FAT/ff.c **** 
1339:Core/Src/FAT/ff.c **** 
1340:Core/Src/FAT/ff.c **** /*----------------------------------------*/
1341:Core/Src/FAT/ff.c **** /* Set/Clear a block of allocation bitmap */
1342:Core/Src/FAT/ff.c **** /*----------------------------------------*/
1343:Core/Src/FAT/ff.c **** 
1344:Core/Src/FAT/ff.c **** static FRESULT change_bitmap (
1345:Core/Src/FAT/ff.c **** 	FATFS* fs,	/* Filesystem object */
1346:Core/Src/FAT/ff.c **** 	DWORD clst,	/* Cluster number to change from */
1347:Core/Src/FAT/ff.c **** 	DWORD ncl,	/* Number of clusters to be changed */
1348:Core/Src/FAT/ff.c **** 	int bv		/* bit value to be set (0 or 1) */
1349:Core/Src/FAT/ff.c **** )
1350:Core/Src/FAT/ff.c **** {
1351:Core/Src/FAT/ff.c **** 	BYTE bm;
1352:Core/Src/FAT/ff.c **** 	UINT i;
1353:Core/Src/FAT/ff.c **** 	LBA_t sect;
1354:Core/Src/FAT/ff.c **** 
1355:Core/Src/FAT/ff.c **** 
1356:Core/Src/FAT/ff.c **** 	clst -= 2;	/* The first bit corresponds to cluster #2 */
1357:Core/Src/FAT/ff.c **** 	sect = fs->bitbase + clst / 8 / SS(fs);	/* Sector address */
1358:Core/Src/FAT/ff.c **** 	i = clst / 8 % SS(fs);					/* Byte offset in the sector */
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 31


1359:Core/Src/FAT/ff.c **** 	bm = 1 << (clst % 8);					/* Bit mask in the byte */
1360:Core/Src/FAT/ff.c **** 	for (;;) {
1361:Core/Src/FAT/ff.c **** 		if (move_window(fs, sect++) != FR_OK) return FR_DISK_ERR;
1362:Core/Src/FAT/ff.c **** 		do {
1363:Core/Src/FAT/ff.c **** 			do {
1364:Core/Src/FAT/ff.c **** 				if (bv == (int)((fs->win[i] & bm) != 0)) return FR_INT_ERR;	/* Is the bit expected value? */
1365:Core/Src/FAT/ff.c **** 				fs->win[i] ^= bm;	/* Flip the bit */
1366:Core/Src/FAT/ff.c **** 				fs->wflag = 1;
1367:Core/Src/FAT/ff.c **** 				if (--ncl == 0) return FR_OK;	/* All bits processed? */
1368:Core/Src/FAT/ff.c **** 			} while (bm <<= 1);		/* Next bit */
1369:Core/Src/FAT/ff.c **** 			bm = 1;
1370:Core/Src/FAT/ff.c **** 		} while (++i < SS(fs));		/* Next byte */
1371:Core/Src/FAT/ff.c **** 		i = 0;
1372:Core/Src/FAT/ff.c **** 	}
1373:Core/Src/FAT/ff.c **** }
1374:Core/Src/FAT/ff.c **** 
1375:Core/Src/FAT/ff.c **** 
1376:Core/Src/FAT/ff.c **** /*---------------------------------------------*/
1377:Core/Src/FAT/ff.c **** /* Fill the first fragment of the FAT chain    */
1378:Core/Src/FAT/ff.c **** /*---------------------------------------------*/
1379:Core/Src/FAT/ff.c **** 
1380:Core/Src/FAT/ff.c **** static FRESULT fill_first_frag (
1381:Core/Src/FAT/ff.c **** 	FFOBJID* obj	/* Pointer to the corresponding object */
1382:Core/Src/FAT/ff.c **** )
1383:Core/Src/FAT/ff.c **** {
1384:Core/Src/FAT/ff.c **** 	FRESULT res;
1385:Core/Src/FAT/ff.c **** 	DWORD cl, n;
1386:Core/Src/FAT/ff.c **** 
1387:Core/Src/FAT/ff.c **** 
1388:Core/Src/FAT/ff.c **** 	if (obj->stat == 3) {	/* Has the object been changed 'fragmented' in this session? */
1389:Core/Src/FAT/ff.c **** 		for (cl = obj->sclust, n = obj->n_cont; n; cl++, n--) {	/* Create cluster chain on the FAT */
1390:Core/Src/FAT/ff.c **** 			res = put_fat(obj->fs, cl, cl + 1);
1391:Core/Src/FAT/ff.c **** 			if (res != FR_OK) return res;
1392:Core/Src/FAT/ff.c **** 		}
1393:Core/Src/FAT/ff.c **** 		obj->stat = 0;	/* Change status 'FAT chain is valid' */
1394:Core/Src/FAT/ff.c **** 	}
1395:Core/Src/FAT/ff.c **** 	return FR_OK;
1396:Core/Src/FAT/ff.c **** }
1397:Core/Src/FAT/ff.c **** 
1398:Core/Src/FAT/ff.c **** 
1399:Core/Src/FAT/ff.c **** /*---------------------------------------------*/
1400:Core/Src/FAT/ff.c **** /* Fill the last fragment of the FAT chain     */
1401:Core/Src/FAT/ff.c **** /*---------------------------------------------*/
1402:Core/Src/FAT/ff.c **** 
1403:Core/Src/FAT/ff.c **** static FRESULT fill_last_frag (
1404:Core/Src/FAT/ff.c **** 	FFOBJID* obj,	/* Pointer to the corresponding object */
1405:Core/Src/FAT/ff.c **** 	DWORD lcl,		/* Last cluster of the fragment */
1406:Core/Src/FAT/ff.c **** 	DWORD term		/* Value to set the last FAT entry */
1407:Core/Src/FAT/ff.c **** )
1408:Core/Src/FAT/ff.c **** {
1409:Core/Src/FAT/ff.c **** 	FRESULT res;
1410:Core/Src/FAT/ff.c **** 
1411:Core/Src/FAT/ff.c **** 
1412:Core/Src/FAT/ff.c **** 	while (obj->n_frag > 0) {	/* Create the chain of last fragment */
1413:Core/Src/FAT/ff.c **** 		res = put_fat(obj->fs, lcl - obj->n_frag + 1, (obj->n_frag > 1) ? lcl - obj->n_frag + 2 : term);
1414:Core/Src/FAT/ff.c **** 		if (res != FR_OK) return res;
1415:Core/Src/FAT/ff.c **** 		obj->n_frag--;
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 32


1416:Core/Src/FAT/ff.c **** 	}
1417:Core/Src/FAT/ff.c **** 	return FR_OK;
1418:Core/Src/FAT/ff.c **** }
1419:Core/Src/FAT/ff.c **** 
1420:Core/Src/FAT/ff.c **** #endif	/* FF_FS_EXFAT && !FF_FS_READONLY */
1421:Core/Src/FAT/ff.c **** 
1422:Core/Src/FAT/ff.c **** 
1423:Core/Src/FAT/ff.c **** 
1424:Core/Src/FAT/ff.c **** #if !FF_FS_READONLY
1425:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
1426:Core/Src/FAT/ff.c **** /* FAT handling - Remove a cluster chain                                 */
1427:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
1428:Core/Src/FAT/ff.c **** 
1429:Core/Src/FAT/ff.c **** static FRESULT remove_chain (	/* FR_OK(0):succeeded, !=0:error */
1430:Core/Src/FAT/ff.c **** 	FFOBJID* obj,		/* Corresponding object */
1431:Core/Src/FAT/ff.c **** 	DWORD clst,			/* Cluster to remove a chain from */
1432:Core/Src/FAT/ff.c **** 	DWORD pclst			/* Previous cluster of clst (0 if entire chain) */
1433:Core/Src/FAT/ff.c **** )
1434:Core/Src/FAT/ff.c **** {
1435:Core/Src/FAT/ff.c **** 	FRESULT res = FR_OK;
1436:Core/Src/FAT/ff.c **** 	DWORD nxt;
1437:Core/Src/FAT/ff.c **** 	FATFS *fs = obj->fs;
1438:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT || FF_USE_TRIM
1439:Core/Src/FAT/ff.c **** 	DWORD scl = clst, ecl = clst;
1440:Core/Src/FAT/ff.c **** #endif
1441:Core/Src/FAT/ff.c **** #if FF_USE_TRIM
1442:Core/Src/FAT/ff.c **** 	LBA_t rt[2];
1443:Core/Src/FAT/ff.c **** #endif
1444:Core/Src/FAT/ff.c **** 
1445:Core/Src/FAT/ff.c **** 	if (clst < 2 || clst >= fs->n_fatent) return FR_INT_ERR;	/* Check if in valid range */
1446:Core/Src/FAT/ff.c **** 
1447:Core/Src/FAT/ff.c **** 	/* Mark the previous cluster 'EOC' on the FAT if it exists */
1448:Core/Src/FAT/ff.c **** 	if (pclst != 0 && (!FF_FS_EXFAT || fs->fs_type != FS_EXFAT || obj->stat != 2)) {
1449:Core/Src/FAT/ff.c **** 		res = put_fat(fs, pclst, 0xFFFFFFFF);
1450:Core/Src/FAT/ff.c **** 		if (res != FR_OK) return res;
1451:Core/Src/FAT/ff.c **** 	}
1452:Core/Src/FAT/ff.c **** 
1453:Core/Src/FAT/ff.c **** 	/* Remove the chain */
1454:Core/Src/FAT/ff.c **** 	do {
1455:Core/Src/FAT/ff.c **** 		nxt = get_fat(obj, clst);			/* Get cluster status */
1456:Core/Src/FAT/ff.c **** 		if (nxt == 0) break;				/* Empty cluster? */
1457:Core/Src/FAT/ff.c **** 		if (nxt == 1) return FR_INT_ERR;	/* Internal error? */
1458:Core/Src/FAT/ff.c **** 		if (nxt == 0xFFFFFFFF) return FR_DISK_ERR;	/* Disk error? */
1459:Core/Src/FAT/ff.c **** 		if (!FF_FS_EXFAT || fs->fs_type != FS_EXFAT) {
1460:Core/Src/FAT/ff.c **** 			res = put_fat(fs, clst, 0);		/* Mark the cluster 'free' on the FAT */
1461:Core/Src/FAT/ff.c **** 			if (res != FR_OK) return res;
1462:Core/Src/FAT/ff.c **** 		}
1463:Core/Src/FAT/ff.c **** 		if (fs->free_clst < fs->n_fatent - 2) {	/* Update FSINFO */
1464:Core/Src/FAT/ff.c **** 			fs->free_clst++;
1465:Core/Src/FAT/ff.c **** 			fs->fsi_flag |= 1;
1466:Core/Src/FAT/ff.c **** 		}
1467:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT || FF_USE_TRIM
1468:Core/Src/FAT/ff.c **** 		if (ecl + 1 == nxt) {	/* Is next cluster contiguous? */
1469:Core/Src/FAT/ff.c **** 			ecl = nxt;
1470:Core/Src/FAT/ff.c **** 		} else {				/* End of contiguous cluster block */
1471:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT
1472:Core/Src/FAT/ff.c **** 			if (fs->fs_type == FS_EXFAT) {
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 33


1473:Core/Src/FAT/ff.c **** 				res = change_bitmap(fs, scl, ecl - scl + 1, 0);	/* Mark the cluster block 'free' on the bitmap 
1474:Core/Src/FAT/ff.c **** 				if (res != FR_OK) return res;
1475:Core/Src/FAT/ff.c **** 			}
1476:Core/Src/FAT/ff.c **** #endif
1477:Core/Src/FAT/ff.c **** #if FF_USE_TRIM
1478:Core/Src/FAT/ff.c **** 			rt[0] = clst2sect(fs, scl);					/* Start of data area to be freed */
1479:Core/Src/FAT/ff.c **** 			rt[1] = clst2sect(fs, ecl) + fs->csize - 1;	/* End of data area to be freed */
1480:Core/Src/FAT/ff.c **** 			disk_ioctl(fs->pdrv, CTRL_TRIM, rt);		/* Inform storage device that the data in the block may be
1481:Core/Src/FAT/ff.c **** #endif
1482:Core/Src/FAT/ff.c **** 			scl = ecl = nxt;
1483:Core/Src/FAT/ff.c **** 		}
1484:Core/Src/FAT/ff.c **** #endif
1485:Core/Src/FAT/ff.c **** 		clst = nxt;					/* Next cluster */
1486:Core/Src/FAT/ff.c **** 	} while (clst < fs->n_fatent);	/* Repeat while not the last link */
1487:Core/Src/FAT/ff.c **** 
1488:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT
1489:Core/Src/FAT/ff.c **** 	/* Some post processes for chain status */
1490:Core/Src/FAT/ff.c **** 	if (fs->fs_type == FS_EXFAT) {
1491:Core/Src/FAT/ff.c **** 		if (pclst == 0) {	/* Has the entire chain been removed? */
1492:Core/Src/FAT/ff.c **** 			obj->stat = 0;		/* Change the chain status 'initial' */
1493:Core/Src/FAT/ff.c **** 		} else {
1494:Core/Src/FAT/ff.c **** 			if (obj->stat == 0) {	/* Is it a fragmented chain from the beginning of this session? */
1495:Core/Src/FAT/ff.c **** 				clst = obj->sclust;		/* Follow the chain to check if it gets contiguous */
1496:Core/Src/FAT/ff.c **** 				while (clst != pclst) {
1497:Core/Src/FAT/ff.c **** 					nxt = get_fat(obj, clst);
1498:Core/Src/FAT/ff.c **** 					if (nxt < 2) return FR_INT_ERR;
1499:Core/Src/FAT/ff.c **** 					if (nxt == 0xFFFFFFFF) return FR_DISK_ERR;
1500:Core/Src/FAT/ff.c **** 					if (nxt != clst + 1) break;	/* Not contiguous? */
1501:Core/Src/FAT/ff.c **** 					clst++;
1502:Core/Src/FAT/ff.c **** 				}
1503:Core/Src/FAT/ff.c **** 				if (clst == pclst) {	/* Has the chain got contiguous again? */
1504:Core/Src/FAT/ff.c **** 					obj->stat = 2;		/* Change the chain status 'contiguous' */
1505:Core/Src/FAT/ff.c **** 				}
1506:Core/Src/FAT/ff.c **** 			} else {
1507:Core/Src/FAT/ff.c **** 				if (obj->stat == 3 && pclst >= obj->sclust && pclst <= obj->sclust + obj->n_cont) {	/* Was the 
1508:Core/Src/FAT/ff.c **** 					obj->stat = 2;	/* Change the chain status 'contiguous' */
1509:Core/Src/FAT/ff.c **** 				}
1510:Core/Src/FAT/ff.c **** 			}
1511:Core/Src/FAT/ff.c **** 		}
1512:Core/Src/FAT/ff.c **** 	}
1513:Core/Src/FAT/ff.c **** #endif
1514:Core/Src/FAT/ff.c **** 	return FR_OK;
1515:Core/Src/FAT/ff.c **** }
1516:Core/Src/FAT/ff.c **** 
1517:Core/Src/FAT/ff.c **** 
1518:Core/Src/FAT/ff.c **** 
1519:Core/Src/FAT/ff.c **** 
1520:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
1521:Core/Src/FAT/ff.c **** /* FAT handling - Stretch a chain or Create a new chain                  */
1522:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
1523:Core/Src/FAT/ff.c **** 
1524:Core/Src/FAT/ff.c **** static DWORD create_chain (	/* 0:No free cluster, 1:Internal error, 0xFFFFFFFF:Disk error, >=2:New 
1525:Core/Src/FAT/ff.c **** 	FFOBJID* obj,		/* Corresponding object */
1526:Core/Src/FAT/ff.c **** 	DWORD clst			/* Cluster# to stretch, 0:Create a new chain */
1527:Core/Src/FAT/ff.c **** )
1528:Core/Src/FAT/ff.c **** {
1529:Core/Src/FAT/ff.c **** 	DWORD cs, ncl, scl;
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 34


1530:Core/Src/FAT/ff.c **** 	FRESULT res;
1531:Core/Src/FAT/ff.c **** 	FATFS *fs = obj->fs;
1532:Core/Src/FAT/ff.c **** 
1533:Core/Src/FAT/ff.c **** 
1534:Core/Src/FAT/ff.c **** 	if (clst == 0) {	/* Create a new chain */
1535:Core/Src/FAT/ff.c **** 		scl = fs->last_clst;				/* Suggested cluster to start to find */
1536:Core/Src/FAT/ff.c **** 		if (scl == 0 || scl >= fs->n_fatent) scl = 1;
1537:Core/Src/FAT/ff.c **** 	}
1538:Core/Src/FAT/ff.c **** 	else {				/* Stretch a chain */
1539:Core/Src/FAT/ff.c **** 		cs = get_fat(obj, clst);			/* Check the cluster status */
1540:Core/Src/FAT/ff.c **** 		if (cs < 2) return 1;				/* Test for insanity */
1541:Core/Src/FAT/ff.c **** 		if (cs == 0xFFFFFFFF) return cs;	/* Test for disk error */
1542:Core/Src/FAT/ff.c **** 		if (cs < fs->n_fatent) return cs;	/* It is already followed by next cluster */
1543:Core/Src/FAT/ff.c **** 		scl = clst;							/* Cluster to start to find */
1544:Core/Src/FAT/ff.c **** 	}
1545:Core/Src/FAT/ff.c **** 	if (fs->free_clst == 0) return 0;		/* No free cluster */
1546:Core/Src/FAT/ff.c **** 
1547:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT
1548:Core/Src/FAT/ff.c **** 	if (fs->fs_type == FS_EXFAT) {	/* On the exFAT volume */
1549:Core/Src/FAT/ff.c **** 		ncl = find_bitmap(fs, scl, 1);				/* Find a free cluster */
1550:Core/Src/FAT/ff.c **** 		if (ncl == 0 || ncl == 0xFFFFFFFF) return ncl;	/* No free cluster or hard error? */
1551:Core/Src/FAT/ff.c **** 		res = change_bitmap(fs, ncl, 1, 1);			/* Mark the cluster 'in use' */
1552:Core/Src/FAT/ff.c **** 		if (res == FR_INT_ERR) return 1;
1553:Core/Src/FAT/ff.c **** 		if (res == FR_DISK_ERR) return 0xFFFFFFFF;
1554:Core/Src/FAT/ff.c **** 		if (clst == 0) {							/* Is it a new chain? */
1555:Core/Src/FAT/ff.c **** 			obj->stat = 2;							/* Set status 'contiguous' */
1556:Core/Src/FAT/ff.c **** 		} else {									/* It is a stretched chain */
1557:Core/Src/FAT/ff.c **** 			if (obj->stat == 2 && ncl != scl + 1) {	/* Is the chain got fragmented? */
1558:Core/Src/FAT/ff.c **** 				obj->n_cont = scl - obj->sclust;	/* Set size of the contiguous part */
1559:Core/Src/FAT/ff.c **** 				obj->stat = 3;						/* Change status 'just fragmented' */
1560:Core/Src/FAT/ff.c **** 			}
1561:Core/Src/FAT/ff.c **** 		}
1562:Core/Src/FAT/ff.c **** 		if (obj->stat != 2) {	/* Is the file non-contiguous? */
1563:Core/Src/FAT/ff.c **** 			if (ncl == clst + 1) {	/* Is the cluster next to previous one? */
1564:Core/Src/FAT/ff.c **** 				obj->n_frag = obj->n_frag ? obj->n_frag + 1 : 2;	/* Increment size of last framgent */
1565:Core/Src/FAT/ff.c **** 			} else {				/* New fragment */
1566:Core/Src/FAT/ff.c **** 				if (obj->n_frag == 0) obj->n_frag = 1;
1567:Core/Src/FAT/ff.c **** 				res = fill_last_frag(obj, clst, ncl);	/* Fill last fragment on the FAT and link it to new one *
1568:Core/Src/FAT/ff.c **** 				if (res == FR_OK) obj->n_frag = 1;
1569:Core/Src/FAT/ff.c **** 			}
1570:Core/Src/FAT/ff.c **** 		}
1571:Core/Src/FAT/ff.c **** 	} else
1572:Core/Src/FAT/ff.c **** #endif
1573:Core/Src/FAT/ff.c **** 	{	/* On the FAT/FAT32 volume */
1574:Core/Src/FAT/ff.c **** 		ncl = 0;
1575:Core/Src/FAT/ff.c **** 		if (scl == clst) {						/* Stretching an existing chain? */
1576:Core/Src/FAT/ff.c **** 			ncl = scl + 1;						/* Test if next cluster is free */
1577:Core/Src/FAT/ff.c **** 			if (ncl >= fs->n_fatent) ncl = 2;
1578:Core/Src/FAT/ff.c **** 			cs = get_fat(obj, ncl);				/* Get next cluster status */
1579:Core/Src/FAT/ff.c **** 			if (cs == 1 || cs == 0xFFFFFFFF) return cs;	/* Test for error */
1580:Core/Src/FAT/ff.c **** 			if (cs != 0) {						/* Not free? */
1581:Core/Src/FAT/ff.c **** 				cs = fs->last_clst;				/* Start at suggested cluster if it is valid */
1582:Core/Src/FAT/ff.c **** 				if (cs >= 2 && cs < fs->n_fatent) scl = cs;
1583:Core/Src/FAT/ff.c **** 				ncl = 0;
1584:Core/Src/FAT/ff.c **** 			}
1585:Core/Src/FAT/ff.c **** 		}
1586:Core/Src/FAT/ff.c **** 		if (ncl == 0) {	/* The new cluster cannot be contiguous and find another fragment */
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 35


1587:Core/Src/FAT/ff.c **** 			ncl = scl;	/* Start cluster */
1588:Core/Src/FAT/ff.c **** 			for (;;) {
1589:Core/Src/FAT/ff.c **** 				ncl++;							/* Next cluster */
1590:Core/Src/FAT/ff.c **** 				if (ncl >= fs->n_fatent) {		/* Check wrap-around */
1591:Core/Src/FAT/ff.c **** 					ncl = 2;
1592:Core/Src/FAT/ff.c **** 					if (ncl > scl) return 0;	/* No free cluster found? */
1593:Core/Src/FAT/ff.c **** 				}
1594:Core/Src/FAT/ff.c **** 				cs = get_fat(obj, ncl);			/* Get the cluster status */
1595:Core/Src/FAT/ff.c **** 				if (cs == 0) break;				/* Found a free cluster? */
1596:Core/Src/FAT/ff.c **** 				if (cs == 1 || cs == 0xFFFFFFFF) return cs;	/* Test for error */
1597:Core/Src/FAT/ff.c **** 				if (ncl == scl) return 0;		/* No free cluster found? */
1598:Core/Src/FAT/ff.c **** 			}
1599:Core/Src/FAT/ff.c **** 		}
1600:Core/Src/FAT/ff.c **** 		res = put_fat(fs, ncl, 0xFFFFFFFF);		/* Mark the new cluster 'EOC' */
1601:Core/Src/FAT/ff.c **** 		if (res == FR_OK && clst != 0) {
1602:Core/Src/FAT/ff.c **** 			res = put_fat(fs, clst, ncl);		/* Link it from the previous one if needed */
1603:Core/Src/FAT/ff.c **** 		}
1604:Core/Src/FAT/ff.c **** 	}
1605:Core/Src/FAT/ff.c **** 
1606:Core/Src/FAT/ff.c **** 	if (res == FR_OK) {			/* Update FSINFO if function succeeded. */
1607:Core/Src/FAT/ff.c **** 		fs->last_clst = ncl;
1608:Core/Src/FAT/ff.c **** 		if (fs->free_clst <= fs->n_fatent - 2) fs->free_clst--;
1609:Core/Src/FAT/ff.c **** 		fs->fsi_flag |= 1;
1610:Core/Src/FAT/ff.c **** 	} else {
1611:Core/Src/FAT/ff.c **** 		ncl = (res == FR_DISK_ERR) ? 0xFFFFFFFF : 1;	/* Failed. Generate error status */
1612:Core/Src/FAT/ff.c **** 	}
1613:Core/Src/FAT/ff.c **** 
1614:Core/Src/FAT/ff.c **** 	return ncl;		/* Return new cluster number or error status */
1615:Core/Src/FAT/ff.c **** }
1616:Core/Src/FAT/ff.c **** 
1617:Core/Src/FAT/ff.c **** #endif /* !FF_FS_READONLY */
1618:Core/Src/FAT/ff.c **** 
1619:Core/Src/FAT/ff.c **** 
1620:Core/Src/FAT/ff.c **** 
1621:Core/Src/FAT/ff.c **** 
1622:Core/Src/FAT/ff.c **** #if FF_USE_FASTSEEK
1623:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
1624:Core/Src/FAT/ff.c **** /* FAT handling - Convert offset into cluster with link map table        */
1625:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
1626:Core/Src/FAT/ff.c **** 
1627:Core/Src/FAT/ff.c **** static DWORD clmt_clust (	/* <2:Error, >=2:Cluster number */
1628:Core/Src/FAT/ff.c **** 	FIL* fp,		/* Pointer to the file object */
1629:Core/Src/FAT/ff.c **** 	FSIZE_t ofs		/* File offset to be converted to cluster# */
1630:Core/Src/FAT/ff.c **** )
1631:Core/Src/FAT/ff.c **** {
1632:Core/Src/FAT/ff.c **** 	DWORD cl, ncl;
1633:Core/Src/FAT/ff.c **** 	DWORD *tbl;
1634:Core/Src/FAT/ff.c **** 	FATFS *fs = fp->obj.fs;
1635:Core/Src/FAT/ff.c **** 
1636:Core/Src/FAT/ff.c **** 
1637:Core/Src/FAT/ff.c **** 	tbl = fp->cltbl + 1;	/* Top of CLMT */
1638:Core/Src/FAT/ff.c **** 	cl = (DWORD)(ofs / SS(fs) / fs->csize);	/* Cluster order from top of the file */
1639:Core/Src/FAT/ff.c **** 	for (;;) {
1640:Core/Src/FAT/ff.c **** 		ncl = *tbl++;			/* Number of cluters in the fragment */
1641:Core/Src/FAT/ff.c **** 		if (ncl == 0) return 0;	/* End of table? (error) */
1642:Core/Src/FAT/ff.c **** 		if (cl < ncl) break;	/* In this fragment? */
1643:Core/Src/FAT/ff.c **** 		cl -= ncl; tbl++;		/* Next fragment */
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 36


1644:Core/Src/FAT/ff.c **** 	}
1645:Core/Src/FAT/ff.c **** 	return cl + *tbl;	/* Return the cluster number */
1646:Core/Src/FAT/ff.c **** }
1647:Core/Src/FAT/ff.c **** 
1648:Core/Src/FAT/ff.c **** #endif	/* FF_USE_FASTSEEK */
1649:Core/Src/FAT/ff.c **** 
1650:Core/Src/FAT/ff.c **** 
1651:Core/Src/FAT/ff.c **** 
1652:Core/Src/FAT/ff.c **** 
1653:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
1654:Core/Src/FAT/ff.c **** /* Directory handling - Fill a cluster with zeros                        */
1655:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
1656:Core/Src/FAT/ff.c **** 
1657:Core/Src/FAT/ff.c **** #if !FF_FS_READONLY
1658:Core/Src/FAT/ff.c **** static FRESULT dir_clear (	/* Returns FR_OK or FR_DISK_ERR */
1659:Core/Src/FAT/ff.c **** 	FATFS *fs,		/* Filesystem object */
1660:Core/Src/FAT/ff.c **** 	DWORD clst		/* Directory table to clear */
1661:Core/Src/FAT/ff.c **** )
1662:Core/Src/FAT/ff.c **** {
1663:Core/Src/FAT/ff.c **** 	LBA_t sect;
1664:Core/Src/FAT/ff.c **** 	UINT n, szb;
1665:Core/Src/FAT/ff.c **** 	BYTE *ibuf;
1666:Core/Src/FAT/ff.c **** 
1667:Core/Src/FAT/ff.c **** 
1668:Core/Src/FAT/ff.c **** 	if (sync_window(fs) != FR_OK) return FR_DISK_ERR;	/* Flush disk access window */
1669:Core/Src/FAT/ff.c **** 	sect = clst2sect(fs, clst);		/* Top of the cluster */
1670:Core/Src/FAT/ff.c **** 	fs->winsect = sect;				/* Set window to top of the cluster */
1671:Core/Src/FAT/ff.c **** 	memset(fs->win, 0, sizeof fs->win);	/* Clear window buffer */
1672:Core/Src/FAT/ff.c **** #if FF_USE_LFN == 3		/* Quick table clear by using multi-secter write */
1673:Core/Src/FAT/ff.c **** 	/* Allocate a temporary buffer */
1674:Core/Src/FAT/ff.c **** 	for (szb = ((DWORD)fs->csize * SS(fs) >= MAX_MALLOC) ? MAX_MALLOC : fs->csize * SS(fs), ibuf = 0; 
1675:Core/Src/FAT/ff.c **** 	if (szb > SS(fs)) {		/* Buffer allocated? */
1676:Core/Src/FAT/ff.c **** 		memset(ibuf, 0, szb);
1677:Core/Src/FAT/ff.c **** 		szb /= SS(fs);		/* Bytes -> Sectors */
1678:Core/Src/FAT/ff.c **** 		for (n = 0; n < fs->csize && disk_write(fs->pdrv, ibuf, sect + n, szb) == RES_OK; n += szb) ;	/* 
1679:Core/Src/FAT/ff.c **** 		ff_memfree(ibuf);
1680:Core/Src/FAT/ff.c **** 	} else
1681:Core/Src/FAT/ff.c **** #endif
1682:Core/Src/FAT/ff.c **** 	{
1683:Core/Src/FAT/ff.c **** 		ibuf = fs->win; szb = 1;	/* Use window buffer (many single-sector writes may take a time) */
1684:Core/Src/FAT/ff.c **** 		for (n = 0; n < fs->csize && disk_write(fs->pdrv, ibuf, sect + n, szb) == RES_OK; n += szb) ;	/* 
1685:Core/Src/FAT/ff.c **** 	}
1686:Core/Src/FAT/ff.c **** 	return (n == fs->csize) ? FR_OK : FR_DISK_ERR;
1687:Core/Src/FAT/ff.c **** }
1688:Core/Src/FAT/ff.c **** #endif	/* !FF_FS_READONLY */
1689:Core/Src/FAT/ff.c **** 
1690:Core/Src/FAT/ff.c **** 
1691:Core/Src/FAT/ff.c **** 
1692:Core/Src/FAT/ff.c **** 
1693:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
1694:Core/Src/FAT/ff.c **** /* Directory handling - Set directory index                              */
1695:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
1696:Core/Src/FAT/ff.c **** 
1697:Core/Src/FAT/ff.c **** static FRESULT dir_sdi (	/* FR_OK(0):succeeded, !=0:error */
1698:Core/Src/FAT/ff.c **** 	DIR* dp,		/* Pointer to directory object */
1699:Core/Src/FAT/ff.c **** 	DWORD ofs		/* Offset of directory table */
1700:Core/Src/FAT/ff.c **** )
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 37


1701:Core/Src/FAT/ff.c **** {
1702:Core/Src/FAT/ff.c **** 	DWORD csz, clst;
1703:Core/Src/FAT/ff.c **** 	FATFS *fs = dp->obj.fs;
1704:Core/Src/FAT/ff.c **** 
1705:Core/Src/FAT/ff.c **** 
1706:Core/Src/FAT/ff.c **** 	if (ofs >= (DWORD)((FF_FS_EXFAT && fs->fs_type == FS_EXFAT) ? MAX_DIR_EX : MAX_DIR) || ofs % SZDIR
1707:Core/Src/FAT/ff.c **** 		return FR_INT_ERR;
1708:Core/Src/FAT/ff.c **** 	}
1709:Core/Src/FAT/ff.c **** 	dp->dptr = ofs;				/* Set current offset */
1710:Core/Src/FAT/ff.c **** 	clst = dp->obj.sclust;		/* Table start cluster (0:root) */
1711:Core/Src/FAT/ff.c **** 	if (clst == 0 && fs->fs_type >= FS_FAT32) {	/* Replace cluster# 0 with root cluster# */
1712:Core/Src/FAT/ff.c **** 		clst = (DWORD)fs->dirbase;
1713:Core/Src/FAT/ff.c **** 		if (FF_FS_EXFAT) dp->obj.stat = 0;	/* exFAT: Root dir has an FAT chain */
1714:Core/Src/FAT/ff.c **** 	}
1715:Core/Src/FAT/ff.c **** 
1716:Core/Src/FAT/ff.c **** 	if (clst == 0) {	/* Static table (root-directory on the FAT volume) */
1717:Core/Src/FAT/ff.c **** 		if (ofs / SZDIRE >= fs->n_rootdir) return FR_INT_ERR;	/* Is index out of range? */
1718:Core/Src/FAT/ff.c **** 		dp->sect = fs->dirbase;
1719:Core/Src/FAT/ff.c **** 
1720:Core/Src/FAT/ff.c **** 	} else {			/* Dynamic table (sub-directory or root-directory on the FAT32/exFAT volume) */
1721:Core/Src/FAT/ff.c **** 		csz = (DWORD)fs->csize * SS(fs);	/* Bytes per cluster */
1722:Core/Src/FAT/ff.c **** 		while (ofs >= csz) {				/* Follow cluster chain */
1723:Core/Src/FAT/ff.c **** 			clst = get_fat(&dp->obj, clst);				/* Get next cluster */
1724:Core/Src/FAT/ff.c **** 			if (clst == 0xFFFFFFFF) return FR_DISK_ERR;	/* Disk error */
1725:Core/Src/FAT/ff.c **** 			if (clst < 2 || clst >= fs->n_fatent) return FR_INT_ERR;	/* Reached to end of table or internal 
1726:Core/Src/FAT/ff.c **** 			ofs -= csz;
1727:Core/Src/FAT/ff.c **** 		}
1728:Core/Src/FAT/ff.c **** 		dp->sect = clst2sect(fs, clst);
1729:Core/Src/FAT/ff.c **** 	}
1730:Core/Src/FAT/ff.c **** 	dp->clust = clst;					/* Current cluster# */
1731:Core/Src/FAT/ff.c **** 	if (dp->sect == 0) return FR_INT_ERR;
1732:Core/Src/FAT/ff.c **** 	dp->sect += ofs / SS(fs);			/* Sector# of the directory entry */
1733:Core/Src/FAT/ff.c **** 	dp->dir = fs->win + (ofs % SS(fs));	/* Pointer to the entry in the win[] */
1734:Core/Src/FAT/ff.c **** 
1735:Core/Src/FAT/ff.c **** 	return FR_OK;
1736:Core/Src/FAT/ff.c **** }
1737:Core/Src/FAT/ff.c **** 
1738:Core/Src/FAT/ff.c **** 
1739:Core/Src/FAT/ff.c **** 
1740:Core/Src/FAT/ff.c **** 
1741:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
1742:Core/Src/FAT/ff.c **** /* Directory handling - Move directory table index next                  */
1743:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
1744:Core/Src/FAT/ff.c **** 
1745:Core/Src/FAT/ff.c **** static FRESULT dir_next (	/* FR_OK(0):succeeded, FR_NO_FILE:End of table, FR_DENIED:Could not stret
1746:Core/Src/FAT/ff.c **** 	DIR* dp,				/* Pointer to the directory object */
1747:Core/Src/FAT/ff.c **** 	int stretch				/* 0: Do not stretch table, 1: Stretch table if needed */
1748:Core/Src/FAT/ff.c **** )
1749:Core/Src/FAT/ff.c **** {
1750:Core/Src/FAT/ff.c **** 	DWORD ofs, clst;
1751:Core/Src/FAT/ff.c **** 	FATFS *fs = dp->obj.fs;
1752:Core/Src/FAT/ff.c **** 
1753:Core/Src/FAT/ff.c **** 
1754:Core/Src/FAT/ff.c **** 	ofs = dp->dptr + SZDIRE;	/* Next entry */
1755:Core/Src/FAT/ff.c **** 	if (ofs >= (DWORD)((FF_FS_EXFAT && fs->fs_type == FS_EXFAT) ? MAX_DIR_EX : MAX_DIR)) dp->sect = 0;
1756:Core/Src/FAT/ff.c **** 	if (dp->sect == 0) return FR_NO_FILE;	/* Report EOT if it has been disabled */
1757:Core/Src/FAT/ff.c **** 
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 38


1758:Core/Src/FAT/ff.c **** 	if (ofs % SS(fs) == 0) {	/* Sector changed? */
1759:Core/Src/FAT/ff.c **** 		dp->sect++;				/* Next sector */
1760:Core/Src/FAT/ff.c **** 
1761:Core/Src/FAT/ff.c **** 		if (dp->clust == 0) {	/* Static table */
1762:Core/Src/FAT/ff.c **** 			if (ofs / SZDIRE >= fs->n_rootdir) {	/* Report EOT if it reached end of static table */
1763:Core/Src/FAT/ff.c **** 				dp->sect = 0; return FR_NO_FILE;
1764:Core/Src/FAT/ff.c **** 			}
1765:Core/Src/FAT/ff.c **** 		}
1766:Core/Src/FAT/ff.c **** 		else {					/* Dynamic table */
1767:Core/Src/FAT/ff.c **** 			if ((ofs / SS(fs) & (fs->csize - 1)) == 0) {	/* Cluster changed? */
1768:Core/Src/FAT/ff.c **** 				clst = get_fat(&dp->obj, dp->clust);		/* Get next cluster */
1769:Core/Src/FAT/ff.c **** 				if (clst <= 1) return FR_INT_ERR;			/* Internal error */
1770:Core/Src/FAT/ff.c **** 				if (clst == 0xFFFFFFFF) return FR_DISK_ERR;	/* Disk error */
1771:Core/Src/FAT/ff.c **** 				if (clst >= fs->n_fatent) {					/* It reached end of dynamic table */
1772:Core/Src/FAT/ff.c **** #if !FF_FS_READONLY
1773:Core/Src/FAT/ff.c **** 					if (!stretch) {								/* If no stretch, report EOT */
1774:Core/Src/FAT/ff.c **** 						dp->sect = 0; return FR_NO_FILE;
1775:Core/Src/FAT/ff.c **** 					}
1776:Core/Src/FAT/ff.c **** 					clst = create_chain(&dp->obj, dp->clust);	/* Allocate a cluster */
1777:Core/Src/FAT/ff.c **** 					if (clst == 0) return FR_DENIED;			/* No free cluster */
1778:Core/Src/FAT/ff.c **** 					if (clst == 1) return FR_INT_ERR;			/* Internal error */
1779:Core/Src/FAT/ff.c **** 					if (clst == 0xFFFFFFFF) return FR_DISK_ERR;	/* Disk error */
1780:Core/Src/FAT/ff.c **** 					if (dir_clear(fs, clst) != FR_OK) return FR_DISK_ERR;	/* Clean up the stretched table */
1781:Core/Src/FAT/ff.c **** 					if (FF_FS_EXFAT) dp->obj.stat |= 4;			/* exFAT: The directory has been stretched */
1782:Core/Src/FAT/ff.c **** #else
1783:Core/Src/FAT/ff.c **** 					if (!stretch) dp->sect = 0;					/* (this line is to suppress compiler warning) */
1784:Core/Src/FAT/ff.c **** 					dp->sect = 0; return FR_NO_FILE;			/* Report EOT */
1785:Core/Src/FAT/ff.c **** #endif
1786:Core/Src/FAT/ff.c **** 				}
1787:Core/Src/FAT/ff.c **** 				dp->clust = clst;		/* Initialize data for new cluster */
1788:Core/Src/FAT/ff.c **** 				dp->sect = clst2sect(fs, clst);
1789:Core/Src/FAT/ff.c **** 			}
1790:Core/Src/FAT/ff.c **** 		}
1791:Core/Src/FAT/ff.c **** 	}
1792:Core/Src/FAT/ff.c **** 	dp->dptr = ofs;						/* Current entry */
1793:Core/Src/FAT/ff.c **** 	dp->dir = fs->win + ofs % SS(fs);	/* Pointer to the entry in the win[] */
1794:Core/Src/FAT/ff.c **** 
1795:Core/Src/FAT/ff.c **** 	return FR_OK;
1796:Core/Src/FAT/ff.c **** }
1797:Core/Src/FAT/ff.c **** 
1798:Core/Src/FAT/ff.c **** 
1799:Core/Src/FAT/ff.c **** 
1800:Core/Src/FAT/ff.c **** 
1801:Core/Src/FAT/ff.c **** #if !FF_FS_READONLY
1802:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
1803:Core/Src/FAT/ff.c **** /* Directory handling - Reserve a block of directory entries             */
1804:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
1805:Core/Src/FAT/ff.c **** 
1806:Core/Src/FAT/ff.c **** static FRESULT dir_alloc (	/* FR_OK(0):succeeded, !=0:error */
1807:Core/Src/FAT/ff.c **** 	DIR* dp,				/* Pointer to the directory object */
1808:Core/Src/FAT/ff.c **** 	UINT n_ent				/* Number of contiguous entries to allocate */
1809:Core/Src/FAT/ff.c **** )
1810:Core/Src/FAT/ff.c **** {
1811:Core/Src/FAT/ff.c **** 	FRESULT res;
1812:Core/Src/FAT/ff.c **** 	UINT n;
1813:Core/Src/FAT/ff.c **** 	FATFS *fs = dp->obj.fs;
1814:Core/Src/FAT/ff.c **** 
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 39


1815:Core/Src/FAT/ff.c **** 
1816:Core/Src/FAT/ff.c **** 	res = dir_sdi(dp, 0);
1817:Core/Src/FAT/ff.c **** 	if (res == FR_OK) {
1818:Core/Src/FAT/ff.c **** 		n = 0;
1819:Core/Src/FAT/ff.c **** 		do {
1820:Core/Src/FAT/ff.c **** 			res = move_window(fs, dp->sect);
1821:Core/Src/FAT/ff.c **** 			if (res != FR_OK) break;
1822:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT
1823:Core/Src/FAT/ff.c **** 			if ((fs->fs_type == FS_EXFAT) ? (int)((dp->dir[XDIR_Type] & 0x80) == 0) : (int)(dp->dir[DIR_Name
1824:Core/Src/FAT/ff.c **** #else
1825:Core/Src/FAT/ff.c **** 			if (dp->dir[DIR_Name] == DDEM || dp->dir[DIR_Name] == 0) {	/* Is the entry free? */
1826:Core/Src/FAT/ff.c **** #endif
1827:Core/Src/FAT/ff.c **** 				if (++n == n_ent) break;	/* Is a block of contiguous free entries found? */
1828:Core/Src/FAT/ff.c **** 			} else {
1829:Core/Src/FAT/ff.c **** 				n = 0;				/* Not a free entry, restart to search */
1830:Core/Src/FAT/ff.c **** 			}
1831:Core/Src/FAT/ff.c **** 			res = dir_next(dp, 1);	/* Next entry with table stretch enabled */
1832:Core/Src/FAT/ff.c **** 		} while (res == FR_OK);
1833:Core/Src/FAT/ff.c **** 	}
1834:Core/Src/FAT/ff.c **** 
1835:Core/Src/FAT/ff.c **** 	if (res == FR_NO_FILE) res = FR_DENIED;	/* No directory entry to allocate */
1836:Core/Src/FAT/ff.c **** 	return res;
1837:Core/Src/FAT/ff.c **** }
1838:Core/Src/FAT/ff.c **** 
1839:Core/Src/FAT/ff.c **** #endif	/* !FF_FS_READONLY */
1840:Core/Src/FAT/ff.c **** 
1841:Core/Src/FAT/ff.c **** 
1842:Core/Src/FAT/ff.c **** 
1843:Core/Src/FAT/ff.c **** 
1844:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
1845:Core/Src/FAT/ff.c **** /* FAT: Directory handling - Load/Store start cluster number             */
1846:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
1847:Core/Src/FAT/ff.c **** 
1848:Core/Src/FAT/ff.c **** static DWORD ld_clust (	/* Returns the top cluster value of the SFN entry */
1849:Core/Src/FAT/ff.c **** 	FATFS* fs,			/* Pointer to the fs object */
1850:Core/Src/FAT/ff.c **** 	const BYTE* dir		/* Pointer to the key entry */
1851:Core/Src/FAT/ff.c **** )
1852:Core/Src/FAT/ff.c **** {
 358              		.loc 1 1852 1 is_stmt 1 view -0
 359              		.cfi_startproc
 360              		@ args = 0, pretend = 0, frame = 0
 361              		@ frame_needed = 0, uses_anonymous_args = 0
 362              		.loc 1 1852 1 is_stmt 0 view .LVU100
 363 0000 70B5     		push	{r4, r5, r6, lr}
 364              	.LCFI0:
 365              		.cfi_def_cfa_offset 16
 366              		.cfi_offset 4, -16
 367              		.cfi_offset 5, -12
 368              		.cfi_offset 6, -8
 369              		.cfi_offset 14, -4
 370 0002 0646     		mov	r6, r0
 371 0004 0D46     		mov	r5, r1
1853:Core/Src/FAT/ff.c **** 	DWORD cl;
 372              		.loc 1 1853 2 is_stmt 1 view .LVU101
1854:Core/Src/FAT/ff.c **** 
1855:Core/Src/FAT/ff.c **** 	cl = ld_word(dir + DIR_FstClusLO);
 373              		.loc 1 1855 2 view .LVU102
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 40


 374              		.loc 1 1855 7 is_stmt 0 view .LVU103
 375 0006 01F11A00 		add	r0, r1, #26
 376              	.LVL44:
 377              		.loc 1 1855 7 view .LVU104
 378 000a FFF7FEFF 		bl	ld_word
 379              	.LVL45:
1856:Core/Src/FAT/ff.c **** 	if (fs->fs_type == FS_FAT32) {
 380              		.loc 1 1856 2 is_stmt 1 view .LVU105
 381              		.loc 1 1856 8 is_stmt 0 view .LVU106
 382 000e 3378     		ldrb	r3, [r6]	@ zero_extendqisi2
 383              		.loc 1 1856 5 view .LVU107
 384 0010 032B     		cmp	r3, #3
 385 0012 00D0     		beq	.L25
 386              	.LVL46:
 387              	.L22:
1857:Core/Src/FAT/ff.c **** 		cl |= (DWORD)ld_word(dir + DIR_FstClusHI) << 16;
1858:Core/Src/FAT/ff.c **** 	}
1859:Core/Src/FAT/ff.c **** 
1860:Core/Src/FAT/ff.c **** 	return cl;
1861:Core/Src/FAT/ff.c **** }
 388              		.loc 1 1861 1 view .LVU108
 389 0014 70BD     		pop	{r4, r5, r6, pc}
 390              	.LVL47:
 391              	.L25:
 392              		.loc 1 1861 1 view .LVU109
 393 0016 0446     		mov	r4, r0
1857:Core/Src/FAT/ff.c **** 		cl |= (DWORD)ld_word(dir + DIR_FstClusHI) << 16;
 394              		.loc 1 1857 3 is_stmt 1 view .LVU110
1857:Core/Src/FAT/ff.c **** 		cl |= (DWORD)ld_word(dir + DIR_FstClusHI) << 16;
 395              		.loc 1 1857 16 is_stmt 0 view .LVU111
 396 0018 05F11400 		add	r0, r5, #20
 397              	.LVL48:
1857:Core/Src/FAT/ff.c **** 		cl |= (DWORD)ld_word(dir + DIR_FstClusHI) << 16;
 398              		.loc 1 1857 16 view .LVU112
 399 001c FFF7FEFF 		bl	ld_word
 400              	.LVL49:
1857:Core/Src/FAT/ff.c **** 		cl |= (DWORD)ld_word(dir + DIR_FstClusHI) << 16;
 401              		.loc 1 1857 6 view .LVU113
 402 0020 44EA0040 		orr	r0, r4, r0, lsl #16
 403              	.LVL50:
1860:Core/Src/FAT/ff.c **** }
 404              		.loc 1 1860 2 is_stmt 1 view .LVU114
1860:Core/Src/FAT/ff.c **** }
 405              		.loc 1 1860 9 is_stmt 0 view .LVU115
 406 0024 F6E7     		b	.L22
 407              		.cfi_endproc
 408              	.LFE18:
 410              		.section	.text.st_clust,"ax",%progbits
 411              		.align	1
 412              		.syntax unified
 413              		.thumb
 414              		.thumb_func
 416              	st_clust:
 417              	.LVL51:
 418              	.LFB19:
1862:Core/Src/FAT/ff.c **** 
1863:Core/Src/FAT/ff.c **** 
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 41


1864:Core/Src/FAT/ff.c **** #if !FF_FS_READONLY
1865:Core/Src/FAT/ff.c **** static void st_clust (
1866:Core/Src/FAT/ff.c **** 	FATFS* fs,	/* Pointer to the fs object */
1867:Core/Src/FAT/ff.c **** 	BYTE* dir,	/* Pointer to the key entry */
1868:Core/Src/FAT/ff.c **** 	DWORD cl	/* Value to be set */
1869:Core/Src/FAT/ff.c **** )
1870:Core/Src/FAT/ff.c **** {
 419              		.loc 1 1870 1 is_stmt 1 view -0
 420              		.cfi_startproc
 421              		@ args = 0, pretend = 0, frame = 0
 422              		@ frame_needed = 0, uses_anonymous_args = 0
 423              		.loc 1 1870 1 is_stmt 0 view .LVU117
 424 0000 70B5     		push	{r4, r5, r6, lr}
 425              	.LCFI1:
 426              		.cfi_def_cfa_offset 16
 427              		.cfi_offset 4, -16
 428              		.cfi_offset 5, -12
 429              		.cfi_offset 6, -8
 430              		.cfi_offset 14, -4
 431 0002 0646     		mov	r6, r0
 432 0004 0C46     		mov	r4, r1
 433 0006 1546     		mov	r5, r2
1871:Core/Src/FAT/ff.c **** 	st_word(dir + DIR_FstClusLO, (WORD)cl);
 434              		.loc 1 1871 2 is_stmt 1 view .LVU118
 435 0008 91B2     		uxth	r1, r2
 436              	.LVL52:
 437              		.loc 1 1871 2 is_stmt 0 view .LVU119
 438 000a 04F11A00 		add	r0, r4, #26
 439              	.LVL53:
 440              		.loc 1 1871 2 view .LVU120
 441 000e FFF7FEFF 		bl	st_word
 442              	.LVL54:
1872:Core/Src/FAT/ff.c **** 	if (fs->fs_type == FS_FAT32) {
 443              		.loc 1 1872 2 is_stmt 1 view .LVU121
 444              		.loc 1 1872 8 is_stmt 0 view .LVU122
 445 0012 3378     		ldrb	r3, [r6]	@ zero_extendqisi2
 446              		.loc 1 1872 5 view .LVU123
 447 0014 032B     		cmp	r3, #3
 448 0016 00D0     		beq	.L29
 449              	.L26:
1873:Core/Src/FAT/ff.c **** 		st_word(dir + DIR_FstClusHI, (WORD)(cl >> 16));
1874:Core/Src/FAT/ff.c **** 	}
1875:Core/Src/FAT/ff.c **** }
 450              		.loc 1 1875 1 view .LVU124
 451 0018 70BD     		pop	{r4, r5, r6, pc}
 452              	.LVL55:
 453              	.L29:
1873:Core/Src/FAT/ff.c **** 		st_word(dir + DIR_FstClusHI, (WORD)(cl >> 16));
 454              		.loc 1 1873 3 is_stmt 1 view .LVU125
 455 001a 290C     		lsrs	r1, r5, #16
 456 001c 04F11400 		add	r0, r4, #20
 457 0020 FFF7FEFF 		bl	st_word
 458              	.LVL56:
 459              		.loc 1 1875 1 is_stmt 0 view .LVU126
 460 0024 F8E7     		b	.L26
 461              		.cfi_endproc
 462              	.LFE19:
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 42


 464              		.section	.text.get_fileinfo,"ax",%progbits
 465              		.align	1
 466              		.syntax unified
 467              		.thumb
 468              		.thumb_func
 470              	get_fileinfo:
 471              	.LVL57:
 472              	.LFB24:
1876:Core/Src/FAT/ff.c **** #endif
1877:Core/Src/FAT/ff.c **** 
1878:Core/Src/FAT/ff.c **** 
1879:Core/Src/FAT/ff.c **** 
1880:Core/Src/FAT/ff.c **** #if FF_USE_LFN
1881:Core/Src/FAT/ff.c **** /*--------------------------------------------------------*/
1882:Core/Src/FAT/ff.c **** /* FAT-LFN: Compare a part of file name with an LFN entry */
1883:Core/Src/FAT/ff.c **** /*--------------------------------------------------------*/
1884:Core/Src/FAT/ff.c **** 
1885:Core/Src/FAT/ff.c **** static int cmp_lfn (		/* 1:matched, 0:not matched */
1886:Core/Src/FAT/ff.c **** 	const WCHAR* lfnbuf,	/* Pointer to the LFN working buffer to be compared */
1887:Core/Src/FAT/ff.c **** 	BYTE* dir				/* Pointer to the directory entry containing the part of LFN */
1888:Core/Src/FAT/ff.c **** )
1889:Core/Src/FAT/ff.c **** {
1890:Core/Src/FAT/ff.c **** 	UINT i, s;
1891:Core/Src/FAT/ff.c **** 	WCHAR wc, uc;
1892:Core/Src/FAT/ff.c **** 
1893:Core/Src/FAT/ff.c **** 
1894:Core/Src/FAT/ff.c **** 	if (ld_word(dir + LDIR_FstClusLO) != 0) return 0;	/* Check LDIR_FstClusLO */
1895:Core/Src/FAT/ff.c **** 
1896:Core/Src/FAT/ff.c **** 	i = ((dir[LDIR_Ord] & 0x3F) - 1) * 13;	/* Offset in the LFN buffer */
1897:Core/Src/FAT/ff.c **** 
1898:Core/Src/FAT/ff.c **** 	for (wc = 1, s = 0; s < 13; s++) {		/* Process all characters in the entry */
1899:Core/Src/FAT/ff.c **** 		uc = ld_word(dir + LfnOfs[s]);		/* Pick an LFN character */
1900:Core/Src/FAT/ff.c **** 		if (wc != 0) {
1901:Core/Src/FAT/ff.c **** 			if (i >= FF_MAX_LFN + 1 || ff_wtoupper(uc) != ff_wtoupper(lfnbuf[i++])) {	/* Compare it */
1902:Core/Src/FAT/ff.c **** 				return 0;					/* Not matched */
1903:Core/Src/FAT/ff.c **** 			}
1904:Core/Src/FAT/ff.c **** 			wc = uc;
1905:Core/Src/FAT/ff.c **** 		} else {
1906:Core/Src/FAT/ff.c **** 			if (uc != 0xFFFF) return 0;		/* Check filler */
1907:Core/Src/FAT/ff.c **** 		}
1908:Core/Src/FAT/ff.c **** 	}
1909:Core/Src/FAT/ff.c **** 
1910:Core/Src/FAT/ff.c **** 	if ((dir[LDIR_Ord] & LLEF) && wc && lfnbuf[i]) return 0;	/* Last segment matched but different len
1911:Core/Src/FAT/ff.c **** 
1912:Core/Src/FAT/ff.c **** 	return 1;		/* The part of LFN matched */
1913:Core/Src/FAT/ff.c **** }
1914:Core/Src/FAT/ff.c **** 
1915:Core/Src/FAT/ff.c **** 
1916:Core/Src/FAT/ff.c **** #if FF_FS_MINIMIZE <= 1 || FF_FS_RPATH >= 2 || FF_USE_LABEL || FF_FS_EXFAT
1917:Core/Src/FAT/ff.c **** /*-----------------------------------------------------*/
1918:Core/Src/FAT/ff.c **** /* FAT-LFN: Pick a part of file name from an LFN entry */
1919:Core/Src/FAT/ff.c **** /*-----------------------------------------------------*/
1920:Core/Src/FAT/ff.c **** 
1921:Core/Src/FAT/ff.c **** static int pick_lfn (	/* 1:succeeded, 0:buffer overflow or invalid LFN entry */
1922:Core/Src/FAT/ff.c **** 	WCHAR* lfnbuf,		/* Pointer to the LFN working buffer */
1923:Core/Src/FAT/ff.c **** 	BYTE* dir			/* Pointer to the LFN entry */
1924:Core/Src/FAT/ff.c **** )
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 43


1925:Core/Src/FAT/ff.c **** {
1926:Core/Src/FAT/ff.c **** 	UINT i, s;
1927:Core/Src/FAT/ff.c **** 	WCHAR wc, uc;
1928:Core/Src/FAT/ff.c **** 
1929:Core/Src/FAT/ff.c **** 
1930:Core/Src/FAT/ff.c **** 	if (ld_word(dir + LDIR_FstClusLO) != 0) return 0;	/* Check LDIR_FstClusLO is 0 */
1931:Core/Src/FAT/ff.c **** 
1932:Core/Src/FAT/ff.c **** 	i = ((dir[LDIR_Ord] & ~LLEF) - 1) * 13;	/* Offset in the LFN buffer */
1933:Core/Src/FAT/ff.c **** 
1934:Core/Src/FAT/ff.c **** 	for (wc = 1, s = 0; s < 13; s++) {		/* Process all characters in the entry */
1935:Core/Src/FAT/ff.c **** 		uc = ld_word(dir + LfnOfs[s]);		/* Pick an LFN character */
1936:Core/Src/FAT/ff.c **** 		if (wc != 0) {
1937:Core/Src/FAT/ff.c **** 			if (i >= FF_MAX_LFN + 1) return 0;	/* Buffer overflow? */
1938:Core/Src/FAT/ff.c **** 			lfnbuf[i++] = wc = uc;			/* Store it */
1939:Core/Src/FAT/ff.c **** 		} else {
1940:Core/Src/FAT/ff.c **** 			if (uc != 0xFFFF) return 0;		/* Check filler */
1941:Core/Src/FAT/ff.c **** 		}
1942:Core/Src/FAT/ff.c **** 	}
1943:Core/Src/FAT/ff.c **** 
1944:Core/Src/FAT/ff.c **** 	if (dir[LDIR_Ord] & LLEF && wc != 0) {	/* Put terminator if it is the last LFN part and not termin
1945:Core/Src/FAT/ff.c **** 		if (i >= FF_MAX_LFN + 1) return 0;	/* Buffer overflow? */
1946:Core/Src/FAT/ff.c **** 		lfnbuf[i] = 0;
1947:Core/Src/FAT/ff.c **** 	}
1948:Core/Src/FAT/ff.c **** 
1949:Core/Src/FAT/ff.c **** 	return 1;		/* The part of LFN is valid */
1950:Core/Src/FAT/ff.c **** }
1951:Core/Src/FAT/ff.c **** #endif
1952:Core/Src/FAT/ff.c **** 
1953:Core/Src/FAT/ff.c **** 
1954:Core/Src/FAT/ff.c **** #if !FF_FS_READONLY
1955:Core/Src/FAT/ff.c **** /*-----------------------------------------*/
1956:Core/Src/FAT/ff.c **** /* FAT-LFN: Create an entry of LFN entries */
1957:Core/Src/FAT/ff.c **** /*-----------------------------------------*/
1958:Core/Src/FAT/ff.c **** 
1959:Core/Src/FAT/ff.c **** static void put_lfn (
1960:Core/Src/FAT/ff.c **** 	const WCHAR* lfn,	/* Pointer to the LFN */
1961:Core/Src/FAT/ff.c **** 	BYTE* dir,			/* Pointer to the LFN entry to be created */
1962:Core/Src/FAT/ff.c **** 	BYTE ord,			/* LFN order (1-20) */
1963:Core/Src/FAT/ff.c **** 	BYTE sum			/* Checksum of the corresponding SFN */
1964:Core/Src/FAT/ff.c **** )
1965:Core/Src/FAT/ff.c **** {
1966:Core/Src/FAT/ff.c **** 	UINT i, s;
1967:Core/Src/FAT/ff.c **** 	WCHAR wc;
1968:Core/Src/FAT/ff.c **** 
1969:Core/Src/FAT/ff.c **** 
1970:Core/Src/FAT/ff.c **** 	dir[LDIR_Chksum] = sum;			/* Set checksum */
1971:Core/Src/FAT/ff.c **** 	dir[LDIR_Attr] = AM_LFN;		/* Set attribute. LFN entry */
1972:Core/Src/FAT/ff.c **** 	dir[LDIR_Type] = 0;
1973:Core/Src/FAT/ff.c **** 	st_word(dir + LDIR_FstClusLO, 0);
1974:Core/Src/FAT/ff.c **** 
1975:Core/Src/FAT/ff.c **** 	i = (ord - 1) * 13;				/* Get offset in the LFN working buffer */
1976:Core/Src/FAT/ff.c **** 	s = wc = 0;
1977:Core/Src/FAT/ff.c **** 	do {
1978:Core/Src/FAT/ff.c **** 		if (wc != 0xFFFF) wc = lfn[i++];	/* Get an effective character */
1979:Core/Src/FAT/ff.c **** 		st_word(dir + LfnOfs[s], wc);		/* Put it */
1980:Core/Src/FAT/ff.c **** 		if (wc == 0) wc = 0xFFFF;			/* Padding characters for following items */
1981:Core/Src/FAT/ff.c **** 	} while (++s < 13);
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 44


1982:Core/Src/FAT/ff.c **** 	if (wc == 0xFFFF || !lfn[i]) ord |= LLEF;	/* Last LFN part is the start of LFN sequence */
1983:Core/Src/FAT/ff.c **** 	dir[LDIR_Ord] = ord;			/* Set the LFN order */
1984:Core/Src/FAT/ff.c **** }
1985:Core/Src/FAT/ff.c **** 
1986:Core/Src/FAT/ff.c **** #endif	/* !FF_FS_READONLY */
1987:Core/Src/FAT/ff.c **** #endif	/* FF_USE_LFN */
1988:Core/Src/FAT/ff.c **** 
1989:Core/Src/FAT/ff.c **** 
1990:Core/Src/FAT/ff.c **** 
1991:Core/Src/FAT/ff.c **** #if FF_USE_LFN && !FF_FS_READONLY
1992:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
1993:Core/Src/FAT/ff.c **** /* FAT-LFN: Create a Numbered SFN                                        */
1994:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
1995:Core/Src/FAT/ff.c **** 
1996:Core/Src/FAT/ff.c **** static void gen_numname (
1997:Core/Src/FAT/ff.c **** 	BYTE* dst,			/* Pointer to the buffer to store numbered SFN */
1998:Core/Src/FAT/ff.c **** 	const BYTE* src,	/* Pointer to SFN in directory form */
1999:Core/Src/FAT/ff.c **** 	const WCHAR* lfn,	/* Pointer to LFN */
2000:Core/Src/FAT/ff.c **** 	UINT seq			/* Sequence number */
2001:Core/Src/FAT/ff.c **** )
2002:Core/Src/FAT/ff.c **** {
2003:Core/Src/FAT/ff.c **** 	BYTE ns[8], c;
2004:Core/Src/FAT/ff.c **** 	UINT i, j;
2005:Core/Src/FAT/ff.c **** 	WCHAR wc;
2006:Core/Src/FAT/ff.c **** 	DWORD sreg;
2007:Core/Src/FAT/ff.c **** 
2008:Core/Src/FAT/ff.c **** 
2009:Core/Src/FAT/ff.c **** 	memcpy(dst, src, 11);	/* Prepare the SFN to be modified */
2010:Core/Src/FAT/ff.c **** 
2011:Core/Src/FAT/ff.c **** 	if (seq > 5) {	/* In case of many collisions, generate a hash number instead of sequential number 
2012:Core/Src/FAT/ff.c **** 		sreg = seq;
2013:Core/Src/FAT/ff.c **** 		while (*lfn) {	/* Create a CRC as hash value */
2014:Core/Src/FAT/ff.c **** 			wc = *lfn++;
2015:Core/Src/FAT/ff.c **** 			for (i = 0; i < 16; i++) {
2016:Core/Src/FAT/ff.c **** 				sreg = (sreg << 1) + (wc & 1);
2017:Core/Src/FAT/ff.c **** 				wc >>= 1;
2018:Core/Src/FAT/ff.c **** 				if (sreg & 0x10000) sreg ^= 0x11021;
2019:Core/Src/FAT/ff.c **** 			}
2020:Core/Src/FAT/ff.c **** 		}
2021:Core/Src/FAT/ff.c **** 		seq = (UINT)sreg;
2022:Core/Src/FAT/ff.c **** 	}
2023:Core/Src/FAT/ff.c **** 
2024:Core/Src/FAT/ff.c **** 	/* Make suffix (~ + hexadecimal) */
2025:Core/Src/FAT/ff.c **** 	i = 7;
2026:Core/Src/FAT/ff.c **** 	do {
2027:Core/Src/FAT/ff.c **** 		c = (BYTE)((seq % 16) + '0'); seq /= 16;
2028:Core/Src/FAT/ff.c **** 		if (c > '9') c += 7;
2029:Core/Src/FAT/ff.c **** 		ns[i--] = c;
2030:Core/Src/FAT/ff.c **** 	} while (i && seq);
2031:Core/Src/FAT/ff.c **** 	ns[i] = '~';
2032:Core/Src/FAT/ff.c **** 
2033:Core/Src/FAT/ff.c **** 	/* Append the suffix to the SFN body */
2034:Core/Src/FAT/ff.c **** 	for (j = 0; j < i && dst[j] != ' '; j++) {	/* Find the offset to append */
2035:Core/Src/FAT/ff.c **** 		if (dbc_1st(dst[j])) {	/* To avoid DBC break up */
2036:Core/Src/FAT/ff.c **** 			if (j == i - 1) break;
2037:Core/Src/FAT/ff.c **** 			j++;
2038:Core/Src/FAT/ff.c **** 		}
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 45


2039:Core/Src/FAT/ff.c **** 	}
2040:Core/Src/FAT/ff.c **** 	do {	/* Append the suffix */
2041:Core/Src/FAT/ff.c **** 		dst[j++] = (i < 8) ? ns[i++] : ' ';
2042:Core/Src/FAT/ff.c **** 	} while (j < 8);
2043:Core/Src/FAT/ff.c **** }
2044:Core/Src/FAT/ff.c **** #endif	/* FF_USE_LFN && !FF_FS_READONLY */
2045:Core/Src/FAT/ff.c **** 
2046:Core/Src/FAT/ff.c **** 
2047:Core/Src/FAT/ff.c **** 
2048:Core/Src/FAT/ff.c **** #if FF_USE_LFN
2049:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
2050:Core/Src/FAT/ff.c **** /* FAT-LFN: Calculate checksum of an SFN entry                           */
2051:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
2052:Core/Src/FAT/ff.c **** 
2053:Core/Src/FAT/ff.c **** static BYTE sum_sfn (
2054:Core/Src/FAT/ff.c **** 	const BYTE* dir		/* Pointer to the SFN entry */
2055:Core/Src/FAT/ff.c **** )
2056:Core/Src/FAT/ff.c **** {
2057:Core/Src/FAT/ff.c **** 	BYTE sum = 0;
2058:Core/Src/FAT/ff.c **** 	UINT n = 11;
2059:Core/Src/FAT/ff.c **** 
2060:Core/Src/FAT/ff.c **** 	do {
2061:Core/Src/FAT/ff.c **** 		sum = (sum >> 1) + (sum << 7) + *dir++;
2062:Core/Src/FAT/ff.c **** 	} while (--n);
2063:Core/Src/FAT/ff.c **** 	return sum;
2064:Core/Src/FAT/ff.c **** }
2065:Core/Src/FAT/ff.c **** 
2066:Core/Src/FAT/ff.c **** #endif	/* FF_USE_LFN */
2067:Core/Src/FAT/ff.c **** 
2068:Core/Src/FAT/ff.c **** 
2069:Core/Src/FAT/ff.c **** 
2070:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT
2071:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
2072:Core/Src/FAT/ff.c **** /* exFAT: Checksum                                                       */
2073:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
2074:Core/Src/FAT/ff.c **** 
2075:Core/Src/FAT/ff.c **** static WORD xdir_sum (	/* Get checksum of the directoly entry block */
2076:Core/Src/FAT/ff.c **** 	const BYTE* dir		/* Directory entry block to be calculated */
2077:Core/Src/FAT/ff.c **** )
2078:Core/Src/FAT/ff.c **** {
2079:Core/Src/FAT/ff.c **** 	UINT i, szblk;
2080:Core/Src/FAT/ff.c **** 	WORD sum;
2081:Core/Src/FAT/ff.c **** 
2082:Core/Src/FAT/ff.c **** 
2083:Core/Src/FAT/ff.c **** 	szblk = (dir[XDIR_NumSec] + 1) * SZDIRE;	/* Number of bytes of the entry block */
2084:Core/Src/FAT/ff.c **** 	for (i = sum = 0; i < szblk; i++) {
2085:Core/Src/FAT/ff.c **** 		if (i == XDIR_SetSum) {	/* Skip 2-byte sum field */
2086:Core/Src/FAT/ff.c **** 			i++;
2087:Core/Src/FAT/ff.c **** 		} else {
2088:Core/Src/FAT/ff.c **** 			sum = ((sum & 1) ? 0x8000 : 0) + (sum >> 1) + dir[i];
2089:Core/Src/FAT/ff.c **** 		}
2090:Core/Src/FAT/ff.c **** 	}
2091:Core/Src/FAT/ff.c **** 	return sum;
2092:Core/Src/FAT/ff.c **** }
2093:Core/Src/FAT/ff.c **** 
2094:Core/Src/FAT/ff.c **** 
2095:Core/Src/FAT/ff.c **** 
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 46


2096:Core/Src/FAT/ff.c **** static WORD xname_sum (	/* Get check sum (to be used as hash) of the file name */
2097:Core/Src/FAT/ff.c **** 	const WCHAR* name	/* File name to be calculated */
2098:Core/Src/FAT/ff.c **** )
2099:Core/Src/FAT/ff.c **** {
2100:Core/Src/FAT/ff.c **** 	WCHAR chr;
2101:Core/Src/FAT/ff.c **** 	WORD sum = 0;
2102:Core/Src/FAT/ff.c **** 
2103:Core/Src/FAT/ff.c **** 
2104:Core/Src/FAT/ff.c **** 	while ((chr = *name++) != 0) {
2105:Core/Src/FAT/ff.c **** 		chr = (WCHAR)ff_wtoupper(chr);		/* File name needs to be up-case converted */
2106:Core/Src/FAT/ff.c **** 		sum = ((sum & 1) ? 0x8000 : 0) + (sum >> 1) + (chr & 0xFF);
2107:Core/Src/FAT/ff.c **** 		sum = ((sum & 1) ? 0x8000 : 0) + (sum >> 1) + (chr >> 8);
2108:Core/Src/FAT/ff.c **** 	}
2109:Core/Src/FAT/ff.c **** 	return sum;
2110:Core/Src/FAT/ff.c **** }
2111:Core/Src/FAT/ff.c **** 
2112:Core/Src/FAT/ff.c **** 
2113:Core/Src/FAT/ff.c **** #if !FF_FS_READONLY && FF_USE_MKFS
2114:Core/Src/FAT/ff.c **** static DWORD xsum32 (	/* Returns 32-bit checksum */
2115:Core/Src/FAT/ff.c **** 	BYTE  dat,			/* Byte to be calculated (byte-by-byte processing) */
2116:Core/Src/FAT/ff.c **** 	DWORD sum			/* Previous sum value */
2117:Core/Src/FAT/ff.c **** )
2118:Core/Src/FAT/ff.c **** {
2119:Core/Src/FAT/ff.c **** 	sum = ((sum & 1) ? 0x80000000 : 0) + (sum >> 1) + dat;
2120:Core/Src/FAT/ff.c **** 	return sum;
2121:Core/Src/FAT/ff.c **** }
2122:Core/Src/FAT/ff.c **** #endif
2123:Core/Src/FAT/ff.c **** 
2124:Core/Src/FAT/ff.c **** 
2125:Core/Src/FAT/ff.c **** 
2126:Core/Src/FAT/ff.c **** /*------------------------------------*/
2127:Core/Src/FAT/ff.c **** /* exFAT: Get a directory entry block */
2128:Core/Src/FAT/ff.c **** /*------------------------------------*/
2129:Core/Src/FAT/ff.c **** 
2130:Core/Src/FAT/ff.c **** static FRESULT load_xdir (	/* FR_INT_ERR: invalid entry block */
2131:Core/Src/FAT/ff.c **** 	DIR* dp					/* Reading directory object pointing top of the entry block to load */
2132:Core/Src/FAT/ff.c **** )
2133:Core/Src/FAT/ff.c **** {
2134:Core/Src/FAT/ff.c **** 	FRESULT res;
2135:Core/Src/FAT/ff.c **** 	UINT i, sz_ent;
2136:Core/Src/FAT/ff.c **** 	BYTE *dirb = dp->obj.fs->dirbuf;	/* Pointer to the on-memory directory entry block 85+C0+C1s */
2137:Core/Src/FAT/ff.c **** 
2138:Core/Src/FAT/ff.c **** 
2139:Core/Src/FAT/ff.c **** 	/* Load file directory entry */
2140:Core/Src/FAT/ff.c **** 	res = move_window(dp->obj.fs, dp->sect);
2141:Core/Src/FAT/ff.c **** 	if (res != FR_OK) return res;
2142:Core/Src/FAT/ff.c **** 	if (dp->dir[XDIR_Type] != ET_FILEDIR) return FR_INT_ERR;	/* Invalid order */
2143:Core/Src/FAT/ff.c **** 	memcpy(dirb + 0 * SZDIRE, dp->dir, SZDIRE);
2144:Core/Src/FAT/ff.c **** 	sz_ent = (dirb[XDIR_NumSec] + 1) * SZDIRE;
2145:Core/Src/FAT/ff.c **** 	if (sz_ent < 3 * SZDIRE || sz_ent > 19 * SZDIRE) return FR_INT_ERR;
2146:Core/Src/FAT/ff.c **** 
2147:Core/Src/FAT/ff.c **** 	/* Load stream extension entry */
2148:Core/Src/FAT/ff.c **** 	res = dir_next(dp, 0);
2149:Core/Src/FAT/ff.c **** 	if (res == FR_NO_FILE) res = FR_INT_ERR;	/* It cannot be */
2150:Core/Src/FAT/ff.c **** 	if (res != FR_OK) return res;
2151:Core/Src/FAT/ff.c **** 	res = move_window(dp->obj.fs, dp->sect);
2152:Core/Src/FAT/ff.c **** 	if (res != FR_OK) return res;
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 47


2153:Core/Src/FAT/ff.c **** 	if (dp->dir[XDIR_Type] != ET_STREAM) return FR_INT_ERR;	/* Invalid order */
2154:Core/Src/FAT/ff.c **** 	memcpy(dirb + 1 * SZDIRE, dp->dir, SZDIRE);
2155:Core/Src/FAT/ff.c **** 	if (MAXDIRB(dirb[XDIR_NumName]) > sz_ent) return FR_INT_ERR;
2156:Core/Src/FAT/ff.c **** 
2157:Core/Src/FAT/ff.c **** 	/* Load file name entries */
2158:Core/Src/FAT/ff.c **** 	i = 2 * SZDIRE;	/* Name offset to load */
2159:Core/Src/FAT/ff.c **** 	do {
2160:Core/Src/FAT/ff.c **** 		res = dir_next(dp, 0);
2161:Core/Src/FAT/ff.c **** 		if (res == FR_NO_FILE) res = FR_INT_ERR;	/* It cannot be */
2162:Core/Src/FAT/ff.c **** 		if (res != FR_OK) return res;
2163:Core/Src/FAT/ff.c **** 		res = move_window(dp->obj.fs, dp->sect);
2164:Core/Src/FAT/ff.c **** 		if (res != FR_OK) return res;
2165:Core/Src/FAT/ff.c **** 		if (dp->dir[XDIR_Type] != ET_FILENAME) return FR_INT_ERR;	/* Invalid order */
2166:Core/Src/FAT/ff.c **** 		if (i < MAXDIRB(FF_MAX_LFN)) memcpy(dirb + i, dp->dir, SZDIRE);
2167:Core/Src/FAT/ff.c **** 	} while ((i += SZDIRE) < sz_ent);
2168:Core/Src/FAT/ff.c **** 
2169:Core/Src/FAT/ff.c **** 	/* Sanity check (do it for only accessible object) */
2170:Core/Src/FAT/ff.c **** 	if (i <= MAXDIRB(FF_MAX_LFN)) {
2171:Core/Src/FAT/ff.c **** 		if (xdir_sum(dirb) != ld_word(dirb + XDIR_SetSum)) return FR_INT_ERR;
2172:Core/Src/FAT/ff.c **** 	}
2173:Core/Src/FAT/ff.c **** 	return FR_OK;
2174:Core/Src/FAT/ff.c **** }
2175:Core/Src/FAT/ff.c **** 
2176:Core/Src/FAT/ff.c **** 
2177:Core/Src/FAT/ff.c **** /*------------------------------------------------------------------*/
2178:Core/Src/FAT/ff.c **** /* exFAT: Initialize object allocation info with loaded entry block */
2179:Core/Src/FAT/ff.c **** /*------------------------------------------------------------------*/
2180:Core/Src/FAT/ff.c **** 
2181:Core/Src/FAT/ff.c **** static void init_alloc_info (
2182:Core/Src/FAT/ff.c **** 	FATFS* fs,		/* Filesystem object */
2183:Core/Src/FAT/ff.c **** 	FFOBJID* obj	/* Object allocation information to be initialized */
2184:Core/Src/FAT/ff.c **** )
2185:Core/Src/FAT/ff.c **** {
2186:Core/Src/FAT/ff.c **** 	obj->sclust = ld_dword(fs->dirbuf + XDIR_FstClus);		/* Start cluster */
2187:Core/Src/FAT/ff.c **** 	obj->objsize = ld_qword(fs->dirbuf + XDIR_FileSize);	/* Size */
2188:Core/Src/FAT/ff.c **** 	obj->stat = fs->dirbuf[XDIR_GenFlags] & 2;				/* Allocation status */
2189:Core/Src/FAT/ff.c **** 	obj->n_frag = 0;										/* No last fragment info */
2190:Core/Src/FAT/ff.c **** }
2191:Core/Src/FAT/ff.c **** 
2192:Core/Src/FAT/ff.c **** 
2193:Core/Src/FAT/ff.c **** 
2194:Core/Src/FAT/ff.c **** #if !FF_FS_READONLY || FF_FS_RPATH != 0
2195:Core/Src/FAT/ff.c **** /*------------------------------------------------*/
2196:Core/Src/FAT/ff.c **** /* exFAT: Load the object's directory entry block */
2197:Core/Src/FAT/ff.c **** /*------------------------------------------------*/
2198:Core/Src/FAT/ff.c **** 
2199:Core/Src/FAT/ff.c **** static FRESULT load_obj_xdir (
2200:Core/Src/FAT/ff.c **** 	DIR* dp,			/* Blank directory object to be used to access containing directory */
2201:Core/Src/FAT/ff.c **** 	const FFOBJID* obj	/* Object with its containing directory information */
2202:Core/Src/FAT/ff.c **** )
2203:Core/Src/FAT/ff.c **** {
2204:Core/Src/FAT/ff.c **** 	FRESULT res;
2205:Core/Src/FAT/ff.c **** 
2206:Core/Src/FAT/ff.c **** 	/* Open object containing directory */
2207:Core/Src/FAT/ff.c **** 	dp->obj.fs = obj->fs;
2208:Core/Src/FAT/ff.c **** 	dp->obj.sclust = obj->c_scl;
2209:Core/Src/FAT/ff.c **** 	dp->obj.stat = (BYTE)obj->c_size;
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 48


2210:Core/Src/FAT/ff.c **** 	dp->obj.objsize = obj->c_size & 0xFFFFFF00;
2211:Core/Src/FAT/ff.c **** 	dp->obj.n_frag = 0;
2212:Core/Src/FAT/ff.c **** 	dp->blk_ofs = obj->c_ofs;
2213:Core/Src/FAT/ff.c **** 
2214:Core/Src/FAT/ff.c **** 	res = dir_sdi(dp, dp->blk_ofs);	/* Goto object's entry block */
2215:Core/Src/FAT/ff.c **** 	if (res == FR_OK) {
2216:Core/Src/FAT/ff.c **** 		res = load_xdir(dp);		/* Load the object's entry block */
2217:Core/Src/FAT/ff.c **** 	}
2218:Core/Src/FAT/ff.c **** 	return res;
2219:Core/Src/FAT/ff.c **** }
2220:Core/Src/FAT/ff.c **** #endif
2221:Core/Src/FAT/ff.c **** 
2222:Core/Src/FAT/ff.c **** 
2223:Core/Src/FAT/ff.c **** #if !FF_FS_READONLY
2224:Core/Src/FAT/ff.c **** /*----------------------------------------*/
2225:Core/Src/FAT/ff.c **** /* exFAT: Store the directory entry block */
2226:Core/Src/FAT/ff.c **** /*----------------------------------------*/
2227:Core/Src/FAT/ff.c **** 
2228:Core/Src/FAT/ff.c **** static FRESULT store_xdir (
2229:Core/Src/FAT/ff.c **** 	DIR* dp				/* Pointer to the directory object */
2230:Core/Src/FAT/ff.c **** )
2231:Core/Src/FAT/ff.c **** {
2232:Core/Src/FAT/ff.c **** 	FRESULT res;
2233:Core/Src/FAT/ff.c **** 	UINT nent;
2234:Core/Src/FAT/ff.c **** 	BYTE *dirb = dp->obj.fs->dirbuf;	/* Pointer to the directory entry block 85+C0+C1s */
2235:Core/Src/FAT/ff.c **** 
2236:Core/Src/FAT/ff.c **** 	/* Create set sum */
2237:Core/Src/FAT/ff.c **** 	st_word(dirb + XDIR_SetSum, xdir_sum(dirb));
2238:Core/Src/FAT/ff.c **** 	nent = dirb[XDIR_NumSec] + 1;
2239:Core/Src/FAT/ff.c **** 
2240:Core/Src/FAT/ff.c **** 	/* Store the directory entry block to the directory */
2241:Core/Src/FAT/ff.c **** 	res = dir_sdi(dp, dp->blk_ofs);
2242:Core/Src/FAT/ff.c **** 	while (res == FR_OK) {
2243:Core/Src/FAT/ff.c **** 		res = move_window(dp->obj.fs, dp->sect);
2244:Core/Src/FAT/ff.c **** 		if (res != FR_OK) break;
2245:Core/Src/FAT/ff.c **** 		memcpy(dp->dir, dirb, SZDIRE);
2246:Core/Src/FAT/ff.c **** 		dp->obj.fs->wflag = 1;
2247:Core/Src/FAT/ff.c **** 		if (--nent == 0) break;
2248:Core/Src/FAT/ff.c **** 		dirb += SZDIRE;
2249:Core/Src/FAT/ff.c **** 		res = dir_next(dp, 0);
2250:Core/Src/FAT/ff.c **** 	}
2251:Core/Src/FAT/ff.c **** 	return (res == FR_OK || res == FR_DISK_ERR) ? res : FR_INT_ERR;
2252:Core/Src/FAT/ff.c **** }
2253:Core/Src/FAT/ff.c **** 
2254:Core/Src/FAT/ff.c **** 
2255:Core/Src/FAT/ff.c **** 
2256:Core/Src/FAT/ff.c **** /*-------------------------------------------*/
2257:Core/Src/FAT/ff.c **** /* exFAT: Create a new directory entry block */
2258:Core/Src/FAT/ff.c **** /*-------------------------------------------*/
2259:Core/Src/FAT/ff.c **** 
2260:Core/Src/FAT/ff.c **** static void create_xdir (
2261:Core/Src/FAT/ff.c **** 	BYTE* dirb,			/* Pointer to the directory entry block buffer */
2262:Core/Src/FAT/ff.c **** 	const WCHAR* lfn	/* Pointer to the object name */
2263:Core/Src/FAT/ff.c **** )
2264:Core/Src/FAT/ff.c **** {
2265:Core/Src/FAT/ff.c **** 	UINT i;
2266:Core/Src/FAT/ff.c **** 	BYTE nc1, nlen;
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 49


2267:Core/Src/FAT/ff.c **** 	WCHAR wc;
2268:Core/Src/FAT/ff.c **** 
2269:Core/Src/FAT/ff.c **** 
2270:Core/Src/FAT/ff.c **** 	/* Create file-directory and stream-extension entry */
2271:Core/Src/FAT/ff.c **** 	memset(dirb, 0, 2 * SZDIRE);
2272:Core/Src/FAT/ff.c **** 	dirb[0 * SZDIRE + XDIR_Type] = ET_FILEDIR;
2273:Core/Src/FAT/ff.c **** 	dirb[1 * SZDIRE + XDIR_Type] = ET_STREAM;
2274:Core/Src/FAT/ff.c **** 
2275:Core/Src/FAT/ff.c **** 	/* Create file-name entries */
2276:Core/Src/FAT/ff.c **** 	i = SZDIRE * 2;	/* Top of file_name entries */
2277:Core/Src/FAT/ff.c **** 	nlen = nc1 = 0; wc = 1;
2278:Core/Src/FAT/ff.c **** 	do {
2279:Core/Src/FAT/ff.c **** 		dirb[i++] = ET_FILENAME; dirb[i++] = 0;
2280:Core/Src/FAT/ff.c **** 		do {	/* Fill name field */
2281:Core/Src/FAT/ff.c **** 			if (wc != 0 && (wc = lfn[nlen]) != 0) nlen++;	/* Get a character if exist */
2282:Core/Src/FAT/ff.c **** 			st_word(dirb + i, wc); 	/* Store it */
2283:Core/Src/FAT/ff.c **** 			i += 2;
2284:Core/Src/FAT/ff.c **** 		} while (i % SZDIRE != 0);
2285:Core/Src/FAT/ff.c **** 		nc1++;
2286:Core/Src/FAT/ff.c **** 	} while (lfn[nlen]);	/* Fill next entry if any char follows */
2287:Core/Src/FAT/ff.c **** 
2288:Core/Src/FAT/ff.c **** 	dirb[XDIR_NumName] = nlen;		/* Set name length */
2289:Core/Src/FAT/ff.c **** 	dirb[XDIR_NumSec] = 1 + nc1;	/* Set secondary count (C0 + C1s) */
2290:Core/Src/FAT/ff.c **** 	st_word(dirb + XDIR_NameHash, xname_sum(lfn));	/* Set name hash */
2291:Core/Src/FAT/ff.c **** }
2292:Core/Src/FAT/ff.c **** 
2293:Core/Src/FAT/ff.c **** #endif	/* !FF_FS_READONLY */
2294:Core/Src/FAT/ff.c **** #endif	/* FF_FS_EXFAT */
2295:Core/Src/FAT/ff.c **** 
2296:Core/Src/FAT/ff.c **** 
2297:Core/Src/FAT/ff.c **** 
2298:Core/Src/FAT/ff.c **** #if FF_FS_MINIMIZE <= 1 || FF_FS_RPATH >= 2 || FF_USE_LABEL || FF_FS_EXFAT
2299:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
2300:Core/Src/FAT/ff.c **** /* Read an object from the directory                                     */
2301:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
2302:Core/Src/FAT/ff.c **** 
2303:Core/Src/FAT/ff.c **** #define DIR_READ_FILE(dp) dir_read(dp, 0)
2304:Core/Src/FAT/ff.c **** #define DIR_READ_LABEL(dp) dir_read(dp, 1)
2305:Core/Src/FAT/ff.c **** 
2306:Core/Src/FAT/ff.c **** static FRESULT dir_read (
2307:Core/Src/FAT/ff.c **** 	DIR* dp,		/* Pointer to the directory object */
2308:Core/Src/FAT/ff.c **** 	int vol			/* Filtered by 0:file/directory or 1:volume label */
2309:Core/Src/FAT/ff.c **** )
2310:Core/Src/FAT/ff.c **** {
2311:Core/Src/FAT/ff.c **** 	FRESULT res = FR_NO_FILE;
2312:Core/Src/FAT/ff.c **** 	FATFS *fs = dp->obj.fs;
2313:Core/Src/FAT/ff.c **** 	BYTE attr, b;
2314:Core/Src/FAT/ff.c **** #if FF_USE_LFN
2315:Core/Src/FAT/ff.c **** 	BYTE ord = 0xFF, sum = 0xFF;
2316:Core/Src/FAT/ff.c **** #endif
2317:Core/Src/FAT/ff.c **** 
2318:Core/Src/FAT/ff.c **** 	while (dp->sect) {
2319:Core/Src/FAT/ff.c **** 		res = move_window(fs, dp->sect);
2320:Core/Src/FAT/ff.c **** 		if (res != FR_OK) break;
2321:Core/Src/FAT/ff.c **** 		b = dp->dir[DIR_Name];	/* Test for the entry type */
2322:Core/Src/FAT/ff.c **** 		if (b == 0) {
2323:Core/Src/FAT/ff.c **** 			res = FR_NO_FILE; break; /* Reached to end of the directory */
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 50


2324:Core/Src/FAT/ff.c **** 		}
2325:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT
2326:Core/Src/FAT/ff.c **** 		if (fs->fs_type == FS_EXFAT) {	/* On the exFAT volume */
2327:Core/Src/FAT/ff.c **** 			if (FF_USE_LABEL && vol) {
2328:Core/Src/FAT/ff.c **** 				if (b == ET_VLABEL) break;	/* Volume label entry? */
2329:Core/Src/FAT/ff.c **** 			} else {
2330:Core/Src/FAT/ff.c **** 				if (b == ET_FILEDIR) {		/* Start of the file entry block? */
2331:Core/Src/FAT/ff.c **** 					dp->blk_ofs = dp->dptr;	/* Get location of the block */
2332:Core/Src/FAT/ff.c **** 					res = load_xdir(dp);	/* Load the entry block */
2333:Core/Src/FAT/ff.c **** 					if (res == FR_OK) {
2334:Core/Src/FAT/ff.c **** 						dp->obj.attr = fs->dirbuf[XDIR_Attr] & AM_MASK;	/* Get attribute */
2335:Core/Src/FAT/ff.c **** 					}
2336:Core/Src/FAT/ff.c **** 					break;
2337:Core/Src/FAT/ff.c **** 				}
2338:Core/Src/FAT/ff.c **** 			}
2339:Core/Src/FAT/ff.c **** 		} else
2340:Core/Src/FAT/ff.c **** #endif
2341:Core/Src/FAT/ff.c **** 		{	/* On the FAT/FAT32 volume */
2342:Core/Src/FAT/ff.c **** 			dp->obj.attr = attr = dp->dir[DIR_Attr] & AM_MASK;	/* Get attribute */
2343:Core/Src/FAT/ff.c **** #if FF_USE_LFN		/* LFN configuration */
2344:Core/Src/FAT/ff.c **** 			if (b == DDEM || b == '.' || (int)((attr & ~AM_ARC) == AM_VOL) != vol) {	/* An entry without val
2345:Core/Src/FAT/ff.c **** 				ord = 0xFF;
2346:Core/Src/FAT/ff.c **** 			} else {
2347:Core/Src/FAT/ff.c **** 				if (attr == AM_LFN) {	/* An LFN entry is found */
2348:Core/Src/FAT/ff.c **** 					if (b & LLEF) {		/* Is it start of an LFN sequence? */
2349:Core/Src/FAT/ff.c **** 						sum = dp->dir[LDIR_Chksum];
2350:Core/Src/FAT/ff.c **** 						b &= (BYTE)~LLEF; ord = b;
2351:Core/Src/FAT/ff.c **** 						dp->blk_ofs = dp->dptr;
2352:Core/Src/FAT/ff.c **** 					}
2353:Core/Src/FAT/ff.c **** 					/* Check LFN validity and capture it */
2354:Core/Src/FAT/ff.c **** 					ord = (b == ord && sum == dp->dir[LDIR_Chksum] && pick_lfn(fs->lfnbuf, dp->dir)) ? ord - 1 : 0
2355:Core/Src/FAT/ff.c **** 				} else {				/* An SFN entry is found */
2356:Core/Src/FAT/ff.c **** 					if (ord != 0 || sum != sum_sfn(dp->dir)) {	/* Is there a valid LFN? */
2357:Core/Src/FAT/ff.c **** 						dp->blk_ofs = 0xFFFFFFFF;	/* It has no LFN. */
2358:Core/Src/FAT/ff.c **** 					}
2359:Core/Src/FAT/ff.c **** 					break;
2360:Core/Src/FAT/ff.c **** 				}
2361:Core/Src/FAT/ff.c **** 			}
2362:Core/Src/FAT/ff.c **** #else		/* Non LFN configuration */
2363:Core/Src/FAT/ff.c **** 			if (b != DDEM && b != '.' && attr != AM_LFN && (int)((attr & ~AM_ARC) == AM_VOL) == vol) {	/* Is
2364:Core/Src/FAT/ff.c **** 				break;
2365:Core/Src/FAT/ff.c **** 			}
2366:Core/Src/FAT/ff.c **** #endif
2367:Core/Src/FAT/ff.c **** 		}
2368:Core/Src/FAT/ff.c **** 		res = dir_next(dp, 0);		/* Next entry */
2369:Core/Src/FAT/ff.c **** 		if (res != FR_OK) break;
2370:Core/Src/FAT/ff.c **** 	}
2371:Core/Src/FAT/ff.c **** 
2372:Core/Src/FAT/ff.c **** 	if (res != FR_OK) dp->sect = 0;		/* Terminate the read operation on error or EOT */
2373:Core/Src/FAT/ff.c **** 	return res;
2374:Core/Src/FAT/ff.c **** }
2375:Core/Src/FAT/ff.c **** 
2376:Core/Src/FAT/ff.c **** #endif	/* FF_FS_MINIMIZE <= 1 || FF_USE_LABEL || FF_FS_RPATH >= 2 */
2377:Core/Src/FAT/ff.c **** 
2378:Core/Src/FAT/ff.c **** 
2379:Core/Src/FAT/ff.c **** 
2380:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 51


2381:Core/Src/FAT/ff.c **** /* Directory handling - Find an object in the directory                  */
2382:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
2383:Core/Src/FAT/ff.c **** 
2384:Core/Src/FAT/ff.c **** static FRESULT dir_find (	/* FR_OK(0):succeeded, !=0:error */
2385:Core/Src/FAT/ff.c **** 	DIR* dp					/* Pointer to the directory object with the file name */
2386:Core/Src/FAT/ff.c **** )
2387:Core/Src/FAT/ff.c **** {
2388:Core/Src/FAT/ff.c **** 	FRESULT res;
2389:Core/Src/FAT/ff.c **** 	FATFS *fs = dp->obj.fs;
2390:Core/Src/FAT/ff.c **** 	BYTE c;
2391:Core/Src/FAT/ff.c **** #if FF_USE_LFN
2392:Core/Src/FAT/ff.c **** 	BYTE a, ord, sum;
2393:Core/Src/FAT/ff.c **** #endif
2394:Core/Src/FAT/ff.c **** 
2395:Core/Src/FAT/ff.c **** 	res = dir_sdi(dp, 0);			/* Rewind directory object */
2396:Core/Src/FAT/ff.c **** 	if (res != FR_OK) return res;
2397:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT
2398:Core/Src/FAT/ff.c **** 	if (fs->fs_type == FS_EXFAT) {	/* On the exFAT volume */
2399:Core/Src/FAT/ff.c **** 		BYTE nc;
2400:Core/Src/FAT/ff.c **** 		UINT di, ni;
2401:Core/Src/FAT/ff.c **** 		WORD hash = xname_sum(fs->lfnbuf);		/* Hash value of the name to find */
2402:Core/Src/FAT/ff.c **** 
2403:Core/Src/FAT/ff.c **** 		while ((res = DIR_READ_FILE(dp)) == FR_OK) {	/* Read an item */
2404:Core/Src/FAT/ff.c **** #if FF_MAX_LFN < 255
2405:Core/Src/FAT/ff.c **** 			if (fs->dirbuf[XDIR_NumName] > FF_MAX_LFN) continue;		/* Skip comparison if inaccessible object 
2406:Core/Src/FAT/ff.c **** #endif
2407:Core/Src/FAT/ff.c **** 			if (ld_word(fs->dirbuf + XDIR_NameHash) != hash) continue;	/* Skip comparison if hash mismatched
2408:Core/Src/FAT/ff.c **** 			for (nc = fs->dirbuf[XDIR_NumName], di = SZDIRE * 2, ni = 0; nc; nc--, di += 2, ni++) {	/* Compa
2409:Core/Src/FAT/ff.c **** 				if ((di % SZDIRE) == 0) di += 2;
2410:Core/Src/FAT/ff.c **** 				if (ff_wtoupper(ld_word(fs->dirbuf + di)) != ff_wtoupper(fs->lfnbuf[ni])) break;
2411:Core/Src/FAT/ff.c **** 			}
2412:Core/Src/FAT/ff.c **** 			if (nc == 0 && !fs->lfnbuf[ni]) break;	/* Name matched? */
2413:Core/Src/FAT/ff.c **** 		}
2414:Core/Src/FAT/ff.c **** 		return res;
2415:Core/Src/FAT/ff.c **** 	}
2416:Core/Src/FAT/ff.c **** #endif
2417:Core/Src/FAT/ff.c **** 	/* On the FAT/FAT32 volume */
2418:Core/Src/FAT/ff.c **** #if FF_USE_LFN
2419:Core/Src/FAT/ff.c **** 	ord = sum = 0xFF; dp->blk_ofs = 0xFFFFFFFF;	/* Reset LFN sequence */
2420:Core/Src/FAT/ff.c **** #endif
2421:Core/Src/FAT/ff.c **** 	do {
2422:Core/Src/FAT/ff.c **** 		res = move_window(fs, dp->sect);
2423:Core/Src/FAT/ff.c **** 		if (res != FR_OK) break;
2424:Core/Src/FAT/ff.c **** 		c = dp->dir[DIR_Name];
2425:Core/Src/FAT/ff.c **** 		if (c == 0) { res = FR_NO_FILE; break; }	/* Reached to end of table */
2426:Core/Src/FAT/ff.c **** #if FF_USE_LFN		/* LFN configuration */
2427:Core/Src/FAT/ff.c **** 		dp->obj.attr = a = dp->dir[DIR_Attr] & AM_MASK;
2428:Core/Src/FAT/ff.c **** 		if (c == DDEM || ((a & AM_VOL) && a != AM_LFN)) {	/* An entry without valid data */
2429:Core/Src/FAT/ff.c **** 			ord = 0xFF; dp->blk_ofs = 0xFFFFFFFF;	/* Reset LFN sequence */
2430:Core/Src/FAT/ff.c **** 		} else {
2431:Core/Src/FAT/ff.c **** 			if (a == AM_LFN) {			/* An LFN entry is found */
2432:Core/Src/FAT/ff.c **** 				if (!(dp->fn[NSFLAG] & NS_NOLFN)) {
2433:Core/Src/FAT/ff.c **** 					if (c & LLEF) {		/* Is it start of LFN sequence? */
2434:Core/Src/FAT/ff.c **** 						sum = dp->dir[LDIR_Chksum];
2435:Core/Src/FAT/ff.c **** 						c &= (BYTE)~LLEF; ord = c;	/* LFN start order */
2436:Core/Src/FAT/ff.c **** 						dp->blk_ofs = dp->dptr;	/* Start offset of LFN */
2437:Core/Src/FAT/ff.c **** 					}
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 52


2438:Core/Src/FAT/ff.c **** 					/* Check validity of the LFN entry and compare it with given name */
2439:Core/Src/FAT/ff.c **** 					ord = (c == ord && sum == dp->dir[LDIR_Chksum] && cmp_lfn(fs->lfnbuf, dp->dir)) ? ord - 1 : 0x
2440:Core/Src/FAT/ff.c **** 				}
2441:Core/Src/FAT/ff.c **** 			} else {					/* An SFN entry is found */
2442:Core/Src/FAT/ff.c **** 				if (ord == 0 && sum == sum_sfn(dp->dir)) break;	/* LFN matched? */
2443:Core/Src/FAT/ff.c **** 				if (!(dp->fn[NSFLAG] & NS_LOSS) && !memcmp(dp->dir, dp->fn, 11)) break;	/* SFN matched? */
2444:Core/Src/FAT/ff.c **** 				ord = 0xFF; dp->blk_ofs = 0xFFFFFFFF;	/* Reset LFN sequence */
2445:Core/Src/FAT/ff.c **** 			}
2446:Core/Src/FAT/ff.c **** 		}
2447:Core/Src/FAT/ff.c **** #else		/* Non LFN configuration */
2448:Core/Src/FAT/ff.c **** 		dp->obj.attr = dp->dir[DIR_Attr] & AM_MASK;
2449:Core/Src/FAT/ff.c **** 		if (!(dp->dir[DIR_Attr] & AM_VOL) && !memcmp(dp->dir, dp->fn, 11)) break;	/* Is it a valid entry?
2450:Core/Src/FAT/ff.c **** #endif
2451:Core/Src/FAT/ff.c **** 		res = dir_next(dp, 0);	/* Next entry */
2452:Core/Src/FAT/ff.c **** 	} while (res == FR_OK);
2453:Core/Src/FAT/ff.c **** 
2454:Core/Src/FAT/ff.c **** 	return res;
2455:Core/Src/FAT/ff.c **** }
2456:Core/Src/FAT/ff.c **** 
2457:Core/Src/FAT/ff.c **** 
2458:Core/Src/FAT/ff.c **** 
2459:Core/Src/FAT/ff.c **** 
2460:Core/Src/FAT/ff.c **** #if !FF_FS_READONLY
2461:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
2462:Core/Src/FAT/ff.c **** /* Register an object to the directory                                   */
2463:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
2464:Core/Src/FAT/ff.c **** 
2465:Core/Src/FAT/ff.c **** static FRESULT dir_register (	/* FR_OK:succeeded, FR_DENIED:no free entry or too many SFN collision
2466:Core/Src/FAT/ff.c **** 	DIR* dp						/* Target directory with object name to be created */
2467:Core/Src/FAT/ff.c **** )
2468:Core/Src/FAT/ff.c **** {
2469:Core/Src/FAT/ff.c **** 	FRESULT res;
2470:Core/Src/FAT/ff.c **** 	FATFS *fs = dp->obj.fs;
2471:Core/Src/FAT/ff.c **** #if FF_USE_LFN		/* LFN configuration */
2472:Core/Src/FAT/ff.c **** 	UINT n, len, n_ent;
2473:Core/Src/FAT/ff.c **** 	BYTE sn[12], sum;
2474:Core/Src/FAT/ff.c **** 
2475:Core/Src/FAT/ff.c **** 
2476:Core/Src/FAT/ff.c **** 	if (dp->fn[NSFLAG] & (NS_DOT | NS_NONAME)) return FR_INVALID_NAME;	/* Check name validity */
2477:Core/Src/FAT/ff.c **** 	for (len = 0; fs->lfnbuf[len]; len++) ;	/* Get lfn length */
2478:Core/Src/FAT/ff.c **** 
2479:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT
2480:Core/Src/FAT/ff.c **** 	if (fs->fs_type == FS_EXFAT) {	/* On the exFAT volume */
2481:Core/Src/FAT/ff.c **** 		n_ent = (len + 14) / 15 + 2;	/* Number of entries to allocate (85+C0+C1s) */
2482:Core/Src/FAT/ff.c **** 		res = dir_alloc(dp, n_ent);		/* Allocate directory entries */
2483:Core/Src/FAT/ff.c **** 		if (res != FR_OK) return res;
2484:Core/Src/FAT/ff.c **** 		dp->blk_ofs = dp->dptr - SZDIRE * (n_ent - 1);	/* Set the allocated entry block offset */
2485:Core/Src/FAT/ff.c **** 
2486:Core/Src/FAT/ff.c **** 		if (dp->obj.stat & 4) {			/* Has the directory been stretched by new allocation? */
2487:Core/Src/FAT/ff.c **** 			dp->obj.stat &= ~4;
2488:Core/Src/FAT/ff.c **** 			res = fill_first_frag(&dp->obj);	/* Fill the first fragment on the FAT if needed */
2489:Core/Src/FAT/ff.c **** 			if (res != FR_OK) return res;
2490:Core/Src/FAT/ff.c **** 			res = fill_last_frag(&dp->obj, dp->clust, 0xFFFFFFFF);	/* Fill the last fragment on the FAT if n
2491:Core/Src/FAT/ff.c **** 			if (res != FR_OK) return res;
2492:Core/Src/FAT/ff.c **** 			if (dp->obj.sclust != 0) {		/* Is it a sub-directory? */
2493:Core/Src/FAT/ff.c **** 				DIR dj;
2494:Core/Src/FAT/ff.c **** 
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 53


2495:Core/Src/FAT/ff.c **** 				res = load_obj_xdir(&dj, &dp->obj);	/* Load the object status */
2496:Core/Src/FAT/ff.c **** 				if (res != FR_OK) return res;
2497:Core/Src/FAT/ff.c **** 				dp->obj.objsize += (DWORD)fs->csize * SS(fs);		/* Increase the directory size by cluster size *
2498:Core/Src/FAT/ff.c **** 				st_qword(fs->dirbuf + XDIR_FileSize, dp->obj.objsize);
2499:Core/Src/FAT/ff.c **** 				st_qword(fs->dirbuf + XDIR_ValidFileSize, dp->obj.objsize);
2500:Core/Src/FAT/ff.c **** 				fs->dirbuf[XDIR_GenFlags] = dp->obj.stat | 1;		/* Update the allocation status */
2501:Core/Src/FAT/ff.c **** 				res = store_xdir(&dj);				/* Store the object status */
2502:Core/Src/FAT/ff.c **** 				if (res != FR_OK) return res;
2503:Core/Src/FAT/ff.c **** 			}
2504:Core/Src/FAT/ff.c **** 		}
2505:Core/Src/FAT/ff.c **** 
2506:Core/Src/FAT/ff.c **** 		create_xdir(fs->dirbuf, fs->lfnbuf);	/* Create on-memory directory block to be written later */
2507:Core/Src/FAT/ff.c **** 		return FR_OK;
2508:Core/Src/FAT/ff.c **** 	}
2509:Core/Src/FAT/ff.c **** #endif
2510:Core/Src/FAT/ff.c **** 	/* On the FAT/FAT32 volume */
2511:Core/Src/FAT/ff.c **** 	memcpy(sn, dp->fn, 12);
2512:Core/Src/FAT/ff.c **** 	if (sn[NSFLAG] & NS_LOSS) {			/* When LFN is out of 8.3 format, generate a numbered name */
2513:Core/Src/FAT/ff.c **** 		dp->fn[NSFLAG] = NS_NOLFN;		/* Find only SFN */
2514:Core/Src/FAT/ff.c **** 		for (n = 1; n < 100; n++) {
2515:Core/Src/FAT/ff.c **** 			gen_numname(dp->fn, sn, fs->lfnbuf, n);	/* Generate a numbered name */
2516:Core/Src/FAT/ff.c **** 			res = dir_find(dp);				/* Check if the name collides with existing SFN */
2517:Core/Src/FAT/ff.c **** 			if (res != FR_OK) break;
2518:Core/Src/FAT/ff.c **** 		}
2519:Core/Src/FAT/ff.c **** 		if (n == 100) return FR_DENIED;		/* Abort if too many collisions */
2520:Core/Src/FAT/ff.c **** 		if (res != FR_NO_FILE) return res;	/* Abort if the result is other than 'not collided' */
2521:Core/Src/FAT/ff.c **** 		dp->fn[NSFLAG] = sn[NSFLAG];
2522:Core/Src/FAT/ff.c **** 	}
2523:Core/Src/FAT/ff.c **** 
2524:Core/Src/FAT/ff.c **** 	/* Create an SFN with/without LFNs. */
2525:Core/Src/FAT/ff.c **** 	n_ent = (sn[NSFLAG] & NS_LFN) ? (len + 12) / 13 + 1 : 1;	/* Number of entries to allocate */
2526:Core/Src/FAT/ff.c **** 	res = dir_alloc(dp, n_ent);		/* Allocate entries */
2527:Core/Src/FAT/ff.c **** 	if (res == FR_OK && --n_ent) {	/* Set LFN entry if needed */
2528:Core/Src/FAT/ff.c **** 		res = dir_sdi(dp, dp->dptr - n_ent * SZDIRE);
2529:Core/Src/FAT/ff.c **** 		if (res == FR_OK) {
2530:Core/Src/FAT/ff.c **** 			sum = sum_sfn(dp->fn);	/* Checksum value of the SFN tied to the LFN */
2531:Core/Src/FAT/ff.c **** 			do {					/* Store LFN entries in bottom first */
2532:Core/Src/FAT/ff.c **** 				res = move_window(fs, dp->sect);
2533:Core/Src/FAT/ff.c **** 				if (res != FR_OK) break;
2534:Core/Src/FAT/ff.c **** 				put_lfn(fs->lfnbuf, dp->dir, (BYTE)n_ent, sum);
2535:Core/Src/FAT/ff.c **** 				fs->wflag = 1;
2536:Core/Src/FAT/ff.c **** 				res = dir_next(dp, 0);	/* Next entry */
2537:Core/Src/FAT/ff.c **** 			} while (res == FR_OK && --n_ent);
2538:Core/Src/FAT/ff.c **** 		}
2539:Core/Src/FAT/ff.c **** 	}
2540:Core/Src/FAT/ff.c **** 
2541:Core/Src/FAT/ff.c **** #else	/* Non LFN configuration */
2542:Core/Src/FAT/ff.c **** 	res = dir_alloc(dp, 1);		/* Allocate an entry for SFN */
2543:Core/Src/FAT/ff.c **** 
2544:Core/Src/FAT/ff.c **** #endif
2545:Core/Src/FAT/ff.c **** 
2546:Core/Src/FAT/ff.c **** 	/* Set SFN entry */
2547:Core/Src/FAT/ff.c **** 	if (res == FR_OK) {
2548:Core/Src/FAT/ff.c **** 		res = move_window(fs, dp->sect);
2549:Core/Src/FAT/ff.c **** 		if (res == FR_OK) {
2550:Core/Src/FAT/ff.c **** 			memset(dp->dir, 0, SZDIRE);	/* Clean the entry */
2551:Core/Src/FAT/ff.c **** 			memcpy(dp->dir + DIR_Name, dp->fn, 11);	/* Put SFN */
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 54


2552:Core/Src/FAT/ff.c **** #if FF_USE_LFN
2553:Core/Src/FAT/ff.c **** 			dp->dir[DIR_NTres] = dp->fn[NSFLAG] & (NS_BODY | NS_EXT);	/* Put NT flag */
2554:Core/Src/FAT/ff.c **** #endif
2555:Core/Src/FAT/ff.c **** 			fs->wflag = 1;
2556:Core/Src/FAT/ff.c **** 		}
2557:Core/Src/FAT/ff.c **** 	}
2558:Core/Src/FAT/ff.c **** 
2559:Core/Src/FAT/ff.c **** 	return res;
2560:Core/Src/FAT/ff.c **** }
2561:Core/Src/FAT/ff.c **** 
2562:Core/Src/FAT/ff.c **** #endif /* !FF_FS_READONLY */
2563:Core/Src/FAT/ff.c **** 
2564:Core/Src/FAT/ff.c **** 
2565:Core/Src/FAT/ff.c **** 
2566:Core/Src/FAT/ff.c **** #if !FF_FS_READONLY && FF_FS_MINIMIZE == 0
2567:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
2568:Core/Src/FAT/ff.c **** /* Remove an object from the directory                                   */
2569:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
2570:Core/Src/FAT/ff.c **** 
2571:Core/Src/FAT/ff.c **** static FRESULT dir_remove (	/* FR_OK:Succeeded, FR_DISK_ERR:A disk error */
2572:Core/Src/FAT/ff.c **** 	DIR* dp					/* Directory object pointing the entry to be removed */
2573:Core/Src/FAT/ff.c **** )
2574:Core/Src/FAT/ff.c **** {
2575:Core/Src/FAT/ff.c **** 	FRESULT res;
2576:Core/Src/FAT/ff.c **** 	FATFS *fs = dp->obj.fs;
2577:Core/Src/FAT/ff.c **** #if FF_USE_LFN		/* LFN configuration */
2578:Core/Src/FAT/ff.c **** 	DWORD last = dp->dptr;
2579:Core/Src/FAT/ff.c **** 
2580:Core/Src/FAT/ff.c **** 	res = (dp->blk_ofs == 0xFFFFFFFF) ? FR_OK : dir_sdi(dp, dp->blk_ofs);	/* Goto top of the entry blo
2581:Core/Src/FAT/ff.c **** 	if (res == FR_OK) {
2582:Core/Src/FAT/ff.c **** 		do {
2583:Core/Src/FAT/ff.c **** 			res = move_window(fs, dp->sect);
2584:Core/Src/FAT/ff.c **** 			if (res != FR_OK) break;
2585:Core/Src/FAT/ff.c **** 			if (FF_FS_EXFAT && fs->fs_type == FS_EXFAT) {	/* On the exFAT volume */
2586:Core/Src/FAT/ff.c **** 				dp->dir[XDIR_Type] &= 0x7F;	/* Clear the entry InUse flag. */
2587:Core/Src/FAT/ff.c **** 			} else {										/* On the FAT/FAT32 volume */
2588:Core/Src/FAT/ff.c **** 				dp->dir[DIR_Name] = DDEM;	/* Mark the entry 'deleted'. */
2589:Core/Src/FAT/ff.c **** 			}
2590:Core/Src/FAT/ff.c **** 			fs->wflag = 1;
2591:Core/Src/FAT/ff.c **** 			if (dp->dptr >= last) break;	/* If reached last entry then all entries of the object has been de
2592:Core/Src/FAT/ff.c **** 			res = dir_next(dp, 0);	/* Next entry */
2593:Core/Src/FAT/ff.c **** 		} while (res == FR_OK);
2594:Core/Src/FAT/ff.c **** 		if (res == FR_NO_FILE) res = FR_INT_ERR;
2595:Core/Src/FAT/ff.c **** 	}
2596:Core/Src/FAT/ff.c **** #else			/* Non LFN configuration */
2597:Core/Src/FAT/ff.c **** 
2598:Core/Src/FAT/ff.c **** 	res = move_window(fs, dp->sect);
2599:Core/Src/FAT/ff.c **** 	if (res == FR_OK) {
2600:Core/Src/FAT/ff.c **** 		dp->dir[DIR_Name] = DDEM;	/* Mark the entry 'deleted'.*/
2601:Core/Src/FAT/ff.c **** 		fs->wflag = 1;
2602:Core/Src/FAT/ff.c **** 	}
2603:Core/Src/FAT/ff.c **** #endif
2604:Core/Src/FAT/ff.c **** 
2605:Core/Src/FAT/ff.c **** 	return res;
2606:Core/Src/FAT/ff.c **** }
2607:Core/Src/FAT/ff.c **** 
2608:Core/Src/FAT/ff.c **** #endif /* !FF_FS_READONLY && FF_FS_MINIMIZE == 0 */
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 55


2609:Core/Src/FAT/ff.c **** 
2610:Core/Src/FAT/ff.c **** 
2611:Core/Src/FAT/ff.c **** 
2612:Core/Src/FAT/ff.c **** #if FF_FS_MINIMIZE <= 1 || FF_FS_RPATH >= 2
2613:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
2614:Core/Src/FAT/ff.c **** /* Get file information from directory entry                             */
2615:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
2616:Core/Src/FAT/ff.c **** 
2617:Core/Src/FAT/ff.c **** static void get_fileinfo (
2618:Core/Src/FAT/ff.c **** 	DIR* dp,			/* Pointer to the directory object */
2619:Core/Src/FAT/ff.c **** 	FILINFO* fno		/* Pointer to the file information to be filled */
2620:Core/Src/FAT/ff.c **** )
2621:Core/Src/FAT/ff.c **** {
 473              		.loc 1 2621 1 is_stmt 1 view -0
 474              		.cfi_startproc
 475              		@ args = 0, pretend = 0, frame = 0
 476              		@ frame_needed = 0, uses_anonymous_args = 0
 477              		.loc 1 2621 1 is_stmt 0 view .LVU128
 478 0000 38B5     		push	{r3, r4, r5, lr}
 479              	.LCFI2:
 480              		.cfi_def_cfa_offset 16
 481              		.cfi_offset 3, -16
 482              		.cfi_offset 4, -12
 483              		.cfi_offset 5, -8
 484              		.cfi_offset 14, -4
2622:Core/Src/FAT/ff.c **** 	UINT si, di;
 485              		.loc 1 2622 2 is_stmt 1 view .LVU129
2623:Core/Src/FAT/ff.c **** #if FF_USE_LFN
2624:Core/Src/FAT/ff.c **** 	BYTE lcf;
2625:Core/Src/FAT/ff.c **** 	WCHAR wc, hs;
2626:Core/Src/FAT/ff.c **** 	FATFS *fs = dp->obj.fs;
2627:Core/Src/FAT/ff.c **** 	UINT nw;
2628:Core/Src/FAT/ff.c **** #else
2629:Core/Src/FAT/ff.c **** 	TCHAR c;
 486              		.loc 1 2629 2 view .LVU130
2630:Core/Src/FAT/ff.c **** #endif
2631:Core/Src/FAT/ff.c **** 
2632:Core/Src/FAT/ff.c **** 
2633:Core/Src/FAT/ff.c **** 	fno->fname[0] = 0;			/* Invaidate file info */
 487              		.loc 1 2633 2 view .LVU131
 488              		.loc 1 2633 16 is_stmt 0 view .LVU132
 489 0002 0023     		movs	r3, #0
 490 0004 4B72     		strb	r3, [r1, #9]
2634:Core/Src/FAT/ff.c **** 	if (dp->sect == 0) return;	/* Exit if read pointer has reached end of directory */
 491              		.loc 1 2634 2 is_stmt 1 view .LVU133
 492              		.loc 1 2634 8 is_stmt 0 view .LVU134
 493 0006 8369     		ldr	r3, [r0, #24]
 494              		.loc 1 2634 5 view .LVU135
 495 0008 9BB3     		cbz	r3, .L30
 496 000a 0546     		mov	r5, r0
 497 000c 0C46     		mov	r4, r1
2635:Core/Src/FAT/ff.c **** 
2636:Core/Src/FAT/ff.c **** #if FF_USE_LFN		/* LFN configuration */
2637:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT
2638:Core/Src/FAT/ff.c **** 	if (fs->fs_type == FS_EXFAT) {	/* exFAT volume */
2639:Core/Src/FAT/ff.c **** 		UINT nc = 0;
2640:Core/Src/FAT/ff.c **** 
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 56


2641:Core/Src/FAT/ff.c **** 		si = SZDIRE * 2; di = 0;	/* 1st C1 entry in the entry block */
2642:Core/Src/FAT/ff.c **** 		hs = 0;
2643:Core/Src/FAT/ff.c **** 		while (nc < fs->dirbuf[XDIR_NumName]) {
2644:Core/Src/FAT/ff.c **** 			if (si >= MAXDIRB(FF_MAX_LFN)) {	/* Truncated directory block? */
2645:Core/Src/FAT/ff.c **** 				di = 0; break;
2646:Core/Src/FAT/ff.c **** 			}
2647:Core/Src/FAT/ff.c **** 			if ((si % SZDIRE) == 0) si += 2;	/* Skip entry type field */
2648:Core/Src/FAT/ff.c **** 			wc = ld_word(fs->dirbuf + si); si += 2; nc++;	/* Get a character */
2649:Core/Src/FAT/ff.c **** 			if (hs == 0 && IsSurrogate(wc)) {	/* Is it a surrogate? */
2650:Core/Src/FAT/ff.c **** 				hs = wc; continue;				/* Get low surrogate */
2651:Core/Src/FAT/ff.c **** 			}
2652:Core/Src/FAT/ff.c **** 			nw = put_utf((DWORD)hs << 16 | wc, &fno->fname[di], FF_LFN_BUF - di);	/* Store it in API encodin
2653:Core/Src/FAT/ff.c **** 			if (nw == 0) {						/* Buffer overflow or wrong char? */
2654:Core/Src/FAT/ff.c **** 				di = 0; break;
2655:Core/Src/FAT/ff.c **** 			}
2656:Core/Src/FAT/ff.c **** 			di += nw;
2657:Core/Src/FAT/ff.c **** 			hs = 0;
2658:Core/Src/FAT/ff.c **** 		}
2659:Core/Src/FAT/ff.c **** 		if (hs != 0) di = 0;					/* Broken surrogate pair? */
2660:Core/Src/FAT/ff.c **** 		if (di == 0) fno->fname[di++] = '\?';	/* Inaccessible object name? */
2661:Core/Src/FAT/ff.c **** 		fno->fname[di] = 0;						/* Terminate the name */
2662:Core/Src/FAT/ff.c **** 		fno->altname[0] = 0;					/* exFAT does not support SFN */
2663:Core/Src/FAT/ff.c **** 
2664:Core/Src/FAT/ff.c **** 		fno->fattrib = fs->dirbuf[XDIR_Attr] & AM_MASKX;		/* Attribute */
2665:Core/Src/FAT/ff.c **** 		fno->fsize = (fno->fattrib & AM_DIR) ? 0 : ld_qword(fs->dirbuf + XDIR_FileSize);	/* Size */
2666:Core/Src/FAT/ff.c **** 		fno->ftime = ld_word(fs->dirbuf + XDIR_ModTime + 0);	/* Time */
2667:Core/Src/FAT/ff.c **** 		fno->fdate = ld_word(fs->dirbuf + XDIR_ModTime + 2);	/* Date */
2668:Core/Src/FAT/ff.c **** 		return;
2669:Core/Src/FAT/ff.c **** 	} else
2670:Core/Src/FAT/ff.c **** #endif
2671:Core/Src/FAT/ff.c **** 	{	/* FAT/FAT32 volume */
2672:Core/Src/FAT/ff.c **** 		if (dp->blk_ofs != 0xFFFFFFFF) {	/* Get LFN if available */
2673:Core/Src/FAT/ff.c **** 			si = di = 0;
2674:Core/Src/FAT/ff.c **** 			hs = 0;
2675:Core/Src/FAT/ff.c **** 			while (fs->lfnbuf[si] != 0) {
2676:Core/Src/FAT/ff.c **** 				wc = fs->lfnbuf[si++];		/* Get an LFN character (UTF-16) */
2677:Core/Src/FAT/ff.c **** 				if (hs == 0 && IsSurrogate(wc)) {	/* Is it a surrogate? */
2678:Core/Src/FAT/ff.c **** 					hs = wc; continue;		/* Get low surrogate */
2679:Core/Src/FAT/ff.c **** 				}
2680:Core/Src/FAT/ff.c **** 				nw = put_utf((DWORD)hs << 16 | wc, &fno->fname[di], FF_LFN_BUF - di);	/* Store it in API encodi
2681:Core/Src/FAT/ff.c **** 				if (nw == 0) {				/* Buffer overflow or wrong char? */
2682:Core/Src/FAT/ff.c **** 					di = 0; break;
2683:Core/Src/FAT/ff.c **** 				}
2684:Core/Src/FAT/ff.c **** 				di += nw;
2685:Core/Src/FAT/ff.c **** 				hs = 0;
2686:Core/Src/FAT/ff.c **** 			}
2687:Core/Src/FAT/ff.c **** 			if (hs != 0) di = 0;	/* Broken surrogate pair? */
2688:Core/Src/FAT/ff.c **** 			fno->fname[di] = 0;		/* Terminate the LFN (null string means LFN is invalid) */
2689:Core/Src/FAT/ff.c **** 		}
2690:Core/Src/FAT/ff.c **** 	}
2691:Core/Src/FAT/ff.c **** 
2692:Core/Src/FAT/ff.c **** 	si = di = 0;
2693:Core/Src/FAT/ff.c **** 	while (si < 11) {		/* Get SFN from SFN entry */
2694:Core/Src/FAT/ff.c **** 		wc = dp->dir[si++];			/* Get a char */
2695:Core/Src/FAT/ff.c **** 		if (wc == ' ') continue;	/* Skip padding spaces */
2696:Core/Src/FAT/ff.c **** 		if (wc == RDDEM) wc = DDEM;	/* Restore replaced DDEM character */
2697:Core/Src/FAT/ff.c **** 		if (si == 9 && di < FF_SFN_BUF) fno->altname[di++] = '.';	/* Insert a . if extension is exist */
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 57


2698:Core/Src/FAT/ff.c **** #if FF_LFN_UNICODE >= 1	/* Unicode output */
2699:Core/Src/FAT/ff.c **** 		if (dbc_1st((BYTE)wc) && si != 8 && si != 11 && dbc_2nd(dp->dir[si])) {	/* Make a DBC if needed *
2700:Core/Src/FAT/ff.c **** 			wc = wc << 8 | dp->dir[si++];
2701:Core/Src/FAT/ff.c **** 		}
2702:Core/Src/FAT/ff.c **** 		wc = ff_oem2uni(wc, CODEPAGE);		/* ANSI/OEM -> Unicode */
2703:Core/Src/FAT/ff.c **** 		if (wc == 0) {				/* Wrong char in the current code page? */
2704:Core/Src/FAT/ff.c **** 			di = 0; break;
2705:Core/Src/FAT/ff.c **** 		}
2706:Core/Src/FAT/ff.c **** 		nw = put_utf(wc, &fno->altname[di], FF_SFN_BUF - di);	/* Store it in API encoding */
2707:Core/Src/FAT/ff.c **** 		if (nw == 0) {				/* Buffer overflow? */
2708:Core/Src/FAT/ff.c **** 			di = 0; break;
2709:Core/Src/FAT/ff.c **** 		}
2710:Core/Src/FAT/ff.c **** 		di += nw;
2711:Core/Src/FAT/ff.c **** #else					/* ANSI/OEM output */
2712:Core/Src/FAT/ff.c **** 		fno->altname[di++] = (TCHAR)wc;	/* Store it without any conversion */
2713:Core/Src/FAT/ff.c **** #endif
2714:Core/Src/FAT/ff.c **** 	}
2715:Core/Src/FAT/ff.c **** 	fno->altname[di] = 0;	/* Terminate the SFN  (null string means SFN is invalid) */
2716:Core/Src/FAT/ff.c **** 
2717:Core/Src/FAT/ff.c **** 	if (fno->fname[0] == 0) {	/* If LFN is invalid, altname[] needs to be copied to fname[] */
2718:Core/Src/FAT/ff.c **** 		if (di == 0) {	/* If LFN and SFN both are invalid, this object is inaccessible */
2719:Core/Src/FAT/ff.c **** 			fno->fname[di++] = '\?';
2720:Core/Src/FAT/ff.c **** 		} else {
2721:Core/Src/FAT/ff.c **** 			for (si = di = 0, lcf = NS_BODY; fno->altname[si]; si++, di++) {	/* Copy altname[] to fname[] wi
2722:Core/Src/FAT/ff.c **** 				wc = (WCHAR)fno->altname[si];
2723:Core/Src/FAT/ff.c **** 				if (wc == '.') lcf = NS_EXT;
2724:Core/Src/FAT/ff.c **** 				if (IsUpper(wc) && (dp->dir[DIR_NTres] & lcf)) wc += 0x20;
2725:Core/Src/FAT/ff.c **** 				fno->fname[di] = (TCHAR)wc;
2726:Core/Src/FAT/ff.c **** 			}
2727:Core/Src/FAT/ff.c **** 		}
2728:Core/Src/FAT/ff.c **** 		fno->fname[di] = 0;	/* Terminate the LFN */
2729:Core/Src/FAT/ff.c **** 		if (!dp->dir[DIR_NTres]) fno->altname[0] = 0;	/* Altname is not needed if neither LFN nor case in
2730:Core/Src/FAT/ff.c **** 	}
2731:Core/Src/FAT/ff.c **** 
2732:Core/Src/FAT/ff.c **** #else	/* Non-LFN configuration */
2733:Core/Src/FAT/ff.c **** 	si = di = 0;
 498              		.loc 1 2733 10 view .LVU136
 499 000e 0022     		movs	r2, #0
 500              		.loc 1 2733 5 view .LVU137
 501 0010 1346     		mov	r3, r2
 502 0012 06E0     		b	.L32
 503              	.LVL58:
 504              	.L34:
2734:Core/Src/FAT/ff.c **** 	while (si < 11) {		/* Copy name body and extension */
2735:Core/Src/FAT/ff.c **** 		c = (TCHAR)dp->dir[si++];
2736:Core/Src/FAT/ff.c **** 		if (c == ' ') continue;		/* Skip padding spaces */
2737:Core/Src/FAT/ff.c **** 		if (c == RDDEM) c = DDEM;	/* Restore replaced DDEM character */
2738:Core/Src/FAT/ff.c **** 		if (si == 9) fno->fname[di++] = '.';/* Insert a . if extension is exist */
 505              		.loc 1 2738 3 is_stmt 1 view .LVU138
 506              		.loc 1 2738 6 is_stmt 0 view .LVU139
 507 0014 BCF1090F 		cmp	ip, #9
 508 0018 0FD0     		beq	.L39
 509              	.L35:
2739:Core/Src/FAT/ff.c **** 		fno->fname[di++] = c;
 510              		.loc 1 2739 3 is_stmt 1 view .LVU140
 511              	.LVL59:
 512              		.loc 1 2739 20 is_stmt 0 view .LVU141
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 58


 513 001a A118     		adds	r1, r4, r2
 514 001c 4B72     		strb	r3, [r1, #9]
 515              		.loc 1 2739 16 view .LVU142
 516 001e 0132     		adds	r2, r2, #1
 517              	.LVL60:
 518              	.L33:
 519              		.loc 1 2739 16 view .LVU143
 520 0020 6346     		mov	r3, ip
 521              	.LVL61:
 522              	.L32:
2734:Core/Src/FAT/ff.c **** 	while (si < 11) {		/* Copy name body and extension */
 523              		.loc 1 2734 8 is_stmt 1 view .LVU144
 524 0022 0A2B     		cmp	r3, #10
 525 0024 0ED8     		bhi	.L40
2735:Core/Src/FAT/ff.c **** 		if (c == ' ') continue;		/* Skip padding spaces */
 526              		.loc 1 2735 3 view .LVU145
2735:Core/Src/FAT/ff.c **** 		if (c == ' ') continue;		/* Skip padding spaces */
 527              		.loc 1 2735 24 is_stmt 0 view .LVU146
 528 0026 03F1010C 		add	ip, r3, #1
 529              	.LVL62:
2735:Core/Src/FAT/ff.c **** 		if (c == ' ') continue;		/* Skip padding spaces */
 530              		.loc 1 2735 5 view .LVU147
 531 002a E969     		ldr	r1, [r5, #28]
 532 002c CB5C     		ldrb	r3, [r1, r3]	@ zero_extendqisi2
 533              	.LVL63:
2736:Core/Src/FAT/ff.c **** 		if (c == RDDEM) c = DDEM;	/* Restore replaced DDEM character */
 534              		.loc 1 2736 3 is_stmt 1 view .LVU148
2736:Core/Src/FAT/ff.c **** 		if (c == RDDEM) c = DDEM;	/* Restore replaced DDEM character */
 535              		.loc 1 2736 6 is_stmt 0 view .LVU149
 536 002e 202B     		cmp	r3, #32
 537 0030 F6D0     		beq	.L33
2737:Core/Src/FAT/ff.c **** 		if (si == 9) fno->fname[di++] = '.';/* Insert a . if extension is exist */
 538              		.loc 1 2737 3 is_stmt 1 view .LVU150
2737:Core/Src/FAT/ff.c **** 		if (si == 9) fno->fname[di++] = '.';/* Insert a . if extension is exist */
 539              		.loc 1 2737 6 is_stmt 0 view .LVU151
 540 0032 052B     		cmp	r3, #5
 541 0034 EED1     		bne	.L34
2737:Core/Src/FAT/ff.c **** 		if (si == 9) fno->fname[di++] = '.';/* Insert a . if extension is exist */
 542              		.loc 1 2737 21 view .LVU152
 543 0036 E523     		movs	r3, #229
 544              	.LVL64:
2737:Core/Src/FAT/ff.c **** 		if (si == 9) fno->fname[di++] = '.';/* Insert a . if extension is exist */
 545              		.loc 1 2737 21 view .LVU153
 546 0038 ECE7     		b	.L34
 547              	.LVL65:
 548              	.L39:
2738:Core/Src/FAT/ff.c **** 		fno->fname[di++] = c;
 549              		.loc 1 2738 16 is_stmt 1 discriminator 1 view .LVU154
2738:Core/Src/FAT/ff.c **** 		fno->fname[di++] = c;
 550              		.loc 1 2738 33 is_stmt 0 discriminator 1 view .LVU155
 551 003a A118     		adds	r1, r4, r2
 552 003c 2E20     		movs	r0, #46
 553 003e 4872     		strb	r0, [r1, #9]
2738:Core/Src/FAT/ff.c **** 		fno->fname[di++] = c;
 554              		.loc 1 2738 29 discriminator 1 view .LVU156
 555 0040 0132     		adds	r2, r2, #1
 556              	.LVL66:
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 59


2738:Core/Src/FAT/ff.c **** 		fno->fname[di++] = c;
 557              		.loc 1 2738 29 discriminator 1 view .LVU157
 558 0042 EAE7     		b	.L35
 559              	.LVL67:
 560              	.L40:
2740:Core/Src/FAT/ff.c **** 	}
2741:Core/Src/FAT/ff.c **** 	fno->fname[di] = 0;		/* Terminate the SFN */
 561              		.loc 1 2741 2 is_stmt 1 view .LVU158
 562              		.loc 1 2741 17 is_stmt 0 view .LVU159
 563 0044 2244     		add	r2, r2, r4
 564              	.LVL68:
 565              		.loc 1 2741 17 view .LVU160
 566 0046 0023     		movs	r3, #0
 567              	.LVL69:
 568              		.loc 1 2741 17 view .LVU161
 569 0048 5372     		strb	r3, [r2, #9]
2742:Core/Src/FAT/ff.c **** #endif
2743:Core/Src/FAT/ff.c **** 
2744:Core/Src/FAT/ff.c **** 	fno->fattrib = dp->dir[DIR_Attr] & AM_MASK;			/* Attribute */
 570              		.loc 1 2744 2 is_stmt 1 view .LVU162
 571              		.loc 1 2744 19 is_stmt 0 view .LVU163
 572 004a EB69     		ldr	r3, [r5, #28]
 573              		.loc 1 2744 24 view .LVU164
 574 004c DB7A     		ldrb	r3, [r3, #11]	@ zero_extendqisi2
 575              		.loc 1 2744 35 view .LVU165
 576 004e 03F03F03 		and	r3, r3, #63
 577              		.loc 1 2744 15 view .LVU166
 578 0052 2372     		strb	r3, [r4, #8]
2745:Core/Src/FAT/ff.c **** 	fno->fsize = ld_dword(dp->dir + DIR_FileSize);		/* Size */
 579              		.loc 1 2745 2 is_stmt 1 view .LVU167
 580              		.loc 1 2745 26 is_stmt 0 view .LVU168
 581 0054 E869     		ldr	r0, [r5, #28]
 582              		.loc 1 2745 15 view .LVU169
 583 0056 1C30     		adds	r0, r0, #28
 584 0058 FFF7FEFF 		bl	ld_dword
 585              	.LVL70:
 586              		.loc 1 2745 13 view .LVU170
 587 005c 2060     		str	r0, [r4]
2746:Core/Src/FAT/ff.c **** 	fno->ftime = ld_word(dp->dir + DIR_ModTime + 0);	/* Time */
 588              		.loc 1 2746 2 is_stmt 1 view .LVU171
 589              		.loc 1 2746 25 is_stmt 0 view .LVU172
 590 005e E869     		ldr	r0, [r5, #28]
 591              		.loc 1 2746 15 view .LVU173
 592 0060 1630     		adds	r0, r0, #22
 593 0062 FFF7FEFF 		bl	ld_word
 594              	.LVL71:
 595              		.loc 1 2746 13 view .LVU174
 596 0066 E080     		strh	r0, [r4, #6]	@ movhi
2747:Core/Src/FAT/ff.c **** 	fno->fdate = ld_word(dp->dir + DIR_ModTime + 2);	/* Date */
 597              		.loc 1 2747 2 is_stmt 1 view .LVU175
 598              		.loc 1 2747 25 is_stmt 0 view .LVU176
 599 0068 E869     		ldr	r0, [r5, #28]
 600              		.loc 1 2747 15 view .LVU177
 601 006a 1830     		adds	r0, r0, #24
 602 006c FFF7FEFF 		bl	ld_word
 603              	.LVL72:
 604              		.loc 1 2747 13 view .LVU178
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 60


 605 0070 A080     		strh	r0, [r4, #4]	@ movhi
 606              	.LVL73:
 607              	.L30:
2748:Core/Src/FAT/ff.c **** }
 608              		.loc 1 2748 1 view .LVU179
 609 0072 38BD     		pop	{r3, r4, r5, pc}
 610              		.cfi_endproc
 611              	.LFE24:
 613              		.section	.text.get_ldnumber,"ax",%progbits
 614              		.align	1
 615              		.syntax unified
 616              		.thumb
 617              		.thumb_func
 619              	get_ldnumber:
 620              	.LVL74:
 621              	.LFB27:
2749:Core/Src/FAT/ff.c **** 
2750:Core/Src/FAT/ff.c **** #endif /* FF_FS_MINIMIZE <= 1 || FF_FS_RPATH >= 2 */
2751:Core/Src/FAT/ff.c **** 
2752:Core/Src/FAT/ff.c **** 
2753:Core/Src/FAT/ff.c **** 
2754:Core/Src/FAT/ff.c **** #if FF_USE_FIND && FF_FS_MINIMIZE <= 1
2755:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
2756:Core/Src/FAT/ff.c **** /* Pattern matching                                                      */
2757:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
2758:Core/Src/FAT/ff.c **** 
2759:Core/Src/FAT/ff.c **** #define FIND_RECURS	4	/* Maximum number of wildcard terms in the pattern to limit recursion */
2760:Core/Src/FAT/ff.c **** 
2761:Core/Src/FAT/ff.c **** 
2762:Core/Src/FAT/ff.c **** static DWORD get_achar (	/* Get a character and advance ptr */
2763:Core/Src/FAT/ff.c **** 	const TCHAR** ptr		/* Pointer to pointer to the ANSI/OEM or Unicode string */
2764:Core/Src/FAT/ff.c **** )
2765:Core/Src/FAT/ff.c **** {
2766:Core/Src/FAT/ff.c **** 	DWORD chr;
2767:Core/Src/FAT/ff.c **** 
2768:Core/Src/FAT/ff.c **** 
2769:Core/Src/FAT/ff.c **** #if FF_USE_LFN && FF_LFN_UNICODE >= 1	/* Unicode input */
2770:Core/Src/FAT/ff.c **** 	chr = tchar2uni(ptr);
2771:Core/Src/FAT/ff.c **** 	if (chr == 0xFFFFFFFF) chr = 0;		/* Wrong UTF encoding is recognized as end of the string */
2772:Core/Src/FAT/ff.c **** 	chr = ff_wtoupper(chr);
2773:Core/Src/FAT/ff.c **** 
2774:Core/Src/FAT/ff.c **** #else									/* ANSI/OEM input */
2775:Core/Src/FAT/ff.c **** 	chr = (BYTE)*(*ptr)++;				/* Get a byte */
2776:Core/Src/FAT/ff.c **** 	if (IsLower(chr)) chr -= 0x20;		/* To upper ASCII char */
2777:Core/Src/FAT/ff.c **** #if FF_CODE_PAGE == 0
2778:Core/Src/FAT/ff.c **** 	if (ExCvt && chr >= 0x80) chr = ExCvt[chr - 0x80];	/* To upper SBCS extended char */
2779:Core/Src/FAT/ff.c **** #elif FF_CODE_PAGE < 900
2780:Core/Src/FAT/ff.c **** 	if (chr >= 0x80) chr = ExCvt[chr - 0x80];	/* To upper SBCS extended char */
2781:Core/Src/FAT/ff.c **** #endif
2782:Core/Src/FAT/ff.c **** #if FF_CODE_PAGE == 0 || FF_CODE_PAGE >= 900
2783:Core/Src/FAT/ff.c **** 	if (dbc_1st((BYTE)chr)) {	/* Get DBC 2nd byte if needed */
2784:Core/Src/FAT/ff.c **** 		chr = dbc_2nd((BYTE)**ptr) ? chr << 8 | (BYTE)*(*ptr)++ : 0;
2785:Core/Src/FAT/ff.c **** 	}
2786:Core/Src/FAT/ff.c **** #endif
2787:Core/Src/FAT/ff.c **** 
2788:Core/Src/FAT/ff.c **** #endif
2789:Core/Src/FAT/ff.c **** 	return chr;
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 61


2790:Core/Src/FAT/ff.c **** }
2791:Core/Src/FAT/ff.c **** 
2792:Core/Src/FAT/ff.c **** 
2793:Core/Src/FAT/ff.c **** static int pattern_match (	/* 0:mismatched, 1:matched */
2794:Core/Src/FAT/ff.c **** 	const TCHAR* pat,	/* Matching pattern */
2795:Core/Src/FAT/ff.c **** 	const TCHAR* nam,	/* String to be tested */
2796:Core/Src/FAT/ff.c **** 	UINT skip,			/* Number of pre-skip chars (number of ?s, b8:infinite (* specified)) */
2797:Core/Src/FAT/ff.c **** 	UINT recur			/* Recursion count */
2798:Core/Src/FAT/ff.c **** )
2799:Core/Src/FAT/ff.c **** {
2800:Core/Src/FAT/ff.c **** 	const TCHAR *pptr;
2801:Core/Src/FAT/ff.c **** 	const TCHAR *nptr;
2802:Core/Src/FAT/ff.c **** 	DWORD pchr, nchr;
2803:Core/Src/FAT/ff.c **** 	UINT sk;
2804:Core/Src/FAT/ff.c **** 
2805:Core/Src/FAT/ff.c **** 
2806:Core/Src/FAT/ff.c **** 	while ((skip & 0xFF) != 0) {		/* Pre-skip name chars */
2807:Core/Src/FAT/ff.c **** 		if (!get_achar(&nam)) return 0;	/* Branch mismatched if less name chars */
2808:Core/Src/FAT/ff.c **** 		skip--;
2809:Core/Src/FAT/ff.c **** 	}
2810:Core/Src/FAT/ff.c **** 	if (*pat == 0 && skip) return 1;	/* Matched? (short circuit) */
2811:Core/Src/FAT/ff.c **** 
2812:Core/Src/FAT/ff.c **** 	do {
2813:Core/Src/FAT/ff.c **** 		pptr = pat; nptr = nam;			/* Top of pattern and name to match */
2814:Core/Src/FAT/ff.c **** 		for (;;) {
2815:Core/Src/FAT/ff.c **** 			if (*pptr == '\?' || *pptr == '*') {	/* Wildcard term? */
2816:Core/Src/FAT/ff.c **** 				if (recur == 0) return 0;	/* Too many wildcard terms? */
2817:Core/Src/FAT/ff.c **** 				sk = 0;
2818:Core/Src/FAT/ff.c **** 				do {	/* Analyze the wildcard term */
2819:Core/Src/FAT/ff.c **** 					if (*pptr++ == '\?') {
2820:Core/Src/FAT/ff.c **** 						sk++;
2821:Core/Src/FAT/ff.c **** 					} else {
2822:Core/Src/FAT/ff.c **** 						sk |= 0x100;
2823:Core/Src/FAT/ff.c **** 					}
2824:Core/Src/FAT/ff.c **** 				} while (*pptr == '\?' || *pptr == '*');
2825:Core/Src/FAT/ff.c **** 				if (pattern_match(pptr, nptr, sk, recur - 1)) return 1;	/* Test new branch (recursive call) */
2826:Core/Src/FAT/ff.c **** 				nchr = *nptr; break;	/* Branch mismatched */
2827:Core/Src/FAT/ff.c **** 			}
2828:Core/Src/FAT/ff.c **** 			pchr = get_achar(&pptr);	/* Get a pattern char */
2829:Core/Src/FAT/ff.c **** 			nchr = get_achar(&nptr);	/* Get a name char */
2830:Core/Src/FAT/ff.c **** 			if (pchr != nchr) break;	/* Branch mismatched? */
2831:Core/Src/FAT/ff.c **** 			if (pchr == 0) return 1;	/* Branch matched? (matched at end of both strings) */
2832:Core/Src/FAT/ff.c **** 		}
2833:Core/Src/FAT/ff.c **** 		get_achar(&nam);			/* nam++ */
2834:Core/Src/FAT/ff.c **** 	} while (skip && nchr);		/* Retry until end of name if infinite search is specified */
2835:Core/Src/FAT/ff.c **** 
2836:Core/Src/FAT/ff.c **** 	return 0;
2837:Core/Src/FAT/ff.c **** }
2838:Core/Src/FAT/ff.c **** 
2839:Core/Src/FAT/ff.c **** #endif /* FF_USE_FIND && FF_FS_MINIMIZE <= 1 */
2840:Core/Src/FAT/ff.c **** 
2841:Core/Src/FAT/ff.c **** 
2842:Core/Src/FAT/ff.c **** 
2843:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
2844:Core/Src/FAT/ff.c **** /* Pick a top segment and create the object name in directory form       */
2845:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
2846:Core/Src/FAT/ff.c **** 
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 62


2847:Core/Src/FAT/ff.c **** static FRESULT create_name (	/* FR_OK: successful, FR_INVALID_NAME: could not create */
2848:Core/Src/FAT/ff.c **** 	DIR* dp,					/* Pointer to the directory object */
2849:Core/Src/FAT/ff.c **** 	const TCHAR** path			/* Pointer to pointer to the segment in the path string */
2850:Core/Src/FAT/ff.c **** )
2851:Core/Src/FAT/ff.c **** {
2852:Core/Src/FAT/ff.c **** #if FF_USE_LFN		/* LFN configuration */
2853:Core/Src/FAT/ff.c **** 	BYTE b, cf;
2854:Core/Src/FAT/ff.c **** 	WCHAR wc;
2855:Core/Src/FAT/ff.c **** 	WCHAR *lfn;
2856:Core/Src/FAT/ff.c **** 	const TCHAR* p;
2857:Core/Src/FAT/ff.c **** 	DWORD uc;
2858:Core/Src/FAT/ff.c **** 	UINT i, ni, si, di;
2859:Core/Src/FAT/ff.c **** 
2860:Core/Src/FAT/ff.c **** 
2861:Core/Src/FAT/ff.c **** 	/* Create LFN into LFN working buffer */
2862:Core/Src/FAT/ff.c **** 	p = *path; lfn = dp->obj.fs->lfnbuf; di = 0;
2863:Core/Src/FAT/ff.c **** 	for (;;) {
2864:Core/Src/FAT/ff.c **** 		uc = tchar2uni(&p);			/* Get a character */
2865:Core/Src/FAT/ff.c **** 		if (uc == 0xFFFFFFFF) return FR_INVALID_NAME;		/* Invalid code or UTF decode error */
2866:Core/Src/FAT/ff.c **** 		if (uc >= 0x10000) lfn[di++] = (WCHAR)(uc >> 16);	/* Store high surrogate if needed */
2867:Core/Src/FAT/ff.c **** 		wc = (WCHAR)uc;
2868:Core/Src/FAT/ff.c **** 		if (wc < ' ' || IsSeparator(wc)) break;	/* Break if end of the path or a separator is found */
2869:Core/Src/FAT/ff.c **** 		if (wc < 0x80 && strchr("*:<>|\"\?\x7F", (int)wc)) return FR_INVALID_NAME;	/* Reject illegal char
2870:Core/Src/FAT/ff.c **** 		if (di >= FF_MAX_LFN) return FR_INVALID_NAME;	/* Reject too long name */
2871:Core/Src/FAT/ff.c **** 		lfn[di++] = wc;				/* Store the Unicode character */
2872:Core/Src/FAT/ff.c **** 	}
2873:Core/Src/FAT/ff.c **** 	if (wc < ' ') {				/* Stopped at end of the path? */
2874:Core/Src/FAT/ff.c **** 		cf = NS_LAST;			/* Last segment */
2875:Core/Src/FAT/ff.c **** 	} else {					/* Stopped at a separator */
2876:Core/Src/FAT/ff.c **** 		while (IsSeparator(*p)) p++;	/* Skip duplicated separators if exist */
2877:Core/Src/FAT/ff.c **** 		cf = 0;					/* Next segment may follow */
2878:Core/Src/FAT/ff.c **** 		if (IsTerminator(*p)) cf = NS_LAST;	/* Ignore terminating separator */
2879:Core/Src/FAT/ff.c **** 	}
2880:Core/Src/FAT/ff.c **** 	*path = p;					/* Return pointer to the next segment */
2881:Core/Src/FAT/ff.c **** 
2882:Core/Src/FAT/ff.c **** #if FF_FS_RPATH != 0
2883:Core/Src/FAT/ff.c **** 	if ((di == 1 && lfn[di - 1] == '.') ||
2884:Core/Src/FAT/ff.c **** 		(di == 2 && lfn[di - 1] == '.' && lfn[di - 2] == '.')) {	/* Is this segment a dot name? */
2885:Core/Src/FAT/ff.c **** 		lfn[di] = 0;
2886:Core/Src/FAT/ff.c **** 		for (i = 0; i < 11; i++) {	/* Create dot name for SFN entry */
2887:Core/Src/FAT/ff.c **** 			dp->fn[i] = (i < di) ? '.' : ' ';
2888:Core/Src/FAT/ff.c **** 		}
2889:Core/Src/FAT/ff.c **** 		dp->fn[i] = cf | NS_DOT;	/* This is a dot entry */
2890:Core/Src/FAT/ff.c **** 		return FR_OK;
2891:Core/Src/FAT/ff.c **** 	}
2892:Core/Src/FAT/ff.c **** #endif
2893:Core/Src/FAT/ff.c **** 	while (di) {					/* Snip off trailing spaces and dots if exist */
2894:Core/Src/FAT/ff.c **** 		wc = lfn[di - 1];
2895:Core/Src/FAT/ff.c **** 		if (wc != ' ' && wc != '.') break;
2896:Core/Src/FAT/ff.c **** 		di--;
2897:Core/Src/FAT/ff.c **** 	}
2898:Core/Src/FAT/ff.c **** 	lfn[di] = 0;							/* LFN is created into the working buffer */
2899:Core/Src/FAT/ff.c **** 	if (di == 0) return FR_INVALID_NAME;	/* Reject null name */
2900:Core/Src/FAT/ff.c **** 
2901:Core/Src/FAT/ff.c **** 	/* Create SFN in directory form */
2902:Core/Src/FAT/ff.c **** 	for (si = 0; lfn[si] == ' '; si++) ;	/* Remove leading spaces */
2903:Core/Src/FAT/ff.c **** 	if (si > 0 || lfn[si] == '.') cf |= NS_LOSS | NS_LFN;	/* Is there any leading space or dot? */
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 63


2904:Core/Src/FAT/ff.c **** 	while (di > 0 && lfn[di - 1] != '.') di--;	/* Find last dot (di<=si: no extension) */
2905:Core/Src/FAT/ff.c **** 
2906:Core/Src/FAT/ff.c **** 	memset(dp->fn, ' ', 11);
2907:Core/Src/FAT/ff.c **** 	i = b = 0; ni = 8;
2908:Core/Src/FAT/ff.c **** 	for (;;) {
2909:Core/Src/FAT/ff.c **** 		wc = lfn[si++];					/* Get an LFN character */
2910:Core/Src/FAT/ff.c **** 		if (wc == 0) break;				/* Break on end of the LFN */
2911:Core/Src/FAT/ff.c **** 		if (wc == ' ' || (wc == '.' && si != di)) {	/* Remove embedded spaces and dots */
2912:Core/Src/FAT/ff.c **** 			cf |= NS_LOSS | NS_LFN;
2913:Core/Src/FAT/ff.c **** 			continue;
2914:Core/Src/FAT/ff.c **** 		}
2915:Core/Src/FAT/ff.c **** 
2916:Core/Src/FAT/ff.c **** 		if (i >= ni || si == di) {		/* End of field? */
2917:Core/Src/FAT/ff.c **** 			if (ni == 11) {				/* Name extension overflow? */
2918:Core/Src/FAT/ff.c **** 				cf |= NS_LOSS | NS_LFN;
2919:Core/Src/FAT/ff.c **** 				break;
2920:Core/Src/FAT/ff.c **** 			}
2921:Core/Src/FAT/ff.c **** 			if (si != di) cf |= NS_LOSS | NS_LFN;	/* Name body overflow? */
2922:Core/Src/FAT/ff.c **** 			if (si > di) break;						/* No name extension? */
2923:Core/Src/FAT/ff.c **** 			si = di; i = 8; ni = 11; b <<= 2;		/* Enter name extension */
2924:Core/Src/FAT/ff.c **** 			continue;
2925:Core/Src/FAT/ff.c **** 		}
2926:Core/Src/FAT/ff.c **** 
2927:Core/Src/FAT/ff.c **** 		if (wc >= 0x80) {	/* Is this an extended character? */
2928:Core/Src/FAT/ff.c **** 			cf |= NS_LFN;	/* LFN entry needs to be created */
2929:Core/Src/FAT/ff.c **** #if FF_CODE_PAGE == 0
2930:Core/Src/FAT/ff.c **** 			if (ExCvt) {	/* In SBCS cfg */
2931:Core/Src/FAT/ff.c **** 				wc = ff_uni2oem(wc, CODEPAGE);			/* Unicode ==> ANSI/OEM code */
2932:Core/Src/FAT/ff.c **** 				if (wc & 0x80) wc = ExCvt[wc & 0x7F];	/* Convert extended character to upper (SBCS) */
2933:Core/Src/FAT/ff.c **** 			} else {		/* In DBCS cfg */
2934:Core/Src/FAT/ff.c **** 				wc = ff_uni2oem(ff_wtoupper(wc), CODEPAGE);	/* Unicode ==> Up-convert ==> ANSI/OEM code */
2935:Core/Src/FAT/ff.c **** 			}
2936:Core/Src/FAT/ff.c **** #elif FF_CODE_PAGE < 900	/* In SBCS cfg */
2937:Core/Src/FAT/ff.c **** 			wc = ff_uni2oem(wc, CODEPAGE);			/* Unicode ==> ANSI/OEM code */
2938:Core/Src/FAT/ff.c **** 			if (wc & 0x80) wc = ExCvt[wc & 0x7F];	/* Convert extended character to upper (SBCS) */
2939:Core/Src/FAT/ff.c **** #else						/* In DBCS cfg */
2940:Core/Src/FAT/ff.c **** 			wc = ff_uni2oem(ff_wtoupper(wc), CODEPAGE);	/* Unicode ==> Up-convert ==> ANSI/OEM code */
2941:Core/Src/FAT/ff.c **** #endif
2942:Core/Src/FAT/ff.c **** 		}
2943:Core/Src/FAT/ff.c **** 
2944:Core/Src/FAT/ff.c **** 		if (wc >= 0x100) {				/* Is this a DBC? */
2945:Core/Src/FAT/ff.c **** 			if (i >= ni - 1) {			/* Field overflow? */
2946:Core/Src/FAT/ff.c **** 				cf |= NS_LOSS | NS_LFN;
2947:Core/Src/FAT/ff.c **** 				i = ni; continue;		/* Next field */
2948:Core/Src/FAT/ff.c **** 			}
2949:Core/Src/FAT/ff.c **** 			dp->fn[i++] = (BYTE)(wc >> 8);	/* Put 1st byte */
2950:Core/Src/FAT/ff.c **** 		} else {						/* SBC */
2951:Core/Src/FAT/ff.c **** 			if (wc == 0 || strchr("+,;=[]", (int)wc)) {	/* Replace illegal characters for SFN */
2952:Core/Src/FAT/ff.c **** 				wc = '_'; cf |= NS_LOSS | NS_LFN;/* Lossy conversion */
2953:Core/Src/FAT/ff.c **** 			} else {
2954:Core/Src/FAT/ff.c **** 				if (IsUpper(wc)) {		/* ASCII upper case? */
2955:Core/Src/FAT/ff.c **** 					b |= 2;
2956:Core/Src/FAT/ff.c **** 				}
2957:Core/Src/FAT/ff.c **** 				if (IsLower(wc)) {		/* ASCII lower case? */
2958:Core/Src/FAT/ff.c **** 					b |= 1; wc -= 0x20;
2959:Core/Src/FAT/ff.c **** 				}
2960:Core/Src/FAT/ff.c **** 			}
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 64


2961:Core/Src/FAT/ff.c **** 		}
2962:Core/Src/FAT/ff.c **** 		dp->fn[i++] = (BYTE)wc;
2963:Core/Src/FAT/ff.c **** 	}
2964:Core/Src/FAT/ff.c **** 
2965:Core/Src/FAT/ff.c **** 	if (dp->fn[0] == DDEM) dp->fn[0] = RDDEM;	/* If the first character collides with DDEM, replace it
2966:Core/Src/FAT/ff.c **** 
2967:Core/Src/FAT/ff.c **** 	if (ni == 8) b <<= 2;				/* Shift capital flags if no extension */
2968:Core/Src/FAT/ff.c **** 	if ((b & 0x0C) == 0x0C || (b & 0x03) == 0x03) cf |= NS_LFN;	/* LFN entry needs to be created if co
2969:Core/Src/FAT/ff.c **** 	if (!(cf & NS_LFN)) {				/* When LFN is in 8.3 format without extended character, NT flags are cre
2970:Core/Src/FAT/ff.c **** 		if (b & 0x01) cf |= NS_EXT;		/* NT flag (Extension has small capital letters only) */
2971:Core/Src/FAT/ff.c **** 		if (b & 0x04) cf |= NS_BODY;	/* NT flag (Body has small capital letters only) */
2972:Core/Src/FAT/ff.c **** 	}
2973:Core/Src/FAT/ff.c **** 
2974:Core/Src/FAT/ff.c **** 	dp->fn[NSFLAG] = cf;	/* SFN is created into dp->fn[] */
2975:Core/Src/FAT/ff.c **** 
2976:Core/Src/FAT/ff.c **** 	return FR_OK;
2977:Core/Src/FAT/ff.c **** 
2978:Core/Src/FAT/ff.c **** 
2979:Core/Src/FAT/ff.c **** #else	/* FF_USE_LFN : Non-LFN configuration */
2980:Core/Src/FAT/ff.c **** 	BYTE c, d;
2981:Core/Src/FAT/ff.c **** 	BYTE *sfn;
2982:Core/Src/FAT/ff.c **** 	UINT ni, si, i;
2983:Core/Src/FAT/ff.c **** 	const char *p;
2984:Core/Src/FAT/ff.c **** 
2985:Core/Src/FAT/ff.c **** 	/* Create file name in directory form */
2986:Core/Src/FAT/ff.c **** 	p = *path; sfn = dp->fn;
2987:Core/Src/FAT/ff.c **** 	memset(sfn, ' ', 11);
2988:Core/Src/FAT/ff.c **** 	si = i = 0; ni = 8;
2989:Core/Src/FAT/ff.c **** #if FF_FS_RPATH != 0
2990:Core/Src/FAT/ff.c **** 	if (p[si] == '.') { /* Is this a dot entry? */
2991:Core/Src/FAT/ff.c **** 		for (;;) {
2992:Core/Src/FAT/ff.c **** 			c = (BYTE)p[si++];
2993:Core/Src/FAT/ff.c **** 			if (c != '.' || si >= 3) break;
2994:Core/Src/FAT/ff.c **** 			sfn[i++] = c;
2995:Core/Src/FAT/ff.c **** 		}
2996:Core/Src/FAT/ff.c **** 		if (!IsSeparator(c) && c > ' ') return FR_INVALID_NAME;
2997:Core/Src/FAT/ff.c **** 		*path = p + si;					/* Return pointer to the next segment */
2998:Core/Src/FAT/ff.c **** 		sfn[NSFLAG] = (c <= ' ') ? NS_LAST | NS_DOT : NS_DOT;	/* Set last segment flag if end of the path
2999:Core/Src/FAT/ff.c **** 		return FR_OK;
3000:Core/Src/FAT/ff.c **** 	}
3001:Core/Src/FAT/ff.c **** #endif
3002:Core/Src/FAT/ff.c **** 	for (;;) {
3003:Core/Src/FAT/ff.c **** 		c = (BYTE)p[si++];				/* Get a byte */
3004:Core/Src/FAT/ff.c **** 		if (c <= ' ') break; 			/* Break if end of the path name */
3005:Core/Src/FAT/ff.c **** 		if (IsSeparator(c)) {			/* Break if a separator is found */
3006:Core/Src/FAT/ff.c **** 			while (IsSeparator(p[si])) si++;	/* Skip duplicated separator if exist */
3007:Core/Src/FAT/ff.c **** 			break;
3008:Core/Src/FAT/ff.c **** 		}
3009:Core/Src/FAT/ff.c **** 		if (c == '.' || i >= ni) {		/* End of body or field overflow? */
3010:Core/Src/FAT/ff.c **** 			if (ni == 11 || c != '.') return FR_INVALID_NAME;	/* Field overflow or invalid dot? */
3011:Core/Src/FAT/ff.c **** 			i = 8; ni = 11;				/* Enter file extension field */
3012:Core/Src/FAT/ff.c **** 			continue;
3013:Core/Src/FAT/ff.c **** 		}
3014:Core/Src/FAT/ff.c **** #if FF_CODE_PAGE == 0
3015:Core/Src/FAT/ff.c **** 		if (ExCvt && c >= 0x80) {		/* Is SBC extended character? */
3016:Core/Src/FAT/ff.c **** 			c = ExCvt[c & 0x7F];		/* To upper SBC extended character */
3017:Core/Src/FAT/ff.c **** 		}
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 65


3018:Core/Src/FAT/ff.c **** #elif FF_CODE_PAGE < 900
3019:Core/Src/FAT/ff.c **** 		if (c >= 0x80) {				/* Is SBC extended character? */
3020:Core/Src/FAT/ff.c **** 			c = ExCvt[c & 0x7F];		/* To upper SBC extended character */
3021:Core/Src/FAT/ff.c **** 		}
3022:Core/Src/FAT/ff.c **** #endif
3023:Core/Src/FAT/ff.c **** 		if (dbc_1st(c)) {				/* Check if it is a DBC 1st byte */
3024:Core/Src/FAT/ff.c **** 			d = (BYTE)p[si++];			/* Get 2nd byte */
3025:Core/Src/FAT/ff.c **** 			if (!dbc_2nd(d) || i >= ni - 1) return FR_INVALID_NAME;	/* Reject invalid DBC */
3026:Core/Src/FAT/ff.c **** 			sfn[i++] = c;
3027:Core/Src/FAT/ff.c **** 			sfn[i++] = d;
3028:Core/Src/FAT/ff.c **** 		} else {						/* SBC */
3029:Core/Src/FAT/ff.c **** 			if (strchr("*+,:;<=>[]|\"\?\x7F", (int)c)) return FR_INVALID_NAME;	/* Reject illegal chrs for SF
3030:Core/Src/FAT/ff.c **** 			if (IsLower(c)) c -= 0x20;	/* To upper */
3031:Core/Src/FAT/ff.c **** 			sfn[i++] = c;
3032:Core/Src/FAT/ff.c **** 		}
3033:Core/Src/FAT/ff.c **** 	}
3034:Core/Src/FAT/ff.c **** 	*path = &p[si];						/* Return pointer to the next segment */
3035:Core/Src/FAT/ff.c **** 	if (i == 0) return FR_INVALID_NAME;	/* Reject nul string */
3036:Core/Src/FAT/ff.c **** 
3037:Core/Src/FAT/ff.c **** 	if (sfn[0] == DDEM) sfn[0] = RDDEM;	/* If the first character collides with DDEM, replace it with 
3038:Core/Src/FAT/ff.c **** 	sfn[NSFLAG] = (c <= ' ' || p[si] <= ' ') ? NS_LAST : 0;	/* Set last segment flag if end of the pat
3039:Core/Src/FAT/ff.c **** 
3040:Core/Src/FAT/ff.c **** 	return FR_OK;
3041:Core/Src/FAT/ff.c **** #endif /* FF_USE_LFN */
3042:Core/Src/FAT/ff.c **** }
3043:Core/Src/FAT/ff.c **** 
3044:Core/Src/FAT/ff.c **** 
3045:Core/Src/FAT/ff.c **** 
3046:Core/Src/FAT/ff.c **** 
3047:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
3048:Core/Src/FAT/ff.c **** /* Follow a file path                                                    */
3049:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
3050:Core/Src/FAT/ff.c **** 
3051:Core/Src/FAT/ff.c **** static FRESULT follow_path (	/* FR_OK(0): successful, !=0: error code */
3052:Core/Src/FAT/ff.c **** 	DIR* dp,					/* Directory object to return last directory and found object */
3053:Core/Src/FAT/ff.c **** 	const TCHAR* path			/* Full-path string to find a file or directory */
3054:Core/Src/FAT/ff.c **** )
3055:Core/Src/FAT/ff.c **** {
3056:Core/Src/FAT/ff.c **** 	FRESULT res;
3057:Core/Src/FAT/ff.c **** 	BYTE ns;
3058:Core/Src/FAT/ff.c **** 	FATFS *fs = dp->obj.fs;
3059:Core/Src/FAT/ff.c **** 
3060:Core/Src/FAT/ff.c **** 
3061:Core/Src/FAT/ff.c **** #if FF_FS_RPATH != 0
3062:Core/Src/FAT/ff.c **** 	if (!IsSeparator(*path) && (FF_STR_VOLUME_ID != 2 || !IsTerminator(*path))) {	/* Without heading s
3063:Core/Src/FAT/ff.c **** 		dp->obj.sclust = fs->cdir;			/* Start at the current directory */
3064:Core/Src/FAT/ff.c **** 	} else
3065:Core/Src/FAT/ff.c **** #endif
3066:Core/Src/FAT/ff.c **** 	{										/* With heading separator */
3067:Core/Src/FAT/ff.c **** 		while (IsSeparator(*path)) path++;	/* Strip separators */
3068:Core/Src/FAT/ff.c **** 		dp->obj.sclust = 0;					/* Start from the root directory */
3069:Core/Src/FAT/ff.c **** 	}
3070:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT
3071:Core/Src/FAT/ff.c **** 	dp->obj.n_frag = 0;	/* Invalidate last fragment counter of the object */
3072:Core/Src/FAT/ff.c **** #if FF_FS_RPATH != 0
3073:Core/Src/FAT/ff.c **** 	if (fs->fs_type == FS_EXFAT && dp->obj.sclust) {	/* exFAT: Retrieve the sub-directory's status */
3074:Core/Src/FAT/ff.c **** 		DIR dj;
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 66


3075:Core/Src/FAT/ff.c **** 
3076:Core/Src/FAT/ff.c **** 		dp->obj.c_scl = fs->cdc_scl;
3077:Core/Src/FAT/ff.c **** 		dp->obj.c_size = fs->cdc_size;
3078:Core/Src/FAT/ff.c **** 		dp->obj.c_ofs = fs->cdc_ofs;
3079:Core/Src/FAT/ff.c **** 		res = load_obj_xdir(&dj, &dp->obj);
3080:Core/Src/FAT/ff.c **** 		if (res != FR_OK) return res;
3081:Core/Src/FAT/ff.c **** 		dp->obj.objsize = ld_dword(fs->dirbuf + XDIR_FileSize);
3082:Core/Src/FAT/ff.c **** 		dp->obj.stat = fs->dirbuf[XDIR_GenFlags] & 2;
3083:Core/Src/FAT/ff.c **** 	}
3084:Core/Src/FAT/ff.c **** #endif
3085:Core/Src/FAT/ff.c **** #endif
3086:Core/Src/FAT/ff.c **** 
3087:Core/Src/FAT/ff.c **** 	if ((UINT)*path < ' ') {				/* Null path name is the origin directory itself */
3088:Core/Src/FAT/ff.c **** 		dp->fn[NSFLAG] = NS_NONAME;
3089:Core/Src/FAT/ff.c **** 		res = dir_sdi(dp, 0);
3090:Core/Src/FAT/ff.c **** 
3091:Core/Src/FAT/ff.c **** 	} else {								/* Follow path */
3092:Core/Src/FAT/ff.c **** 		for (;;) {
3093:Core/Src/FAT/ff.c **** 			res = create_name(dp, &path);	/* Get a segment name of the path */
3094:Core/Src/FAT/ff.c **** 			if (res != FR_OK) break;
3095:Core/Src/FAT/ff.c **** 			res = dir_find(dp);				/* Find an object with the segment name */
3096:Core/Src/FAT/ff.c **** 			ns = dp->fn[NSFLAG];
3097:Core/Src/FAT/ff.c **** 			if (res != FR_OK) {				/* Failed to find the object */
3098:Core/Src/FAT/ff.c **** 				if (res == FR_NO_FILE) {	/* Object is not found */
3099:Core/Src/FAT/ff.c **** 					if (FF_FS_RPATH && (ns & NS_DOT)) {	/* If dot entry is not exist, stay there */
3100:Core/Src/FAT/ff.c **** 						if (!(ns & NS_LAST)) continue;	/* Continue to follow if not last segment */
3101:Core/Src/FAT/ff.c **** 						dp->fn[NSFLAG] = NS_NONAME;
3102:Core/Src/FAT/ff.c **** 						res = FR_OK;
3103:Core/Src/FAT/ff.c **** 					} else {							/* Could not find the object */
3104:Core/Src/FAT/ff.c **** 						if (!(ns & NS_LAST)) res = FR_NO_PATH;	/* Adjust error code if not last segment */
3105:Core/Src/FAT/ff.c **** 					}
3106:Core/Src/FAT/ff.c **** 				}
3107:Core/Src/FAT/ff.c **** 				break;
3108:Core/Src/FAT/ff.c **** 			}
3109:Core/Src/FAT/ff.c **** 			if (ns & NS_LAST) break;		/* Last segment matched. Function completed. */
3110:Core/Src/FAT/ff.c **** 			/* Get into the sub-directory */
3111:Core/Src/FAT/ff.c **** 			if (!(dp->obj.attr & AM_DIR)) {	/* It is not a sub-directory and cannot follow */
3112:Core/Src/FAT/ff.c **** 				res = FR_NO_PATH; break;
3113:Core/Src/FAT/ff.c **** 			}
3114:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT
3115:Core/Src/FAT/ff.c **** 			if (fs->fs_type == FS_EXFAT) {	/* Save containing directory information for next dir */
3116:Core/Src/FAT/ff.c **** 				dp->obj.c_scl = dp->obj.sclust;
3117:Core/Src/FAT/ff.c **** 				dp->obj.c_size = ((DWORD)dp->obj.objsize & 0xFFFFFF00) | dp->obj.stat;
3118:Core/Src/FAT/ff.c **** 				dp->obj.c_ofs = dp->blk_ofs;
3119:Core/Src/FAT/ff.c **** 				init_alloc_info(fs, &dp->obj);	/* Open next directory */
3120:Core/Src/FAT/ff.c **** 			} else
3121:Core/Src/FAT/ff.c **** #endif
3122:Core/Src/FAT/ff.c **** 			{
3123:Core/Src/FAT/ff.c **** 				dp->obj.sclust = ld_clust(fs, fs->win + dp->dptr % SS(fs));	/* Open next directory */
3124:Core/Src/FAT/ff.c **** 			}
3125:Core/Src/FAT/ff.c **** 		}
3126:Core/Src/FAT/ff.c **** 	}
3127:Core/Src/FAT/ff.c **** 
3128:Core/Src/FAT/ff.c **** 	return res;
3129:Core/Src/FAT/ff.c **** }
3130:Core/Src/FAT/ff.c **** 
3131:Core/Src/FAT/ff.c **** 
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 67


3132:Core/Src/FAT/ff.c **** 
3133:Core/Src/FAT/ff.c **** 
3134:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
3135:Core/Src/FAT/ff.c **** /* Get logical drive number from path name                               */
3136:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
3137:Core/Src/FAT/ff.c **** 
3138:Core/Src/FAT/ff.c **** static int get_ldnumber (	/* Returns logical drive number (-1:invalid drive number or null pointer)
3139:Core/Src/FAT/ff.c **** 	const TCHAR** path		/* Pointer to pointer to the path name */
3140:Core/Src/FAT/ff.c **** )
3141:Core/Src/FAT/ff.c **** {
 622              		.loc 1 3141 1 is_stmt 1 view -0
 623              		.cfi_startproc
 624              		@ args = 0, pretend = 0, frame = 0
 625              		@ frame_needed = 0, uses_anonymous_args = 0
 626              		@ link register save eliminated.
 627              		.loc 1 3141 1 is_stmt 0 view .LVU181
 628 0000 0146     		mov	r1, r0
3142:Core/Src/FAT/ff.c **** 	const TCHAR *tp;
 629              		.loc 1 3142 2 is_stmt 1 view .LVU182
3143:Core/Src/FAT/ff.c **** 	const TCHAR *tt;
 630              		.loc 1 3143 2 view .LVU183
3144:Core/Src/FAT/ff.c **** 	TCHAR tc;
 631              		.loc 1 3144 2 view .LVU184
3145:Core/Src/FAT/ff.c **** 	int i;
 632              		.loc 1 3145 2 view .LVU185
3146:Core/Src/FAT/ff.c **** 	int vol = -1;
 633              		.loc 1 3146 2 view .LVU186
 634              	.LVL75:
3147:Core/Src/FAT/ff.c **** #if FF_STR_VOLUME_ID		/* Find string volume ID */
3148:Core/Src/FAT/ff.c **** 	const char *sp;
3149:Core/Src/FAT/ff.c **** 	char c;
3150:Core/Src/FAT/ff.c **** #endif
3151:Core/Src/FAT/ff.c **** 
3152:Core/Src/FAT/ff.c **** 	tt = tp = *path;
 635              		.loc 1 3152 2 view .LVU187
 636              		.loc 1 3152 10 is_stmt 0 view .LVU188
 637 0002 0068     		ldr	r0, [r0]
 638              	.LVL76:
3153:Core/Src/FAT/ff.c **** 	if (!tp) return vol;	/* Invalid path name? */
 639              		.loc 1 3153 2 is_stmt 1 view .LVU189
 640              		.loc 1 3153 5 is_stmt 0 view .LVU190
 641 0004 20B3     		cbz	r0, .L46
3152:Core/Src/FAT/ff.c **** 	if (!tp) return vol;	/* Invalid path name? */
 642              		.loc 1 3152 5 view .LVU191
 643 0006 0246     		mov	r2, r0
 644              	.LVL77:
 645              	.L44:
3154:Core/Src/FAT/ff.c **** 	do {					/* Find a colon in the path */
 646              		.loc 1 3154 2 is_stmt 1 discriminator 2 view .LVU192
3155:Core/Src/FAT/ff.c **** 		tc = *tt++;
 647              		.loc 1 3155 3 discriminator 2 view .LVU193
 648              		.loc 1 3155 6 is_stmt 0 discriminator 2 view .LVU194
 649 0008 1378     		ldrb	r3, [r2]	@ zero_extendqisi2
 650 000a 0132     		adds	r2, r2, #1
 651              	.LVL78:
3156:Core/Src/FAT/ff.c **** 	} while (!IsTerminator(tc) && tc != ':');
 652              		.loc 1 3156 10 is_stmt 1 discriminator 2 view .LVU195
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 68


 653              		.loc 1 3156 2 is_stmt 0 discriminator 2 view .LVU196
 654 000c 202B     		cmp	r3, #32
 655 000e 01D9     		bls	.L43
 656              		.loc 1 3156 29 discriminator 1 view .LVU197
 657 0010 3A2B     		cmp	r3, #58
 658 0012 F9D1     		bne	.L44
 659              	.L43:
3157:Core/Src/FAT/ff.c **** 
3158:Core/Src/FAT/ff.c **** 	if (tc == ':') {	/* DOS/Windows style volume ID? */
 660              		.loc 1 3158 2 is_stmt 1 view .LVU198
 661              		.loc 1 3158 5 is_stmt 0 view .LVU199
 662 0014 3A2B     		cmp	r3, #58
 663 0016 01D0     		beq	.L51
3159:Core/Src/FAT/ff.c **** 		i = FF_VOLUMES;
3160:Core/Src/FAT/ff.c **** 		if (IsDigit(*tp) && tp + 2 == tt) {	/* Is there a numeric volume ID + colon? */
3161:Core/Src/FAT/ff.c **** 			i = (int)*tp - '0';	/* Get the LD number */
3162:Core/Src/FAT/ff.c **** 		}
3163:Core/Src/FAT/ff.c **** #if FF_STR_VOLUME_ID == 1	/* Arbitrary string is enabled */
3164:Core/Src/FAT/ff.c **** 		else {
3165:Core/Src/FAT/ff.c **** 			i = 0;
3166:Core/Src/FAT/ff.c **** 			do {
3167:Core/Src/FAT/ff.c **** 				sp = VolumeStr[i]; tp = *path;	/* This string volume ID and path name */
3168:Core/Src/FAT/ff.c **** 				do {	/* Compare the volume ID with path name */
3169:Core/Src/FAT/ff.c **** 					c = *sp++; tc = *tp++;
3170:Core/Src/FAT/ff.c **** 					if (IsLower(c)) c -= 0x20;
3171:Core/Src/FAT/ff.c **** 					if (IsLower(tc)) tc -= 0x20;
3172:Core/Src/FAT/ff.c **** 				} while (c && (TCHAR)c == tc);
3173:Core/Src/FAT/ff.c **** 			} while ((c || tp != tt) && ++i < FF_VOLUMES);	/* Repeat for each id until pattern match */
3174:Core/Src/FAT/ff.c **** 		}
3175:Core/Src/FAT/ff.c **** #endif
3176:Core/Src/FAT/ff.c **** 		if (i < FF_VOLUMES) {	/* If a volume ID is found, get the drive number and strip it */
3177:Core/Src/FAT/ff.c **** 			vol = i;		/* Drive number */
3178:Core/Src/FAT/ff.c **** 			*path = tt;		/* Snip the drive prefix off */
3179:Core/Src/FAT/ff.c **** 		}
3180:Core/Src/FAT/ff.c **** 		return vol;
3181:Core/Src/FAT/ff.c **** 	}
3182:Core/Src/FAT/ff.c **** #if FF_STR_VOLUME_ID == 2		/* Unix style volume ID is enabled */
3183:Core/Src/FAT/ff.c **** 	if (*tp == '/') {			/* Is there a volume ID? */
3184:Core/Src/FAT/ff.c **** 		while (*(tp + 1) == '/') tp++;	/* Skip duplicated separator */
3185:Core/Src/FAT/ff.c **** 		i = 0;
3186:Core/Src/FAT/ff.c **** 		do {
3187:Core/Src/FAT/ff.c **** 			tt = tp; sp = VolumeStr[i]; /* Path name and this string volume ID */
3188:Core/Src/FAT/ff.c **** 			do {	/* Compare the volume ID with path name */
3189:Core/Src/FAT/ff.c **** 				c = *sp++; tc = *(++tt);
3190:Core/Src/FAT/ff.c **** 				if (IsLower(c)) c -= 0x20;
3191:Core/Src/FAT/ff.c **** 				if (IsLower(tc)) tc -= 0x20;
3192:Core/Src/FAT/ff.c **** 			} while (c && (TCHAR)c == tc);
3193:Core/Src/FAT/ff.c **** 		} while ((c || (tc != '/' && !IsTerminator(tc))) && ++i < FF_VOLUMES);	/* Repeat for each ID unti
3194:Core/Src/FAT/ff.c **** 		if (i < FF_VOLUMES) {	/* If a volume ID is found, get the drive number and strip it */
3195:Core/Src/FAT/ff.c **** 			vol = i;		/* Drive number */
3196:Core/Src/FAT/ff.c **** 			*path = tt;		/* Snip the drive prefix off */
3197:Core/Src/FAT/ff.c **** 		}
3198:Core/Src/FAT/ff.c **** 		return vol;
3199:Core/Src/FAT/ff.c **** 	}
3200:Core/Src/FAT/ff.c **** #endif
3201:Core/Src/FAT/ff.c **** 	/* No drive prefix is found */
3202:Core/Src/FAT/ff.c **** #if FF_FS_RPATH != 0
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 69


3203:Core/Src/FAT/ff.c **** 	vol = CurrVol;	/* Default drive is current drive */
3204:Core/Src/FAT/ff.c **** #else
3205:Core/Src/FAT/ff.c **** 	vol = 0;		/* Default drive is 0 */
3206:Core/Src/FAT/ff.c **** #endif
3207:Core/Src/FAT/ff.c **** 	return vol;		/* Return the default drive */
 664              		.loc 1 3207 9 view .LVU200
 665 0018 0020     		movs	r0, #0
 666              	.LVL79:
3208:Core/Src/FAT/ff.c **** }
 667              		.loc 1 3208 1 view .LVU201
 668 001a 7047     		bx	lr
 669              	.LVL80:
 670              	.L51:
3159:Core/Src/FAT/ff.c **** 		i = FF_VOLUMES;
 671              		.loc 1 3159 3 is_stmt 1 view .LVU202
3160:Core/Src/FAT/ff.c **** 			i = (int)*tp - '0';	/* Get the LD number */
 672              		.loc 1 3160 3 view .LVU203
3160:Core/Src/FAT/ff.c **** 			i = (int)*tp - '0';	/* Get the LD number */
 673              		.loc 1 3160 7 is_stmt 0 view .LVU204
 674 001c 0378     		ldrb	r3, [r0]	@ zero_extendqisi2
 675              	.LVL81:
3160:Core/Src/FAT/ff.c **** 			i = (int)*tp - '0';	/* Get the LD number */
 676              		.loc 1 3160 7 view .LVU205
 677 001e A3F1300C 		sub	ip, r3, #48
 678 0022 5FFA8CFC 		uxtb	ip, ip
3160:Core/Src/FAT/ff.c **** 			i = (int)*tp - '0';	/* Get the LD number */
 679              		.loc 1 3160 6 view .LVU206
 680 0026 BCF1090F 		cmp	ip, #9
 681 002a 0ED8     		bhi	.L48
3160:Core/Src/FAT/ff.c **** 			i = (int)*tp - '0';	/* Get the LD number */
 682              		.loc 1 3160 26 discriminator 1 view .LVU207
 683 002c 0230     		adds	r0, r0, #2
 684              	.LVL82:
3160:Core/Src/FAT/ff.c **** 			i = (int)*tp - '0';	/* Get the LD number */
 685              		.loc 1 3160 20 discriminator 1 view .LVU208
 686 002e 9042     		cmp	r0, r2
 687 0030 02D0     		beq	.L52
3146:Core/Src/FAT/ff.c **** #if FF_STR_VOLUME_ID		/* Find string volume ID */
 688              		.loc 1 3146 6 view .LVU209
 689 0032 4FF0FF30 		mov	r0, #-1
 690 0036 7047     		bx	lr
 691              	.L52:
3161:Core/Src/FAT/ff.c **** 		}
 692              		.loc 1 3161 4 is_stmt 1 view .LVU210
3161:Core/Src/FAT/ff.c **** 		}
 693              		.loc 1 3161 6 is_stmt 0 view .LVU211
 694 0038 A3F13000 		sub	r0, r3, #48
 695              	.LVL83:
3176:Core/Src/FAT/ff.c **** 			vol = i;		/* Drive number */
 696              		.loc 1 3176 3 is_stmt 1 view .LVU212
3176:Core/Src/FAT/ff.c **** 			vol = i;		/* Drive number */
 697              		.loc 1 3176 6 is_stmt 0 view .LVU213
 698 003c 0028     		cmp	r0, #0
 699 003e 02DD     		ble	.L53
3146:Core/Src/FAT/ff.c **** #if FF_STR_VOLUME_ID		/* Find string volume ID */
 700              		.loc 1 3146 6 view .LVU214
 701 0040 4FF0FF30 		mov	r0, #-1
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 70


 702              	.LVL84:
3180:Core/Src/FAT/ff.c **** 	}
 703              		.loc 1 3180 3 is_stmt 1 view .LVU215
3180:Core/Src/FAT/ff.c **** 	}
 704              		.loc 1 3180 10 is_stmt 0 view .LVU216
 705 0044 7047     		bx	lr
 706              	.LVL85:
 707              	.L53:
3177:Core/Src/FAT/ff.c **** 			*path = tt;		/* Snip the drive prefix off */
 708              		.loc 1 3177 4 is_stmt 1 view .LVU217
3178:Core/Src/FAT/ff.c **** 		}
 709              		.loc 1 3178 4 view .LVU218
3178:Core/Src/FAT/ff.c **** 		}
 710              		.loc 1 3178 10 is_stmt 0 view .LVU219
 711 0046 0A60     		str	r2, [r1]
 712              	.LVL86:
3178:Core/Src/FAT/ff.c **** 		}
 713              		.loc 1 3178 10 view .LVU220
 714 0048 7047     		bx	lr
 715              	.LVL87:
 716              	.L48:
3146:Core/Src/FAT/ff.c **** #if FF_STR_VOLUME_ID		/* Find string volume ID */
 717              		.loc 1 3146 6 view .LVU221
 718 004a 4FF0FF30 		mov	r0, #-1
 719              	.LVL88:
3146:Core/Src/FAT/ff.c **** #if FF_STR_VOLUME_ID		/* Find string volume ID */
 720              		.loc 1 3146 6 view .LVU222
 721 004e 7047     		bx	lr
 722              	.LVL89:
 723              	.L46:
3153:Core/Src/FAT/ff.c **** 	do {					/* Find a colon in the path */
 724              		.loc 1 3153 18 view .LVU223
 725 0050 4FF0FF30 		mov	r0, #-1
 726              	.LVL90:
3153:Core/Src/FAT/ff.c **** 	do {					/* Find a colon in the path */
 727              		.loc 1 3153 18 view .LVU224
 728 0054 7047     		bx	lr
 729              		.cfi_endproc
 730              	.LFE27:
 732              		.section	.text.validate,"ax",%progbits
 733              		.align	1
 734              		.syntax unified
 735              		.thumb
 736              		.thumb_func
 738              	validate:
 739              	.LVL91:
 740              	.LFB31:
3209:Core/Src/FAT/ff.c **** 
3210:Core/Src/FAT/ff.c **** 
3211:Core/Src/FAT/ff.c **** 
3212:Core/Src/FAT/ff.c **** 
3213:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
3214:Core/Src/FAT/ff.c **** /* GPT support functions                                                 */
3215:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
3216:Core/Src/FAT/ff.c **** 
3217:Core/Src/FAT/ff.c **** #if FF_LBA64
3218:Core/Src/FAT/ff.c **** 
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 71


3219:Core/Src/FAT/ff.c **** /* Calculate CRC32 in byte-by-byte */
3220:Core/Src/FAT/ff.c **** 
3221:Core/Src/FAT/ff.c **** static DWORD crc32 (	/* Returns next CRC value */
3222:Core/Src/FAT/ff.c **** 	DWORD crc,			/* Current CRC value */
3223:Core/Src/FAT/ff.c **** 	BYTE d				/* A byte to be processed */
3224:Core/Src/FAT/ff.c **** )
3225:Core/Src/FAT/ff.c **** {
3226:Core/Src/FAT/ff.c **** 	BYTE b;
3227:Core/Src/FAT/ff.c **** 
3228:Core/Src/FAT/ff.c **** 
3229:Core/Src/FAT/ff.c **** 	for (b = 1; b; b <<= 1) {
3230:Core/Src/FAT/ff.c **** 		crc ^= (d & b) ? 1 : 0;
3231:Core/Src/FAT/ff.c **** 		crc = (crc & 1) ? crc >> 1 ^ 0xEDB88320 : crc >> 1;
3232:Core/Src/FAT/ff.c **** 	}
3233:Core/Src/FAT/ff.c **** 	return crc;
3234:Core/Src/FAT/ff.c **** }
3235:Core/Src/FAT/ff.c **** 
3236:Core/Src/FAT/ff.c **** 
3237:Core/Src/FAT/ff.c **** /* Check validity of GPT header */
3238:Core/Src/FAT/ff.c **** 
3239:Core/Src/FAT/ff.c **** static int test_gpt_header (	/* 0:Invalid, 1:Valid */
3240:Core/Src/FAT/ff.c **** 	const BYTE* gpth			/* Pointer to the GPT header */
3241:Core/Src/FAT/ff.c **** )
3242:Core/Src/FAT/ff.c **** {
3243:Core/Src/FAT/ff.c **** 	UINT i;
3244:Core/Src/FAT/ff.c **** 	DWORD bcc, hlen;
3245:Core/Src/FAT/ff.c **** 
3246:Core/Src/FAT/ff.c **** 
3247:Core/Src/FAT/ff.c **** 	if (memcmp(gpth + GPTH_Sign, "EFI PART" "\0\0\1", 12)) return 0;	/* Check signature and version (1
3248:Core/Src/FAT/ff.c **** 	hlen = ld_dword(gpth + GPTH_Size);						/* Check header size */
3249:Core/Src/FAT/ff.c **** 	if (hlen < 92 || hlen > FF_MIN_SS) return 0;
3250:Core/Src/FAT/ff.c **** 	for (i = 0, bcc = 0xFFFFFFFF; i < hlen; i++) {			/* Check header BCC */
3251:Core/Src/FAT/ff.c **** 		bcc = crc32(bcc, i - GPTH_Bcc < 4 ? 0 : gpth[i]);
3252:Core/Src/FAT/ff.c **** 	}
3253:Core/Src/FAT/ff.c **** 	if (~bcc != ld_dword(gpth + GPTH_Bcc)) return 0;
3254:Core/Src/FAT/ff.c **** 	if (ld_dword(gpth + GPTH_PteSize) != SZ_GPTE) return 0;	/* Table entry size (must be SZ_GPTE bytes
3255:Core/Src/FAT/ff.c **** 	if (ld_dword(gpth + GPTH_PtNum) > 128) return 0;		/* Table size (must be 128 entries or less) */
3256:Core/Src/FAT/ff.c **** 
3257:Core/Src/FAT/ff.c **** 	return 1;
3258:Core/Src/FAT/ff.c **** }
3259:Core/Src/FAT/ff.c **** 
3260:Core/Src/FAT/ff.c **** #if !FF_FS_READONLY && FF_USE_MKFS
3261:Core/Src/FAT/ff.c **** 
3262:Core/Src/FAT/ff.c **** /* Generate random value */
3263:Core/Src/FAT/ff.c **** static DWORD make_rand (
3264:Core/Src/FAT/ff.c **** 	DWORD seed,		/* Seed value */
3265:Core/Src/FAT/ff.c **** 	BYTE *buff,		/* Output buffer */
3266:Core/Src/FAT/ff.c **** 	UINT n			/* Data length */
3267:Core/Src/FAT/ff.c **** )
3268:Core/Src/FAT/ff.c **** {
3269:Core/Src/FAT/ff.c **** 	UINT r;
3270:Core/Src/FAT/ff.c **** 
3271:Core/Src/FAT/ff.c **** 
3272:Core/Src/FAT/ff.c **** 	if (seed == 0) seed = 1;
3273:Core/Src/FAT/ff.c **** 	do {
3274:Core/Src/FAT/ff.c **** 		for (r = 0; r < 8; r++) seed = seed & 1 ? seed >> 1 ^ 0xA3000000 : seed >> 1;	/* Shift 8 bits the
3275:Core/Src/FAT/ff.c **** 		*buff++ = (BYTE)seed;
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 72


3276:Core/Src/FAT/ff.c **** 	} while (--n);
3277:Core/Src/FAT/ff.c **** 	return seed;
3278:Core/Src/FAT/ff.c **** }
3279:Core/Src/FAT/ff.c **** 
3280:Core/Src/FAT/ff.c **** #endif
3281:Core/Src/FAT/ff.c **** #endif
3282:Core/Src/FAT/ff.c **** 
3283:Core/Src/FAT/ff.c **** 
3284:Core/Src/FAT/ff.c **** 
3285:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
3286:Core/Src/FAT/ff.c **** /* Load a sector and check if it is an FAT VBR                           */
3287:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
3288:Core/Src/FAT/ff.c **** 
3289:Core/Src/FAT/ff.c **** /* Check what the sector is */
3290:Core/Src/FAT/ff.c **** 
3291:Core/Src/FAT/ff.c **** static UINT check_fs (	/* 0:FAT/FAT32 VBR, 1:exFAT VBR, 2:Not FAT and valid BS, 3:Not FAT and inval
3292:Core/Src/FAT/ff.c **** 	FATFS* fs,			/* Filesystem object */
3293:Core/Src/FAT/ff.c **** 	LBA_t sect			/* Sector to load and check if it is an FAT-VBR or not */
3294:Core/Src/FAT/ff.c **** )
3295:Core/Src/FAT/ff.c **** {
3296:Core/Src/FAT/ff.c **** 	WORD w, sign;
3297:Core/Src/FAT/ff.c **** 	BYTE b;
3298:Core/Src/FAT/ff.c **** 
3299:Core/Src/FAT/ff.c **** 
3300:Core/Src/FAT/ff.c **** 	fs->wflag = 0; fs->winsect = (LBA_t)0 - 1;		/* Invaidate window */
3301:Core/Src/FAT/ff.c **** 	if (move_window(fs, sect) != FR_OK) return 4;	/* Load the boot sector */
3302:Core/Src/FAT/ff.c **** 	sign = ld_word(fs->win + BS_55AA);
3303:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT
3304:Core/Src/FAT/ff.c **** 	if (sign == 0xAA55 && !memcmp(fs->win + BS_JmpBoot, "\xEB\x76\x90" "EXFAT   ", 11)) return 1;	/* I
3305:Core/Src/FAT/ff.c **** #endif
3306:Core/Src/FAT/ff.c **** 	b = fs->win[BS_JmpBoot];
3307:Core/Src/FAT/ff.c **** 	if (b == 0xEB || b == 0xE9 || b == 0xE8) {	/* Valid JumpBoot code? (short jump, near jump or near 
3308:Core/Src/FAT/ff.c **** 		if (sign == 0xAA55 && !memcmp(fs->win + BS_FilSysType32, "FAT32   ", 8)) {
3309:Core/Src/FAT/ff.c **** 			return 0;	/* It is an FAT32 VBR */
3310:Core/Src/FAT/ff.c **** 		}
3311:Core/Src/FAT/ff.c **** 		/* FAT volumes formatted with early MS-DOS lack BS_55AA and BS_FilSysType, so FAT VBR needs to be
3312:Core/Src/FAT/ff.c **** 		w = ld_word(fs->win + BPB_BytsPerSec);
3313:Core/Src/FAT/ff.c **** 		b = fs->win[BPB_SecPerClus];
3314:Core/Src/FAT/ff.c **** 		if ((w & (w - 1)) == 0 && w >= FF_MIN_SS && w <= FF_MAX_SS	/* Properness of sector size (512-4096
3315:Core/Src/FAT/ff.c **** 			&& b != 0 && (b & (b - 1)) == 0				/* Properness of cluster size (2^n) */
3316:Core/Src/FAT/ff.c **** 			&& ld_word(fs->win + BPB_RsvdSecCnt) != 0	/* Properness of reserved sectors (MNBZ) */
3317:Core/Src/FAT/ff.c **** 			&& (UINT)fs->win[BPB_NumFATs] - 1 <= 1		/* Properness of FATs (1 or 2) */
3318:Core/Src/FAT/ff.c **** 			&& ld_word(fs->win + BPB_RootEntCnt) != 0	/* Properness of root dir entries (MNBZ) */
3319:Core/Src/FAT/ff.c **** 			&& (ld_word(fs->win + BPB_TotSec16) >= 128 || ld_dword(fs->win + BPB_TotSec32) >= 0x10000)	/* Pr
3320:Core/Src/FAT/ff.c **** 			&& ld_word(fs->win + BPB_FATSz16) != 0) {	/* Properness of FAT size (MNBZ) */
3321:Core/Src/FAT/ff.c **** 				return 0;	/* It can be presumed an FAT VBR */
3322:Core/Src/FAT/ff.c **** 		}
3323:Core/Src/FAT/ff.c **** 	}
3324:Core/Src/FAT/ff.c **** 	return sign == 0xAA55 ? 2 : 3;	/* Not an FAT VBR (valid or invalid BS) */
3325:Core/Src/FAT/ff.c **** }
3326:Core/Src/FAT/ff.c **** 
3327:Core/Src/FAT/ff.c **** 
3328:Core/Src/FAT/ff.c **** /* Find an FAT volume */
3329:Core/Src/FAT/ff.c **** /* (It supports only generic partitioning rules, MBR, GPT and SFD) */
3330:Core/Src/FAT/ff.c **** 
3331:Core/Src/FAT/ff.c **** static UINT find_volume (	/* Returns BS status found in the hosting drive */
3332:Core/Src/FAT/ff.c **** 	FATFS* fs,		/* Filesystem object */
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 73


3333:Core/Src/FAT/ff.c **** 	UINT part		/* Partition to fined = 0:find as SFD and partitions, >0:forced partition number */
3334:Core/Src/FAT/ff.c **** )
3335:Core/Src/FAT/ff.c **** {
3336:Core/Src/FAT/ff.c **** 	UINT fmt, i;
3337:Core/Src/FAT/ff.c **** 	DWORD mbr_pt[4];
3338:Core/Src/FAT/ff.c **** 
3339:Core/Src/FAT/ff.c **** 
3340:Core/Src/FAT/ff.c **** 	fmt = check_fs(fs, 0);				/* Load sector 0 and check if it is an FAT VBR as SFD format */
3341:Core/Src/FAT/ff.c **** 	if (fmt != 2 && (fmt >= 3 || part == 0)) return fmt;	/* Returns if it is an FAT VBR as auto scan, 
3342:Core/Src/FAT/ff.c **** 
3343:Core/Src/FAT/ff.c **** 	/* Sector 0 is not an FAT VBR or forced partition number wants a partition */
3344:Core/Src/FAT/ff.c **** 
3345:Core/Src/FAT/ff.c **** #if FF_LBA64
3346:Core/Src/FAT/ff.c **** 	if (fs->win[MBR_Table + PTE_System] == 0xEE) {	/* GPT protective MBR? */
3347:Core/Src/FAT/ff.c **** 		DWORD n_ent, v_ent, ofs;
3348:Core/Src/FAT/ff.c **** 		QWORD pt_lba;
3349:Core/Src/FAT/ff.c **** 
3350:Core/Src/FAT/ff.c **** 		if (move_window(fs, 1) != FR_OK) return 4;	/* Load GPT header sector (next to MBR) */
3351:Core/Src/FAT/ff.c **** 		if (!test_gpt_header(fs->win)) return 3;	/* Check if GPT header is valid */
3352:Core/Src/FAT/ff.c **** 		n_ent = ld_dword(fs->win + GPTH_PtNum);		/* Number of entries */
3353:Core/Src/FAT/ff.c **** 		pt_lba = ld_qword(fs->win + GPTH_PtOfs);	/* Table location */
3354:Core/Src/FAT/ff.c **** 		for (v_ent = i = 0; i < n_ent; i++) {		/* Find FAT partition */
3355:Core/Src/FAT/ff.c **** 			if (move_window(fs, pt_lba + i * SZ_GPTE / SS(fs)) != FR_OK) return 4;	/* PT sector */
3356:Core/Src/FAT/ff.c **** 			ofs = i * SZ_GPTE % SS(fs);												/* Offset in the sector */
3357:Core/Src/FAT/ff.c **** 			if (!memcmp(fs->win + ofs + GPTE_PtGuid, GUID_MS_Basic, 16)) {	/* MS basic data partition? */
3358:Core/Src/FAT/ff.c **** 				v_ent++;
3359:Core/Src/FAT/ff.c **** 				fmt = check_fs(fs, ld_qword(fs->win + ofs + GPTE_FstLba));	/* Load VBR and check status */
3360:Core/Src/FAT/ff.c **** 				if (part == 0 && fmt <= 1) return fmt;			/* Auto search (valid FAT volume found first) */
3361:Core/Src/FAT/ff.c **** 				if (part != 0 && v_ent == part) return fmt;		/* Forced partition order (regardless of it is val
3362:Core/Src/FAT/ff.c **** 			}
3363:Core/Src/FAT/ff.c **** 		}
3364:Core/Src/FAT/ff.c **** 		return 3;	/* Not found */
3365:Core/Src/FAT/ff.c **** 	}
3366:Core/Src/FAT/ff.c **** #endif
3367:Core/Src/FAT/ff.c **** 	if (FF_MULTI_PARTITION && part > 4) return 3;	/* MBR has 4 partitions max */
3368:Core/Src/FAT/ff.c **** 	for (i = 0; i < 4; i++) {		/* Load partition offset in the MBR */
3369:Core/Src/FAT/ff.c **** 		mbr_pt[i] = ld_dword(fs->win + MBR_Table + i * SZ_PTE + PTE_StLba);
3370:Core/Src/FAT/ff.c **** 	}
3371:Core/Src/FAT/ff.c **** 	i = part ? part - 1 : 0;		/* Table index to find first */
3372:Core/Src/FAT/ff.c **** 	do {							/* Find an FAT volume */
3373:Core/Src/FAT/ff.c **** 		fmt = mbr_pt[i] ? check_fs(fs, mbr_pt[i]) : 3;	/* Check if the partition is FAT */
3374:Core/Src/FAT/ff.c **** 	} while (part == 0 && fmt >= 2 && ++i < 4);
3375:Core/Src/FAT/ff.c **** 	return fmt;
3376:Core/Src/FAT/ff.c **** }
3377:Core/Src/FAT/ff.c **** 
3378:Core/Src/FAT/ff.c **** 
3379:Core/Src/FAT/ff.c **** 
3380:Core/Src/FAT/ff.c **** 
3381:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
3382:Core/Src/FAT/ff.c **** /* Determine logical drive number and mount the volume if needed         */
3383:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
3384:Core/Src/FAT/ff.c **** 
3385:Core/Src/FAT/ff.c **** static FRESULT mount_volume (	/* FR_OK(0): successful, !=0: an error occurred */
3386:Core/Src/FAT/ff.c **** 	const TCHAR** path,			/* Pointer to pointer to the path name (drive number) */
3387:Core/Src/FAT/ff.c **** 	FATFS** rfs,				/* Pointer to pointer to the found filesystem object */
3388:Core/Src/FAT/ff.c **** 	BYTE mode					/* Desiered access mode to check write protection */
3389:Core/Src/FAT/ff.c **** )
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 74


3390:Core/Src/FAT/ff.c **** {
3391:Core/Src/FAT/ff.c **** 	int vol;
3392:Core/Src/FAT/ff.c **** 	FATFS *fs;
3393:Core/Src/FAT/ff.c **** 	DSTATUS stat;
3394:Core/Src/FAT/ff.c **** 	LBA_t bsect;
3395:Core/Src/FAT/ff.c **** 	DWORD tsect, sysect, fasize, nclst, szbfat;
3396:Core/Src/FAT/ff.c **** 	WORD nrsv;
3397:Core/Src/FAT/ff.c **** 	UINT fmt;
3398:Core/Src/FAT/ff.c **** 
3399:Core/Src/FAT/ff.c **** 
3400:Core/Src/FAT/ff.c **** 	/* Get logical drive number */
3401:Core/Src/FAT/ff.c **** 	*rfs = 0;
3402:Core/Src/FAT/ff.c **** 	vol = get_ldnumber(path);
3403:Core/Src/FAT/ff.c **** 	if (vol < 0) return FR_INVALID_DRIVE;
3404:Core/Src/FAT/ff.c **** 
3405:Core/Src/FAT/ff.c **** 	/* Check if the filesystem object is valid or not */
3406:Core/Src/FAT/ff.c **** 	fs = FatFs[vol];					/* Get pointer to the filesystem object */
3407:Core/Src/FAT/ff.c **** 	if (!fs) return FR_NOT_ENABLED;		/* Is the filesystem object available? */
3408:Core/Src/FAT/ff.c **** #if FF_FS_REENTRANT
3409:Core/Src/FAT/ff.c **** 	if (!lock_volume(fs, 1)) return FR_TIMEOUT;	/* Lock the volume, and system if needed */
3410:Core/Src/FAT/ff.c **** #endif
3411:Core/Src/FAT/ff.c **** 	*rfs = fs;							/* Return pointer to the filesystem object */
3412:Core/Src/FAT/ff.c **** 
3413:Core/Src/FAT/ff.c **** 	mode &= (BYTE)~FA_READ;				/* Desired access mode, write access or not */
3414:Core/Src/FAT/ff.c **** 	if (fs->fs_type != 0) {				/* If the volume has been mounted */
3415:Core/Src/FAT/ff.c **** 		stat = disk_status(fs->pdrv);
3416:Core/Src/FAT/ff.c **** 		if (!(stat & STA_NOINIT)) {		/* and the physical drive is kept initialized */
3417:Core/Src/FAT/ff.c **** 			if (!FF_FS_READONLY && mode && (stat & STA_PROTECT)) {	/* Check write protection if needed */
3418:Core/Src/FAT/ff.c **** 				return FR_WRITE_PROTECTED;
3419:Core/Src/FAT/ff.c **** 			}
3420:Core/Src/FAT/ff.c **** 			return FR_OK;				/* The filesystem object is already valid */
3421:Core/Src/FAT/ff.c **** 		}
3422:Core/Src/FAT/ff.c **** 	}
3423:Core/Src/FAT/ff.c **** 
3424:Core/Src/FAT/ff.c **** 	/* The filesystem object is not valid. */
3425:Core/Src/FAT/ff.c **** 	/* Following code attempts to mount the volume. (find an FAT volume, analyze the BPB and initializ
3426:Core/Src/FAT/ff.c **** 
3427:Core/Src/FAT/ff.c **** 	fs->fs_type = 0;					/* Invalidate the filesystem object */
3428:Core/Src/FAT/ff.c **** 	stat = disk_initialize(fs->pdrv);	/* Initialize the volume hosting physical drive */
3429:Core/Src/FAT/ff.c **** 	if (stat & STA_NOINIT) { 			/* Check if the initialization succeeded */
3430:Core/Src/FAT/ff.c **** 		return FR_NOT_READY;			/* Failed to initialize due to no medium or hard error */
3431:Core/Src/FAT/ff.c **** 	}
3432:Core/Src/FAT/ff.c **** 	if (!FF_FS_READONLY && mode && (stat & STA_PROTECT)) { /* Check disk write protection if needed */
3433:Core/Src/FAT/ff.c **** 		return FR_WRITE_PROTECTED;
3434:Core/Src/FAT/ff.c **** 	}
3435:Core/Src/FAT/ff.c **** #if FF_MAX_SS != FF_MIN_SS				/* Get sector size (multiple sector size cfg only) */
3436:Core/Src/FAT/ff.c **** 	if (disk_ioctl(fs->pdrv, GET_SECTOR_SIZE, &SS(fs)) != RES_OK) return FR_DISK_ERR;
3437:Core/Src/FAT/ff.c **** 	if (SS(fs) > FF_MAX_SS || SS(fs) < FF_MIN_SS || (SS(fs) & (SS(fs) - 1))) return FR_DISK_ERR;
3438:Core/Src/FAT/ff.c **** #endif
3439:Core/Src/FAT/ff.c **** 
3440:Core/Src/FAT/ff.c **** 	/* Find an FAT volume on the hosting drive */
3441:Core/Src/FAT/ff.c **** 	fmt = find_volume(fs, LD2PT(vol));
3442:Core/Src/FAT/ff.c **** 	if (fmt == 4) return FR_DISK_ERR;		/* An error occurred in the disk I/O layer */
3443:Core/Src/FAT/ff.c **** 	if (fmt >= 2) return FR_NO_FILESYSTEM;	/* No FAT volume is found */
3444:Core/Src/FAT/ff.c **** 	bsect = fs->winsect;					/* Volume offset in the hosting physical drive */
3445:Core/Src/FAT/ff.c **** 
3446:Core/Src/FAT/ff.c **** 	/* An FAT volume is found (bsect). Following code initializes the filesystem object */
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 75


3447:Core/Src/FAT/ff.c **** 
3448:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT
3449:Core/Src/FAT/ff.c **** 	if (fmt == 1) {
3450:Core/Src/FAT/ff.c **** 		QWORD maxlba;
3451:Core/Src/FAT/ff.c **** 		DWORD so, cv, bcl, i;
3452:Core/Src/FAT/ff.c **** 
3453:Core/Src/FAT/ff.c **** 		for (i = BPB_ZeroedEx; i < BPB_ZeroedEx + 53 && fs->win[i] == 0; i++) ;	/* Check zero filler */
3454:Core/Src/FAT/ff.c **** 		if (i < BPB_ZeroedEx + 53) return FR_NO_FILESYSTEM;
3455:Core/Src/FAT/ff.c **** 
3456:Core/Src/FAT/ff.c **** 		if (ld_word(fs->win + BPB_FSVerEx) != 0x100) return FR_NO_FILESYSTEM;	/* Check exFAT version (mus
3457:Core/Src/FAT/ff.c **** 
3458:Core/Src/FAT/ff.c **** 		if (1 << fs->win[BPB_BytsPerSecEx] != SS(fs)) {	/* (BPB_BytsPerSecEx must be equal to the physica
3459:Core/Src/FAT/ff.c **** 			return FR_NO_FILESYSTEM;
3460:Core/Src/FAT/ff.c **** 		}
3461:Core/Src/FAT/ff.c **** 
3462:Core/Src/FAT/ff.c **** 		maxlba = ld_qword(fs->win + BPB_TotSecEx) + bsect;	/* Last LBA of the volume + 1 */
3463:Core/Src/FAT/ff.c **** 		if (!FF_LBA64 && maxlba >= 0x100000000) return FR_NO_FILESYSTEM;	/* (It cannot be accessed in 32-
3464:Core/Src/FAT/ff.c **** 
3465:Core/Src/FAT/ff.c **** 		fs->fsize = ld_dword(fs->win + BPB_FatSzEx);	/* Number of sectors per FAT */
3466:Core/Src/FAT/ff.c **** 
3467:Core/Src/FAT/ff.c **** 		fs->n_fats = fs->win[BPB_NumFATsEx];			/* Number of FATs */
3468:Core/Src/FAT/ff.c **** 		if (fs->n_fats != 1) return FR_NO_FILESYSTEM;	/* (Supports only 1 FAT) */
3469:Core/Src/FAT/ff.c **** 
3470:Core/Src/FAT/ff.c **** 		fs->csize = 1 << fs->win[BPB_SecPerClusEx];		/* Cluster size */
3471:Core/Src/FAT/ff.c **** 		if (fs->csize == 0)	return FR_NO_FILESYSTEM;	/* (Must be 1..32768 sectors) */
3472:Core/Src/FAT/ff.c **** 
3473:Core/Src/FAT/ff.c **** 		nclst = ld_dword(fs->win + BPB_NumClusEx);		/* Number of clusters */
3474:Core/Src/FAT/ff.c **** 		if (nclst > MAX_EXFAT) return FR_NO_FILESYSTEM;	/* (Too many clusters) */
3475:Core/Src/FAT/ff.c **** 		fs->n_fatent = nclst + 2;
3476:Core/Src/FAT/ff.c **** 
3477:Core/Src/FAT/ff.c **** 		/* Boundaries and Limits */
3478:Core/Src/FAT/ff.c **** 		fs->volbase = bsect;
3479:Core/Src/FAT/ff.c **** 		fs->database = bsect + ld_dword(fs->win + BPB_DataOfsEx);
3480:Core/Src/FAT/ff.c **** 		fs->fatbase = bsect + ld_dword(fs->win + BPB_FatOfsEx);
3481:Core/Src/FAT/ff.c **** 		if (maxlba < (QWORD)fs->database + nclst * fs->csize) return FR_NO_FILESYSTEM;	/* (Volume size mu
3482:Core/Src/FAT/ff.c **** 		fs->dirbase = ld_dword(fs->win + BPB_RootClusEx);
3483:Core/Src/FAT/ff.c **** 
3484:Core/Src/FAT/ff.c **** 		/* Get bitmap location and check if it is contiguous (implementation assumption) */
3485:Core/Src/FAT/ff.c **** 		so = i = 0;
3486:Core/Src/FAT/ff.c **** 		for (;;) {	/* Find the bitmap entry in the root directory (in only first cluster) */
3487:Core/Src/FAT/ff.c **** 			if (i == 0) {
3488:Core/Src/FAT/ff.c **** 				if (so >= fs->csize) return FR_NO_FILESYSTEM;	/* Not found? */
3489:Core/Src/FAT/ff.c **** 				if (move_window(fs, clst2sect(fs, (DWORD)fs->dirbase) + so) != FR_OK) return FR_DISK_ERR;
3490:Core/Src/FAT/ff.c **** 				so++;
3491:Core/Src/FAT/ff.c **** 			}
3492:Core/Src/FAT/ff.c **** 			if (fs->win[i] == ET_BITMAP) break;			/* Is it a bitmap entry? */
3493:Core/Src/FAT/ff.c **** 			i = (i + SZDIRE) % SS(fs);	/* Next entry */
3494:Core/Src/FAT/ff.c **** 		}
3495:Core/Src/FAT/ff.c **** 		bcl = ld_dword(fs->win + i + 20);				/* Bitmap cluster */
3496:Core/Src/FAT/ff.c **** 		if (bcl < 2 || bcl >= fs->n_fatent) return FR_NO_FILESYSTEM;	/* (Wrong cluster#) */
3497:Core/Src/FAT/ff.c **** 		fs->bitbase = fs->database + fs->csize * (bcl - 2);	/* Bitmap sector */
3498:Core/Src/FAT/ff.c **** 		for (;;) {	/* Check if bitmap is contiguous */
3499:Core/Src/FAT/ff.c **** 			if (move_window(fs, fs->fatbase + bcl / (SS(fs) / 4)) != FR_OK) return FR_DISK_ERR;
3500:Core/Src/FAT/ff.c **** 			cv = ld_dword(fs->win + bcl % (SS(fs) / 4) * 4);
3501:Core/Src/FAT/ff.c **** 			if (cv == 0xFFFFFFFF) break;				/* Last link? */
3502:Core/Src/FAT/ff.c **** 			if (cv != ++bcl) return FR_NO_FILESYSTEM;	/* Fragmented bitmap? */
3503:Core/Src/FAT/ff.c **** 		}
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 76


3504:Core/Src/FAT/ff.c **** 
3505:Core/Src/FAT/ff.c **** #if !FF_FS_READONLY
3506:Core/Src/FAT/ff.c **** 		fs->last_clst = fs->free_clst = 0xFFFFFFFF;		/* Initialize cluster allocation information */
3507:Core/Src/FAT/ff.c **** #endif
3508:Core/Src/FAT/ff.c **** 		fmt = FS_EXFAT;			/* FAT sub-type */
3509:Core/Src/FAT/ff.c **** 	} else
3510:Core/Src/FAT/ff.c **** #endif	/* FF_FS_EXFAT */
3511:Core/Src/FAT/ff.c **** 	{
3512:Core/Src/FAT/ff.c **** 		if (ld_word(fs->win + BPB_BytsPerSec) != SS(fs)) return FR_NO_FILESYSTEM;	/* (BPB_BytsPerSec must
3513:Core/Src/FAT/ff.c **** 
3514:Core/Src/FAT/ff.c **** 		fasize = ld_word(fs->win + BPB_FATSz16);		/* Number of sectors per FAT */
3515:Core/Src/FAT/ff.c **** 		if (fasize == 0) fasize = ld_dword(fs->win + BPB_FATSz32);
3516:Core/Src/FAT/ff.c **** 		fs->fsize = fasize;
3517:Core/Src/FAT/ff.c **** 
3518:Core/Src/FAT/ff.c **** 		fs->n_fats = fs->win[BPB_NumFATs];				/* Number of FATs */
3519:Core/Src/FAT/ff.c **** 		if (fs->n_fats != 1 && fs->n_fats != 2) return FR_NO_FILESYSTEM;	/* (Must be 1 or 2) */
3520:Core/Src/FAT/ff.c **** 		fasize *= fs->n_fats;							/* Number of sectors for FAT area */
3521:Core/Src/FAT/ff.c **** 
3522:Core/Src/FAT/ff.c **** 		fs->csize = fs->win[BPB_SecPerClus];			/* Cluster size */
3523:Core/Src/FAT/ff.c **** 		if (fs->csize == 0 || (fs->csize & (fs->csize - 1))) return FR_NO_FILESYSTEM;	/* (Must be power o
3524:Core/Src/FAT/ff.c **** 
3525:Core/Src/FAT/ff.c **** 		fs->n_rootdir = ld_word(fs->win + BPB_RootEntCnt);	/* Number of root directory entries */
3526:Core/Src/FAT/ff.c **** 		if (fs->n_rootdir % (SS(fs) / SZDIRE)) return FR_NO_FILESYSTEM;	/* (Must be sector aligned) */
3527:Core/Src/FAT/ff.c **** 
3528:Core/Src/FAT/ff.c **** 		tsect = ld_word(fs->win + BPB_TotSec16);		/* Number of sectors on the volume */
3529:Core/Src/FAT/ff.c **** 		if (tsect == 0) tsect = ld_dword(fs->win + BPB_TotSec32);
3530:Core/Src/FAT/ff.c **** 
3531:Core/Src/FAT/ff.c **** 		nrsv = ld_word(fs->win + BPB_RsvdSecCnt);		/* Number of reserved sectors */
3532:Core/Src/FAT/ff.c **** 		if (nrsv == 0) return FR_NO_FILESYSTEM;			/* (Must not be 0) */
3533:Core/Src/FAT/ff.c **** 
3534:Core/Src/FAT/ff.c **** 		/* Determine the FAT sub type */
3535:Core/Src/FAT/ff.c **** 		sysect = nrsv + fasize + fs->n_rootdir / (SS(fs) / SZDIRE);	/* RSV + FAT + DIR */
3536:Core/Src/FAT/ff.c **** 		if (tsect < sysect) return FR_NO_FILESYSTEM;	/* (Invalid volume size) */
3537:Core/Src/FAT/ff.c **** 		nclst = (tsect - sysect) / fs->csize;			/* Number of clusters */
3538:Core/Src/FAT/ff.c **** 		if (nclst == 0) return FR_NO_FILESYSTEM;		/* (Invalid volume size) */
3539:Core/Src/FAT/ff.c **** 		fmt = 0;
3540:Core/Src/FAT/ff.c **** 		if (nclst <= MAX_FAT32) fmt = FS_FAT32;
3541:Core/Src/FAT/ff.c **** 		if (nclst <= MAX_FAT16) fmt = FS_FAT16;
3542:Core/Src/FAT/ff.c **** 		if (nclst <= MAX_FAT12) fmt = FS_FAT12;
3543:Core/Src/FAT/ff.c **** 		if (fmt == 0) return FR_NO_FILESYSTEM;
3544:Core/Src/FAT/ff.c **** 
3545:Core/Src/FAT/ff.c **** 		/* Boundaries and Limits */
3546:Core/Src/FAT/ff.c **** 		fs->n_fatent = nclst + 2;						/* Number of FAT entries */
3547:Core/Src/FAT/ff.c **** 		fs->volbase = bsect;							/* Volume start sector */
3548:Core/Src/FAT/ff.c **** 		fs->fatbase = bsect + nrsv; 					/* FAT start sector */
3549:Core/Src/FAT/ff.c **** 		fs->database = bsect + sysect;					/* Data start sector */
3550:Core/Src/FAT/ff.c **** 		if (fmt == FS_FAT32) {
3551:Core/Src/FAT/ff.c **** 			if (ld_word(fs->win + BPB_FSVer32) != 0) return FR_NO_FILESYSTEM;	/* (Must be FAT32 revision 0.0
3552:Core/Src/FAT/ff.c **** 			if (fs->n_rootdir != 0) return FR_NO_FILESYSTEM;	/* (BPB_RootEntCnt must be 0) */
3553:Core/Src/FAT/ff.c **** 			fs->dirbase = ld_dword(fs->win + BPB_RootClus32);	/* Root directory start cluster */
3554:Core/Src/FAT/ff.c **** 			szbfat = fs->n_fatent * 4;					/* (Needed FAT size) */
3555:Core/Src/FAT/ff.c **** 		} else {
3556:Core/Src/FAT/ff.c **** 			if (fs->n_rootdir == 0)	return FR_NO_FILESYSTEM;	/* (BPB_RootEntCnt must not be 0) */
3557:Core/Src/FAT/ff.c **** 			fs->dirbase = fs->fatbase + fasize;			/* Root directory start sector */
3558:Core/Src/FAT/ff.c **** 			szbfat = (fmt == FS_FAT16) ?				/* (Needed FAT size) */
3559:Core/Src/FAT/ff.c **** 				fs->n_fatent * 2 : fs->n_fatent * 3 / 2 + (fs->n_fatent & 1);
3560:Core/Src/FAT/ff.c **** 		}
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 77


3561:Core/Src/FAT/ff.c **** 		if (fs->fsize < (szbfat + (SS(fs) - 1)) / SS(fs)) return FR_NO_FILESYSTEM;	/* (BPB_FATSz must not
3562:Core/Src/FAT/ff.c **** 
3563:Core/Src/FAT/ff.c **** #if !FF_FS_READONLY
3564:Core/Src/FAT/ff.c **** 		/* Get FSInfo if available */
3565:Core/Src/FAT/ff.c **** 		fs->last_clst = fs->free_clst = 0xFFFFFFFF;		/* Initialize cluster allocation information */
3566:Core/Src/FAT/ff.c **** 		fs->fsi_flag = 0x80;
3567:Core/Src/FAT/ff.c **** #if (FF_FS_NOFSINFO & 3) != 3
3568:Core/Src/FAT/ff.c **** 		if (fmt == FS_FAT32				/* Allow to update FSInfo only if BPB_FSInfo32 == 1 */
3569:Core/Src/FAT/ff.c **** 			&& ld_word(fs->win + BPB_FSInfo32) == 1
3570:Core/Src/FAT/ff.c **** 			&& move_window(fs, bsect + 1) == FR_OK)
3571:Core/Src/FAT/ff.c **** 		{
3572:Core/Src/FAT/ff.c **** 			fs->fsi_flag = 0;
3573:Core/Src/FAT/ff.c **** 			if (ld_word(fs->win + BS_55AA) == 0xAA55	/* Load FSInfo data if available */
3574:Core/Src/FAT/ff.c **** 				&& ld_dword(fs->win + FSI_LeadSig) == 0x41615252
3575:Core/Src/FAT/ff.c **** 				&& ld_dword(fs->win + FSI_StrucSig) == 0x61417272)
3576:Core/Src/FAT/ff.c **** 			{
3577:Core/Src/FAT/ff.c **** #if (FF_FS_NOFSINFO & 1) == 0
3578:Core/Src/FAT/ff.c **** 				fs->free_clst = ld_dword(fs->win + FSI_Free_Count);
3579:Core/Src/FAT/ff.c **** #endif
3580:Core/Src/FAT/ff.c **** #if (FF_FS_NOFSINFO & 2) == 0
3581:Core/Src/FAT/ff.c **** 				fs->last_clst = ld_dword(fs->win + FSI_Nxt_Free);
3582:Core/Src/FAT/ff.c **** #endif
3583:Core/Src/FAT/ff.c **** 			}
3584:Core/Src/FAT/ff.c **** 		}
3585:Core/Src/FAT/ff.c **** #endif	/* (FF_FS_NOFSINFO & 3) != 3 */
3586:Core/Src/FAT/ff.c **** #endif	/* !FF_FS_READONLY */
3587:Core/Src/FAT/ff.c **** 	}
3588:Core/Src/FAT/ff.c **** 
3589:Core/Src/FAT/ff.c **** 	fs->fs_type = (BYTE)fmt;/* FAT sub-type (the filesystem object gets valid) */
3590:Core/Src/FAT/ff.c **** 	fs->id = ++Fsid;		/* Volume mount ID */
3591:Core/Src/FAT/ff.c **** #if FF_USE_LFN == 1
3592:Core/Src/FAT/ff.c **** 	fs->lfnbuf = LfnBuf;	/* Static LFN working buffer */
3593:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT
3594:Core/Src/FAT/ff.c **** 	fs->dirbuf = DirBuf;	/* Static directory block scratchpad buuffer */
3595:Core/Src/FAT/ff.c **** #endif
3596:Core/Src/FAT/ff.c **** #endif
3597:Core/Src/FAT/ff.c **** #if FF_FS_RPATH != 0
3598:Core/Src/FAT/ff.c **** 	fs->cdir = 0;			/* Initialize current directory */
3599:Core/Src/FAT/ff.c **** #endif
3600:Core/Src/FAT/ff.c **** #if FF_FS_LOCK				/* Clear file lock semaphores */
3601:Core/Src/FAT/ff.c **** 	clear_share(fs);
3602:Core/Src/FAT/ff.c **** #endif
3603:Core/Src/FAT/ff.c **** 	return FR_OK;
3604:Core/Src/FAT/ff.c **** }
3605:Core/Src/FAT/ff.c **** 
3606:Core/Src/FAT/ff.c **** 
3607:Core/Src/FAT/ff.c **** 
3608:Core/Src/FAT/ff.c **** 
3609:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
3610:Core/Src/FAT/ff.c **** /* Check if the file/directory object is valid or not                    */
3611:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
3612:Core/Src/FAT/ff.c **** 
3613:Core/Src/FAT/ff.c **** static FRESULT validate (	/* Returns FR_OK or FR_INVALID_OBJECT */
3614:Core/Src/FAT/ff.c **** 	FFOBJID* obj,			/* Pointer to the FFOBJID, the 1st member in the FIL/DIR structure, to check valid
3615:Core/Src/FAT/ff.c **** 	FATFS** rfs				/* Pointer to pointer to the owner filesystem object to return */
3616:Core/Src/FAT/ff.c **** )
3617:Core/Src/FAT/ff.c **** {
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 78


 741              		.loc 1 3617 1 is_stmt 1 view -0
 742              		.cfi_startproc
 743              		@ args = 0, pretend = 0, frame = 0
 744              		@ frame_needed = 0, uses_anonymous_args = 0
 745              		.loc 1 3617 1 is_stmt 0 view .LVU226
 746 0000 38B5     		push	{r3, r4, r5, lr}
 747              	.LCFI3:
 748              		.cfi_def_cfa_offset 16
 749              		.cfi_offset 3, -16
 750              		.cfi_offset 4, -12
 751              		.cfi_offset 5, -8
 752              		.cfi_offset 14, -4
 753 0002 0D46     		mov	r5, r1
3618:Core/Src/FAT/ff.c **** 	FRESULT res = FR_INVALID_OBJECT;
 754              		.loc 1 3618 2 is_stmt 1 view .LVU227
 755              	.LVL92:
3619:Core/Src/FAT/ff.c **** 
3620:Core/Src/FAT/ff.c **** 
3621:Core/Src/FAT/ff.c **** 	if (obj && obj->fs && obj->fs->fs_type && obj->id == obj->fs->id) {	/* Test if the object is valid
 756              		.loc 1 3621 2 view .LVU228
 757              		.loc 1 3621 5 is_stmt 0 view .LVU229
 758 0004 0446     		mov	r4, r0
 759 0006 98B1     		cbz	r0, .L56
 760              		.loc 1 3621 16 discriminator 1 view .LVU230
 761 0008 0368     		ldr	r3, [r0]
 762              		.loc 1 3621 10 discriminator 1 view .LVU231
 763 000a 9BB1     		cbz	r3, .L57
 764              		.loc 1 3621 31 discriminator 2 view .LVU232
 765 000c 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
 766              		.loc 1 3621 21 discriminator 2 view .LVU233
 767 000e A2B1     		cbz	r2, .L58
 768              		.loc 1 3621 47 discriminator 3 view .LVU234
 769 0010 8188     		ldrh	r1, [r0, #4]
 770              	.LVL93:
 771              		.loc 1 3621 62 discriminator 3 view .LVU235
 772 0012 DA88     		ldrh	r2, [r3, #6]
 773              		.loc 1 3621 41 discriminator 3 view .LVU236
 774 0014 9142     		cmp	r1, r2
 775 0016 03D0     		beq	.L62
3618:Core/Src/FAT/ff.c **** 	FRESULT res = FR_INVALID_OBJECT;
 776              		.loc 1 3618 10 view .LVU237
 777 0018 0920     		movs	r0, #9
 778              	.LVL94:
3622:Core/Src/FAT/ff.c **** #if FF_FS_REENTRANT
3623:Core/Src/FAT/ff.c **** 		if (lock_volume(obj->fs, 0)) {	/* Take a grant to access the volume */
3624:Core/Src/FAT/ff.c **** 			if (!(disk_status(obj->fs->pdrv) & STA_NOINIT)) { /* Test if the hosting phsical drive is kept i
3625:Core/Src/FAT/ff.c **** 				res = FR_OK;
3626:Core/Src/FAT/ff.c **** 			} else {
3627:Core/Src/FAT/ff.c **** 				unlock_volume(obj->fs, FR_OK);	/* Invalidated volume, abort to access */
3628:Core/Src/FAT/ff.c **** 			}
3629:Core/Src/FAT/ff.c **** 		} else {	/* Could not take */
3630:Core/Src/FAT/ff.c **** 			res = FR_TIMEOUT;
3631:Core/Src/FAT/ff.c **** 		}
3632:Core/Src/FAT/ff.c **** #else
3633:Core/Src/FAT/ff.c **** 		if (!(disk_status(obj->fs->pdrv) & STA_NOINIT)) { /* Test if the hosting phsical drive is kept in
3634:Core/Src/FAT/ff.c **** 			res = FR_OK;
3635:Core/Src/FAT/ff.c **** 		}
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 79


3636:Core/Src/FAT/ff.c **** #endif
3637:Core/Src/FAT/ff.c **** 	}
3638:Core/Src/FAT/ff.c **** 	*rfs = (res == FR_OK) ? obj->fs : 0;	/* Return corresponding filesystem object if it is valid */
 779              		.loc 1 3638 34 view .LVU238
 780 001a 0024     		movs	r4, #0
 781              	.LVL95:
 782              	.L55:
 783              		.loc 1 3638 7 discriminator 4 view .LVU239
 784 001c 2C60     		str	r4, [r5]
3639:Core/Src/FAT/ff.c **** 	return res;
 785              		.loc 1 3639 2 is_stmt 1 discriminator 4 view .LVU240
3640:Core/Src/FAT/ff.c **** }
 786              		.loc 1 3640 1 is_stmt 0 discriminator 4 view .LVU241
 787 001e 38BD     		pop	{r3, r4, r5, pc}
 788              	.LVL96:
 789              	.L62:
3633:Core/Src/FAT/ff.c **** 			res = FR_OK;
 790              		.loc 1 3633 3 is_stmt 1 view .LVU242
3633:Core/Src/FAT/ff.c **** 			res = FR_OK;
 791              		.loc 1 3633 9 is_stmt 0 view .LVU243
 792 0020 5878     		ldrb	r0, [r3, #1]	@ zero_extendqisi2
 793              	.LVL97:
3633:Core/Src/FAT/ff.c **** 			res = FR_OK;
 794              		.loc 1 3633 9 view .LVU244
 795 0022 FFF7FEFF 		bl	disk_status
 796              	.LVL98:
3633:Core/Src/FAT/ff.c **** 			res = FR_OK;
 797              		.loc 1 3633 6 view .LVU245
 798 0026 10F00100 		ands	r0, r0, #1
 799 002a 09D1     		bne	.L60
3634:Core/Src/FAT/ff.c **** 		}
 800              		.loc 1 3634 4 is_stmt 1 view .LVU246
 801              	.LVL99:
3638:Core/Src/FAT/ff.c **** 	return res;
 802              		.loc 1 3638 2 view .LVU247
3638:Core/Src/FAT/ff.c **** 	return res;
 803              		.loc 1 3638 34 is_stmt 0 view .LVU248
 804 002c 2468     		ldr	r4, [r4]
 805              	.LVL100:
3638:Core/Src/FAT/ff.c **** 	return res;
 806              		.loc 1 3638 34 view .LVU249
 807 002e F5E7     		b	.L55
 808              	.LVL101:
 809              	.L56:
3618:Core/Src/FAT/ff.c **** 
 810              		.loc 1 3618 10 view .LVU250
 811 0030 0920     		movs	r0, #9
 812              	.LVL102:
3618:Core/Src/FAT/ff.c **** 
 813              		.loc 1 3618 10 view .LVU251
 814 0032 F3E7     		b	.L55
 815              	.LVL103:
 816              	.L57:
3638:Core/Src/FAT/ff.c **** 	return res;
 817              		.loc 1 3638 34 view .LVU252
 818 0034 1C46     		mov	r4, r3
3618:Core/Src/FAT/ff.c **** 
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 80


 819              		.loc 1 3618 10 view .LVU253
 820 0036 0920     		movs	r0, #9
 821              	.LVL104:
3618:Core/Src/FAT/ff.c **** 
 822              		.loc 1 3618 10 view .LVU254
 823 0038 F0E7     		b	.L55
 824              	.LVL105:
 825              	.L58:
3618:Core/Src/FAT/ff.c **** 
 826              		.loc 1 3618 10 view .LVU255
 827 003a 0920     		movs	r0, #9
 828              	.LVL106:
3638:Core/Src/FAT/ff.c **** 	return res;
 829              		.loc 1 3638 34 view .LVU256
 830 003c 0024     		movs	r4, #0
 831              	.LVL107:
3638:Core/Src/FAT/ff.c **** 	return res;
 832              		.loc 1 3638 34 view .LVU257
 833 003e EDE7     		b	.L55
 834              	.LVL108:
 835              	.L60:
3618:Core/Src/FAT/ff.c **** 
 836              		.loc 1 3618 10 view .LVU258
 837 0040 0920     		movs	r0, #9
3638:Core/Src/FAT/ff.c **** 	return res;
 838              		.loc 1 3638 34 view .LVU259
 839 0042 0024     		movs	r4, #0
 840              	.LVL109:
3638:Core/Src/FAT/ff.c **** 	return res;
 841              		.loc 1 3638 34 view .LVU260
 842 0044 EAE7     		b	.L55
 843              		.cfi_endproc
 844              	.LFE31:
 846              		.section	.text.sync_window,"ax",%progbits
 847              		.align	1
 848              		.syntax unified
 849              		.thumb
 850              		.thumb_func
 852              	sync_window:
 853              	.LVL110:
 854              	.LFB6:
1058:Core/Src/FAT/ff.c **** 	FRESULT res = FR_OK;
 855              		.loc 1 1058 1 is_stmt 1 view -0
 856              		.cfi_startproc
 857              		@ args = 0, pretend = 0, frame = 0
 858              		@ frame_needed = 0, uses_anonymous_args = 0
1058:Core/Src/FAT/ff.c **** 	FRESULT res = FR_OK;
 859              		.loc 1 1058 1 is_stmt 0 view .LVU262
 860 0000 70B5     		push	{r4, r5, r6, lr}
 861              	.LCFI4:
 862              		.cfi_def_cfa_offset 16
 863              		.cfi_offset 4, -16
 864              		.cfi_offset 5, -12
 865              		.cfi_offset 6, -8
 866              		.cfi_offset 14, -4
1059:Core/Src/FAT/ff.c **** 
 867              		.loc 1 1059 2 is_stmt 1 view .LVU263
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 81


 868              	.LVL111:
1062:Core/Src/FAT/ff.c **** 		if (disk_write(fs->pdrv, fs->win, fs->winsect, 1) == RES_OK) {	/* Write it back into the volume *
 869              		.loc 1 1062 2 view .LVU264
1062:Core/Src/FAT/ff.c **** 		if (disk_write(fs->pdrv, fs->win, fs->winsect, 1) == RES_OK) {	/* Write it back into the volume *
 870              		.loc 1 1062 8 is_stmt 0 view .LVU265
 871 0002 0579     		ldrb	r5, [r0, #4]	@ zero_extendqisi2
1062:Core/Src/FAT/ff.c **** 		if (disk_write(fs->pdrv, fs->win, fs->winsect, 1) == RES_OK) {	/* Write it back into the volume *
 872              		.loc 1 1062 5 view .LVU266
 873 0004 0DB9     		cbnz	r5, .L67
 874              	.LVL112:
 875              	.L64:
1072:Core/Src/FAT/ff.c **** }
 876              		.loc 1 1072 2 is_stmt 1 view .LVU267
1073:Core/Src/FAT/ff.c **** #endif
 877              		.loc 1 1073 1 is_stmt 0 view .LVU268
 878 0006 2846     		mov	r0, r5
 879 0008 70BD     		pop	{r4, r5, r6, pc}
 880              	.LVL113:
 881              	.L67:
1073:Core/Src/FAT/ff.c **** #endif
 882              		.loc 1 1073 1 view .LVU269
 883 000a 0446     		mov	r4, r0
1063:Core/Src/FAT/ff.c **** 			fs->wflag = 0;	/* Clear window dirty flag */
 884              		.loc 1 1063 3 is_stmt 1 view .LVU270
1063:Core/Src/FAT/ff.c **** 			fs->wflag = 0;	/* Clear window dirty flag */
 885              		.loc 1 1063 30 is_stmt 0 view .LVU271
 886 000c 00F13006 		add	r6, r0, #48
1063:Core/Src/FAT/ff.c **** 			fs->wflag = 0;	/* Clear window dirty flag */
 887              		.loc 1 1063 7 view .LVU272
 888 0010 0123     		movs	r3, #1
 889 0012 C26A     		ldr	r2, [r0, #44]
 890 0014 3146     		mov	r1, r6
 891 0016 4078     		ldrb	r0, [r0, #1]	@ zero_extendqisi2
 892              	.LVL114:
1063:Core/Src/FAT/ff.c **** 			fs->wflag = 0;	/* Clear window dirty flag */
 893              		.loc 1 1063 7 view .LVU273
 894 0018 FFF7FEFF 		bl	disk_write
 895              	.LVL115:
1063:Core/Src/FAT/ff.c **** 			fs->wflag = 0;	/* Clear window dirty flag */
 896              		.loc 1 1063 6 view .LVU274
 897 001c 0546     		mov	r5, r0
 898 001e 88B9     		cbnz	r0, .L65
1064:Core/Src/FAT/ff.c **** 			if (fs->winsect - fs->fatbase < fs->fsize) {	/* Is it in the 1st FAT? */
 899              		.loc 1 1064 4 is_stmt 1 view .LVU275
1064:Core/Src/FAT/ff.c **** 			if (fs->winsect - fs->fatbase < fs->fsize) {	/* Is it in the 1st FAT? */
 900              		.loc 1 1064 14 is_stmt 0 view .LVU276
 901 0020 0023     		movs	r3, #0
 902 0022 2371     		strb	r3, [r4, #4]
1065:Core/Src/FAT/ff.c **** 				if (fs->n_fats == 2) disk_write(fs->pdrv, fs->win, fs->winsect + fs->fsize, 1);	/* Reflect it t
 903              		.loc 1 1065 4 is_stmt 1 view .LVU277
1065:Core/Src/FAT/ff.c **** 				if (fs->n_fats == 2) disk_write(fs->pdrv, fs->win, fs->winsect + fs->fsize, 1);	/* Reflect it t
 904              		.loc 1 1065 10 is_stmt 0 view .LVU278
 905 0024 E16A     		ldr	r1, [r4, #44]
1065:Core/Src/FAT/ff.c **** 				if (fs->n_fats == 2) disk_write(fs->pdrv, fs->win, fs->winsect + fs->fsize, 1);	/* Reflect it t
 906              		.loc 1 1065 24 view .LVU279
 907 0026 236A     		ldr	r3, [r4, #32]
1065:Core/Src/FAT/ff.c **** 				if (fs->n_fats == 2) disk_write(fs->pdrv, fs->win, fs->winsect + fs->fsize, 1);	/* Reflect it t
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 82


 908              		.loc 1 1065 20 view .LVU280
 909 0028 CB1A     		subs	r3, r1, r3
1065:Core/Src/FAT/ff.c **** 				if (fs->n_fats == 2) disk_write(fs->pdrv, fs->win, fs->winsect + fs->fsize, 1);	/* Reflect it t
 910              		.loc 1 1065 38 view .LVU281
 911 002a A269     		ldr	r2, [r4, #24]
1065:Core/Src/FAT/ff.c **** 				if (fs->n_fats == 2) disk_write(fs->pdrv, fs->win, fs->winsect + fs->fsize, 1);	/* Reflect it t
 912              		.loc 1 1065 7 view .LVU282
 913 002c 9342     		cmp	r3, r2
 914 002e EAD2     		bcs	.L64
1066:Core/Src/FAT/ff.c **** 			}
 915              		.loc 1 1066 5 is_stmt 1 view .LVU283
1066:Core/Src/FAT/ff.c **** 			}
 916              		.loc 1 1066 11 is_stmt 0 view .LVU284
 917 0030 E378     		ldrb	r3, [r4, #3]	@ zero_extendqisi2
1066:Core/Src/FAT/ff.c **** 			}
 918              		.loc 1 1066 8 view .LVU285
 919 0032 022B     		cmp	r3, #2
 920 0034 E7D1     		bne	.L64
1066:Core/Src/FAT/ff.c **** 			}
 921              		.loc 1 1066 26 is_stmt 1 discriminator 1 view .LVU286
 922 0036 0123     		movs	r3, #1
 923 0038 0A44     		add	r2, r2, r1
 924 003a 3146     		mov	r1, r6
 925 003c 6078     		ldrb	r0, [r4, #1]	@ zero_extendqisi2
 926 003e FFF7FEFF 		bl	disk_write
 927              	.LVL116:
 928 0042 E0E7     		b	.L64
 929              	.L65:
1069:Core/Src/FAT/ff.c **** 		}
 930              		.loc 1 1069 8 is_stmt 0 view .LVU287
 931 0044 0125     		movs	r5, #1
 932 0046 DEE7     		b	.L64
 933              		.cfi_endproc
 934              	.LFE6:
 936              		.section	.text.move_window,"ax",%progbits
 937              		.align	1
 938              		.syntax unified
 939              		.thumb
 940              		.thumb_func
 942              	move_window:
 943              	.LVL117:
 944              	.LFB7:
1081:Core/Src/FAT/ff.c **** 	FRESULT res = FR_OK;
 945              		.loc 1 1081 1 is_stmt 1 view -0
 946              		.cfi_startproc
 947              		@ args = 0, pretend = 0, frame = 0
 948              		@ frame_needed = 0, uses_anonymous_args = 0
1081:Core/Src/FAT/ff.c **** 	FRESULT res = FR_OK;
 949              		.loc 1 1081 1 is_stmt 0 view .LVU289
 950 0000 70B5     		push	{r4, r5, r6, lr}
 951              	.LCFI5:
 952              		.cfi_def_cfa_offset 16
 953              		.cfi_offset 4, -16
 954              		.cfi_offset 5, -12
 955              		.cfi_offset 6, -8
 956              		.cfi_offset 14, -4
1082:Core/Src/FAT/ff.c **** 
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 83


 957              		.loc 1 1082 2 is_stmt 1 view .LVU290
 958              	.LVL118:
1085:Core/Src/FAT/ff.c **** #if !FF_FS_READONLY
 959              		.loc 1 1085 2 view .LVU291
1085:Core/Src/FAT/ff.c **** #if !FF_FS_READONLY
 960              		.loc 1 1085 16 is_stmt 0 view .LVU292
 961 0002 C36A     		ldr	r3, [r0, #44]
1085:Core/Src/FAT/ff.c **** #if !FF_FS_READONLY
 962              		.loc 1 1085 5 view .LVU293
 963 0004 8B42     		cmp	r3, r1
 964 0006 02D1     		bne	.L74
1082:Core/Src/FAT/ff.c **** 
 965              		.loc 1 1082 10 view .LVU294
 966 0008 0026     		movs	r6, #0
 967              	.LVL119:
 968              	.L69:
1097:Core/Src/FAT/ff.c **** }
 969              		.loc 1 1097 2 is_stmt 1 view .LVU295
1098:Core/Src/FAT/ff.c **** 
 970              		.loc 1 1098 1 is_stmt 0 view .LVU296
 971 000a 3046     		mov	r0, r6
 972 000c 70BD     		pop	{r4, r5, r6, pc}
 973              	.LVL120:
 974              	.L74:
1098:Core/Src/FAT/ff.c **** 
 975              		.loc 1 1098 1 view .LVU297
 976 000e 0446     		mov	r4, r0
 977 0010 0D46     		mov	r5, r1
1087:Core/Src/FAT/ff.c **** #endif
 978              		.loc 1 1087 3 is_stmt 1 view .LVU298
1087:Core/Src/FAT/ff.c **** #endif
 979              		.loc 1 1087 9 is_stmt 0 view .LVU299
 980 0012 FFF7FEFF 		bl	sync_window
 981              	.LVL121:
1089:Core/Src/FAT/ff.c **** 			if (disk_read(fs->pdrv, fs->win, sect, 1) != RES_OK) {
 982              		.loc 1 1089 3 is_stmt 1 view .LVU300
1089:Core/Src/FAT/ff.c **** 			if (disk_read(fs->pdrv, fs->win, sect, 1) != RES_OK) {
 983              		.loc 1 1089 6 is_stmt 0 view .LVU301
 984 0016 0646     		mov	r6, r0
 985 0018 0028     		cmp	r0, #0
 986 001a F6D1     		bne	.L69
1090:Core/Src/FAT/ff.c **** 				sect = (LBA_t)0 - 1;	/* Invalidate window if read data is not valid */
 987              		.loc 1 1090 4 is_stmt 1 view .LVU302
1090:Core/Src/FAT/ff.c **** 				sect = (LBA_t)0 - 1;	/* Invalidate window if read data is not valid */
 988              		.loc 1 1090 8 is_stmt 0 view .LVU303
 989 001c 0123     		movs	r3, #1
 990 001e 2A46     		mov	r2, r5
 991 0020 04F13001 		add	r1, r4, #48
 992 0024 6078     		ldrb	r0, [r4, #1]	@ zero_extendqisi2
 993              	.LVL122:
1090:Core/Src/FAT/ff.c **** 				sect = (LBA_t)0 - 1;	/* Invalidate window if read data is not valid */
 994              		.loc 1 1090 8 view .LVU304
 995 0026 FFF7FEFF 		bl	disk_read
 996              	.LVL123:
1090:Core/Src/FAT/ff.c **** 				sect = (LBA_t)0 - 1;	/* Invalidate window if read data is not valid */
 997              		.loc 1 1090 7 view .LVU305
 998 002a 10B1     		cbz	r0, .L70
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 84


1092:Core/Src/FAT/ff.c **** 			}
 999              		.loc 1 1092 9 view .LVU306
 1000 002c 0126     		movs	r6, #1
1091:Core/Src/FAT/ff.c **** 				res = FR_DISK_ERR;
 1001              		.loc 1 1091 10 view .LVU307
 1002 002e 4FF0FF35 		mov	r5, #-1
 1003              	.LVL124:
 1004              	.L70:
1094:Core/Src/FAT/ff.c **** 		}
 1005              		.loc 1 1094 4 is_stmt 1 view .LVU308
1094:Core/Src/FAT/ff.c **** 		}
 1006              		.loc 1 1094 16 is_stmt 0 view .LVU309
 1007 0032 E562     		str	r5, [r4, #44]
 1008 0034 E9E7     		b	.L69
 1009              		.cfi_endproc
 1010              	.LFE7:
 1012              		.section	.rodata.check_fs.str1.4,"aMS",%progbits,1
 1013              		.align	2
 1014              	.LC0:
 1015 0000 46415433 		.ascii	"FAT32   \000"
 1015      32202020 
 1015      00
 1016              		.section	.text.check_fs,"ax",%progbits
 1017              		.align	1
 1018              		.syntax unified
 1019              		.thumb
 1020              		.thumb_func
 1022              	check_fs:
 1023              	.LVL125:
 1024              	.LFB28:
3295:Core/Src/FAT/ff.c **** 	WORD w, sign;
 1025              		.loc 1 3295 1 is_stmt 1 view -0
 1026              		.cfi_startproc
 1027              		@ args = 0, pretend = 0, frame = 0
 1028              		@ frame_needed = 0, uses_anonymous_args = 0
3295:Core/Src/FAT/ff.c **** 	WORD w, sign;
 1029              		.loc 1 3295 1 is_stmt 0 view .LVU311
 1030 0000 38B5     		push	{r3, r4, r5, lr}
 1031              	.LCFI6:
 1032              		.cfi_def_cfa_offset 16
 1033              		.cfi_offset 3, -16
 1034              		.cfi_offset 4, -12
 1035              		.cfi_offset 5, -8
 1036              		.cfi_offset 14, -4
 1037 0002 0446     		mov	r4, r0
3296:Core/Src/FAT/ff.c **** 	BYTE b;
 1038              		.loc 1 3296 2 is_stmt 1 view .LVU312
3297:Core/Src/FAT/ff.c **** 
 1039              		.loc 1 3297 2 view .LVU313
3300:Core/Src/FAT/ff.c **** 	if (move_window(fs, sect) != FR_OK) return 4;	/* Load the boot sector */
 1040              		.loc 1 3300 2 view .LVU314
3300:Core/Src/FAT/ff.c **** 	if (move_window(fs, sect) != FR_OK) return 4;	/* Load the boot sector */
 1041              		.loc 1 3300 12 is_stmt 0 view .LVU315
 1042 0004 0023     		movs	r3, #0
 1043 0006 0371     		strb	r3, [r0, #4]
3300:Core/Src/FAT/ff.c **** 	if (move_window(fs, sect) != FR_OK) return 4;	/* Load the boot sector */
 1044              		.loc 1 3300 17 is_stmt 1 view .LVU316
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 85


3300:Core/Src/FAT/ff.c **** 	if (move_window(fs, sect) != FR_OK) return 4;	/* Load the boot sector */
 1045              		.loc 1 3300 29 is_stmt 0 view .LVU317
 1046 0008 4FF0FF33 		mov	r3, #-1
 1047 000c C362     		str	r3, [r0, #44]
3301:Core/Src/FAT/ff.c **** 	sign = ld_word(fs->win + BS_55AA);
 1048              		.loc 1 3301 2 is_stmt 1 view .LVU318
3301:Core/Src/FAT/ff.c **** 	sign = ld_word(fs->win + BS_55AA);
 1049              		.loc 1 3301 6 is_stmt 0 view .LVU319
 1050 000e FFF7FEFF 		bl	move_window
 1051              	.LVL126:
3301:Core/Src/FAT/ff.c **** 	sign = ld_word(fs->win + BS_55AA);
 1052              		.loc 1 3301 5 view .LVU320
 1053 0012 0028     		cmp	r0, #0
 1054 0014 5AD1     		bne	.L81
3302:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT
 1055              		.loc 1 3302 2 is_stmt 1 view .LVU321
3302:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT
 1056              		.loc 1 3302 9 is_stmt 0 view .LVU322
 1057 0016 04F22E20 		addw	r0, r4, #558
 1058 001a FFF7FEFF 		bl	ld_word
 1059              	.LVL127:
 1060 001e 0546     		mov	r5, r0
 1061              	.LVL128:
3306:Core/Src/FAT/ff.c **** 	if (b == 0xEB || b == 0xE9 || b == 0xE8) {	/* Valid JumpBoot code? (short jump, near jump or near 
 1062              		.loc 1 3306 2 is_stmt 1 view .LVU323
3306:Core/Src/FAT/ff.c **** 	if (b == 0xEB || b == 0xE9 || b == 0xE8) {	/* Valid JumpBoot code? (short jump, near jump or near 
 1063              		.loc 1 3306 4 is_stmt 0 view .LVU324
 1064 0020 94F83030 		ldrb	r3, [r4, #48]	@ zero_extendqisi2
 1065              	.LVL129:
3307:Core/Src/FAT/ff.c **** 		if (sign == 0xAA55 && !memcmp(fs->win + BS_FilSysType32, "FAT32   ", 8)) {
 1066              		.loc 1 3307 2 is_stmt 1 view .LVU325
3307:Core/Src/FAT/ff.c **** 		if (sign == 0xAA55 && !memcmp(fs->win + BS_FilSysType32, "FAT32   ", 8)) {
 1067              		.loc 1 3307 5 is_stmt 0 view .LVU326
 1068 0024 EB2B     		cmp	r3, #235
 1069 0026 09D0     		beq	.L77
3307:Core/Src/FAT/ff.c **** 		if (sign == 0xAA55 && !memcmp(fs->win + BS_FilSysType32, "FAT32   ", 8)) {
 1070              		.loc 1 3307 16 discriminator 1 view .LVU327
 1071 0028 E92B     		cmp	r3, #233
 1072 002a 07D0     		beq	.L77
3307:Core/Src/FAT/ff.c **** 		if (sign == 0xAA55 && !memcmp(fs->win + BS_FilSysType32, "FAT32   ", 8)) {
 1073              		.loc 1 3307 29 discriminator 2 view .LVU328
 1074 002c E82B     		cmp	r3, #232
 1075 002e 05D0     		beq	.L77
 1076              	.LVL130:
 1077              	.L78:
3324:Core/Src/FAT/ff.c **** }
 1078              		.loc 1 3324 2 is_stmt 1 view .LVU329
3324:Core/Src/FAT/ff.c **** }
 1079              		.loc 1 3324 28 is_stmt 0 view .LVU330
 1080 0030 4AF65523 		movw	r3, #43605
 1081 0034 9D42     		cmp	r5, r3
 1082 0036 47D0     		beq	.L86
 1083 0038 0320     		movs	r0, #3
 1084              	.LVL131:
 1085              	.L75:
3325:Core/Src/FAT/ff.c **** 
 1086              		.loc 1 3325 1 view .LVU331
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 86


 1087 003a 38BD     		pop	{r3, r4, r5, pc}
 1088              	.LVL132:
 1089              	.L77:
3308:Core/Src/FAT/ff.c **** 			return 0;	/* It is an FAT32 VBR */
 1090              		.loc 1 3308 3 is_stmt 1 view .LVU332
3308:Core/Src/FAT/ff.c **** 			return 0;	/* It is an FAT32 VBR */
 1091              		.loc 1 3308 6 is_stmt 0 view .LVU333
 1092 003c 4AF65523 		movw	r3, #43605
 1093              	.LVL133:
3308:Core/Src/FAT/ff.c **** 			return 0;	/* It is an FAT32 VBR */
 1094              		.loc 1 3308 6 view .LVU334
 1095 0040 9D42     		cmp	r5, r3
 1096 0042 37D0     		beq	.L87
 1097              	.LVL134:
 1098              	.L79:
3312:Core/Src/FAT/ff.c **** 		b = fs->win[BPB_SecPerClus];
 1099              		.loc 1 3312 3 is_stmt 1 view .LVU335
3312:Core/Src/FAT/ff.c **** 		b = fs->win[BPB_SecPerClus];
 1100              		.loc 1 3312 7 is_stmt 0 view .LVU336
 1101 0044 04F13B00 		add	r0, r4, #59
 1102 0048 FFF7FEFF 		bl	ld_word
 1103              	.LVL135:
3313:Core/Src/FAT/ff.c **** 		if ((w & (w - 1)) == 0 && w >= FF_MIN_SS && w <= FF_MAX_SS	/* Properness of sector size (512-4096
 1104              		.loc 1 3313 3 is_stmt 1 view .LVU337
3313:Core/Src/FAT/ff.c **** 		if ((w & (w - 1)) == 0 && w >= FF_MIN_SS && w <= FF_MAX_SS	/* Properness of sector size (512-4096
 1105              		.loc 1 3313 5 is_stmt 0 view .LVU338
 1106 004c 94F83D20 		ldrb	r2, [r4, #61]	@ zero_extendqisi2
 1107              	.LVL136:
3314:Core/Src/FAT/ff.c **** 			&& b != 0 && (b & (b - 1)) == 0				/* Properness of cluster size (2^n) */
 1108              		.loc 1 3314 3 is_stmt 1 view .LVU339
3314:Core/Src/FAT/ff.c **** 			&& b != 0 && (b & (b - 1)) == 0				/* Properness of cluster size (2^n) */
 1109              		.loc 1 3314 15 is_stmt 0 view .LVU340
 1110 0050 431E     		subs	r3, r0, #1
3314:Core/Src/FAT/ff.c **** 			&& b != 0 && (b & (b - 1)) == 0				/* Properness of cluster size (2^n) */
 1111              		.loc 1 3314 6 view .LVU341
 1112 0052 1842     		tst	r0, r3
 1113 0054 ECD1     		bne	.L78
3314:Core/Src/FAT/ff.c **** 			&& b != 0 && (b & (b - 1)) == 0				/* Properness of cluster size (2^n) */
 1114              		.loc 1 3314 26 discriminator 1 view .LVU342
 1115 0056 B0F5007F 		cmp	r0, #512
 1116 005a E9D3     		bcc	.L78
3314:Core/Src/FAT/ff.c **** 			&& b != 0 && (b & (b - 1)) == 0				/* Properness of cluster size (2^n) */
 1117              		.loc 1 3314 44 discriminator 2 view .LVU343
 1118 005c E8D8     		bhi	.L78
3315:Core/Src/FAT/ff.c **** 			&& ld_word(fs->win + BPB_RsvdSecCnt) != 0	/* Properness of reserved sectors (MNBZ) */
 1119              		.loc 1 3315 4 view .LVU344
 1120 005e 002A     		cmp	r2, #0
 1121 0060 E6D0     		beq	.L78
3315:Core/Src/FAT/ff.c **** 			&& ld_word(fs->win + BPB_RsvdSecCnt) != 0	/* Properness of reserved sectors (MNBZ) */
 1122              		.loc 1 3315 25 discriminator 1 view .LVU345
 1123 0062 531E     		subs	r3, r2, #1
3315:Core/Src/FAT/ff.c **** 			&& ld_word(fs->win + BPB_RsvdSecCnt) != 0	/* Properness of reserved sectors (MNBZ) */
 1124              		.loc 1 3315 14 discriminator 1 view .LVU346
 1125 0064 1A42     		tst	r2, r3
 1126 0066 E3D1     		bne	.L78
3316:Core/Src/FAT/ff.c **** 			&& (UINT)fs->win[BPB_NumFATs] - 1 <= 1		/* Properness of FATs (1 or 2) */
 1127              		.loc 1 3316 7 view .LVU347
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 87


 1128 0068 04F13E00 		add	r0, r4, #62
 1129              	.LVL137:
3316:Core/Src/FAT/ff.c **** 			&& (UINT)fs->win[BPB_NumFATs] - 1 <= 1		/* Properness of FATs (1 or 2) */
 1130              		.loc 1 3316 7 view .LVU348
 1131 006c FFF7FEFF 		bl	ld_word
 1132              	.LVL138:
3316:Core/Src/FAT/ff.c **** 			&& (UINT)fs->win[BPB_NumFATs] - 1 <= 1		/* Properness of FATs (1 or 2) */
 1133              		.loc 1 3316 4 view .LVU349
 1134 0070 0028     		cmp	r0, #0
 1135 0072 DDD0     		beq	.L78
3317:Core/Src/FAT/ff.c **** 			&& ld_word(fs->win + BPB_RootEntCnt) != 0	/* Properness of root dir entries (MNBZ) */
 1136              		.loc 1 3317 20 view .LVU350
 1137 0074 94F84030 		ldrb	r3, [r4, #64]	@ zero_extendqisi2
3317:Core/Src/FAT/ff.c **** 			&& ld_word(fs->win + BPB_RootEntCnt) != 0	/* Properness of root dir entries (MNBZ) */
 1138              		.loc 1 3317 34 view .LVU351
 1139 0078 013B     		subs	r3, r3, #1
3317:Core/Src/FAT/ff.c **** 			&& ld_word(fs->win + BPB_RootEntCnt) != 0	/* Properness of root dir entries (MNBZ) */
 1140              		.loc 1 3317 4 view .LVU352
 1141 007a 012B     		cmp	r3, #1
 1142 007c D8D8     		bhi	.L78
3318:Core/Src/FAT/ff.c **** 			&& (ld_word(fs->win + BPB_TotSec16) >= 128 || ld_dword(fs->win + BPB_TotSec32) >= 0x10000)	/* Pr
 1143              		.loc 1 3318 7 view .LVU353
 1144 007e 04F14100 		add	r0, r4, #65
 1145 0082 FFF7FEFF 		bl	ld_word
 1146              	.LVL139:
3318:Core/Src/FAT/ff.c **** 			&& (ld_word(fs->win + BPB_TotSec16) >= 128 || ld_dword(fs->win + BPB_TotSec32) >= 0x10000)	/* Pr
 1147              		.loc 1 3318 4 view .LVU354
 1148 0086 0028     		cmp	r0, #0
 1149 0088 D2D0     		beq	.L78
3319:Core/Src/FAT/ff.c **** 			&& ld_word(fs->win + BPB_FATSz16) != 0) {	/* Properness of FAT size (MNBZ) */
 1150              		.loc 1 3319 8 view .LVU355
 1151 008a 04F14300 		add	r0, r4, #67
 1152 008e FFF7FEFF 		bl	ld_word
 1153              	.LVL140:
3319:Core/Src/FAT/ff.c **** 			&& ld_word(fs->win + BPB_FATSz16) != 0) {	/* Properness of FAT size (MNBZ) */
 1154              		.loc 1 3319 4 view .LVU356
 1155 0092 7F28     		cmp	r0, #127
 1156 0094 06D8     		bhi	.L80
3319:Core/Src/FAT/ff.c **** 			&& ld_word(fs->win + BPB_FATSz16) != 0) {	/* Properness of FAT size (MNBZ) */
 1157              		.loc 1 3319 50 discriminator 1 view .LVU357
 1158 0096 04F15000 		add	r0, r4, #80
 1159 009a FFF7FEFF 		bl	ld_dword
 1160              	.LVL141:
3319:Core/Src/FAT/ff.c **** 			&& ld_word(fs->win + BPB_FATSz16) != 0) {	/* Properness of FAT size (MNBZ) */
 1161              		.loc 1 3319 47 discriminator 1 view .LVU358
 1162 009e B0F5803F 		cmp	r0, #65536
 1163 00a2 C5D3     		bcc	.L78
 1164              	.L80:
3320:Core/Src/FAT/ff.c **** 				return 0;	/* It can be presumed an FAT VBR */
 1165              		.loc 1 3320 7 view .LVU359
 1166 00a4 04F14600 		add	r0, r4, #70
 1167 00a8 FFF7FEFF 		bl	ld_word
 1168              	.LVL142:
3320:Core/Src/FAT/ff.c **** 				return 0;	/* It can be presumed an FAT VBR */
 1169              		.loc 1 3320 4 view .LVU360
 1170 00ac 0028     		cmp	r0, #0
 1171 00ae BFD0     		beq	.L78
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 88


3321:Core/Src/FAT/ff.c **** 		}
 1172              		.loc 1 3321 12 view .LVU361
 1173 00b0 0020     		movs	r0, #0
 1174 00b2 C2E7     		b	.L75
 1175              	.LVL143:
 1176              	.L87:
3308:Core/Src/FAT/ff.c **** 			return 0;	/* It is an FAT32 VBR */
 1177              		.loc 1 3308 26 discriminator 1 view .LVU362
 1178 00b4 0822     		movs	r2, #8
 1179 00b6 0649     		ldr	r1, .L88
 1180 00b8 04F18200 		add	r0, r4, #130
 1181 00bc FFF7FEFF 		bl	memcmp
 1182              	.LVL144:
3308:Core/Src/FAT/ff.c **** 			return 0;	/* It is an FAT32 VBR */
 1183              		.loc 1 3308 22 discriminator 1 view .LVU363
 1184 00c0 0028     		cmp	r0, #0
 1185 00c2 BFD1     		bne	.L79
3309:Core/Src/FAT/ff.c **** 		}
 1186              		.loc 1 3309 11 view .LVU364
 1187 00c4 0020     		movs	r0, #0
 1188 00c6 B8E7     		b	.L75
 1189              	.L86:
3324:Core/Src/FAT/ff.c **** }
 1190              		.loc 1 3324 28 view .LVU365
 1191 00c8 0220     		movs	r0, #2
 1192 00ca B6E7     		b	.L75
 1193              	.LVL145:
 1194              	.L81:
3301:Core/Src/FAT/ff.c **** 	sign = ld_word(fs->win + BS_55AA);
 1195              		.loc 1 3301 45 view .LVU366
 1196 00cc 0420     		movs	r0, #4
 1197 00ce B4E7     		b	.L75
 1198              	.L89:
 1199              		.align	2
 1200              	.L88:
 1201 00d0 00000000 		.word	.LC0
 1202              		.cfi_endproc
 1203              	.LFE28:
 1205              		.section	.text.find_volume,"ax",%progbits
 1206              		.align	1
 1207              		.syntax unified
 1208              		.thumb
 1209              		.thumb_func
 1211              	find_volume:
 1212              	.LVL146:
 1213              	.LFB29:
3335:Core/Src/FAT/ff.c **** 	UINT fmt, i;
 1214              		.loc 1 3335 1 is_stmt 1 view -0
 1215              		.cfi_startproc
 1216              		@ args = 0, pretend = 0, frame = 16
 1217              		@ frame_needed = 0, uses_anonymous_args = 0
3335:Core/Src/FAT/ff.c **** 	UINT fmt, i;
 1218              		.loc 1 3335 1 is_stmt 0 view .LVU368
 1219 0000 70B5     		push	{r4, r5, r6, lr}
 1220              	.LCFI7:
 1221              		.cfi_def_cfa_offset 16
 1222              		.cfi_offset 4, -16
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 89


 1223              		.cfi_offset 5, -12
 1224              		.cfi_offset 6, -8
 1225              		.cfi_offset 14, -4
 1226 0002 84B0     		sub	sp, sp, #16
 1227              	.LCFI8:
 1228              		.cfi_def_cfa_offset 32
 1229 0004 0646     		mov	r6, r0
 1230 0006 0D46     		mov	r5, r1
3336:Core/Src/FAT/ff.c **** 	DWORD mbr_pt[4];
 1231              		.loc 1 3336 2 is_stmt 1 view .LVU369
3337:Core/Src/FAT/ff.c **** 
 1232              		.loc 1 3337 2 view .LVU370
3340:Core/Src/FAT/ff.c **** 	if (fmt != 2 && (fmt >= 3 || part == 0)) return fmt;	/* Returns if it is an FAT VBR as auto scan, 
 1233              		.loc 1 3340 2 view .LVU371
3340:Core/Src/FAT/ff.c **** 	if (fmt != 2 && (fmt >= 3 || part == 0)) return fmt;	/* Returns if it is an FAT VBR as auto scan, 
 1234              		.loc 1 3340 8 is_stmt 0 view .LVU372
 1235 0008 0021     		movs	r1, #0
 1236              	.LVL147:
3340:Core/Src/FAT/ff.c **** 	if (fmt != 2 && (fmt >= 3 || part == 0)) return fmt;	/* Returns if it is an FAT VBR as auto scan, 
 1237              		.loc 1 3340 8 view .LVU373
 1238 000a FFF7FEFF 		bl	check_fs
 1239              	.LVL148:
3341:Core/Src/FAT/ff.c **** 
 1240              		.loc 1 3341 2 is_stmt 1 view .LVU374
3341:Core/Src/FAT/ff.c **** 
 1241              		.loc 1 3341 5 is_stmt 0 view .LVU375
 1242 000e 0228     		cmp	r0, #2
 1243 0010 03D0     		beq	.L98
3341:Core/Src/FAT/ff.c **** 
 1244              		.loc 1 3341 15 discriminator 1 view .LVU376
 1245 0012 2BD8     		bhi	.L90
3341:Core/Src/FAT/ff.c **** 
 1246              		.loc 1 3341 28 discriminator 3 view .LVU377
 1247 0014 55B3     		cbz	r5, .L90
 1248 0016 0024     		movs	r4, #0
 1249 0018 00E0     		b	.L93
 1250              	.L98:
 1251 001a 0024     		movs	r4, #0
 1252              	.LVL149:
 1253              	.L93:
3368:Core/Src/FAT/ff.c **** 		mbr_pt[i] = ld_dword(fs->win + MBR_Table + i * SZ_PTE + PTE_StLba);
 1254              		.loc 1 3368 14 is_stmt 1 discriminator 1 view .LVU378
3368:Core/Src/FAT/ff.c **** 		mbr_pt[i] = ld_dword(fs->win + MBR_Table + i * SZ_PTE + PTE_StLba);
 1255              		.loc 1 3368 2 is_stmt 0 discriminator 1 view .LVU379
 1256 001c 032C     		cmp	r4, #3
 1257 001e 0ED8     		bhi	.L102
3369:Core/Src/FAT/ff.c **** 	}
 1258              		.loc 1 3369 3 is_stmt 1 discriminator 3 view .LVU380
3369:Core/Src/FAT/ff.c **** 	}
 1259              		.loc 1 3369 24 is_stmt 0 discriminator 3 view .LVU381
 1260 0020 06F13000 		add	r0, r6, #48
3369:Core/Src/FAT/ff.c **** 	}
 1261              		.loc 1 3369 48 discriminator 3 view .LVU382
 1262 0024 2301     		lsls	r3, r4, #4
3369:Core/Src/FAT/ff.c **** 	}
 1263              		.loc 1 3369 57 discriminator 3 view .LVU383
 1264 0026 03F5E373 		add	r3, r3, #454
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 90


3369:Core/Src/FAT/ff.c **** 	}
 1265              		.loc 1 3369 15 discriminator 3 view .LVU384
 1266 002a 1844     		add	r0, r0, r3
 1267 002c FFF7FEFF 		bl	ld_dword
 1268              	.LVL150:
3369:Core/Src/FAT/ff.c **** 	}
 1269              		.loc 1 3369 13 discriminator 3 view .LVU385
 1270 0030 04AB     		add	r3, sp, #16
 1271 0032 03EB8403 		add	r3, r3, r4, lsl #2
 1272 0036 43F8100C 		str	r0, [r3, #-16]
3368:Core/Src/FAT/ff.c **** 		mbr_pt[i] = ld_dword(fs->win + MBR_Table + i * SZ_PTE + PTE_StLba);
 1273              		.loc 1 3368 21 is_stmt 1 discriminator 3 view .LVU386
3368:Core/Src/FAT/ff.c **** 		mbr_pt[i] = ld_dword(fs->win + MBR_Table + i * SZ_PTE + PTE_StLba);
 1274              		.loc 1 3368 22 is_stmt 0 discriminator 3 view .LVU387
 1275 003a 0134     		adds	r4, r4, #1
 1276              	.LVL151:
3368:Core/Src/FAT/ff.c **** 		mbr_pt[i] = ld_dword(fs->win + MBR_Table + i * SZ_PTE + PTE_StLba);
 1277              		.loc 1 3368 22 discriminator 3 view .LVU388
 1278 003c EEE7     		b	.L93
 1279              	.L102:
3371:Core/Src/FAT/ff.c **** 	do {							/* Find an FAT volume */
 1280              		.loc 1 3371 2 is_stmt 1 view .LVU389
3371:Core/Src/FAT/ff.c **** 	do {							/* Find an FAT volume */
 1281              		.loc 1 3371 22 is_stmt 0 view .LVU390
 1282 003e 0DB1     		cbz	r5, .L99
3371:Core/Src/FAT/ff.c **** 	do {							/* Find an FAT volume */
 1283              		.loc 1 3371 22 discriminator 1 view .LVU391
 1284 0040 6C1E     		subs	r4, r5, #1
 1285              	.LVL152:
3371:Core/Src/FAT/ff.c **** 	do {							/* Find an FAT volume */
 1286              		.loc 1 3371 22 discriminator 1 view .LVU392
 1287 0042 0AE0     		b	.L97
 1288              	.LVL153:
 1289              	.L99:
3371:Core/Src/FAT/ff.c **** 	do {							/* Find an FAT volume */
 1290              		.loc 1 3371 22 view .LVU393
 1291 0044 2C46     		mov	r4, r5
 1292              	.LVL154:
3371:Core/Src/FAT/ff.c **** 	do {							/* Find an FAT volume */
 1293              		.loc 1 3371 22 view .LVU394
 1294 0046 08E0     		b	.L97
 1295              	.LVL155:
 1296              	.L103:
3373:Core/Src/FAT/ff.c **** 	} while (part == 0 && fmt >= 2 && ++i < 4);
 1297              		.loc 1 3373 21 discriminator 1 view .LVU395
 1298 0048 3046     		mov	r0, r6
 1299 004a FFF7FEFF 		bl	check_fs
 1300              	.LVL156:
 1301              	.L96:
3374:Core/Src/FAT/ff.c **** 	return fmt;
 1302              		.loc 1 3374 10 is_stmt 1 discriminator 4 view .LVU396
3374:Core/Src/FAT/ff.c **** 	return fmt;
 1303              		.loc 1 3374 2 is_stmt 0 discriminator 4 view .LVU397
 1304 004e 6DB9     		cbnz	r5, .L90
3374:Core/Src/FAT/ff.c **** 	return fmt;
 1305              		.loc 1 3374 21 discriminator 1 view .LVU398
 1306 0050 0128     		cmp	r0, #1
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 91


 1307 0052 0BD9     		bls	.L90
3374:Core/Src/FAT/ff.c **** 	return fmt;
 1308              		.loc 1 3374 33 discriminator 2 view .LVU399
 1309 0054 0134     		adds	r4, r4, #1
 1310              	.LVL157:
3374:Core/Src/FAT/ff.c **** 	return fmt;
 1311              		.loc 1 3374 33 discriminator 2 view .LVU400
 1312 0056 032C     		cmp	r4, #3
 1313 0058 08D8     		bhi	.L90
 1314              	.LVL158:
 1315              	.L97:
3372:Core/Src/FAT/ff.c **** 		fmt = mbr_pt[i] ? check_fs(fs, mbr_pt[i]) : 3;	/* Check if the partition is FAT */
 1316              		.loc 1 3372 2 is_stmt 1 view .LVU401
3373:Core/Src/FAT/ff.c **** 	} while (part == 0 && fmt >= 2 && ++i < 4);
 1317              		.loc 1 3373 3 view .LVU402
3373:Core/Src/FAT/ff.c **** 	} while (part == 0 && fmt >= 2 && ++i < 4);
 1318              		.loc 1 3373 15 is_stmt 0 view .LVU403
 1319 005a 04AB     		add	r3, sp, #16
 1320 005c 03EB8403 		add	r3, r3, r4, lsl #2
 1321 0060 53F8101C 		ldr	r1, [r3, #-16]
3373:Core/Src/FAT/ff.c **** 	} while (part == 0 && fmt >= 2 && ++i < 4);
 1322              		.loc 1 3373 45 view .LVU404
 1323 0064 0029     		cmp	r1, #0
 1324 0066 EFD1     		bne	.L103
 1325 0068 0320     		movs	r0, #3
 1326 006a F0E7     		b	.L96
 1327              	.LVL159:
 1328              	.L90:
3376:Core/Src/FAT/ff.c **** 
 1329              		.loc 1 3376 1 view .LVU405
 1330 006c 04B0     		add	sp, sp, #16
 1331              	.LCFI9:
 1332              		.cfi_def_cfa_offset 16
 1333              		@ sp needed
 1334 006e 70BD     		pop	{r4, r5, r6, pc}
3376:Core/Src/FAT/ff.c **** 
 1335              		.loc 1 3376 1 view .LVU406
 1336              		.cfi_endproc
 1337              	.LFE29:
 1339              		.section	.text.mount_volume,"ax",%progbits
 1340              		.align	1
 1341              		.syntax unified
 1342              		.thumb
 1343              		.thumb_func
 1345              	mount_volume:
 1346              	.LVL160:
 1347              	.LFB30:
3390:Core/Src/FAT/ff.c **** 	int vol;
 1348              		.loc 1 3390 1 is_stmt 1 view -0
 1349              		.cfi_startproc
 1350              		@ args = 0, pretend = 0, frame = 0
 1351              		@ frame_needed = 0, uses_anonymous_args = 0
3390:Core/Src/FAT/ff.c **** 	int vol;
 1352              		.loc 1 3390 1 is_stmt 0 view .LVU408
 1353 0000 2DE9F84F 		push	{r3, r4, r5, r6, r7, r8, r9, r10, fp, lr}
 1354              	.LCFI10:
 1355              		.cfi_def_cfa_offset 40
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 92


 1356              		.cfi_offset 3, -40
 1357              		.cfi_offset 4, -36
 1358              		.cfi_offset 5, -32
 1359              		.cfi_offset 6, -28
 1360              		.cfi_offset 7, -24
 1361              		.cfi_offset 8, -20
 1362              		.cfi_offset 9, -16
 1363              		.cfi_offset 10, -12
 1364              		.cfi_offset 11, -8
 1365              		.cfi_offset 14, -4
 1366 0004 0D46     		mov	r5, r1
 1367 0006 1646     		mov	r6, r2
3391:Core/Src/FAT/ff.c **** 	FATFS *fs;
 1368              		.loc 1 3391 2 is_stmt 1 view .LVU409
3392:Core/Src/FAT/ff.c **** 	DSTATUS stat;
 1369              		.loc 1 3392 2 view .LVU410
3393:Core/Src/FAT/ff.c **** 	LBA_t bsect;
 1370              		.loc 1 3393 2 view .LVU411
3394:Core/Src/FAT/ff.c **** 	DWORD tsect, sysect, fasize, nclst, szbfat;
 1371              		.loc 1 3394 2 view .LVU412
3395:Core/Src/FAT/ff.c **** 	WORD nrsv;
 1372              		.loc 1 3395 2 view .LVU413
3396:Core/Src/FAT/ff.c **** 	UINT fmt;
 1373              		.loc 1 3396 2 view .LVU414
3397:Core/Src/FAT/ff.c **** 
 1374              		.loc 1 3397 2 view .LVU415
3401:Core/Src/FAT/ff.c **** 	vol = get_ldnumber(path);
 1375              		.loc 1 3401 2 view .LVU416
3401:Core/Src/FAT/ff.c **** 	vol = get_ldnumber(path);
 1376              		.loc 1 3401 7 is_stmt 0 view .LVU417
 1377 0008 0023     		movs	r3, #0
 1378 000a 0B60     		str	r3, [r1]
3402:Core/Src/FAT/ff.c **** 	if (vol < 0) return FR_INVALID_DRIVE;
 1379              		.loc 1 3402 2 is_stmt 1 view .LVU418
3402:Core/Src/FAT/ff.c **** 	if (vol < 0) return FR_INVALID_DRIVE;
 1380              		.loc 1 3402 8 is_stmt 0 view .LVU419
 1381 000c FFF7FEFF 		bl	get_ldnumber
 1382              	.LVL161:
3403:Core/Src/FAT/ff.c **** 
 1383              		.loc 1 3403 2 is_stmt 1 view .LVU420
3403:Core/Src/FAT/ff.c **** 
 1384              		.loc 1 3403 5 is_stmt 0 view .LVU421
 1385 0010 0028     		cmp	r0, #0
3403:Core/Src/FAT/ff.c **** 
 1386              		.loc 1 3403 5 view .LVU422
 1387 0012 C0F21881 		blt	.L117
3406:Core/Src/FAT/ff.c **** 	if (!fs) return FR_NOT_ENABLED;		/* Is the filesystem object available? */
 1388              		.loc 1 3406 2 is_stmt 1 view .LVU423
3406:Core/Src/FAT/ff.c **** 	if (!fs) return FR_NOT_ENABLED;		/* Is the filesystem object available? */
 1389              		.loc 1 3406 5 is_stmt 0 view .LVU424
 1390 0016 9F4B     		ldr	r3, .L144
 1391 0018 53F82040 		ldr	r4, [r3, r0, lsl #2]
 1392              	.LVL162:
3407:Core/Src/FAT/ff.c **** #if FF_FS_REENTRANT
 1393              		.loc 1 3407 2 is_stmt 1 view .LVU425
3407:Core/Src/FAT/ff.c **** #if FF_FS_REENTRANT
 1394              		.loc 1 3407 5 is_stmt 0 view .LVU426
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 93


 1395 001c 002C     		cmp	r4, #0
 1396 001e 00F01681 		beq	.L118
3411:Core/Src/FAT/ff.c **** 
 1397              		.loc 1 3411 2 is_stmt 1 view .LVU427
3411:Core/Src/FAT/ff.c **** 
 1398              		.loc 1 3411 7 is_stmt 0 view .LVU428
 1399 0022 2C60     		str	r4, [r5]
3413:Core/Src/FAT/ff.c **** 	if (fs->fs_type != 0) {				/* If the volume has been mounted */
 1400              		.loc 1 3413 2 is_stmt 1 view .LVU429
3413:Core/Src/FAT/ff.c **** 	if (fs->fs_type != 0) {				/* If the volume has been mounted */
 1401              		.loc 1 3413 7 is_stmt 0 view .LVU430
 1402 0024 06F0FE06 		and	r6, r6, #254
 1403              	.LVL163:
3414:Core/Src/FAT/ff.c **** 		stat = disk_status(fs->pdrv);
 1404              		.loc 1 3414 2 is_stmt 1 view .LVU431
3414:Core/Src/FAT/ff.c **** 		stat = disk_status(fs->pdrv);
 1405              		.loc 1 3414 8 is_stmt 0 view .LVU432
 1406 0028 2378     		ldrb	r3, [r4]	@ zero_extendqisi2
3414:Core/Src/FAT/ff.c **** 		stat = disk_status(fs->pdrv);
 1407              		.loc 1 3414 5 view .LVU433
 1408 002a 73B1     		cbz	r3, .L106
3415:Core/Src/FAT/ff.c **** 		if (!(stat & STA_NOINIT)) {		/* and the physical drive is kept initialized */
 1409              		.loc 1 3415 3 is_stmt 1 view .LVU434
3415:Core/Src/FAT/ff.c **** 		if (!(stat & STA_NOINIT)) {		/* and the physical drive is kept initialized */
 1410              		.loc 1 3415 10 is_stmt 0 view .LVU435
 1411 002c 6078     		ldrb	r0, [r4, #1]	@ zero_extendqisi2
 1412              	.LVL164:
3415:Core/Src/FAT/ff.c **** 		if (!(stat & STA_NOINIT)) {		/* and the physical drive is kept initialized */
 1413              		.loc 1 3415 10 view .LVU436
 1414 002e FFF7FEFF 		bl	disk_status
 1415              	.LVL165:
3416:Core/Src/FAT/ff.c **** 			if (!FF_FS_READONLY && mode && (stat & STA_PROTECT)) {	/* Check write protection if needed */
 1416              		.loc 1 3416 3 is_stmt 1 view .LVU437
3416:Core/Src/FAT/ff.c **** 			if (!FF_FS_READONLY && mode && (stat & STA_PROTECT)) {	/* Check write protection if needed */
 1417              		.loc 1 3416 6 is_stmt 0 view .LVU438
 1418 0032 10F00105 		ands	r5, r0, #1
 1419              	.LVL166:
3416:Core/Src/FAT/ff.c **** 			if (!FF_FS_READONLY && mode && (stat & STA_PROTECT)) {	/* Check write protection if needed */
 1420              		.loc 1 3416 6 view .LVU439
 1421 0036 08D1     		bne	.L106
3417:Core/Src/FAT/ff.c **** 				return FR_WRITE_PROTECTED;
 1422              		.loc 1 3417 4 is_stmt 1 view .LVU440
3417:Core/Src/FAT/ff.c **** 				return FR_WRITE_PROTECTED;
 1423              		.loc 1 3417 7 is_stmt 0 view .LVU441
 1424 0038 002E     		cmp	r6, #0
 1425 003a 00F00581 		beq	.L105
3417:Core/Src/FAT/ff.c **** 				return FR_WRITE_PROTECTED;
 1426              		.loc 1 3417 32 discriminator 1 view .LVU442
 1427 003e 10F0040F 		tst	r0, #4
 1428 0042 00F00181 		beq	.L105
3418:Core/Src/FAT/ff.c **** 			}
 1429              		.loc 1 3418 12 view .LVU443
 1430 0046 0A25     		movs	r5, #10
 1431 0048 FEE0     		b	.L105
 1432              	.LVL167:
 1433              	.L106:
3427:Core/Src/FAT/ff.c **** 	stat = disk_initialize(fs->pdrv);	/* Initialize the volume hosting physical drive */
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 94


 1434              		.loc 1 3427 2 is_stmt 1 view .LVU444
3427:Core/Src/FAT/ff.c **** 	stat = disk_initialize(fs->pdrv);	/* Initialize the volume hosting physical drive */
 1435              		.loc 1 3427 14 is_stmt 0 view .LVU445
 1436 004a 0023     		movs	r3, #0
 1437 004c 2370     		strb	r3, [r4]
3428:Core/Src/FAT/ff.c **** 	if (stat & STA_NOINIT) { 			/* Check if the initialization succeeded */
 1438              		.loc 1 3428 2 is_stmt 1 view .LVU446
3428:Core/Src/FAT/ff.c **** 	if (stat & STA_NOINIT) { 			/* Check if the initialization succeeded */
 1439              		.loc 1 3428 9 is_stmt 0 view .LVU447
 1440 004e 6078     		ldrb	r0, [r4, #1]	@ zero_extendqisi2
 1441 0050 FFF7FEFF 		bl	disk_initialize
 1442              	.LVL168:
3429:Core/Src/FAT/ff.c **** 		return FR_NOT_READY;			/* Failed to initialize due to no medium or hard error */
 1443              		.loc 1 3429 2 is_stmt 1 view .LVU448
3429:Core/Src/FAT/ff.c **** 		return FR_NOT_READY;			/* Failed to initialize due to no medium or hard error */
 1444              		.loc 1 3429 5 is_stmt 0 view .LVU449
 1445 0054 10F00105 		ands	r5, r0, #1
 1446 0058 40F0FB80 		bne	.L120
3432:Core/Src/FAT/ff.c **** 		return FR_WRITE_PROTECTED;
 1447              		.loc 1 3432 2 is_stmt 1 view .LVU450
3432:Core/Src/FAT/ff.c **** 		return FR_WRITE_PROTECTED;
 1448              		.loc 1 3432 5 is_stmt 0 view .LVU451
 1449 005c 1EB1     		cbz	r6, .L107
3432:Core/Src/FAT/ff.c **** 		return FR_WRITE_PROTECTED;
 1450              		.loc 1 3432 30 discriminator 1 view .LVU452
 1451 005e 10F0040F 		tst	r0, #4
 1452 0062 40F0F880 		bne	.L121
 1453              	.L107:
3441:Core/Src/FAT/ff.c **** 	if (fmt == 4) return FR_DISK_ERR;		/* An error occurred in the disk I/O layer */
 1454              		.loc 1 3441 2 is_stmt 1 view .LVU453
3441:Core/Src/FAT/ff.c **** 	if (fmt == 4) return FR_DISK_ERR;		/* An error occurred in the disk I/O layer */
 1455              		.loc 1 3441 8 is_stmt 0 view .LVU454
 1456 0066 0021     		movs	r1, #0
 1457 0068 2046     		mov	r0, r4
 1458              	.LVL169:
3441:Core/Src/FAT/ff.c **** 	if (fmt == 4) return FR_DISK_ERR;		/* An error occurred in the disk I/O layer */
 1459              		.loc 1 3441 8 view .LVU455
 1460 006a FFF7FEFF 		bl	find_volume
 1461              	.LVL170:
3442:Core/Src/FAT/ff.c **** 	if (fmt >= 2) return FR_NO_FILESYSTEM;	/* No FAT volume is found */
 1462              		.loc 1 3442 2 is_stmt 1 view .LVU456
3442:Core/Src/FAT/ff.c **** 	if (fmt >= 2) return FR_NO_FILESYSTEM;	/* No FAT volume is found */
 1463              		.loc 1 3442 5 is_stmt 0 view .LVU457
 1464 006e 0428     		cmp	r0, #4
 1465 0070 00F0F380 		beq	.L122
3443:Core/Src/FAT/ff.c **** 	bsect = fs->winsect;					/* Volume offset in the hosting physical drive */
 1466              		.loc 1 3443 2 is_stmt 1 view .LVU458
3443:Core/Src/FAT/ff.c **** 	bsect = fs->winsect;					/* Volume offset in the hosting physical drive */
 1467              		.loc 1 3443 5 is_stmt 0 view .LVU459
 1468 0074 0128     		cmp	r0, #1
 1469 0076 00F2F280 		bhi	.L123
3444:Core/Src/FAT/ff.c **** 
 1470              		.loc 1 3444 2 is_stmt 1 view .LVU460
3444:Core/Src/FAT/ff.c **** 
 1471              		.loc 1 3444 8 is_stmt 0 view .LVU461
 1472 007a E66A     		ldr	r6, [r4, #44]
 1473              	.LVL171:
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 95


3512:Core/Src/FAT/ff.c **** 
 1474              		.loc 1 3512 3 is_stmt 1 view .LVU462
3512:Core/Src/FAT/ff.c **** 
 1475              		.loc 1 3512 7 is_stmt 0 view .LVU463
 1476 007c 04F13B00 		add	r0, r4, #59
 1477              	.LVL172:
3512:Core/Src/FAT/ff.c **** 
 1478              		.loc 1 3512 7 view .LVU464
 1479 0080 FFF7FEFF 		bl	ld_word
 1480              	.LVL173:
3512:Core/Src/FAT/ff.c **** 
 1481              		.loc 1 3512 6 view .LVU465
 1482 0084 B0F5007F 		cmp	r0, #512
 1483 0088 40F0EB80 		bne	.L124
3514:Core/Src/FAT/ff.c **** 		if (fasize == 0) fasize = ld_dword(fs->win + BPB_FATSz32);
 1484              		.loc 1 3514 3 is_stmt 1 view .LVU466
3514:Core/Src/FAT/ff.c **** 		if (fasize == 0) fasize = ld_dword(fs->win + BPB_FATSz32);
 1485              		.loc 1 3514 12 is_stmt 0 view .LVU467
 1486 008c 04F14600 		add	r0, r4, #70
 1487 0090 FFF7FEFF 		bl	ld_word
 1488              	.LVL174:
3514:Core/Src/FAT/ff.c **** 		if (fasize == 0) fasize = ld_dword(fs->win + BPB_FATSz32);
 1489              		.loc 1 3514 10 view .LVU468
 1490 0094 0746     		mov	r7, r0
 1491              	.LVL175:
3515:Core/Src/FAT/ff.c **** 		fs->fsize = fasize;
 1492              		.loc 1 3515 3 is_stmt 1 view .LVU469
3515:Core/Src/FAT/ff.c **** 		fs->fsize = fasize;
 1493              		.loc 1 3515 6 is_stmt 0 view .LVU470
 1494 0096 20B9     		cbnz	r0, .L108
3515:Core/Src/FAT/ff.c **** 		fs->fsize = fasize;
 1495              		.loc 1 3515 20 is_stmt 1 discriminator 1 view .LVU471
3515:Core/Src/FAT/ff.c **** 		fs->fsize = fasize;
 1496              		.loc 1 3515 29 is_stmt 0 discriminator 1 view .LVU472
 1497 0098 04F15400 		add	r0, r4, #84
 1498              	.LVL176:
3515:Core/Src/FAT/ff.c **** 		fs->fsize = fasize;
 1499              		.loc 1 3515 29 discriminator 1 view .LVU473
 1500 009c FFF7FEFF 		bl	ld_dword
 1501              	.LVL177:
 1502 00a0 0746     		mov	r7, r0
 1503              	.LVL178:
 1504              	.L108:
3516:Core/Src/FAT/ff.c **** 
 1505              		.loc 1 3516 3 is_stmt 1 view .LVU474
3516:Core/Src/FAT/ff.c **** 
 1506              		.loc 1 3516 13 is_stmt 0 view .LVU475
 1507 00a2 A761     		str	r7, [r4, #24]
3518:Core/Src/FAT/ff.c **** 		if (fs->n_fats != 1 && fs->n_fats != 2) return FR_NO_FILESYSTEM;	/* (Must be 1 or 2) */
 1508              		.loc 1 3518 3 is_stmt 1 view .LVU476
3518:Core/Src/FAT/ff.c **** 		if (fs->n_fats != 1 && fs->n_fats != 2) return FR_NO_FILESYSTEM;	/* (Must be 1 or 2) */
 1509              		.loc 1 3518 23 is_stmt 0 view .LVU477
 1510 00a4 94F84020 		ldrb	r2, [r4, #64]	@ zero_extendqisi2
3518:Core/Src/FAT/ff.c **** 		if (fs->n_fats != 1 && fs->n_fats != 2) return FR_NO_FILESYSTEM;	/* (Must be 1 or 2) */
 1511              		.loc 1 3518 14 view .LVU478
 1512 00a8 E270     		strb	r2, [r4, #3]
3519:Core/Src/FAT/ff.c **** 		fasize *= fs->n_fats;							/* Number of sectors for FAT area */
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 96


 1513              		.loc 1 3519 3 is_stmt 1 view .LVU479
3519:Core/Src/FAT/ff.c **** 		fasize *= fs->n_fats;							/* Number of sectors for FAT area */
 1514              		.loc 1 3519 23 is_stmt 0 view .LVU480
 1515 00aa 531E     		subs	r3, r2, #1
 1516 00ac DBB2     		uxtb	r3, r3
3519:Core/Src/FAT/ff.c **** 		fasize *= fs->n_fats;							/* Number of sectors for FAT area */
 1517              		.loc 1 3519 6 view .LVU481
 1518 00ae 012B     		cmp	r3, #1
 1519 00b0 00F2D980 		bhi	.L125
3520:Core/Src/FAT/ff.c **** 
 1520              		.loc 1 3520 3 is_stmt 1 view .LVU482
3520:Core/Src/FAT/ff.c **** 
 1521              		.loc 1 3520 10 is_stmt 0 view .LVU483
 1522 00b4 07FB02F8 		mul	r8, r7, r2
 1523              	.LVL179:
3522:Core/Src/FAT/ff.c **** 		if (fs->csize == 0 || (fs->csize & (fs->csize - 1))) return FR_NO_FILESYSTEM;	/* (Must be power o
 1524              		.loc 1 3522 3 is_stmt 1 view .LVU484
3522:Core/Src/FAT/ff.c **** 		if (fs->csize == 0 || (fs->csize & (fs->csize - 1))) return FR_NO_FILESYSTEM;	/* (Must be power o
 1525              		.loc 1 3522 22 is_stmt 0 view .LVU485
 1526 00b8 94F83D90 		ldrb	r9, [r4, #61]	@ zero_extendqisi2
3522:Core/Src/FAT/ff.c **** 		if (fs->csize == 0 || (fs->csize & (fs->csize - 1))) return FR_NO_FILESYSTEM;	/* (Must be power o
 1527              		.loc 1 3522 13 view .LVU486
 1528 00bc A4F80A90 		strh	r9, [r4, #10]	@ movhi
3523:Core/Src/FAT/ff.c **** 
 1529              		.loc 1 3523 3 is_stmt 1 view .LVU487
3523:Core/Src/FAT/ff.c **** 
 1530              		.loc 1 3523 6 is_stmt 0 view .LVU488
 1531 00c0 B9F1000F 		cmp	r9, #0
 1532 00c4 00F0D180 		beq	.L126
3523:Core/Src/FAT/ff.c **** 
 1533              		.loc 1 3523 49 discriminator 2 view .LVU489
 1534 00c8 09F1FF33 		add	r3, r9, #-1
3523:Core/Src/FAT/ff.c **** 
 1535              		.loc 1 3523 22 discriminator 2 view .LVU490
 1536 00cc 19EA030F 		tst	r9, r3
 1537 00d0 40F0CD80 		bne	.L127
3525:Core/Src/FAT/ff.c **** 		if (fs->n_rootdir % (SS(fs) / SZDIRE)) return FR_NO_FILESYSTEM;	/* (Must be sector aligned) */
 1538              		.loc 1 3525 3 is_stmt 1 view .LVU491
3525:Core/Src/FAT/ff.c **** 		if (fs->n_rootdir % (SS(fs) / SZDIRE)) return FR_NO_FILESYSTEM;	/* (Must be sector aligned) */
 1539              		.loc 1 3525 19 is_stmt 0 view .LVU492
 1540 00d4 04F14100 		add	r0, r4, #65
 1541 00d8 FFF7FEFF 		bl	ld_word
 1542              	.LVL180:
 1543 00dc 8246     		mov	r10, r0
3525:Core/Src/FAT/ff.c **** 		if (fs->n_rootdir % (SS(fs) / SZDIRE)) return FR_NO_FILESYSTEM;	/* (Must be sector aligned) */
 1544              		.loc 1 3525 17 view .LVU493
 1545 00de 2081     		strh	r0, [r4, #8]	@ movhi
3526:Core/Src/FAT/ff.c **** 
 1546              		.loc 1 3526 3 is_stmt 1 view .LVU494
3526:Core/Src/FAT/ff.c **** 
 1547              		.loc 1 3526 6 is_stmt 0 view .LVU495
 1548 00e0 10F00F0F 		tst	r0, #15
 1549 00e4 40F0C580 		bne	.L128
3528:Core/Src/FAT/ff.c **** 		if (tsect == 0) tsect = ld_dword(fs->win + BPB_TotSec32);
 1550              		.loc 1 3528 3 is_stmt 1 view .LVU496
3528:Core/Src/FAT/ff.c **** 		if (tsect == 0) tsect = ld_dword(fs->win + BPB_TotSec32);
 1551              		.loc 1 3528 11 is_stmt 0 view .LVU497
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 97


 1552 00e8 04F14300 		add	r0, r4, #67
 1553 00ec FFF7FEFF 		bl	ld_word
 1554              	.LVL181:
3528:Core/Src/FAT/ff.c **** 		if (tsect == 0) tsect = ld_dword(fs->win + BPB_TotSec32);
 1555              		.loc 1 3528 9 view .LVU498
 1556 00f0 8346     		mov	fp, r0
 1557              	.LVL182:
3529:Core/Src/FAT/ff.c **** 
 1558              		.loc 1 3529 3 is_stmt 1 view .LVU499
3529:Core/Src/FAT/ff.c **** 
 1559              		.loc 1 3529 6 is_stmt 0 view .LVU500
 1560 00f2 20B9     		cbnz	r0, .L109
3529:Core/Src/FAT/ff.c **** 
 1561              		.loc 1 3529 19 is_stmt 1 discriminator 1 view .LVU501
3529:Core/Src/FAT/ff.c **** 
 1562              		.loc 1 3529 27 is_stmt 0 discriminator 1 view .LVU502
 1563 00f4 04F15000 		add	r0, r4, #80
 1564              	.LVL183:
3529:Core/Src/FAT/ff.c **** 
 1565              		.loc 1 3529 27 discriminator 1 view .LVU503
 1566 00f8 FFF7FEFF 		bl	ld_dword
 1567              	.LVL184:
 1568 00fc 8346     		mov	fp, r0
 1569              	.LVL185:
 1570              	.L109:
3531:Core/Src/FAT/ff.c **** 		if (nrsv == 0) return FR_NO_FILESYSTEM;			/* (Must not be 0) */
 1571              		.loc 1 3531 3 is_stmt 1 view .LVU504
3531:Core/Src/FAT/ff.c **** 		if (nrsv == 0) return FR_NO_FILESYSTEM;			/* (Must not be 0) */
 1572              		.loc 1 3531 10 is_stmt 0 view .LVU505
 1573 00fe 04F13E00 		add	r0, r4, #62
 1574              	.LVL186:
3531:Core/Src/FAT/ff.c **** 		if (nrsv == 0) return FR_NO_FILESYSTEM;			/* (Must not be 0) */
 1575              		.loc 1 3531 10 view .LVU506
 1576 0102 FFF7FEFF 		bl	ld_word
 1577              	.LVL187:
3532:Core/Src/FAT/ff.c **** 
 1578              		.loc 1 3532 3 is_stmt 1 view .LVU507
3532:Core/Src/FAT/ff.c **** 
 1579              		.loc 1 3532 6 is_stmt 0 view .LVU508
 1580 0106 0246     		mov	r2, r0
 1581 0108 0028     		cmp	r0, #0
 1582 010a 00F0B480 		beq	.L129
3535:Core/Src/FAT/ff.c **** 		if (tsect < sysect) return FR_NO_FILESYSTEM;	/* (Invalid volume size) */
 1583              		.loc 1 3535 3 is_stmt 1 view .LVU509
3535:Core/Src/FAT/ff.c **** 		if (tsect < sysect) return FR_NO_FILESYSTEM;	/* (Invalid volume size) */
 1584              		.loc 1 3535 17 is_stmt 0 view .LVU510
 1585 010e 00EB0803 		add	r3, r0, r8
3535:Core/Src/FAT/ff.c **** 		if (tsect < sysect) return FR_NO_FILESYSTEM;	/* (Invalid volume size) */
 1586              		.loc 1 3535 10 view .LVU511
 1587 0112 03EB1A13 		add	r3, r3, r10, lsr #4
 1588              	.LVL188:
3536:Core/Src/FAT/ff.c **** 		nclst = (tsect - sysect) / fs->csize;			/* Number of clusters */
 1589              		.loc 1 3536 3 is_stmt 1 view .LVU512
3536:Core/Src/FAT/ff.c **** 		nclst = (tsect - sysect) / fs->csize;			/* Number of clusters */
 1590              		.loc 1 3536 6 is_stmt 0 view .LVU513
 1591 0116 9B45     		cmp	fp, r3
 1592 0118 C0F0AF80 		bcc	.L130
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 98


3537:Core/Src/FAT/ff.c **** 		if (nclst == 0) return FR_NO_FILESYSTEM;		/* (Invalid volume size) */
 1593              		.loc 1 3537 3 is_stmt 1 view .LVU514
3537:Core/Src/FAT/ff.c **** 		if (nclst == 0) return FR_NO_FILESYSTEM;		/* (Invalid volume size) */
 1594              		.loc 1 3537 18 is_stmt 0 view .LVU515
 1595 011c ABEB030B 		sub	fp, fp, r3
 1596              	.LVL189:
3537:Core/Src/FAT/ff.c **** 		if (nclst == 0) return FR_NO_FILESYSTEM;		/* (Invalid volume size) */
 1597              		.loc 1 3537 9 view .LVU516
 1598 0120 BBFBF9F1 		udiv	r1, fp, r9
 1599              	.LVL190:
3538:Core/Src/FAT/ff.c **** 		fmt = 0;
 1600              		.loc 1 3538 3 is_stmt 1 view .LVU517
3538:Core/Src/FAT/ff.c **** 		fmt = 0;
 1601              		.loc 1 3538 6 is_stmt 0 view .LVU518
 1602 0124 CB45     		cmp	fp, r9
 1603 0126 C0F0AA80 		bcc	.L131
3539:Core/Src/FAT/ff.c **** 		if (nclst <= MAX_FAT32) fmt = FS_FAT32;
 1604              		.loc 1 3539 3 is_stmt 1 view .LVU519
 1605              	.LVL191:
3540:Core/Src/FAT/ff.c **** 		if (nclst <= MAX_FAT16) fmt = FS_FAT16;
 1606              		.loc 1 3540 3 view .LVU520
3540:Core/Src/FAT/ff.c **** 		if (nclst <= MAX_FAT16) fmt = FS_FAT16;
 1607              		.loc 1 3540 6 is_stmt 0 view .LVU521
 1608 012a 5B48     		ldr	r0, .L144+4
 1609              	.LVL192:
3540:Core/Src/FAT/ff.c **** 		if (nclst <= MAX_FAT16) fmt = FS_FAT16;
 1610              		.loc 1 3540 6 view .LVU522
 1611 012c 8142     		cmp	r1, r0
 1612 012e 10D9     		bls	.L132
3539:Core/Src/FAT/ff.c **** 		if (nclst <= MAX_FAT32) fmt = FS_FAT32;
 1613              		.loc 1 3539 7 view .LVU523
 1614 0130 4FF0000B 		mov	fp, #0
 1615              	.L110:
 1616              	.LVL193:
3541:Core/Src/FAT/ff.c **** 		if (nclst <= MAX_FAT12) fmt = FS_FAT12;
 1617              		.loc 1 3541 3 is_stmt 1 view .LVU524
3541:Core/Src/FAT/ff.c **** 		if (nclst <= MAX_FAT12) fmt = FS_FAT12;
 1618              		.loc 1 3541 6 is_stmt 0 view .LVU525
 1619 0134 4FF6F570 		movw	r0, #65525
 1620 0138 8142     		cmp	r1, r0
 1621 013a 01D8     		bhi	.L111
3541:Core/Src/FAT/ff.c **** 		if (nclst <= MAX_FAT12) fmt = FS_FAT12;
 1622              		.loc 1 3541 31 view .LVU526
 1623 013c 4FF0020B 		mov	fp, #2
 1624              	.LVL194:
 1625              	.L111:
3542:Core/Src/FAT/ff.c **** 		if (fmt == 0) return FR_NO_FILESYSTEM;
 1626              		.loc 1 3542 3 is_stmt 1 view .LVU527
3542:Core/Src/FAT/ff.c **** 		if (fmt == 0) return FR_NO_FILESYSTEM;
 1627              		.loc 1 3542 6 is_stmt 0 view .LVU528
 1628 0140 40F6F570 		movw	r0, #4085
 1629 0144 8142     		cmp	r1, r0
 1630 0146 07D9     		bls	.L134
3543:Core/Src/FAT/ff.c **** 
 1631              		.loc 1 3543 3 is_stmt 1 view .LVU529
3543:Core/Src/FAT/ff.c **** 
 1632              		.loc 1 3543 6 is_stmt 0 view .LVU530
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 99


 1633 0148 BBF1000F 		cmp	fp, #0
 1634 014c 06D1     		bne	.L112
3543:Core/Src/FAT/ff.c **** 
 1635              		.loc 1 3543 24 view .LVU531
 1636 014e 0D25     		movs	r5, #13
 1637 0150 7AE0     		b	.L105
 1638              	.LVL195:
 1639              	.L132:
3540:Core/Src/FAT/ff.c **** 		if (nclst <= MAX_FAT16) fmt = FS_FAT16;
 1640              		.loc 1 3540 31 view .LVU532
 1641 0152 4FF0030B 		mov	fp, #3
 1642 0156 EDE7     		b	.L110
 1643              	.LVL196:
 1644              	.L134:
3542:Core/Src/FAT/ff.c **** 		if (fmt == 0) return FR_NO_FILESYSTEM;
 1645              		.loc 1 3542 31 view .LVU533
 1646 0158 4FF0010B 		mov	fp, #1
 1647              	.LVL197:
 1648              	.L112:
3546:Core/Src/FAT/ff.c **** 		fs->volbase = bsect;							/* Volume start sector */
 1649              		.loc 1 3546 3 is_stmt 1 view .LVU534
3546:Core/Src/FAT/ff.c **** 		fs->volbase = bsect;							/* Volume start sector */
 1650              		.loc 1 3546 24 is_stmt 0 view .LVU535
 1651 015c 01F10209 		add	r9, r1, #2
3546:Core/Src/FAT/ff.c **** 		fs->volbase = bsect;							/* Volume start sector */
 1652              		.loc 1 3546 16 view .LVU536
 1653 0160 C4F81490 		str	r9, [r4, #20]
3547:Core/Src/FAT/ff.c **** 		fs->fatbase = bsect + nrsv; 					/* FAT start sector */
 1654              		.loc 1 3547 3 is_stmt 1 view .LVU537
3547:Core/Src/FAT/ff.c **** 		fs->fatbase = bsect + nrsv; 					/* FAT start sector */
 1655              		.loc 1 3547 15 is_stmt 0 view .LVU538
 1656 0164 E661     		str	r6, [r4, #28]
3548:Core/Src/FAT/ff.c **** 		fs->database = bsect + sysect;					/* Data start sector */
 1657              		.loc 1 3548 3 is_stmt 1 view .LVU539
3548:Core/Src/FAT/ff.c **** 		fs->database = bsect + sysect;					/* Data start sector */
 1658              		.loc 1 3548 23 is_stmt 0 view .LVU540
 1659 0166 3244     		add	r2, r2, r6
3548:Core/Src/FAT/ff.c **** 		fs->database = bsect + sysect;					/* Data start sector */
 1660              		.loc 1 3548 15 view .LVU541
 1661 0168 2262     		str	r2, [r4, #32]
3549:Core/Src/FAT/ff.c **** 		if (fmt == FS_FAT32) {
 1662              		.loc 1 3549 3 is_stmt 1 view .LVU542
3549:Core/Src/FAT/ff.c **** 		if (fmt == FS_FAT32) {
 1663              		.loc 1 3549 24 is_stmt 0 view .LVU543
 1664 016a 3344     		add	r3, r3, r6
 1665              	.LVL198:
3549:Core/Src/FAT/ff.c **** 		if (fmt == FS_FAT32) {
 1666              		.loc 1 3549 16 view .LVU544
 1667 016c A362     		str	r3, [r4, #40]
3550:Core/Src/FAT/ff.c **** 			if (ld_word(fs->win + BPB_FSVer32) != 0) return FR_NO_FILESYSTEM;	/* (Must be FAT32 revision 0.0
 1668              		.loc 1 3550 3 is_stmt 1 view .LVU545
3550:Core/Src/FAT/ff.c **** 			if (ld_word(fs->win + BPB_FSVer32) != 0) return FR_NO_FILESYSTEM;	/* (Must be FAT32 revision 0.0
 1669              		.loc 1 3550 6 is_stmt 0 view .LVU546
 1670 016e BBF1030F 		cmp	fp, #3
 1671 0172 25D0     		beq	.L141
3556:Core/Src/FAT/ff.c **** 			fs->dirbase = fs->fatbase + fasize;			/* Root directory start sector */
 1672              		.loc 1 3556 4 is_stmt 1 view .LVU547
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 100


3556:Core/Src/FAT/ff.c **** 			fs->dirbase = fs->fatbase + fasize;			/* Root directory start sector */
 1673              		.loc 1 3556 7 is_stmt 0 view .LVU548
 1674 0174 BAF1000F 		cmp	r10, #0
 1675 0178 00F08780 		beq	.L138
3557:Core/Src/FAT/ff.c **** 			szbfat = (fmt == FS_FAT16) ?				/* (Needed FAT size) */
 1676              		.loc 1 3557 4 is_stmt 1 view .LVU549
3557:Core/Src/FAT/ff.c **** 			szbfat = (fmt == FS_FAT16) ?				/* (Needed FAT size) */
 1677              		.loc 1 3557 30 is_stmt 0 view .LVU550
 1678 017c 4244     		add	r2, r2, r8
3557:Core/Src/FAT/ff.c **** 			szbfat = (fmt == FS_FAT16) ?				/* (Needed FAT size) */
 1679              		.loc 1 3557 16 view .LVU551
 1680 017e 6262     		str	r2, [r4, #36]
3558:Core/Src/FAT/ff.c **** 				fs->n_fatent * 2 : fs->n_fatent * 3 / 2 + (fs->n_fatent & 1);
 1681              		.loc 1 3558 4 is_stmt 1 view .LVU552
3559:Core/Src/FAT/ff.c **** 		}
 1682              		.loc 1 3559 22 is_stmt 0 view .LVU553
 1683 0180 BBF1020F 		cmp	fp, #2
 1684 0184 2DD0     		beq	.L142
3559:Core/Src/FAT/ff.c **** 		}
 1685              		.loc 1 3559 37 discriminator 2 view .LVU554
 1686 0186 09EB4903 		add	r3, r9, r9, lsl #1
3559:Core/Src/FAT/ff.c **** 		}
 1687              		.loc 1 3559 61 discriminator 2 view .LVU555
 1688 018a 09F00109 		and	r9, r9, #1
3559:Core/Src/FAT/ff.c **** 		}
 1689              		.loc 1 3559 22 discriminator 2 view .LVU556
 1690 018e 09EB5309 		add	r9, r9, r3, lsr #1
 1691              	.LVL199:
 1692              	.L114:
3561:Core/Src/FAT/ff.c **** 
 1693              		.loc 1 3561 3 is_stmt 1 view .LVU557
3561:Core/Src/FAT/ff.c **** 
 1694              		.loc 1 3561 27 is_stmt 0 view .LVU558
 1695 0192 09F2FF13 		addw	r3, r9, #511
3561:Core/Src/FAT/ff.c **** 
 1696              		.loc 1 3561 6 view .LVU559
 1697 0196 B7EB532F 		cmp	r7, r3, lsr #9
 1698 019a 78D3     		bcc	.L139
3565:Core/Src/FAT/ff.c **** 		fs->fsi_flag = 0x80;
 1699              		.loc 1 3565 3 is_stmt 1 view .LVU560
3565:Core/Src/FAT/ff.c **** 		fs->fsi_flag = 0x80;
 1700              		.loc 1 3565 33 is_stmt 0 view .LVU561
 1701 019c 4FF0FF33 		mov	r3, #-1
 1702 01a0 2361     		str	r3, [r4, #16]
3565:Core/Src/FAT/ff.c **** 		fs->fsi_flag = 0x80;
 1703              		.loc 1 3565 17 view .LVU562
 1704 01a2 E360     		str	r3, [r4, #12]
3566:Core/Src/FAT/ff.c **** #if (FF_FS_NOFSINFO & 3) != 3
 1705              		.loc 1 3566 3 is_stmt 1 view .LVU563
3566:Core/Src/FAT/ff.c **** #if (FF_FS_NOFSINFO & 3) != 3
 1706              		.loc 1 3566 16 is_stmt 0 view .LVU564
 1707 01a4 8023     		movs	r3, #128
 1708 01a6 6371     		strb	r3, [r4, #5]
3568:Core/Src/FAT/ff.c **** 			&& ld_word(fs->win + BPB_FSInfo32) == 1
 1709              		.loc 1 3568 3 is_stmt 1 view .LVU565
3568:Core/Src/FAT/ff.c **** 			&& ld_word(fs->win + BPB_FSInfo32) == 1
 1710              		.loc 1 3568 6 is_stmt 0 view .LVU566
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 101


 1711 01a8 BBF1030F 		cmp	fp, #3
 1712 01ac 1CD0     		beq	.L143
 1713              	.L116:
3589:Core/Src/FAT/ff.c **** 	fs->id = ++Fsid;		/* Volume mount ID */
 1714              		.loc 1 3589 2 is_stmt 1 view .LVU567
3589:Core/Src/FAT/ff.c **** 	fs->id = ++Fsid;		/* Volume mount ID */
 1715              		.loc 1 3589 14 is_stmt 0 view .LVU568
 1716 01ae 84F800B0 		strb	fp, [r4]
3590:Core/Src/FAT/ff.c **** #if FF_USE_LFN == 1
 1717              		.loc 1 3590 2 is_stmt 1 view .LVU569
3590:Core/Src/FAT/ff.c **** #if FF_USE_LFN == 1
 1718              		.loc 1 3590 11 is_stmt 0 view .LVU570
 1719 01b2 3A4A     		ldr	r2, .L144+8
 1720 01b4 1388     		ldrh	r3, [r2]
 1721 01b6 0133     		adds	r3, r3, #1
 1722 01b8 9BB2     		uxth	r3, r3
3590:Core/Src/FAT/ff.c **** #if FF_USE_LFN == 1
 1723              		.loc 1 3590 9 view .LVU571
 1724 01ba 1380     		strh	r3, [r2]	@ movhi
 1725 01bc E380     		strh	r3, [r4, #6]	@ movhi
3603:Core/Src/FAT/ff.c **** }
 1726              		.loc 1 3603 2 is_stmt 1 view .LVU572
3603:Core/Src/FAT/ff.c **** }
 1727              		.loc 1 3603 9 is_stmt 0 view .LVU573
 1728 01be 43E0     		b	.L105
 1729              	.LVL200:
 1730              	.L141:
3551:Core/Src/FAT/ff.c **** 			if (fs->n_rootdir != 0) return FR_NO_FILESYSTEM;	/* (BPB_RootEntCnt must be 0) */
 1731              		.loc 1 3551 4 is_stmt 1 view .LVU574
3551:Core/Src/FAT/ff.c **** 			if (fs->n_rootdir != 0) return FR_NO_FILESYSTEM;	/* (BPB_RootEntCnt must be 0) */
 1732              		.loc 1 3551 8 is_stmt 0 view .LVU575
 1733 01c0 04F15A00 		add	r0, r4, #90
 1734 01c4 FFF7FEFF 		bl	ld_word
 1735              	.LVL201:
3551:Core/Src/FAT/ff.c **** 			if (fs->n_rootdir != 0) return FR_NO_FILESYSTEM;	/* (BPB_RootEntCnt must be 0) */
 1736              		.loc 1 3551 7 view .LVU576
 1737 01c8 0028     		cmp	r0, #0
 1738 01ca 5AD1     		bne	.L136
3552:Core/Src/FAT/ff.c **** 			fs->dirbase = ld_dword(fs->win + BPB_RootClus32);	/* Root directory start cluster */
 1739              		.loc 1 3552 4 is_stmt 1 view .LVU577
3552:Core/Src/FAT/ff.c **** 			fs->dirbase = ld_dword(fs->win + BPB_RootClus32);	/* Root directory start cluster */
 1740              		.loc 1 3552 7 is_stmt 0 view .LVU578
 1741 01cc BAF1000F 		cmp	r10, #0
 1742 01d0 59D1     		bne	.L137
3553:Core/Src/FAT/ff.c **** 			szbfat = fs->n_fatent * 4;					/* (Needed FAT size) */
 1743              		.loc 1 3553 4 is_stmt 1 view .LVU579
3553:Core/Src/FAT/ff.c **** 			szbfat = fs->n_fatent * 4;					/* (Needed FAT size) */
 1744              		.loc 1 3553 18 is_stmt 0 view .LVU580
 1745 01d2 04F15C00 		add	r0, r4, #92
 1746 01d6 FFF7FEFF 		bl	ld_dword
 1747              	.LVL202:
3553:Core/Src/FAT/ff.c **** 			szbfat = fs->n_fatent * 4;					/* (Needed FAT size) */
 1748              		.loc 1 3553 16 view .LVU581
 1749 01da 6062     		str	r0, [r4, #36]
3554:Core/Src/FAT/ff.c **** 		} else {
 1750              		.loc 1 3554 4 is_stmt 1 view .LVU582
3554:Core/Src/FAT/ff.c **** 		} else {
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 102


 1751              		.loc 1 3554 11 is_stmt 0 view .LVU583
 1752 01dc 4FEA8909 		lsl	r9, r9, #2
 1753              	.LVL203:
3554:Core/Src/FAT/ff.c **** 		} else {
 1754              		.loc 1 3554 11 view .LVU584
 1755 01e0 D7E7     		b	.L114
 1756              	.LVL204:
 1757              	.L142:
3559:Core/Src/FAT/ff.c **** 		}
 1758              		.loc 1 3559 22 discriminator 1 view .LVU585
 1759 01e2 4FEA4909 		lsl	r9, r9, #1
 1760 01e6 D4E7     		b	.L114
 1761              	.LVL205:
 1762              	.L143:
3569:Core/Src/FAT/ff.c **** 			&& move_window(fs, bsect + 1) == FR_OK)
 1763              		.loc 1 3569 7 view .LVU586
 1764 01e8 04F16000 		add	r0, r4, #96
 1765 01ec FFF7FEFF 		bl	ld_word
 1766              	.LVL206:
3569:Core/Src/FAT/ff.c **** 			&& move_window(fs, bsect + 1) == FR_OK)
 1767              		.loc 1 3569 4 view .LVU587
 1768 01f0 0128     		cmp	r0, #1
 1769 01f2 DCD1     		bne	.L116
3570:Core/Src/FAT/ff.c **** 		{
 1770              		.loc 1 3570 7 view .LVU588
 1771 01f4 711C     		adds	r1, r6, #1
 1772 01f6 2046     		mov	r0, r4
 1773 01f8 FFF7FEFF 		bl	move_window
 1774              	.LVL207:
3570:Core/Src/FAT/ff.c **** 		{
 1775              		.loc 1 3570 4 view .LVU589
 1776 01fc 0028     		cmp	r0, #0
 1777 01fe D6D1     		bne	.L116
3572:Core/Src/FAT/ff.c **** 			if (ld_word(fs->win + BS_55AA) == 0xAA55	/* Load FSInfo data if available */
 1778              		.loc 1 3572 4 is_stmt 1 view .LVU590
3572:Core/Src/FAT/ff.c **** 			if (ld_word(fs->win + BS_55AA) == 0xAA55	/* Load FSInfo data if available */
 1779              		.loc 1 3572 17 is_stmt 0 view .LVU591
 1780 0200 0023     		movs	r3, #0
 1781 0202 6371     		strb	r3, [r4, #5]
3573:Core/Src/FAT/ff.c **** 				&& ld_dword(fs->win + FSI_LeadSig) == 0x41615252
 1782              		.loc 1 3573 4 is_stmt 1 view .LVU592
3573:Core/Src/FAT/ff.c **** 				&& ld_dword(fs->win + FSI_LeadSig) == 0x41615252
 1783              		.loc 1 3573 8 is_stmt 0 view .LVU593
 1784 0204 04F22E20 		addw	r0, r4, #558
 1785 0208 FFF7FEFF 		bl	ld_word
 1786              	.LVL208:
3573:Core/Src/FAT/ff.c **** 				&& ld_dword(fs->win + FSI_LeadSig) == 0x41615252
 1787              		.loc 1 3573 7 view .LVU594
 1788 020c 4AF65523 		movw	r3, #43605
 1789 0210 9842     		cmp	r0, r3
 1790 0212 CCD1     		bne	.L116
3574:Core/Src/FAT/ff.c **** 				&& ld_dword(fs->win + FSI_StrucSig) == 0x61417272)
 1791              		.loc 1 3574 8 view .LVU595
 1792 0214 04F13000 		add	r0, r4, #48
 1793 0218 FFF7FEFF 		bl	ld_dword
 1794              	.LVL209:
3574:Core/Src/FAT/ff.c **** 				&& ld_dword(fs->win + FSI_StrucSig) == 0x61417272)
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 103


 1795              		.loc 1 3574 5 view .LVU596
 1796 021c 204B     		ldr	r3, .L144+12
 1797 021e 9842     		cmp	r0, r3
 1798 0220 C5D1     		bne	.L116
3575:Core/Src/FAT/ff.c **** 			{
 1799              		.loc 1 3575 8 view .LVU597
 1800 0222 04F50570 		add	r0, r4, #532
 1801 0226 FFF7FEFF 		bl	ld_dword
 1802              	.LVL210:
3575:Core/Src/FAT/ff.c **** 			{
 1803              		.loc 1 3575 5 view .LVU598
 1804 022a 1E4B     		ldr	r3, .L144+16
 1805 022c 9842     		cmp	r0, r3
 1806 022e BED1     		bne	.L116
3578:Core/Src/FAT/ff.c **** #endif
 1807              		.loc 1 3578 5 is_stmt 1 view .LVU599
3578:Core/Src/FAT/ff.c **** #endif
 1808              		.loc 1 3578 21 is_stmt 0 view .LVU600
 1809 0230 04F50670 		add	r0, r4, #536
 1810 0234 FFF7FEFF 		bl	ld_dword
 1811              	.LVL211:
3578:Core/Src/FAT/ff.c **** #endif
 1812              		.loc 1 3578 19 view .LVU601
 1813 0238 2061     		str	r0, [r4, #16]
3581:Core/Src/FAT/ff.c **** #endif
 1814              		.loc 1 3581 5 is_stmt 1 view .LVU602
3581:Core/Src/FAT/ff.c **** #endif
 1815              		.loc 1 3581 21 is_stmt 0 view .LVU603
 1816 023a 04F50770 		add	r0, r4, #540
 1817 023e FFF7FEFF 		bl	ld_dword
 1818              	.LVL212:
3581:Core/Src/FAT/ff.c **** #endif
 1819              		.loc 1 3581 19 view .LVU604
 1820 0242 E060     		str	r0, [r4, #12]
 1821 0244 B3E7     		b	.L116
 1822              	.LVL213:
 1823              	.L117:
3403:Core/Src/FAT/ff.c **** 
 1824              		.loc 1 3403 22 view .LVU605
 1825 0246 0B25     		movs	r5, #11
 1826              	.LVL214:
 1827              	.L105:
3604:Core/Src/FAT/ff.c **** 
 1828              		.loc 1 3604 1 view .LVU606
 1829 0248 2846     		mov	r0, r5
 1830 024a BDE8F88F 		pop	{r3, r4, r5, r6, r7, r8, r9, r10, fp, pc}
 1831              	.LVL215:
 1832              	.L118:
3407:Core/Src/FAT/ff.c **** #if FF_FS_REENTRANT
 1833              		.loc 1 3407 18 view .LVU607
 1834 024e 0C25     		movs	r5, #12
 1835              	.LVL216:
3407:Core/Src/FAT/ff.c **** #if FF_FS_REENTRANT
 1836              		.loc 1 3407 18 view .LVU608
 1837 0250 FAE7     		b	.L105
 1838              	.LVL217:
 1839              	.L120:
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 104


3430:Core/Src/FAT/ff.c **** 	}
 1840              		.loc 1 3430 10 view .LVU609
 1841 0252 0325     		movs	r5, #3
 1842 0254 F8E7     		b	.L105
 1843              	.L121:
3433:Core/Src/FAT/ff.c **** 	}
 1844              		.loc 1 3433 10 view .LVU610
 1845 0256 0A25     		movs	r5, #10
 1846 0258 F6E7     		b	.L105
 1847              	.LVL218:
 1848              	.L122:
3442:Core/Src/FAT/ff.c **** 	if (fmt >= 2) return FR_NO_FILESYSTEM;	/* No FAT volume is found */
 1849              		.loc 1 3442 23 view .LVU611
 1850 025a 0125     		movs	r5, #1
 1851 025c F4E7     		b	.L105
 1852              	.L123:
3443:Core/Src/FAT/ff.c **** 	bsect = fs->winsect;					/* Volume offset in the hosting physical drive */
 1853              		.loc 1 3443 23 view .LVU612
 1854 025e 0D25     		movs	r5, #13
 1855 0260 F2E7     		b	.L105
 1856              	.LVL219:
 1857              	.L124:
3512:Core/Src/FAT/ff.c **** 
 1858              		.loc 1 3512 59 view .LVU613
 1859 0262 0D25     		movs	r5, #13
 1860 0264 F0E7     		b	.L105
 1861              	.LVL220:
 1862              	.L125:
3519:Core/Src/FAT/ff.c **** 		fasize *= fs->n_fats;							/* Number of sectors for FAT area */
 1863              		.loc 1 3519 50 view .LVU614
 1864 0266 0D25     		movs	r5, #13
 1865 0268 EEE7     		b	.L105
 1866              	.LVL221:
 1867              	.L126:
3523:Core/Src/FAT/ff.c **** 
 1868              		.loc 1 3523 63 view .LVU615
 1869 026a 0D25     		movs	r5, #13
 1870 026c ECE7     		b	.L105
 1871              	.L127:
 1872 026e 0D25     		movs	r5, #13
 1873 0270 EAE7     		b	.L105
 1874              	.L128:
3526:Core/Src/FAT/ff.c **** 
 1875              		.loc 1 3526 49 view .LVU616
 1876 0272 0D25     		movs	r5, #13
 1877 0274 E8E7     		b	.L105
 1878              	.LVL222:
 1879              	.L129:
3532:Core/Src/FAT/ff.c **** 
 1880              		.loc 1 3532 25 view .LVU617
 1881 0276 0D25     		movs	r5, #13
 1882 0278 E6E7     		b	.L105
 1883              	.LVL223:
 1884              	.L130:
3536:Core/Src/FAT/ff.c **** 		nclst = (tsect - sysect) / fs->csize;			/* Number of clusters */
 1885              		.loc 1 3536 30 view .LVU618
 1886 027a 0D25     		movs	r5, #13
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 105


 1887 027c E4E7     		b	.L105
 1888              	.LVL224:
 1889              	.L131:
3538:Core/Src/FAT/ff.c **** 		fmt = 0;
 1890              		.loc 1 3538 26 view .LVU619
 1891 027e 0D25     		movs	r5, #13
 1892 0280 E2E7     		b	.L105
 1893              	.LVL225:
 1894              	.L136:
3551:Core/Src/FAT/ff.c **** 			if (fs->n_rootdir != 0) return FR_NO_FILESYSTEM;	/* (BPB_RootEntCnt must be 0) */
 1895              		.loc 1 3551 52 view .LVU620
 1896 0282 0D25     		movs	r5, #13
 1897 0284 E0E7     		b	.L105
 1898              	.L137:
3552:Core/Src/FAT/ff.c **** 			fs->dirbase = ld_dword(fs->win + BPB_RootClus32);	/* Root directory start cluster */
 1899              		.loc 1 3552 35 view .LVU621
 1900 0286 0D25     		movs	r5, #13
 1901 0288 DEE7     		b	.L105
 1902              	.LVL226:
 1903              	.L138:
3556:Core/Src/FAT/ff.c **** 			fs->dirbase = fs->fatbase + fasize;			/* Root directory start sector */
 1904              		.loc 1 3556 35 view .LVU622
 1905 028a 0D25     		movs	r5, #13
 1906 028c DCE7     		b	.L105
 1907              	.LVL227:
 1908              	.L139:
3561:Core/Src/FAT/ff.c **** 
 1909              		.loc 1 3561 60 view .LVU623
 1910 028e 0D25     		movs	r5, #13
 1911 0290 DAE7     		b	.L105
 1912              	.L145:
 1913 0292 00BF     		.align	2
 1914              	.L144:
 1915 0294 00000000 		.word	.LANCHOR0
 1916 0298 F5FFFF0F 		.word	268435445
 1917 029c 00000000 		.word	.LANCHOR1
 1918 02a0 52526141 		.word	1096897106
 1919 02a4 72724161 		.word	1631679090
 1920              		.cfi_endproc
 1921              	.LFE30:
 1923              		.section	.text.put_fat,"ax",%progbits
 1924              		.align	1
 1925              		.syntax unified
 1926              		.thumb
 1927              		.thumb_func
 1929              	put_fat:
 1930              	.LVL228:
 1931              	.LFB11:
1244:Core/Src/FAT/ff.c **** 	UINT bc;
 1932              		.loc 1 1244 1 is_stmt 1 view -0
 1933              		.cfi_startproc
 1934              		@ args = 0, pretend = 0, frame = 0
 1935              		@ frame_needed = 0, uses_anonymous_args = 0
1244:Core/Src/FAT/ff.c **** 	UINT bc;
 1936              		.loc 1 1244 1 is_stmt 0 view .LVU625
 1937 0000 2DE9F047 		push	{r4, r5, r6, r7, r8, r9, r10, lr}
 1938              	.LCFI11:
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 106


 1939              		.cfi_def_cfa_offset 32
 1940              		.cfi_offset 4, -32
 1941              		.cfi_offset 5, -28
 1942              		.cfi_offset 6, -24
 1943              		.cfi_offset 7, -20
 1944              		.cfi_offset 8, -16
 1945              		.cfi_offset 9, -12
 1946              		.cfi_offset 10, -8
 1947              		.cfi_offset 14, -4
1245:Core/Src/FAT/ff.c **** 	BYTE *p;
 1948              		.loc 1 1245 2 is_stmt 1 view .LVU626
1246:Core/Src/FAT/ff.c **** 	FRESULT res = FR_INT_ERR;
 1949              		.loc 1 1246 2 view .LVU627
1247:Core/Src/FAT/ff.c **** 
 1950              		.loc 1 1247 2 view .LVU628
 1951              	.LVL229:
1250:Core/Src/FAT/ff.c **** 		switch (fs->fs_type) {
 1952              		.loc 1 1250 2 view .LVU629
1250:Core/Src/FAT/ff.c **** 		switch (fs->fs_type) {
 1953              		.loc 1 1250 5 is_stmt 0 view .LVU630
 1954 0004 0129     		cmp	r1, #1
 1955 0006 7ED9     		bls	.L154
 1956 0008 0746     		mov	r7, r0
 1957 000a 0C46     		mov	r4, r1
 1958 000c 1646     		mov	r6, r2
1250:Core/Src/FAT/ff.c **** 		switch (fs->fs_type) {
 1959              		.loc 1 1250 28 discriminator 1 view .LVU631
 1960 000e 4369     		ldr	r3, [r0, #20]
1250:Core/Src/FAT/ff.c **** 		switch (fs->fs_type) {
 1961              		.loc 1 1250 16 discriminator 1 view .LVU632
 1962 0010 8B42     		cmp	r3, r1
 1963 0012 7AD9     		bls	.L155
1251:Core/Src/FAT/ff.c **** 		case FS_FAT12:
 1964              		.loc 1 1251 3 is_stmt 1 view .LVU633
1251:Core/Src/FAT/ff.c **** 		case FS_FAT12:
 1965              		.loc 1 1251 13 is_stmt 0 view .LVU634
 1966 0014 0378     		ldrb	r3, [r0]	@ zero_extendqisi2
1251:Core/Src/FAT/ff.c **** 		case FS_FAT12:
 1967              		.loc 1 1251 3 view .LVU635
 1968 0016 022B     		cmp	r3, #2
 1969 0018 45D0     		beq	.L148
 1970 001a 032B     		cmp	r3, #3
 1971 001c 57D0     		beq	.L149
 1972 001e 012B     		cmp	r3, #1
 1973 0020 03D0     		beq	.L158
 1974 0022 0225     		movs	r5, #2
 1975              	.LVL230:
 1976              	.L147:
1287:Core/Src/FAT/ff.c **** }
 1977              		.loc 1 1287 2 is_stmt 1 view .LVU636
1288:Core/Src/FAT/ff.c **** 
 1978              		.loc 1 1288 1 is_stmt 0 view .LVU637
 1979 0024 2846     		mov	r0, r5
 1980 0026 BDE8F087 		pop	{r4, r5, r6, r7, r8, r9, r10, pc}
 1981              	.LVL231:
 1982              	.L158:
1253:Core/Src/FAT/ff.c **** 			res = move_window(fs, fs->fatbase + (bc / SS(fs)));
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 107


 1983              		.loc 1 1253 4 is_stmt 1 view .LVU638
1253:Core/Src/FAT/ff.c **** 			res = move_window(fs, fs->fatbase + (bc / SS(fs)));
 1984              		.loc 1 1253 21 view .LVU639
1253:Core/Src/FAT/ff.c **** 			res = move_window(fs, fs->fatbase + (bc / SS(fs)));
 1985              		.loc 1 1253 24 is_stmt 0 view .LVU640
 1986 002a 01EB5108 		add	r8, r1, r1, lsr #1
 1987              	.LVL232:
1254:Core/Src/FAT/ff.c **** 			if (res != FR_OK) break;
 1988              		.loc 1 1254 4 is_stmt 1 view .LVU641
1254:Core/Src/FAT/ff.c **** 			if (res != FR_OK) break;
 1989              		.loc 1 1254 28 is_stmt 0 view .LVU642
 1990 002e 016A     		ldr	r1, [r0, #32]
 1991              	.LVL233:
1254:Core/Src/FAT/ff.c **** 			if (res != FR_OK) break;
 1992              		.loc 1 1254 10 view .LVU643
 1993 0030 01EB5821 		add	r1, r1, r8, lsr #9
 1994 0034 FFF7FEFF 		bl	move_window
 1995              	.LVL234:
1255:Core/Src/FAT/ff.c **** 			p = fs->win + bc++ % SS(fs);
 1996              		.loc 1 1255 4 is_stmt 1 view .LVU644
1255:Core/Src/FAT/ff.c **** 			p = fs->win + bc++ % SS(fs);
 1997              		.loc 1 1255 7 is_stmt 0 view .LVU645
 1998 0038 0546     		mov	r5, r0
 1999 003a 0028     		cmp	r0, #0
 2000 003c F2D1     		bne	.L147
1256:Core/Src/FAT/ff.c **** 			*p = (clst & 1) ? ((*p & 0x0F) | ((BYTE)val << 4)) : (BYTE)val;	/* Update 1st byte */
 2001              		.loc 1 1256 4 is_stmt 1 view .LVU646
1256:Core/Src/FAT/ff.c **** 			*p = (clst & 1) ? ((*p & 0x0F) | ((BYTE)val << 4)) : (BYTE)val;	/* Update 1st byte */
 2002              		.loc 1 1256 8 is_stmt 0 view .LVU647
 2003 003e 07F1300A 		add	r10, r7, #48
1256:Core/Src/FAT/ff.c **** 			*p = (clst & 1) ? ((*p & 0x0F) | ((BYTE)val << 4)) : (BYTE)val;	/* Update 1st byte */
 2004              		.loc 1 1256 23 view .LVU648
 2005 0042 08F10109 		add	r9, r8, #1
 2006              	.LVL235:
1256:Core/Src/FAT/ff.c **** 			*p = (clst & 1) ? ((*p & 0x0F) | ((BYTE)val << 4)) : (BYTE)val;	/* Update 1st byte */
 2007              		.loc 1 1256 23 view .LVU649
 2008 0046 C8F30808 		ubfx	r8, r8, #0, #9
 2009              	.LVL236:
1257:Core/Src/FAT/ff.c **** 			fs->wflag = 1;
 2010              		.loc 1 1257 4 is_stmt 1 view .LVU650
1257:Core/Src/FAT/ff.c **** 			fs->wflag = 1;
 2011              		.loc 1 1257 7 is_stmt 0 view .LVU651
 2012 004a 14F00104 		ands	r4, r4, #1
 2013              	.LVL237:
1257:Core/Src/FAT/ff.c **** 			fs->wflag = 1;
 2014              		.loc 1 1257 7 view .LVU652
 2015 004e 1FD0     		beq	.L150
1257:Core/Src/FAT/ff.c **** 			fs->wflag = 1;
 2016              		.loc 1 1257 24 discriminator 1 view .LVU653
 2017 0050 1AF90830 		ldrsb	r3, [r10, r8]
1257:Core/Src/FAT/ff.c **** 			fs->wflag = 1;
 2018              		.loc 1 1257 27 discriminator 1 view .LVU654
 2019 0054 03F00F03 		and	r3, r3, #15
1257:Core/Src/FAT/ff.c **** 			fs->wflag = 1;
 2020              		.loc 1 1257 48 discriminator 1 view .LVU655
 2021 0058 3201     		lsls	r2, r6, #4
 2022 005a 02F47F62 		and	r2, r2, #4080
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 108


1257:Core/Src/FAT/ff.c **** 			fs->wflag = 1;
 2023              		.loc 1 1257 35 discriminator 1 view .LVU656
 2024 005e 1343     		orrs	r3, r3, r2
1257:Core/Src/FAT/ff.c **** 			fs->wflag = 1;
 2025              		.loc 1 1257 7 discriminator 1 view .LVU657
 2026 0060 DBB2     		uxtb	r3, r3
 2027              	.L151:
1257:Core/Src/FAT/ff.c **** 			fs->wflag = 1;
 2028              		.loc 1 1257 7 discriminator 4 view .LVU658
 2029 0062 0AF80830 		strb	r3, [r10, r8]
1258:Core/Src/FAT/ff.c **** 			res = move_window(fs, fs->fatbase + (bc / SS(fs)));
 2030              		.loc 1 1258 4 is_stmt 1 discriminator 4 view .LVU659
1258:Core/Src/FAT/ff.c **** 			res = move_window(fs, fs->fatbase + (bc / SS(fs)));
 2031              		.loc 1 1258 14 is_stmt 0 discriminator 4 view .LVU660
 2032 0066 0123     		movs	r3, #1
 2033 0068 3B71     		strb	r3, [r7, #4]
1259:Core/Src/FAT/ff.c **** 			if (res != FR_OK) break;
 2034              		.loc 1 1259 4 is_stmt 1 discriminator 4 view .LVU661
1259:Core/Src/FAT/ff.c **** 			if (res != FR_OK) break;
 2035              		.loc 1 1259 28 is_stmt 0 discriminator 4 view .LVU662
 2036 006a 396A     		ldr	r1, [r7, #32]
1259:Core/Src/FAT/ff.c **** 			if (res != FR_OK) break;
 2037              		.loc 1 1259 10 discriminator 4 view .LVU663
 2038 006c 01EB5921 		add	r1, r1, r9, lsr #9
 2039 0070 3846     		mov	r0, r7
 2040              	.LVL238:
1259:Core/Src/FAT/ff.c **** 			if (res != FR_OK) break;
 2041              		.loc 1 1259 10 discriminator 4 view .LVU664
 2042 0072 FFF7FEFF 		bl	move_window
 2043              	.LVL239:
1260:Core/Src/FAT/ff.c **** 			p = fs->win + bc % SS(fs);
 2044              		.loc 1 1260 4 is_stmt 1 discriminator 4 view .LVU665
1260:Core/Src/FAT/ff.c **** 			p = fs->win + bc % SS(fs);
 2045              		.loc 1 1260 7 is_stmt 0 discriminator 4 view .LVU666
 2046 0076 0546     		mov	r5, r0
 2047 0078 0028     		cmp	r0, #0
 2048 007a D3D1     		bne	.L147
1261:Core/Src/FAT/ff.c **** 			*p = (clst & 1) ? (BYTE)(val >> 4) : ((*p & 0xF0) | ((BYTE)(val >> 8) & 0x0F));	/* Update 2nd by
 2049              		.loc 1 1261 4 is_stmt 1 view .LVU667
1261:Core/Src/FAT/ff.c **** 			*p = (clst & 1) ? (BYTE)(val >> 4) : ((*p & 0xF0) | ((BYTE)(val >> 8) & 0x0F));	/* Update 2nd by
 2050              		.loc 1 1261 21 is_stmt 0 view .LVU668
 2051 007c C9F30809 		ubfx	r9, r9, #0, #9
 2052              	.LVL240:
1262:Core/Src/FAT/ff.c **** 			fs->wflag = 1;
 2053              		.loc 1 1262 4 is_stmt 1 view .LVU669
1262:Core/Src/FAT/ff.c **** 			fs->wflag = 1;
 2054              		.loc 1 1262 7 is_stmt 0 view .LVU670
 2055 0080 44B1     		cbz	r4, .L152
1262:Core/Src/FAT/ff.c **** 			fs->wflag = 1;
 2056              		.loc 1 1262 7 discriminator 1 view .LVU671
 2057 0082 C6F30712 		ubfx	r2, r6, #4, #8
 2058              	.LVL241:
 2059              	.L153:
1262:Core/Src/FAT/ff.c **** 			fs->wflag = 1;
 2060              		.loc 1 1262 7 discriminator 4 view .LVU672
 2061 0086 0AF80920 		strb	r2, [r10, r9]
1263:Core/Src/FAT/ff.c **** 			break;
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 109


 2062              		.loc 1 1263 4 is_stmt 1 discriminator 4 view .LVU673
1263:Core/Src/FAT/ff.c **** 			break;
 2063              		.loc 1 1263 14 is_stmt 0 discriminator 4 view .LVU674
 2064 008a 0123     		movs	r3, #1
 2065 008c 3B71     		strb	r3, [r7, #4]
1264:Core/Src/FAT/ff.c **** 
 2066              		.loc 1 1264 4 is_stmt 1 discriminator 4 view .LVU675
 2067 008e C9E7     		b	.L147
 2068              	.LVL242:
 2069              	.L150:
1257:Core/Src/FAT/ff.c **** 			fs->wflag = 1;
 2070              		.loc 1 1257 7 is_stmt 0 discriminator 2 view .LVU676
 2071 0090 F3B2     		uxtb	r3, r6
 2072 0092 E6E7     		b	.L151
 2073              	.LVL243:
 2074              	.L152:
1262:Core/Src/FAT/ff.c **** 			fs->wflag = 1;
 2075              		.loc 1 1262 43 discriminator 2 view .LVU677
 2076 0094 1AF90920 		ldrsb	r2, [r10, r9]
1262:Core/Src/FAT/ff.c **** 			fs->wflag = 1;
 2077              		.loc 1 1262 46 discriminator 2 view .LVU678
 2078 0098 22F00F02 		bic	r2, r2, #15
1262:Core/Src/FAT/ff.c **** 			fs->wflag = 1;
 2079              		.loc 1 1262 74 discriminator 2 view .LVU679
 2080 009c C6F30326 		ubfx	r6, r6, #8, #4
 2081              	.LVL244:
1262:Core/Src/FAT/ff.c **** 			fs->wflag = 1;
 2082              		.loc 1 1262 54 discriminator 2 view .LVU680
 2083 00a0 3243     		orrs	r2, r2, r6
1262:Core/Src/FAT/ff.c **** 			fs->wflag = 1;
 2084              		.loc 1 1262 7 discriminator 2 view .LVU681
 2085 00a2 D2B2     		uxtb	r2, r2
 2086 00a4 EFE7     		b	.L153
 2087              	.LVL245:
 2088              	.L148:
1267:Core/Src/FAT/ff.c **** 			if (res != FR_OK) break;
 2089              		.loc 1 1267 4 is_stmt 1 view .LVU682
1267:Core/Src/FAT/ff.c **** 			if (res != FR_OK) break;
 2090              		.loc 1 1267 28 is_stmt 0 view .LVU683
 2091 00a6 016A     		ldr	r1, [r0, #32]
 2092              	.LVL246:
1267:Core/Src/FAT/ff.c **** 			if (res != FR_OK) break;
 2093              		.loc 1 1267 10 view .LVU684
 2094 00a8 01EB1421 		add	r1, r1, r4, lsr #8
 2095 00ac FFF7FEFF 		bl	move_window
 2096              	.LVL247:
1268:Core/Src/FAT/ff.c **** 			st_word(fs->win + clst * 2 % SS(fs), (WORD)val);	/* Simple WORD array */
 2097              		.loc 1 1268 4 is_stmt 1 view .LVU685
1268:Core/Src/FAT/ff.c **** 			st_word(fs->win + clst * 2 % SS(fs), (WORD)val);	/* Simple WORD array */
 2098              		.loc 1 1268 7 is_stmt 0 view .LVU686
 2099 00b0 0546     		mov	r5, r0
 2100 00b2 0028     		cmp	r0, #0
 2101 00b4 B6D1     		bne	.L147
1269:Core/Src/FAT/ff.c **** 			fs->wflag = 1;
 2102              		.loc 1 1269 4 is_stmt 1 view .LVU687
1269:Core/Src/FAT/ff.c **** 			fs->wflag = 1;
 2103              		.loc 1 1269 12 is_stmt 0 view .LVU688
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 110


 2104 00b6 07F13000 		add	r0, r7, #48
 2105              	.LVL248:
1269:Core/Src/FAT/ff.c **** 			fs->wflag = 1;
 2106              		.loc 1 1269 27 view .LVU689
 2107 00ba 6400     		lsls	r4, r4, #1
 2108              	.LVL249:
1269:Core/Src/FAT/ff.c **** 			fs->wflag = 1;
 2109              		.loc 1 1269 31 view .LVU690
 2110 00bc 04F4FF74 		and	r4, r4, #510
1269:Core/Src/FAT/ff.c **** 			fs->wflag = 1;
 2111              		.loc 1 1269 4 view .LVU691
 2112 00c0 B1B2     		uxth	r1, r6
 2113 00c2 2044     		add	r0, r0, r4
 2114 00c4 FFF7FEFF 		bl	st_word
 2115              	.LVL250:
1270:Core/Src/FAT/ff.c **** 			break;
 2116              		.loc 1 1270 4 is_stmt 1 view .LVU692
1270:Core/Src/FAT/ff.c **** 			break;
 2117              		.loc 1 1270 14 is_stmt 0 view .LVU693
 2118 00c8 0123     		movs	r3, #1
 2119 00ca 3B71     		strb	r3, [r7, #4]
1271:Core/Src/FAT/ff.c **** 
 2120              		.loc 1 1271 4 is_stmt 1 view .LVU694
 2121 00cc AAE7     		b	.L147
 2122              	.LVL251:
 2123              	.L149:
1277:Core/Src/FAT/ff.c **** 			if (res != FR_OK) break;
 2124              		.loc 1 1277 4 view .LVU695
1277:Core/Src/FAT/ff.c **** 			if (res != FR_OK) break;
 2125              		.loc 1 1277 28 is_stmt 0 view .LVU696
 2126 00ce 016A     		ldr	r1, [r0, #32]
 2127              	.LVL252:
1277:Core/Src/FAT/ff.c **** 			if (res != FR_OK) break;
 2128              		.loc 1 1277 10 view .LVU697
 2129 00d0 01EBD411 		add	r1, r1, r4, lsr #7
 2130 00d4 FFF7FEFF 		bl	move_window
 2131              	.LVL253:
1278:Core/Src/FAT/ff.c **** 			if (!FF_FS_EXFAT || fs->fs_type != FS_EXFAT) {
 2132              		.loc 1 1278 4 is_stmt 1 view .LVU698
1278:Core/Src/FAT/ff.c **** 			if (!FF_FS_EXFAT || fs->fs_type != FS_EXFAT) {
 2133              		.loc 1 1278 7 is_stmt 0 view .LVU699
 2134 00d8 0546     		mov	r5, r0
 2135 00da 0028     		cmp	r0, #0
 2136 00dc A2D1     		bne	.L147
1279:Core/Src/FAT/ff.c **** 				val = (val & 0x0FFFFFFF) | (ld_dword(fs->win + clst * 4 % SS(fs)) & 0xF0000000);
 2137              		.loc 1 1279 4 is_stmt 1 view .LVU700
1280:Core/Src/FAT/ff.c **** 			}
 2138              		.loc 1 1280 5 view .LVU701
1280:Core/Src/FAT/ff.c **** 			}
 2139              		.loc 1 1280 16 is_stmt 0 view .LVU702
 2140 00de 26F07046 		bic	r6, r6, #-268435456
 2141              	.LVL254:
1280:Core/Src/FAT/ff.c **** 			}
 2142              		.loc 1 1280 42 view .LVU703
 2143 00e2 07F13003 		add	r3, r7, #48
1280:Core/Src/FAT/ff.c **** 			}
 2144              		.loc 1 1280 57 view .LVU704
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 111


 2145 00e6 A400     		lsls	r4, r4, #2
 2146              	.LVL255:
1280:Core/Src/FAT/ff.c **** 			}
 2147              		.loc 1 1280 61 view .LVU705
 2148 00e8 04F4FE74 		and	r4, r4, #508
1280:Core/Src/FAT/ff.c **** 			}
 2149              		.loc 1 1280 33 view .LVU706
 2150 00ec 1C44     		add	r4, r4, r3
 2151 00ee 2046     		mov	r0, r4
 2152              	.LVL256:
1280:Core/Src/FAT/ff.c **** 			}
 2153              		.loc 1 1280 33 view .LVU707
 2154 00f0 FFF7FEFF 		bl	ld_dword
 2155              	.LVL257:
1280:Core/Src/FAT/ff.c **** 			}
 2156              		.loc 1 1280 71 view .LVU708
 2157 00f4 00F07041 		and	r1, r0, #-268435456
 2158              	.LVL258:
1282:Core/Src/FAT/ff.c **** 			fs->wflag = 1;
 2159              		.loc 1 1282 4 is_stmt 1 view .LVU709
 2160 00f8 3143     		orrs	r1, r1, r6
 2161              	.LVL259:
1282:Core/Src/FAT/ff.c **** 			fs->wflag = 1;
 2162              		.loc 1 1282 4 is_stmt 0 view .LVU710
 2163 00fa 2046     		mov	r0, r4
 2164 00fc FFF7FEFF 		bl	st_dword
 2165              	.LVL260:
1283:Core/Src/FAT/ff.c **** 			break;
 2166              		.loc 1 1283 4 is_stmt 1 view .LVU711
1283:Core/Src/FAT/ff.c **** 			break;
 2167              		.loc 1 1283 14 is_stmt 0 view .LVU712
 2168 0100 0123     		movs	r3, #1
 2169 0102 3B71     		strb	r3, [r7, #4]
1284:Core/Src/FAT/ff.c **** 		}
 2170              		.loc 1 1284 4 is_stmt 1 view .LVU713
 2171 0104 8EE7     		b	.L147
 2172              	.LVL261:
 2173              	.L154:
1247:Core/Src/FAT/ff.c **** 
 2174              		.loc 1 1247 10 is_stmt 0 view .LVU714
 2175 0106 0225     		movs	r5, #2
 2176 0108 8CE7     		b	.L147
 2177              	.L155:
1247:Core/Src/FAT/ff.c **** 
 2178              		.loc 1 1247 10 view .LVU715
 2179 010a 0225     		movs	r5, #2
 2180 010c 8AE7     		b	.L147
 2181              		.cfi_endproc
 2182              	.LFE11:
 2184              		.section	.text.get_fat,"ax",%progbits
 2185              		.align	1
 2186              		.syntax unified
 2187              		.thumb
 2188              		.thumb_func
 2190              	get_fat:
 2191              	.LVL262:
 2192              	.LFB10:
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 112


1165:Core/Src/FAT/ff.c **** 	UINT wc, bc;
 2193              		.loc 1 1165 1 is_stmt 1 view -0
 2194              		.cfi_startproc
 2195              		@ args = 0, pretend = 0, frame = 0
 2196              		@ frame_needed = 0, uses_anonymous_args = 0
1165:Core/Src/FAT/ff.c **** 	UINT wc, bc;
 2197              		.loc 1 1165 1 is_stmt 0 view .LVU717
 2198 0000 F8B5     		push	{r3, r4, r5, r6, r7, lr}
 2199              	.LCFI12:
 2200              		.cfi_def_cfa_offset 24
 2201              		.cfi_offset 3, -24
 2202              		.cfi_offset 4, -20
 2203              		.cfi_offset 5, -16
 2204              		.cfi_offset 6, -12
 2205              		.cfi_offset 7, -8
 2206              		.cfi_offset 14, -4
1166:Core/Src/FAT/ff.c **** 	DWORD val;
 2207              		.loc 1 1166 2 is_stmt 1 view .LVU718
1167:Core/Src/FAT/ff.c **** 	FATFS *fs = obj->fs;
 2208              		.loc 1 1167 2 view .LVU719
1168:Core/Src/FAT/ff.c **** 
 2209              		.loc 1 1168 2 view .LVU720
1168:Core/Src/FAT/ff.c **** 
 2210              		.loc 1 1168 9 is_stmt 0 view .LVU721
 2211 0002 0568     		ldr	r5, [r0]
 2212              	.LVL263:
1171:Core/Src/FAT/ff.c **** 		val = 1;	/* Internal error */
 2213              		.loc 1 1171 2 is_stmt 1 view .LVU722
1171:Core/Src/FAT/ff.c **** 		val = 1;	/* Internal error */
 2214              		.loc 1 1171 5 is_stmt 0 view .LVU723
 2215 0004 0129     		cmp	r1, #1
 2216 0006 56D9     		bls	.L164
 2217 0008 0C46     		mov	r4, r1
1171:Core/Src/FAT/ff.c **** 		val = 1;	/* Internal error */
 2218              		.loc 1 1171 28 discriminator 1 view .LVU724
 2219 000a 6B69     		ldr	r3, [r5, #20]
1171:Core/Src/FAT/ff.c **** 		val = 1;	/* Internal error */
 2220              		.loc 1 1171 15 discriminator 1 view .LVU725
 2221 000c 8B42     		cmp	r3, r1
 2222 000e 54D9     		bls	.L165
1175:Core/Src/FAT/ff.c **** 
 2223              		.loc 1 1175 3 is_stmt 1 view .LVU726
 2224              	.LVL264:
1177:Core/Src/FAT/ff.c **** 		case FS_FAT12 :
 2225              		.loc 1 1177 3 view .LVU727
1177:Core/Src/FAT/ff.c **** 		case FS_FAT12 :
 2226              		.loc 1 1177 13 is_stmt 0 view .LVU728
 2227 0010 2B78     		ldrb	r3, [r5]	@ zero_extendqisi2
1177:Core/Src/FAT/ff.c **** 		case FS_FAT12 :
 2228              		.loc 1 1177 3 view .LVU729
 2229 0012 022B     		cmp	r3, #2
 2230 0014 2DD0     		beq	.L161
 2231 0016 032B     		cmp	r3, #3
 2232 0018 3BD0     		beq	.L162
 2233 001a 012B     		cmp	r3, #1
 2234 001c 01D0     		beq	.L172
 2235 001e 0120     		movs	r0, #1
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 113


 2236              	.LVL265:
1177:Core/Src/FAT/ff.c **** 		case FS_FAT12 :
 2237              		.loc 1 1177 3 view .LVU730
 2238 0020 4AE0     		b	.L159
 2239              	.LVL266:
 2240              	.L172:
1179:Core/Src/FAT/ff.c **** 			if (move_window(fs, fs->fatbase + (bc / SS(fs))) != FR_OK) break;
 2241              		.loc 1 1179 4 is_stmt 1 view .LVU731
1179:Core/Src/FAT/ff.c **** 			if (move_window(fs, fs->fatbase + (bc / SS(fs))) != FR_OK) break;
 2242              		.loc 1 1179 21 view .LVU732
1179:Core/Src/FAT/ff.c **** 			if (move_window(fs, fs->fatbase + (bc / SS(fs))) != FR_OK) break;
 2243              		.loc 1 1179 24 is_stmt 0 view .LVU733
 2244 0022 01EB5106 		add	r6, r1, r1, lsr #1
 2245              	.LVL267:
1180:Core/Src/FAT/ff.c **** 			wc = fs->win[bc++ % SS(fs)];		/* Get 1st byte of the entry */
 2246              		.loc 1 1180 4 is_stmt 1 view .LVU734
1180:Core/Src/FAT/ff.c **** 			wc = fs->win[bc++ % SS(fs)];		/* Get 1st byte of the entry */
 2247              		.loc 1 1180 26 is_stmt 0 view .LVU735
 2248 0026 296A     		ldr	r1, [r5, #32]
 2249              	.LVL268:
1180:Core/Src/FAT/ff.c **** 			wc = fs->win[bc++ % SS(fs)];		/* Get 1st byte of the entry */
 2250              		.loc 1 1180 8 view .LVU736
 2251 0028 01EB5621 		add	r1, r1, r6, lsr #9
 2252 002c 2846     		mov	r0, r5
 2253              	.LVL269:
1180:Core/Src/FAT/ff.c **** 			wc = fs->win[bc++ % SS(fs)];		/* Get 1st byte of the entry */
 2254              		.loc 1 1180 8 view .LVU737
 2255 002e FFF7FEFF 		bl	move_window
 2256              	.LVL270:
1180:Core/Src/FAT/ff.c **** 			wc = fs->win[bc++ % SS(fs)];		/* Get 1st byte of the entry */
 2257              		.loc 1 1180 7 view .LVU738
 2258 0032 10B1     		cbz	r0, .L173
1175:Core/Src/FAT/ff.c **** 
 2259              		.loc 1 1175 7 view .LVU739
 2260 0034 4FF0FF30 		mov	r0, #-1
 2261 0038 3EE0     		b	.L159
 2262              	.L173:
1181:Core/Src/FAT/ff.c **** 			if (move_window(fs, fs->fatbase + (bc / SS(fs))) != FR_OK) break;
 2263              		.loc 1 1181 4 is_stmt 1 view .LVU740
1181:Core/Src/FAT/ff.c **** 			if (move_window(fs, fs->fatbase + (bc / SS(fs))) != FR_OK) break;
 2264              		.loc 1 1181 19 is_stmt 0 view .LVU741
 2265 003a 771C     		adds	r7, r6, #1
 2266              	.LVL271:
1181:Core/Src/FAT/ff.c **** 			if (move_window(fs, fs->fatbase + (bc / SS(fs))) != FR_OK) break;
 2267              		.loc 1 1181 22 view .LVU742
 2268 003c C6F30806 		ubfx	r6, r6, #0, #9
1181:Core/Src/FAT/ff.c **** 			if (move_window(fs, fs->fatbase + (bc / SS(fs))) != FR_OK) break;
 2269              		.loc 1 1181 16 view .LVU743
 2270 0040 2E44     		add	r6, r6, r5
 2271 0042 96F83060 		ldrb	r6, [r6, #48]	@ zero_extendqisi2
 2272              	.LVL272:
1182:Core/Src/FAT/ff.c **** 			wc |= fs->win[bc % SS(fs)] << 8;	/* Merge 2nd byte of the entry */
 2273              		.loc 1 1182 4 is_stmt 1 view .LVU744
1182:Core/Src/FAT/ff.c **** 			wc |= fs->win[bc % SS(fs)] << 8;	/* Merge 2nd byte of the entry */
 2274              		.loc 1 1182 26 is_stmt 0 view .LVU745
 2275 0046 296A     		ldr	r1, [r5, #32]
1182:Core/Src/FAT/ff.c **** 			wc |= fs->win[bc % SS(fs)] << 8;	/* Merge 2nd byte of the entry */
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 114


 2276              		.loc 1 1182 8 view .LVU746
 2277 0048 01EB5721 		add	r1, r1, r7, lsr #9
 2278 004c 2846     		mov	r0, r5
 2279 004e FFF7FEFF 		bl	move_window
 2280              	.LVL273:
1182:Core/Src/FAT/ff.c **** 			wc |= fs->win[bc % SS(fs)] << 8;	/* Merge 2nd byte of the entry */
 2281              		.loc 1 1182 7 view .LVU747
 2282 0052 A0BB     		cbnz	r0, .L168
1183:Core/Src/FAT/ff.c **** 			val = (clst & 1) ? (wc >> 4) : (wc & 0xFFF);	/* Adjust bit position */
 2283              		.loc 1 1183 4 is_stmt 1 view .LVU748
1183:Core/Src/FAT/ff.c **** 			val = (clst & 1) ? (wc >> 4) : (wc & 0xFFF);	/* Adjust bit position */
 2284              		.loc 1 1183 21 is_stmt 0 view .LVU749
 2285 0054 C7F30807 		ubfx	r7, r7, #0, #9
 2286              	.LVL274:
1183:Core/Src/FAT/ff.c **** 			val = (clst & 1) ? (wc >> 4) : (wc & 0xFFF);	/* Adjust bit position */
 2287              		.loc 1 1183 17 view .LVU750
 2288 0058 3D44     		add	r5, r5, r7
 2289              	.LVL275:
1183:Core/Src/FAT/ff.c **** 			val = (clst & 1) ? (wc >> 4) : (wc & 0xFFF);	/* Adjust bit position */
 2290              		.loc 1 1183 17 view .LVU751
 2291 005a 95F83000 		ldrb	r0, [r5, #48]	@ zero_extendqisi2
1183:Core/Src/FAT/ff.c **** 			val = (clst & 1) ? (wc >> 4) : (wc & 0xFFF);	/* Adjust bit position */
 2292              		.loc 1 1183 7 view .LVU752
 2293 005e 46EA0020 		orr	r0, r6, r0, lsl #8
 2294              	.LVL276:
1184:Core/Src/FAT/ff.c **** 			break;
 2295              		.loc 1 1184 4 is_stmt 1 view .LVU753
1184:Core/Src/FAT/ff.c **** 			break;
 2296              		.loc 1 1184 33 is_stmt 0 view .LVU754
 2297 0062 14F0010F 		tst	r4, #1
 2298 0066 01D0     		beq	.L163
1184:Core/Src/FAT/ff.c **** 			break;
 2299              		.loc 1 1184 33 discriminator 1 view .LVU755
 2300 0068 0009     		lsrs	r0, r0, #4
 2301              	.LVL277:
1184:Core/Src/FAT/ff.c **** 			break;
 2302              		.loc 1 1184 33 discriminator 1 view .LVU756
 2303 006a 25E0     		b	.L159
 2304              	.LVL278:
 2305              	.L163:
1184:Core/Src/FAT/ff.c **** 			break;
 2306              		.loc 1 1184 33 discriminator 2 view .LVU757
 2307 006c C0F30B00 		ubfx	r0, r0, #0, #12
 2308              	.LVL279:
1184:Core/Src/FAT/ff.c **** 			break;
 2309              		.loc 1 1184 33 discriminator 2 view .LVU758
 2310 0070 22E0     		b	.L159
 2311              	.LVL280:
 2312              	.L161:
1188:Core/Src/FAT/ff.c **** 			val = ld_word(fs->win + clst * 2 % SS(fs));		/* Simple WORD array */
 2313              		.loc 1 1188 4 is_stmt 1 view .LVU759
1188:Core/Src/FAT/ff.c **** 			val = ld_word(fs->win + clst * 2 % SS(fs));		/* Simple WORD array */
 2314              		.loc 1 1188 26 is_stmt 0 view .LVU760
 2315 0072 296A     		ldr	r1, [r5, #32]
 2316              	.LVL281:
1188:Core/Src/FAT/ff.c **** 			val = ld_word(fs->win + clst * 2 % SS(fs));		/* Simple WORD array */
 2317              		.loc 1 1188 8 view .LVU761
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 115


 2318 0074 01EB1421 		add	r1, r1, r4, lsr #8
 2319 0078 2846     		mov	r0, r5
 2320              	.LVL282:
1188:Core/Src/FAT/ff.c **** 			val = ld_word(fs->win + clst * 2 % SS(fs));		/* Simple WORD array */
 2321              		.loc 1 1188 8 view .LVU762
 2322 007a FFF7FEFF 		bl	move_window
 2323              	.LVL283:
1188:Core/Src/FAT/ff.c **** 			val = ld_word(fs->win + clst * 2 % SS(fs));		/* Simple WORD array */
 2324              		.loc 1 1188 7 view .LVU763
 2325 007e 08BB     		cbnz	r0, .L169
1189:Core/Src/FAT/ff.c **** 			break;
 2326              		.loc 1 1189 4 is_stmt 1 view .LVU764
1189:Core/Src/FAT/ff.c **** 			break;
 2327              		.loc 1 1189 18 is_stmt 0 view .LVU765
 2328 0080 05F13000 		add	r0, r5, #48
1189:Core/Src/FAT/ff.c **** 			break;
 2329              		.loc 1 1189 33 view .LVU766
 2330 0084 6400     		lsls	r4, r4, #1
 2331              	.LVL284:
1189:Core/Src/FAT/ff.c **** 			break;
 2332              		.loc 1 1189 37 view .LVU767
 2333 0086 04F4FF74 		and	r4, r4, #510
1189:Core/Src/FAT/ff.c **** 			break;
 2334              		.loc 1 1189 10 view .LVU768
 2335 008a 2044     		add	r0, r0, r4
 2336 008c FFF7FEFF 		bl	ld_word
 2337              	.LVL285:
1190:Core/Src/FAT/ff.c **** 
 2338              		.loc 1 1190 4 is_stmt 1 view .LVU769
 2339 0090 12E0     		b	.L159
 2340              	.LVL286:
 2341              	.L162:
1193:Core/Src/FAT/ff.c **** 			val = ld_dword(fs->win + clst * 4 % SS(fs)) & 0x0FFFFFFF;	/* Simple DWORD array but mask out upp
 2342              		.loc 1 1193 4 view .LVU770
1193:Core/Src/FAT/ff.c **** 			val = ld_dword(fs->win + clst * 4 % SS(fs)) & 0x0FFFFFFF;	/* Simple DWORD array but mask out upp
 2343              		.loc 1 1193 26 is_stmt 0 view .LVU771
 2344 0092 296A     		ldr	r1, [r5, #32]
 2345              	.LVL287:
1193:Core/Src/FAT/ff.c **** 			val = ld_dword(fs->win + clst * 4 % SS(fs)) & 0x0FFFFFFF;	/* Simple DWORD array but mask out upp
 2346              		.loc 1 1193 8 view .LVU772
 2347 0094 01EBD411 		add	r1, r1, r4, lsr #7
 2348 0098 2846     		mov	r0, r5
 2349              	.LVL288:
1193:Core/Src/FAT/ff.c **** 			val = ld_dword(fs->win + clst * 4 % SS(fs)) & 0x0FFFFFFF;	/* Simple DWORD array but mask out upp
 2350              		.loc 1 1193 8 view .LVU773
 2351 009a FFF7FEFF 		bl	move_window
 2352              	.LVL289:
1193:Core/Src/FAT/ff.c **** 			val = ld_dword(fs->win + clst * 4 % SS(fs)) & 0x0FFFFFFF;	/* Simple DWORD array but mask out upp
 2353              		.loc 1 1193 7 view .LVU774
 2354 009e A0B9     		cbnz	r0, .L170
1194:Core/Src/FAT/ff.c **** 			break;
 2355              		.loc 1 1194 4 is_stmt 1 view .LVU775
1194:Core/Src/FAT/ff.c **** 			break;
 2356              		.loc 1 1194 19 is_stmt 0 view .LVU776
 2357 00a0 05F13000 		add	r0, r5, #48
1194:Core/Src/FAT/ff.c **** 			break;
 2358              		.loc 1 1194 34 view .LVU777
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 116


 2359 00a4 A400     		lsls	r4, r4, #2
 2360              	.LVL290:
1194:Core/Src/FAT/ff.c **** 			break;
 2361              		.loc 1 1194 38 view .LVU778
 2362 00a6 04F4FE74 		and	r4, r4, #508
1194:Core/Src/FAT/ff.c **** 			break;
 2363              		.loc 1 1194 10 view .LVU779
 2364 00aa 2044     		add	r0, r0, r4
 2365 00ac FFF7FEFF 		bl	ld_dword
 2366              	.LVL291:
1194:Core/Src/FAT/ff.c **** 			break;
 2367              		.loc 1 1194 8 view .LVU780
 2368 00b0 20F07040 		bic	r0, r0, #-268435456
 2369              	.LVL292:
1195:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT
 2370              		.loc 1 1195 4 is_stmt 1 view .LVU781
 2371 00b4 00E0     		b	.L159
 2372              	.LVL293:
 2373              	.L164:
1172:Core/Src/FAT/ff.c **** 
 2374              		.loc 1 1172 7 is_stmt 0 view .LVU782
 2375 00b6 0120     		movs	r0, #1
 2376              	.LVL294:
 2377              	.L159:
1229:Core/Src/FAT/ff.c **** 
 2378              		.loc 1 1229 1 view .LVU783
 2379 00b8 F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 2380              	.LVL295:
 2381              	.L165:
1172:Core/Src/FAT/ff.c **** 
 2382              		.loc 1 1172 7 view .LVU784
 2383 00ba 0120     		movs	r0, #1
 2384              	.LVL296:
1172:Core/Src/FAT/ff.c **** 
 2385              		.loc 1 1172 7 view .LVU785
 2386 00bc FCE7     		b	.L159
 2387              	.LVL297:
 2388              	.L168:
1175:Core/Src/FAT/ff.c **** 
 2389              		.loc 1 1175 7 view .LVU786
 2390 00be 4FF0FF30 		mov	r0, #-1
 2391 00c2 F9E7     		b	.L159
 2392              	.LVL298:
 2393              	.L169:
1175:Core/Src/FAT/ff.c **** 
 2394              		.loc 1 1175 7 view .LVU787
 2395 00c4 4FF0FF30 		mov	r0, #-1
 2396 00c8 F6E7     		b	.L159
 2397              	.L170:
1175:Core/Src/FAT/ff.c **** 
 2398              		.loc 1 1175 7 view .LVU788
 2399 00ca 4FF0FF30 		mov	r0, #-1
1228:Core/Src/FAT/ff.c **** }
 2400              		.loc 1 1228 2 is_stmt 1 view .LVU789
1228:Core/Src/FAT/ff.c **** }
 2401              		.loc 1 1228 9 is_stmt 0 view .LVU790
 2402 00ce F3E7     		b	.L159
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 117


 2403              		.cfi_endproc
 2404              	.LFE10:
 2406              		.section	.text.dir_sdi,"ax",%progbits
 2407              		.align	1
 2408              		.syntax unified
 2409              		.thumb
 2410              		.thumb_func
 2412              	dir_sdi:
 2413              	.LVL299:
 2414              	.LFB15:
1701:Core/Src/FAT/ff.c **** 	DWORD csz, clst;
 2415              		.loc 1 1701 1 is_stmt 1 view -0
 2416              		.cfi_startproc
 2417              		@ args = 0, pretend = 0, frame = 0
 2418              		@ frame_needed = 0, uses_anonymous_args = 0
1701:Core/Src/FAT/ff.c **** 	DWORD csz, clst;
 2419              		.loc 1 1701 1 is_stmt 0 view .LVU792
 2420 0000 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 2421              	.LCFI13:
 2422              		.cfi_def_cfa_offset 24
 2423              		.cfi_offset 4, -24
 2424              		.cfi_offset 5, -20
 2425              		.cfi_offset 6, -16
 2426              		.cfi_offset 7, -12
 2427              		.cfi_offset 8, -8
 2428              		.cfi_offset 14, -4
1702:Core/Src/FAT/ff.c **** 	FATFS *fs = dp->obj.fs;
 2429              		.loc 1 1702 2 is_stmt 1 view .LVU793
1703:Core/Src/FAT/ff.c **** 
 2430              		.loc 1 1703 2 view .LVU794
1703:Core/Src/FAT/ff.c **** 
 2431              		.loc 1 1703 9 is_stmt 0 view .LVU795
 2432 0004 D0F80080 		ldr	r8, [r0]
 2433              	.LVL300:
1706:Core/Src/FAT/ff.c **** 		return FR_INT_ERR;
 2434              		.loc 1 1706 2 is_stmt 1 view .LVU796
1706:Core/Src/FAT/ff.c **** 		return FR_INT_ERR;
 2435              		.loc 1 1706 5 is_stmt 0 view .LVU797
 2436 0008 B1F5001F 		cmp	r1, #2097152
 2437 000c 40D2     		bcs	.L181
 2438 000e 0646     		mov	r6, r0
 2439 0010 0F46     		mov	r7, r1
1706:Core/Src/FAT/ff.c **** 		return FR_INT_ERR;
 2440              		.loc 1 1706 86 discriminator 1 view .LVU798
 2441 0012 11F01F0F 		tst	r1, #31
 2442 0016 3DD1     		bne	.L182
1709:Core/Src/FAT/ff.c **** 	clst = dp->obj.sclust;		/* Table start cluster (0:root) */
 2443              		.loc 1 1709 2 is_stmt 1 view .LVU799
1709:Core/Src/FAT/ff.c **** 	clst = dp->obj.sclust;		/* Table start cluster (0:root) */
 2444              		.loc 1 1709 11 is_stmt 0 view .LVU800
 2445 0018 0161     		str	r1, [r0, #16]
1710:Core/Src/FAT/ff.c **** 	if (clst == 0 && fs->fs_type >= FS_FAT32) {	/* Replace cluster# 0 with root cluster# */
 2446              		.loc 1 1710 2 is_stmt 1 view .LVU801
1710:Core/Src/FAT/ff.c **** 	if (clst == 0 && fs->fs_type >= FS_FAT32) {	/* Replace cluster# 0 with root cluster# */
 2447              		.loc 1 1710 7 is_stmt 0 view .LVU802
 2448 001a 8468     		ldr	r4, [r0, #8]
 2449              	.LVL301:
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 118


1711:Core/Src/FAT/ff.c **** 		clst = (DWORD)fs->dirbase;
 2450              		.loc 1 1711 2 is_stmt 1 view .LVU803
1711:Core/Src/FAT/ff.c **** 		clst = (DWORD)fs->dirbase;
 2451              		.loc 1 1711 5 is_stmt 0 view .LVU804
 2452 001c 2CB9     		cbnz	r4, .L176
1711:Core/Src/FAT/ff.c **** 		clst = (DWORD)fs->dirbase;
 2453              		.loc 1 1711 21 discriminator 1 view .LVU805
 2454 001e 98F80030 		ldrb	r3, [r8]	@ zero_extendqisi2
1711:Core/Src/FAT/ff.c **** 		clst = (DWORD)fs->dirbase;
 2455              		.loc 1 1711 16 discriminator 1 view .LVU806
 2456 0022 022B     		cmp	r3, #2
 2457 0024 01D9     		bls	.L176
1712:Core/Src/FAT/ff.c **** 		if (FF_FS_EXFAT) dp->obj.stat = 0;	/* exFAT: Root dir has an FAT chain */
 2458              		.loc 1 1712 3 is_stmt 1 view .LVU807
1712:Core/Src/FAT/ff.c **** 		if (FF_FS_EXFAT) dp->obj.stat = 0;	/* exFAT: Root dir has an FAT chain */
 2459              		.loc 1 1712 8 is_stmt 0 view .LVU808
 2460 0026 D8F82440 		ldr	r4, [r8, #36]
 2461              	.LVL302:
1713:Core/Src/FAT/ff.c **** 	}
 2462              		.loc 1 1713 3 is_stmt 1 view .LVU809
 2463              	.L176:
1716:Core/Src/FAT/ff.c **** 		if (ofs / SZDIRE >= fs->n_rootdir) return FR_INT_ERR;	/* Is index out of range? */
 2464              		.loc 1 1716 2 view .LVU810
1716:Core/Src/FAT/ff.c **** 		if (ofs / SZDIRE >= fs->n_rootdir) return FR_INT_ERR;	/* Is index out of range? */
 2465              		.loc 1 1716 5 is_stmt 0 view .LVU811
 2466 002a B4B9     		cbnz	r4, .L177
1717:Core/Src/FAT/ff.c **** 		dp->sect = fs->dirbase;
 2467              		.loc 1 1717 3 is_stmt 1 view .LVU812
1717:Core/Src/FAT/ff.c **** 		dp->sect = fs->dirbase;
 2468              		.loc 1 1717 25 is_stmt 0 view .LVU813
 2469 002c B8F80830 		ldrh	r3, [r8, #8]
1717:Core/Src/FAT/ff.c **** 		dp->sect = fs->dirbase;
 2470              		.loc 1 1717 6 view .LVU814
 2471 0030 B3EB571F 		cmp	r3, r7, lsr #5
 2472 0034 30D9     		bls	.L183
1718:Core/Src/FAT/ff.c **** 
 2473              		.loc 1 1718 3 is_stmt 1 view .LVU815
1718:Core/Src/FAT/ff.c **** 
 2474              		.loc 1 1718 16 is_stmt 0 view .LVU816
 2475 0036 D8F82430 		ldr	r3, [r8, #36]
1718:Core/Src/FAT/ff.c **** 
 2476              		.loc 1 1718 12 view .LVU817
 2477 003a B361     		str	r3, [r6, #24]
 2478              	.LVL303:
 2479              	.L178:
1730:Core/Src/FAT/ff.c **** 	if (dp->sect == 0) return FR_INT_ERR;
 2480              		.loc 1 1730 2 is_stmt 1 view .LVU818
1730:Core/Src/FAT/ff.c **** 	if (dp->sect == 0) return FR_INT_ERR;
 2481              		.loc 1 1730 12 is_stmt 0 view .LVU819
 2482 003c 7461     		str	r4, [r6, #20]
1731:Core/Src/FAT/ff.c **** 	dp->sect += ofs / SS(fs);			/* Sector# of the directory entry */
 2483              		.loc 1 1731 2 is_stmt 1 view .LVU820
1731:Core/Src/FAT/ff.c **** 	dp->sect += ofs / SS(fs);			/* Sector# of the directory entry */
 2484              		.loc 1 1731 8 is_stmt 0 view .LVU821
 2485 003e B369     		ldr	r3, [r6, #24]
1731:Core/Src/FAT/ff.c **** 	dp->sect += ofs / SS(fs);			/* Sector# of the directory entry */
 2486              		.loc 1 1731 5 view .LVU822
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 119


 2487 0040 93B3     		cbz	r3, .L187
1732:Core/Src/FAT/ff.c **** 	dp->dir = fs->win + (ofs % SS(fs));	/* Pointer to the entry in the win[] */
 2488              		.loc 1 1732 2 is_stmt 1 view .LVU823
1732:Core/Src/FAT/ff.c **** 	dp->dir = fs->win + (ofs % SS(fs));	/* Pointer to the entry in the win[] */
 2489              		.loc 1 1732 11 is_stmt 0 view .LVU824
 2490 0042 03EB5723 		add	r3, r3, r7, lsr #9
 2491 0046 B361     		str	r3, [r6, #24]
1733:Core/Src/FAT/ff.c **** 
 2492              		.loc 1 1733 2 is_stmt 1 view .LVU825
1733:Core/Src/FAT/ff.c **** 
 2493              		.loc 1 1733 12 is_stmt 0 view .LVU826
 2494 0048 08F13003 		add	r3, r8, #48
1733:Core/Src/FAT/ff.c **** 
 2495              		.loc 1 1733 27 view .LVU827
 2496 004c C7F30801 		ubfx	r1, r7, #0, #9
1733:Core/Src/FAT/ff.c **** 
 2497              		.loc 1 1733 20 view .LVU828
 2498 0050 1944     		add	r1, r1, r3
1733:Core/Src/FAT/ff.c **** 
 2499              		.loc 1 1733 10 view .LVU829
 2500 0052 F161     		str	r1, [r6, #28]
1735:Core/Src/FAT/ff.c **** }
 2501              		.loc 1 1735 2 is_stmt 1 view .LVU830
1735:Core/Src/FAT/ff.c **** }
 2502              		.loc 1 1735 9 is_stmt 0 view .LVU831
 2503 0054 0020     		movs	r0, #0
 2504              	.LVL304:
 2505              	.L175:
1736:Core/Src/FAT/ff.c **** 
 2506              		.loc 1 1736 1 view .LVU832
 2507 0056 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 2508              	.LVL305:
 2509              	.L177:
1721:Core/Src/FAT/ff.c **** 		while (ofs >= csz) {				/* Follow cluster chain */
 2510              		.loc 1 1721 3 is_stmt 1 view .LVU833
1721:Core/Src/FAT/ff.c **** 		while (ofs >= csz) {				/* Follow cluster chain */
 2511              		.loc 1 1721 18 is_stmt 0 view .LVU834
 2512 005a B8F80A50 		ldrh	r5, [r8, #10]
1721:Core/Src/FAT/ff.c **** 		while (ofs >= csz) {				/* Follow cluster chain */
 2513              		.loc 1 1721 7 view .LVU835
 2514 005e 6D02     		lsls	r5, r5, #9
 2515              	.LVL306:
1722:Core/Src/FAT/ff.c **** 			clst = get_fat(&dp->obj, clst);				/* Get next cluster */
 2516              		.loc 1 1722 3 is_stmt 1 view .LVU836
 2517              	.L179:
1722:Core/Src/FAT/ff.c **** 			clst = get_fat(&dp->obj, clst);				/* Get next cluster */
 2518              		.loc 1 1722 9 view .LVU837
 2519 0060 AF42     		cmp	r7, r5
 2520 0062 0FD3     		bcc	.L189
1723:Core/Src/FAT/ff.c **** 			if (clst == 0xFFFFFFFF) return FR_DISK_ERR;	/* Disk error */
 2521              		.loc 1 1723 4 view .LVU838
1723:Core/Src/FAT/ff.c **** 			if (clst == 0xFFFFFFFF) return FR_DISK_ERR;	/* Disk error */
 2522              		.loc 1 1723 11 is_stmt 0 view .LVU839
 2523 0064 2146     		mov	r1, r4
 2524 0066 3046     		mov	r0, r6
 2525 0068 FFF7FEFF 		bl	get_fat
 2526              	.LVL307:
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 120


 2527 006c 0446     		mov	r4, r0
 2528              	.LVL308:
1724:Core/Src/FAT/ff.c **** 			if (clst < 2 || clst >= fs->n_fatent) return FR_INT_ERR;	/* Reached to end of table or internal 
 2529              		.loc 1 1724 4 is_stmt 1 view .LVU840
1724:Core/Src/FAT/ff.c **** 			if (clst < 2 || clst >= fs->n_fatent) return FR_INT_ERR;	/* Reached to end of table or internal 
 2530              		.loc 1 1724 7 is_stmt 0 view .LVU841
 2531 006e B0F1FF3F 		cmp	r0, #-1
 2532 0072 13D0     		beq	.L184
1725:Core/Src/FAT/ff.c **** 			ofs -= csz;
 2533              		.loc 1 1725 4 is_stmt 1 view .LVU842
1725:Core/Src/FAT/ff.c **** 			ofs -= csz;
 2534              		.loc 1 1725 7 is_stmt 0 view .LVU843
 2535 0074 0128     		cmp	r0, #1
 2536 0076 13D9     		bls	.L185
1725:Core/Src/FAT/ff.c **** 			ofs -= csz;
 2537              		.loc 1 1725 30 discriminator 2 view .LVU844
 2538 0078 D8F81430 		ldr	r3, [r8, #20]
1725:Core/Src/FAT/ff.c **** 			ofs -= csz;
 2539              		.loc 1 1725 17 discriminator 2 view .LVU845
 2540 007c 8342     		cmp	r3, r0
 2541 007e 11D9     		bls	.L186
1726:Core/Src/FAT/ff.c **** 		}
 2542              		.loc 1 1726 4 is_stmt 1 view .LVU846
1726:Core/Src/FAT/ff.c **** 		}
 2543              		.loc 1 1726 8 is_stmt 0 view .LVU847
 2544 0080 7F1B     		subs	r7, r7, r5
 2545              	.LVL309:
1726:Core/Src/FAT/ff.c **** 		}
 2546              		.loc 1 1726 8 view .LVU848
 2547 0082 EDE7     		b	.L179
 2548              	.LVL310:
 2549              	.L189:
1728:Core/Src/FAT/ff.c **** 	}
 2550              		.loc 1 1728 3 is_stmt 1 view .LVU849
1728:Core/Src/FAT/ff.c **** 	}
 2551              		.loc 1 1728 14 is_stmt 0 view .LVU850
 2552 0084 2146     		mov	r1, r4
 2553 0086 4046     		mov	r0, r8
 2554 0088 FFF7FEFF 		bl	clst2sect
 2555              	.LVL311:
1728:Core/Src/FAT/ff.c **** 	}
 2556              		.loc 1 1728 12 view .LVU851
 2557 008c B061     		str	r0, [r6, #24]
 2558 008e D5E7     		b	.L178
 2559              	.LVL312:
 2560              	.L181:
1707:Core/Src/FAT/ff.c **** 	}
 2561              		.loc 1 1707 10 view .LVU852
 2562 0090 0220     		movs	r0, #2
 2563              	.LVL313:
1707:Core/Src/FAT/ff.c **** 	}
 2564              		.loc 1 1707 10 view .LVU853
 2565 0092 E0E7     		b	.L175
 2566              	.LVL314:
 2567              	.L182:
1707:Core/Src/FAT/ff.c **** 	}
 2568              		.loc 1 1707 10 view .LVU854
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 121


 2569 0094 0220     		movs	r0, #2
 2570              	.LVL315:
1707:Core/Src/FAT/ff.c **** 	}
 2571              		.loc 1 1707 10 view .LVU855
 2572 0096 DEE7     		b	.L175
 2573              	.LVL316:
 2574              	.L183:
1717:Core/Src/FAT/ff.c **** 		dp->sect = fs->dirbase;
 2575              		.loc 1 1717 45 view .LVU856
 2576 0098 0220     		movs	r0, #2
 2577              	.LVL317:
1717:Core/Src/FAT/ff.c **** 		dp->sect = fs->dirbase;
 2578              		.loc 1 1717 45 view .LVU857
 2579 009a DCE7     		b	.L175
 2580              	.LVL318:
 2581              	.L184:
1724:Core/Src/FAT/ff.c **** 			if (clst < 2 || clst >= fs->n_fatent) return FR_INT_ERR;	/* Reached to end of table or internal 
 2582              		.loc 1 1724 35 view .LVU858
 2583 009c 0120     		movs	r0, #1
 2584              	.LVL319:
1724:Core/Src/FAT/ff.c **** 			if (clst < 2 || clst >= fs->n_fatent) return FR_INT_ERR;	/* Reached to end of table or internal 
 2585              		.loc 1 1724 35 view .LVU859
 2586 009e DAE7     		b	.L175
 2587              	.LVL320:
 2588              	.L185:
1725:Core/Src/FAT/ff.c **** 			ofs -= csz;
 2589              		.loc 1 1725 49 view .LVU860
 2590 00a0 0220     		movs	r0, #2
 2591              	.LVL321:
1725:Core/Src/FAT/ff.c **** 			ofs -= csz;
 2592              		.loc 1 1725 49 view .LVU861
 2593 00a2 D8E7     		b	.L175
 2594              	.LVL322:
 2595              	.L186:
1725:Core/Src/FAT/ff.c **** 			ofs -= csz;
 2596              		.loc 1 1725 49 view .LVU862
 2597 00a4 0220     		movs	r0, #2
 2598              	.LVL323:
1725:Core/Src/FAT/ff.c **** 			ofs -= csz;
 2599              		.loc 1 1725 49 view .LVU863
 2600 00a6 D6E7     		b	.L175
 2601              	.LVL324:
 2602              	.L187:
1731:Core/Src/FAT/ff.c **** 	dp->sect += ofs / SS(fs);			/* Sector# of the directory entry */
 2603              		.loc 1 1731 28 view .LVU864
 2604 00a8 0220     		movs	r0, #2
 2605 00aa D4E7     		b	.L175
 2606              		.cfi_endproc
 2607              	.LFE15:
 2609              		.section	.text.create_chain,"ax",%progbits
 2610              		.align	1
 2611              		.syntax unified
 2612              		.thumb
 2613              		.thumb_func
 2615              	create_chain:
 2616              	.LVL325:
 2617              	.LFB13:
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 122


1528:Core/Src/FAT/ff.c **** 	DWORD cs, ncl, scl;
 2618              		.loc 1 1528 1 is_stmt 1 view -0
 2619              		.cfi_startproc
 2620              		@ args = 0, pretend = 0, frame = 0
 2621              		@ frame_needed = 0, uses_anonymous_args = 0
1528:Core/Src/FAT/ff.c **** 	DWORD cs, ncl, scl;
 2622              		.loc 1 1528 1 is_stmt 0 view .LVU866
 2623 0000 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 2624              	.LCFI14:
 2625              		.cfi_def_cfa_offset 24
 2626              		.cfi_offset 4, -24
 2627              		.cfi_offset 5, -20
 2628              		.cfi_offset 6, -16
 2629              		.cfi_offset 7, -12
 2630              		.cfi_offset 8, -8
 2631              		.cfi_offset 14, -4
 2632 0004 0546     		mov	r5, r0
1529:Core/Src/FAT/ff.c **** 	FRESULT res;
 2633              		.loc 1 1529 2 is_stmt 1 view .LVU867
1530:Core/Src/FAT/ff.c **** 	FATFS *fs = obj->fs;
 2634              		.loc 1 1530 2 view .LVU868
1531:Core/Src/FAT/ff.c **** 
 2635              		.loc 1 1531 2 view .LVU869
1531:Core/Src/FAT/ff.c **** 
 2636              		.loc 1 1531 9 is_stmt 0 view .LVU870
 2637 0006 0668     		ldr	r6, [r0]
 2638              	.LVL326:
1534:Core/Src/FAT/ff.c **** 		scl = fs->last_clst;				/* Suggested cluster to start to find */
 2639              		.loc 1 1534 2 is_stmt 1 view .LVU871
1534:Core/Src/FAT/ff.c **** 		scl = fs->last_clst;				/* Suggested cluster to start to find */
 2640              		.loc 1 1534 5 is_stmt 0 view .LVU872
 2641 0008 0F46     		mov	r7, r1
 2642 000a 51B9     		cbnz	r1, .L191
1535:Core/Src/FAT/ff.c **** 		if (scl == 0 || scl >= fs->n_fatent) scl = 1;
 2643              		.loc 1 1535 3 is_stmt 1 view .LVU873
1535:Core/Src/FAT/ff.c **** 		if (scl == 0 || scl >= fs->n_fatent) scl = 1;
 2644              		.loc 1 1535 7 is_stmt 0 view .LVU874
 2645 000c D6F80C80 		ldr	r8, [r6, #12]
 2646              	.LVL327:
1536:Core/Src/FAT/ff.c **** 	}
 2647              		.loc 1 1536 3 is_stmt 1 view .LVU875
1536:Core/Src/FAT/ff.c **** 	}
 2648              		.loc 1 1536 6 is_stmt 0 view .LVU876
 2649 0010 B8F1000F 		cmp	r8, #0
 2650 0014 12D0     		beq	.L203
1536:Core/Src/FAT/ff.c **** 	}
 2651              		.loc 1 1536 28 discriminator 2 view .LVU877
 2652 0016 7369     		ldr	r3, [r6, #20]
1536:Core/Src/FAT/ff.c **** 	}
 2653              		.loc 1 1536 16 discriminator 2 view .LVU878
 2654 0018 4345     		cmp	r3, r8
 2655 001a 11D8     		bhi	.L192
1536:Core/Src/FAT/ff.c **** 	}
 2656              		.loc 1 1536 44 view .LVU879
 2657 001c 4FF00108 		mov	r8, #1
 2658              	.LVL328:
1536:Core/Src/FAT/ff.c **** 	}
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 123


 2659              		.loc 1 1536 44 view .LVU880
 2660 0020 0EE0     		b	.L192
 2661              	.LVL329:
 2662              	.L191:
1539:Core/Src/FAT/ff.c **** 		if (cs < 2) return 1;				/* Test for insanity */
 2663              		.loc 1 1539 3 is_stmt 1 view .LVU881
1539:Core/Src/FAT/ff.c **** 		if (cs < 2) return 1;				/* Test for insanity */
 2664              		.loc 1 1539 8 is_stmt 0 view .LVU882
 2665 0022 FFF7FEFF 		bl	get_fat
 2666              	.LVL330:
1539:Core/Src/FAT/ff.c **** 		if (cs < 2) return 1;				/* Test for insanity */
 2667              		.loc 1 1539 8 view .LVU883
 2668 0026 0346     		mov	r3, r0
 2669              	.LVL331:
1540:Core/Src/FAT/ff.c **** 		if (cs == 0xFFFFFFFF) return cs;	/* Test for disk error */
 2670              		.loc 1 1540 3 is_stmt 1 view .LVU884
1540:Core/Src/FAT/ff.c **** 		if (cs == 0xFFFFFFFF) return cs;	/* Test for disk error */
 2671              		.loc 1 1540 6 is_stmt 0 view .LVU885
 2672 0028 0128     		cmp	r0, #1
 2673 002a 68D9     		bls	.L205
1541:Core/Src/FAT/ff.c **** 		if (cs < fs->n_fatent) return cs;	/* It is already followed by next cluster */
 2674              		.loc 1 1541 3 is_stmt 1 view .LVU886
1541:Core/Src/FAT/ff.c **** 		if (cs < fs->n_fatent) return cs;	/* It is already followed by next cluster */
 2675              		.loc 1 1541 6 is_stmt 0 view .LVU887
 2676 002c B0F1FF3F 		cmp	r0, #-1
 2677 0030 6AD0     		beq	.L190
1542:Core/Src/FAT/ff.c **** 		scl = clst;							/* Cluster to start to find */
 2678              		.loc 1 1542 3 is_stmt 1 view .LVU888
1542:Core/Src/FAT/ff.c **** 		scl = clst;							/* Cluster to start to find */
 2679              		.loc 1 1542 14 is_stmt 0 view .LVU889
 2680 0032 7269     		ldr	r2, [r6, #20]
1542:Core/Src/FAT/ff.c **** 		scl = clst;							/* Cluster to start to find */
 2681              		.loc 1 1542 6 view .LVU890
 2682 0034 8242     		cmp	r2, r0
 2683 0036 67D8     		bhi	.L190
1543:Core/Src/FAT/ff.c **** 	}
 2684              		.loc 1 1543 7 view .LVU891
 2685 0038 B846     		mov	r8, r7
 2686 003a 01E0     		b	.L192
 2687              	.LVL332:
 2688              	.L203:
1536:Core/Src/FAT/ff.c **** 	}
 2689              		.loc 1 1536 44 view .LVU892
 2690 003c 4FF00108 		mov	r8, #1
 2691              	.LVL333:
 2692              	.L192:
1545:Core/Src/FAT/ff.c **** 
 2693              		.loc 1 1545 2 is_stmt 1 view .LVU893
1545:Core/Src/FAT/ff.c **** 
 2694              		.loc 1 1545 8 is_stmt 0 view .LVU894
 2695 0040 3369     		ldr	r3, [r6, #16]
1545:Core/Src/FAT/ff.c **** 
 2696              		.loc 1 1545 5 view .LVU895
 2697 0042 002B     		cmp	r3, #0
 2698 0044 60D0     		beq	.L190
1574:Core/Src/FAT/ff.c **** 		if (scl == clst) {						/* Stretching an existing chain? */
 2699              		.loc 1 1574 3 is_stmt 1 view .LVU896
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 124


 2700              	.LVL334:
1575:Core/Src/FAT/ff.c **** 			ncl = scl + 1;						/* Test if next cluster is free */
 2701              		.loc 1 1575 3 view .LVU897
1575:Core/Src/FAT/ff.c **** 			ncl = scl + 1;						/* Test if next cluster is free */
 2702              		.loc 1 1575 6 is_stmt 0 view .LVU898
 2703 0046 B845     		cmp	r8, r7
 2704 0048 01D0     		beq	.L212
 2705              	.LVL335:
 2706              	.L194:
1582:Core/Src/FAT/ff.c **** 				ncl = 0;
 2707              		.loc 1 1582 43 view .LVU899
 2708 004a 4446     		mov	r4, r8
 2709 004c 40E0     		b	.L199
 2710              	.LVL336:
 2711              	.L212:
1576:Core/Src/FAT/ff.c **** 			if (ncl >= fs->n_fatent) ncl = 2;
 2712              		.loc 1 1576 4 is_stmt 1 view .LVU900
1576:Core/Src/FAT/ff.c **** 			if (ncl >= fs->n_fatent) ncl = 2;
 2713              		.loc 1 1576 8 is_stmt 0 view .LVU901
 2714 004e 08F10104 		add	r4, r8, #1
 2715              	.LVL337:
1577:Core/Src/FAT/ff.c **** 			cs = get_fat(obj, ncl);				/* Get next cluster status */
 2716              		.loc 1 1577 4 is_stmt 1 view .LVU902
1577:Core/Src/FAT/ff.c **** 			cs = get_fat(obj, ncl);				/* Get next cluster status */
 2717              		.loc 1 1577 17 is_stmt 0 view .LVU903
 2718 0052 7369     		ldr	r3, [r6, #20]
1577:Core/Src/FAT/ff.c **** 			cs = get_fat(obj, ncl);				/* Get next cluster status */
 2719              		.loc 1 1577 7 view .LVU904
 2720 0054 A342     		cmp	r3, r4
 2721 0056 00D8     		bhi	.L195
1577:Core/Src/FAT/ff.c **** 			cs = get_fat(obj, ncl);				/* Get next cluster status */
 2722              		.loc 1 1577 33 view .LVU905
 2723 0058 0224     		movs	r4, #2
 2724              	.LVL338:
 2725              	.L195:
1578:Core/Src/FAT/ff.c **** 			if (cs == 1 || cs == 0xFFFFFFFF) return cs;	/* Test for error */
 2726              		.loc 1 1578 4 is_stmt 1 view .LVU906
1578:Core/Src/FAT/ff.c **** 			if (cs == 1 || cs == 0xFFFFFFFF) return cs;	/* Test for error */
 2727              		.loc 1 1578 9 is_stmt 0 view .LVU907
 2728 005a 2146     		mov	r1, r4
 2729 005c 2846     		mov	r0, r5
 2730 005e FFF7FEFF 		bl	get_fat
 2731              	.LVL339:
 2732 0062 0346     		mov	r3, r0
 2733              	.LVL340:
1579:Core/Src/FAT/ff.c **** 			if (cs != 0) {						/* Not free? */
 2734              		.loc 1 1579 4 is_stmt 1 view .LVU908
1579:Core/Src/FAT/ff.c **** 			if (cs != 0) {						/* Not free? */
 2735              		.loc 1 1579 7 is_stmt 0 view .LVU909
 2736 0064 0128     		cmp	r0, #1
 2737 0066 4FD0     		beq	.L190
1579:Core/Src/FAT/ff.c **** 			if (cs != 0) {						/* Not free? */
 2738              		.loc 1 1579 16 discriminator 2 view .LVU910
 2739 0068 B0F1FF3F 		cmp	r0, #-1
 2740 006c 4CD0     		beq	.L190
1580:Core/Src/FAT/ff.c **** 				cs = fs->last_clst;				/* Start at suggested cluster if it is valid */
 2741              		.loc 1 1580 4 is_stmt 1 view .LVU911
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 125


1580:Core/Src/FAT/ff.c **** 				cs = fs->last_clst;				/* Start at suggested cluster if it is valid */
 2742              		.loc 1 1580 7 is_stmt 0 view .LVU912
 2743 006e 38B1     		cbz	r0, .L196
1581:Core/Src/FAT/ff.c **** 				if (cs >= 2 && cs < fs->n_fatent) scl = cs;
 2744              		.loc 1 1581 5 is_stmt 1 view .LVU913
1581:Core/Src/FAT/ff.c **** 				if (cs >= 2 && cs < fs->n_fatent) scl = cs;
 2745              		.loc 1 1581 8 is_stmt 0 view .LVU914
 2746 0070 F368     		ldr	r3, [r6, #12]
 2747              	.LVL341:
1582:Core/Src/FAT/ff.c **** 				ncl = 0;
 2748              		.loc 1 1582 5 is_stmt 1 view .LVU915
1582:Core/Src/FAT/ff.c **** 				ncl = 0;
 2749              		.loc 1 1582 8 is_stmt 0 view .LVU916
 2750 0072 012B     		cmp	r3, #1
 2751 0074 E9D9     		bls	.L194
1582:Core/Src/FAT/ff.c **** 				ncl = 0;
 2752              		.loc 1 1582 27 discriminator 1 view .LVU917
 2753 0076 7269     		ldr	r2, [r6, #20]
1582:Core/Src/FAT/ff.c **** 				ncl = 0;
 2754              		.loc 1 1582 17 discriminator 1 view .LVU918
 2755 0078 9A42     		cmp	r2, r3
 2756 007a E6D9     		bls	.L194
1582:Core/Src/FAT/ff.c **** 				ncl = 0;
 2757              		.loc 1 1582 43 view .LVU919
 2758 007c 9846     		mov	r8, r3
 2759              	.LVL342:
1582:Core/Src/FAT/ff.c **** 				ncl = 0;
 2760              		.loc 1 1582 43 view .LVU920
 2761 007e E4E7     		b	.L194
 2762              	.LVL343:
 2763              	.L196:
1586:Core/Src/FAT/ff.c **** 			ncl = scl;	/* Start cluster */
 2764              		.loc 1 1586 3 is_stmt 1 view .LVU921
1586:Core/Src/FAT/ff.c **** 			ncl = scl;	/* Start cluster */
 2765              		.loc 1 1586 6 is_stmt 0 view .LVU922
 2766 0080 002C     		cmp	r4, #0
 2767 0082 E2D0     		beq	.L194
 2768              	.LVL344:
 2769              	.L197:
1600:Core/Src/FAT/ff.c **** 		if (res == FR_OK && clst != 0) {
 2770              		.loc 1 1600 3 is_stmt 1 view .LVU923
1600:Core/Src/FAT/ff.c **** 		if (res == FR_OK && clst != 0) {
 2771              		.loc 1 1600 9 is_stmt 0 view .LVU924
 2772 0084 4FF0FF32 		mov	r2, #-1
 2773 0088 2146     		mov	r1, r4
 2774 008a 3046     		mov	r0, r6
 2775              	.LVL345:
1600:Core/Src/FAT/ff.c **** 		if (res == FR_OK && clst != 0) {
 2776              		.loc 1 1600 9 view .LVU925
 2777 008c FFF7FEFF 		bl	put_fat
 2778              	.LVL346:
1601:Core/Src/FAT/ff.c **** 			res = put_fat(fs, clst, ncl);		/* Link it from the previous one if needed */
 2779              		.loc 1 1601 3 is_stmt 1 view .LVU926
1601:Core/Src/FAT/ff.c **** 			res = put_fat(fs, clst, ncl);		/* Link it from the previous one if needed */
 2780              		.loc 1 1601 6 is_stmt 0 view .LVU927
 2781 0090 0346     		mov	r3, r0
 2782 0092 00B9     		cbnz	r0, .L200
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 126


1601:Core/Src/FAT/ff.c **** 			res = put_fat(fs, clst, ncl);		/* Link it from the previous one if needed */
 2783              		.loc 1 1601 20 discriminator 1 view .LVU928
 2784 0094 2FBB     		cbnz	r7, .L213
 2785              	.LVL347:
 2786              	.L200:
1606:Core/Src/FAT/ff.c **** 		fs->last_clst = ncl;
 2787              		.loc 1 1606 2 is_stmt 1 view .LVU929
1606:Core/Src/FAT/ff.c **** 		fs->last_clst = ncl;
 2788              		.loc 1 1606 5 is_stmt 0 view .LVU930
 2789 0096 5BBB     		cbnz	r3, .L201
1607:Core/Src/FAT/ff.c **** 		if (fs->free_clst <= fs->n_fatent - 2) fs->free_clst--;
 2790              		.loc 1 1607 3 is_stmt 1 view .LVU931
1607:Core/Src/FAT/ff.c **** 		if (fs->free_clst <= fs->n_fatent - 2) fs->free_clst--;
 2791              		.loc 1 1607 17 is_stmt 0 view .LVU932
 2792 0098 F460     		str	r4, [r6, #12]
1608:Core/Src/FAT/ff.c **** 		fs->fsi_flag |= 1;
 2793              		.loc 1 1608 3 is_stmt 1 view .LVU933
1608:Core/Src/FAT/ff.c **** 		fs->fsi_flag |= 1;
 2794              		.loc 1 1608 9 is_stmt 0 view .LVU934
 2795 009a 3269     		ldr	r2, [r6, #16]
1608:Core/Src/FAT/ff.c **** 		fs->fsi_flag |= 1;
 2796              		.loc 1 1608 26 view .LVU935
 2797 009c 7369     		ldr	r3, [r6, #20]
 2798              	.LVL348:
1608:Core/Src/FAT/ff.c **** 		fs->fsi_flag |= 1;
 2799              		.loc 1 1608 37 view .LVU936
 2800 009e 023B     		subs	r3, r3, #2
1608:Core/Src/FAT/ff.c **** 		fs->fsi_flag |= 1;
 2801              		.loc 1 1608 6 view .LVU937
 2802 00a0 9A42     		cmp	r2, r3
 2803 00a2 01D8     		bhi	.L202
1608:Core/Src/FAT/ff.c **** 		fs->fsi_flag |= 1;
 2804              		.loc 1 1608 42 is_stmt 1 discriminator 1 view .LVU938
1608:Core/Src/FAT/ff.c **** 		fs->fsi_flag |= 1;
 2805              		.loc 1 1608 55 is_stmt 0 discriminator 1 view .LVU939
 2806 00a4 013A     		subs	r2, r2, #1
 2807 00a6 3261     		str	r2, [r6, #16]
 2808              	.L202:
1609:Core/Src/FAT/ff.c **** 	} else {
 2809              		.loc 1 1609 3 is_stmt 1 view .LVU940
1609:Core/Src/FAT/ff.c **** 	} else {
 2810              		.loc 1 1609 16 is_stmt 0 view .LVU941
 2811 00a8 7379     		ldrb	r3, [r6, #5]	@ zero_extendqisi2
 2812 00aa 43F00103 		orr	r3, r3, #1
 2813 00ae 7371     		strb	r3, [r6, #5]
 2814 00b0 2346     		mov	r3, r4
 2815 00b2 29E0     		b	.L190
 2816              	.LVL349:
 2817              	.L198:
1594:Core/Src/FAT/ff.c **** 				if (cs == 0) break;				/* Found a free cluster? */
 2818              		.loc 1 1594 5 is_stmt 1 view .LVU942
1594:Core/Src/FAT/ff.c **** 				if (cs == 0) break;				/* Found a free cluster? */
 2819              		.loc 1 1594 10 is_stmt 0 view .LVU943
 2820 00b4 2146     		mov	r1, r4
 2821 00b6 2846     		mov	r0, r5
 2822 00b8 FFF7FEFF 		bl	get_fat
 2823              	.LVL350:
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 127


1595:Core/Src/FAT/ff.c **** 				if (cs == 1 || cs == 0xFFFFFFFF) return cs;	/* Test for error */
 2824              		.loc 1 1595 5 is_stmt 1 view .LVU944
1595:Core/Src/FAT/ff.c **** 				if (cs == 1 || cs == 0xFFFFFFFF) return cs;	/* Test for error */
 2825              		.loc 1 1595 8 is_stmt 0 view .LVU945
 2826 00bc 0346     		mov	r3, r0
 2827 00be 0028     		cmp	r0, #0
 2828 00c0 E0D0     		beq	.L197
1596:Core/Src/FAT/ff.c **** 				if (ncl == scl) return 0;		/* No free cluster found? */
 2829              		.loc 1 1596 5 is_stmt 1 view .LVU946
1596:Core/Src/FAT/ff.c **** 				if (ncl == scl) return 0;		/* No free cluster found? */
 2830              		.loc 1 1596 8 is_stmt 0 view .LVU947
 2831 00c2 0128     		cmp	r0, #1
 2832 00c4 20D0     		beq	.L190
1596:Core/Src/FAT/ff.c **** 				if (ncl == scl) return 0;		/* No free cluster found? */
 2833              		.loc 1 1596 17 discriminator 2 view .LVU948
 2834 00c6 B0F1FF3F 		cmp	r0, #-1
 2835 00ca 1DD0     		beq	.L190
1597:Core/Src/FAT/ff.c **** 			}
 2836              		.loc 1 1597 5 is_stmt 1 view .LVU949
1597:Core/Src/FAT/ff.c **** 			}
 2837              		.loc 1 1597 8 is_stmt 0 view .LVU950
 2838 00cc 4445     		cmp	r4, r8
 2839 00ce 1AD0     		beq	.L214
 2840              	.LVL351:
 2841              	.L199:
1588:Core/Src/FAT/ff.c **** 				ncl++;							/* Next cluster */
 2842              		.loc 1 1588 4 is_stmt 1 view .LVU951
1589:Core/Src/FAT/ff.c **** 				if (ncl >= fs->n_fatent) {		/* Check wrap-around */
 2843              		.loc 1 1589 5 view .LVU952
1589:Core/Src/FAT/ff.c **** 				if (ncl >= fs->n_fatent) {		/* Check wrap-around */
 2844              		.loc 1 1589 8 is_stmt 0 view .LVU953
 2845 00d0 0134     		adds	r4, r4, #1
 2846              	.LVL352:
1590:Core/Src/FAT/ff.c **** 					ncl = 2;
 2847              		.loc 1 1590 5 is_stmt 1 view .LVU954
1590:Core/Src/FAT/ff.c **** 					ncl = 2;
 2848              		.loc 1 1590 18 is_stmt 0 view .LVU955
 2849 00d2 7369     		ldr	r3, [r6, #20]
1590:Core/Src/FAT/ff.c **** 					ncl = 2;
 2850              		.loc 1 1590 8 view .LVU956
 2851 00d4 A342     		cmp	r3, r4
 2852 00d6 EDD8     		bhi	.L198
1591:Core/Src/FAT/ff.c **** 					if (ncl > scl) return 0;	/* No free cluster found? */
 2853              		.loc 1 1591 6 is_stmt 1 view .LVU957
 2854              	.LVL353:
1592:Core/Src/FAT/ff.c **** 				}
 2855              		.loc 1 1592 6 view .LVU958
1592:Core/Src/FAT/ff.c **** 				}
 2856              		.loc 1 1592 9 is_stmt 0 view .LVU959
 2857 00d8 B8F1010F 		cmp	r8, #1
 2858 00dc 11D9     		bls	.L208
1591:Core/Src/FAT/ff.c **** 					if (ncl > scl) return 0;	/* No free cluster found? */
 2859              		.loc 1 1591 10 view .LVU960
 2860 00de 0224     		movs	r4, #2
 2861 00e0 E8E7     		b	.L198
 2862              	.LVL354:
 2863              	.L213:
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 128


1602:Core/Src/FAT/ff.c **** 		}
 2864              		.loc 1 1602 4 is_stmt 1 view .LVU961
1602:Core/Src/FAT/ff.c **** 		}
 2865              		.loc 1 1602 10 is_stmt 0 view .LVU962
 2866 00e2 2246     		mov	r2, r4
 2867 00e4 3946     		mov	r1, r7
 2868 00e6 3046     		mov	r0, r6
 2869              	.LVL355:
1602:Core/Src/FAT/ff.c **** 		}
 2870              		.loc 1 1602 10 view .LVU963
 2871 00e8 FFF7FEFF 		bl	put_fat
 2872              	.LVL356:
 2873 00ec 0346     		mov	r3, r0
 2874              	.LVL357:
1602:Core/Src/FAT/ff.c **** 		}
 2875              		.loc 1 1602 10 view .LVU964
 2876 00ee D2E7     		b	.L200
 2877              	.L201:
1611:Core/Src/FAT/ff.c **** 	}
 2878              		.loc 1 1611 3 is_stmt 1 view .LVU965
1611:Core/Src/FAT/ff.c **** 	}
 2879              		.loc 1 1611 43 is_stmt 0 view .LVU966
 2880 00f0 012B     		cmp	r3, #1
 2881 00f2 01D0     		beq	.L215
 2882 00f4 0123     		movs	r3, #1
 2883              	.LVL358:
1611:Core/Src/FAT/ff.c **** 	}
 2884              		.loc 1 1611 43 view .LVU967
 2885 00f6 07E0     		b	.L190
 2886              	.LVL359:
 2887              	.L215:
1611:Core/Src/FAT/ff.c **** 	}
 2888              		.loc 1 1611 43 view .LVU968
 2889 00f8 4FF0FF33 		mov	r3, #-1
 2890              	.LVL360:
1611:Core/Src/FAT/ff.c **** 	}
 2891              		.loc 1 1611 43 view .LVU969
 2892 00fc 04E0     		b	.L190
 2893              	.LVL361:
 2894              	.L205:
1540:Core/Src/FAT/ff.c **** 		if (cs == 0xFFFFFFFF) return cs;	/* Test for disk error */
 2895              		.loc 1 1540 22 view .LVU970
 2896 00fe 0123     		movs	r3, #1
 2897 0100 02E0     		b	.L190
 2898              	.LVL362:
 2899              	.L208:
1592:Core/Src/FAT/ff.c **** 				}
 2900              		.loc 1 1592 28 view .LVU971
 2901 0102 0023     		movs	r3, #0
 2902 0104 00E0     		b	.L190
 2903              	.LVL363:
 2904              	.L214:
1597:Core/Src/FAT/ff.c **** 			}
 2905              		.loc 1 1597 28 view .LVU972
 2906 0106 0023     		movs	r3, #0
 2907              	.LVL364:
 2908              	.L190:
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 129


1615:Core/Src/FAT/ff.c **** 
 2909              		.loc 1 1615 1 view .LVU973
 2910 0108 1846     		mov	r0, r3
 2911 010a BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
1615:Core/Src/FAT/ff.c **** 
 2912              		.loc 1 1615 1 view .LVU974
 2913              		.cfi_endproc
 2914              	.LFE13:
 2916              		.section	.text.remove_chain,"ax",%progbits
 2917              		.align	1
 2918              		.syntax unified
 2919              		.thumb
 2920              		.thumb_func
 2922              	remove_chain:
 2923              	.LVL365:
 2924              	.LFB12:
1434:Core/Src/FAT/ff.c **** 	FRESULT res = FR_OK;
 2925              		.loc 1 1434 1 is_stmt 1 view -0
 2926              		.cfi_startproc
 2927              		@ args = 0, pretend = 0, frame = 0
 2928              		@ frame_needed = 0, uses_anonymous_args = 0
1434:Core/Src/FAT/ff.c **** 	FRESULT res = FR_OK;
 2929              		.loc 1 1434 1 is_stmt 0 view .LVU976
 2930 0000 F8B5     		push	{r3, r4, r5, r6, r7, lr}
 2931              	.LCFI15:
 2932              		.cfi_def_cfa_offset 24
 2933              		.cfi_offset 3, -24
 2934              		.cfi_offset 4, -20
 2935              		.cfi_offset 5, -16
 2936              		.cfi_offset 6, -12
 2937              		.cfi_offset 7, -8
 2938              		.cfi_offset 14, -4
 2939 0002 0C46     		mov	r4, r1
1435:Core/Src/FAT/ff.c **** 	DWORD nxt;
 2940              		.loc 1 1435 2 is_stmt 1 view .LVU977
 2941              	.LVL366:
1436:Core/Src/FAT/ff.c **** 	FATFS *fs = obj->fs;
 2942              		.loc 1 1436 2 view .LVU978
1437:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT || FF_USE_TRIM
 2943              		.loc 1 1437 2 view .LVU979
1437:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT || FF_USE_TRIM
 2944              		.loc 1 1437 9 is_stmt 0 view .LVU980
 2945 0004 0568     		ldr	r5, [r0]
 2946              	.LVL367:
1445:Core/Src/FAT/ff.c **** 
 2947              		.loc 1 1445 2 is_stmt 1 view .LVU981
1445:Core/Src/FAT/ff.c **** 
 2948              		.loc 1 1445 5 is_stmt 0 view .LVU982
 2949 0006 0129     		cmp	r1, #1
 2950 0008 2ED9     		bls	.L221
 2951 000a 0646     		mov	r6, r0
 2952 000c 1146     		mov	r1, r2
 2953              	.LVL368:
1445:Core/Src/FAT/ff.c **** 
 2954              		.loc 1 1445 28 discriminator 2 view .LVU983
 2955 000e 6B69     		ldr	r3, [r5, #20]
1445:Core/Src/FAT/ff.c **** 
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 130


 2956              		.loc 1 1445 15 discriminator 2 view .LVU984
 2957 0010 A342     		cmp	r3, r4
 2958 0012 2BD9     		bls	.L222
1448:Core/Src/FAT/ff.c **** 		res = put_fat(fs, pclst, 0xFFFFFFFF);
 2959              		.loc 1 1448 2 is_stmt 1 view .LVU985
1448:Core/Src/FAT/ff.c **** 		res = put_fat(fs, pclst, 0xFFFFFFFF);
 2960              		.loc 1 1448 5 is_stmt 0 view .LVU986
 2961 0014 4AB1     		cbz	r2, .L220
1449:Core/Src/FAT/ff.c **** 		if (res != FR_OK) return res;
 2962              		.loc 1 1449 3 is_stmt 1 view .LVU987
1449:Core/Src/FAT/ff.c **** 		if (res != FR_OK) return res;
 2963              		.loc 1 1449 9 is_stmt 0 view .LVU988
 2964 0016 4FF0FF32 		mov	r2, #-1
 2965              	.LVL369:
1449:Core/Src/FAT/ff.c **** 		if (res != FR_OK) return res;
 2966              		.loc 1 1449 9 view .LVU989
 2967 001a 2846     		mov	r0, r5
 2968              	.LVL370:
1449:Core/Src/FAT/ff.c **** 		if (res != FR_OK) return res;
 2969              		.loc 1 1449 9 view .LVU990
 2970 001c FFF7FEFF 		bl	put_fat
 2971              	.LVL371:
1450:Core/Src/FAT/ff.c **** 	}
 2972              		.loc 1 1450 3 is_stmt 1 view .LVU991
1450:Core/Src/FAT/ff.c **** 	}
 2973              		.loc 1 1450 6 is_stmt 0 view .LVU992
 2974 0020 0746     		mov	r7, r0
 2975 0022 10B1     		cbz	r0, .L220
 2976 0024 23E0     		b	.L217
 2977              	.LVL372:
 2978              	.L219:
1485:Core/Src/FAT/ff.c **** 	} while (clst < fs->n_fatent);	/* Repeat while not the last link */
 2979              		.loc 1 1485 3 is_stmt 1 view .LVU993
1486:Core/Src/FAT/ff.c **** 
 2980              		.loc 1 1486 10 view .LVU994
1486:Core/Src/FAT/ff.c **** 
 2981              		.loc 1 1486 2 is_stmt 0 view .LVU995
 2982 0026 A242     		cmp	r2, r4
 2983 0028 21D9     		bls	.L217
 2984              	.LVL373:
 2985              	.L220:
1454:Core/Src/FAT/ff.c **** 		nxt = get_fat(obj, clst);			/* Get cluster status */
 2986              		.loc 1 1454 2 is_stmt 1 view .LVU996
1455:Core/Src/FAT/ff.c **** 		if (nxt == 0) break;				/* Empty cluster? */
 2987              		.loc 1 1455 3 view .LVU997
 2988 002a 2746     		mov	r7, r4
1455:Core/Src/FAT/ff.c **** 		if (nxt == 0) break;				/* Empty cluster? */
 2989              		.loc 1 1455 9 is_stmt 0 view .LVU998
 2990 002c 2146     		mov	r1, r4
 2991 002e 3046     		mov	r0, r6
 2992 0030 FFF7FEFF 		bl	get_fat
 2993              	.LVL374:
1456:Core/Src/FAT/ff.c **** 		if (nxt == 1) return FR_INT_ERR;	/* Internal error? */
 2994              		.loc 1 1456 3 is_stmt 1 view .LVU999
1456:Core/Src/FAT/ff.c **** 		if (nxt == 1) return FR_INT_ERR;	/* Internal error? */
 2995              		.loc 1 1456 6 is_stmt 0 view .LVU1000
 2996 0034 0446     		mov	r4, r0
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 131


 2997              	.LVL375:
1456:Core/Src/FAT/ff.c **** 		if (nxt == 1) return FR_INT_ERR;	/* Internal error? */
 2998              		.loc 1 1456 6 view .LVU1001
 2999 0036 E0B1     		cbz	r0, .L223
1457:Core/Src/FAT/ff.c **** 		if (nxt == 0xFFFFFFFF) return FR_DISK_ERR;	/* Disk error? */
 3000              		.loc 1 1457 3 is_stmt 1 view .LVU1002
1457:Core/Src/FAT/ff.c **** 		if (nxt == 0xFFFFFFFF) return FR_DISK_ERR;	/* Disk error? */
 3001              		.loc 1 1457 6 is_stmt 0 view .LVU1003
 3002 0038 0128     		cmp	r0, #1
 3003 003a 1CD0     		beq	.L224
1458:Core/Src/FAT/ff.c **** 		if (!FF_FS_EXFAT || fs->fs_type != FS_EXFAT) {
 3004              		.loc 1 1458 3 is_stmt 1 view .LVU1004
1458:Core/Src/FAT/ff.c **** 		if (!FF_FS_EXFAT || fs->fs_type != FS_EXFAT) {
 3005              		.loc 1 1458 6 is_stmt 0 view .LVU1005
 3006 003c B0F1FF3F 		cmp	r0, #-1
 3007 0040 1BD0     		beq	.L225
1459:Core/Src/FAT/ff.c **** 			res = put_fat(fs, clst, 0);		/* Mark the cluster 'free' on the FAT */
 3008              		.loc 1 1459 3 is_stmt 1 view .LVU1006
1460:Core/Src/FAT/ff.c **** 			if (res != FR_OK) return res;
 3009              		.loc 1 1460 4 view .LVU1007
1460:Core/Src/FAT/ff.c **** 			if (res != FR_OK) return res;
 3010              		.loc 1 1460 10 is_stmt 0 view .LVU1008
 3011 0042 0022     		movs	r2, #0
 3012 0044 3946     		mov	r1, r7
 3013 0046 2846     		mov	r0, r5
 3014              	.LVL376:
1460:Core/Src/FAT/ff.c **** 			if (res != FR_OK) return res;
 3015              		.loc 1 1460 10 view .LVU1009
 3016 0048 FFF7FEFF 		bl	put_fat
 3017              	.LVL377:
1461:Core/Src/FAT/ff.c **** 		}
 3018              		.loc 1 1461 4 is_stmt 1 view .LVU1010
1461:Core/Src/FAT/ff.c **** 		}
 3019              		.loc 1 1461 7 is_stmt 0 view .LVU1011
 3020 004c 0746     		mov	r7, r0
 3021              	.LVL378:
1461:Core/Src/FAT/ff.c **** 		}
 3022              		.loc 1 1461 7 view .LVU1012
 3023 004e 70B9     		cbnz	r0, .L217
1463:Core/Src/FAT/ff.c **** 			fs->free_clst++;
 3024              		.loc 1 1463 3 is_stmt 1 view .LVU1013
1463:Core/Src/FAT/ff.c **** 			fs->free_clst++;
 3025              		.loc 1 1463 9 is_stmt 0 view .LVU1014
 3026 0050 2B69     		ldr	r3, [r5, #16]
1463:Core/Src/FAT/ff.c **** 			fs->free_clst++;
 3027              		.loc 1 1463 25 view .LVU1015
 3028 0052 6A69     		ldr	r2, [r5, #20]
1463:Core/Src/FAT/ff.c **** 			fs->free_clst++;
 3029              		.loc 1 1463 36 view .LVU1016
 3030 0054 911E     		subs	r1, r2, #2
1463:Core/Src/FAT/ff.c **** 			fs->free_clst++;
 3031              		.loc 1 1463 6 view .LVU1017
 3032 0056 8B42     		cmp	r3, r1
 3033 0058 E5D2     		bcs	.L219
1464:Core/Src/FAT/ff.c **** 			fs->fsi_flag |= 1;
 3034              		.loc 1 1464 4 is_stmt 1 view .LVU1018
1464:Core/Src/FAT/ff.c **** 			fs->fsi_flag |= 1;
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 132


 3035              		.loc 1 1464 17 is_stmt 0 view .LVU1019
 3036 005a 0133     		adds	r3, r3, #1
 3037 005c 2B61     		str	r3, [r5, #16]
1465:Core/Src/FAT/ff.c **** 		}
 3038              		.loc 1 1465 4 is_stmt 1 view .LVU1020
1465:Core/Src/FAT/ff.c **** 		}
 3039              		.loc 1 1465 17 is_stmt 0 view .LVU1021
 3040 005e 6B79     		ldrb	r3, [r5, #5]	@ zero_extendqisi2
 3041 0060 43F00103 		orr	r3, r3, #1
 3042 0064 6B71     		strb	r3, [r5, #5]
 3043 0066 DEE7     		b	.L219
 3044              	.LVL379:
 3045              	.L221:
1445:Core/Src/FAT/ff.c **** 
 3046              		.loc 1 1445 47 view .LVU1022
 3047 0068 0227     		movs	r7, #2
 3048 006a 00E0     		b	.L217
 3049              	.LVL380:
 3050              	.L222:
1445:Core/Src/FAT/ff.c **** 
 3051              		.loc 1 1445 47 view .LVU1023
 3052 006c 0227     		movs	r7, #2
 3053              	.LVL381:
 3054              	.L217:
1515:Core/Src/FAT/ff.c **** 
 3055              		.loc 1 1515 1 view .LVU1024
 3056 006e 3846     		mov	r0, r7
 3057 0070 F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 3058              	.LVL382:
 3059              	.L223:
1514:Core/Src/FAT/ff.c **** }
 3060              		.loc 1 1514 9 view .LVU1025
 3061 0072 0027     		movs	r7, #0
 3062              	.LVL383:
1514:Core/Src/FAT/ff.c **** }
 3063              		.loc 1 1514 9 view .LVU1026
 3064 0074 FBE7     		b	.L217
 3065              	.LVL384:
 3066              	.L224:
1457:Core/Src/FAT/ff.c **** 		if (nxt == 0xFFFFFFFF) return FR_DISK_ERR;	/* Disk error? */
 3067              		.loc 1 1457 24 view .LVU1027
 3068 0076 0227     		movs	r7, #2
 3069              	.LVL385:
1457:Core/Src/FAT/ff.c **** 		if (nxt == 0xFFFFFFFF) return FR_DISK_ERR;	/* Disk error? */
 3070              		.loc 1 1457 24 view .LVU1028
 3071 0078 F9E7     		b	.L217
 3072              	.LVL386:
 3073              	.L225:
1458:Core/Src/FAT/ff.c **** 		if (!FF_FS_EXFAT || fs->fs_type != FS_EXFAT) {
 3074              		.loc 1 1458 33 view .LVU1029
 3075 007a 0127     		movs	r7, #1
 3076              	.LVL387:
1458:Core/Src/FAT/ff.c **** 		if (!FF_FS_EXFAT || fs->fs_type != FS_EXFAT) {
 3077              		.loc 1 1458 33 view .LVU1030
 3078 007c F7E7     		b	.L217
 3079              		.cfi_endproc
 3080              	.LFE12:
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 133


 3082              		.section	.text.dir_remove,"ax",%progbits
 3083              		.align	1
 3084              		.syntax unified
 3085              		.thumb
 3086              		.thumb_func
 3088              	dir_remove:
 3089              	.LVL388:
 3090              	.LFB23:
2574:Core/Src/FAT/ff.c **** 	FRESULT res;
 3091              		.loc 1 2574 1 is_stmt 1 view -0
 3092              		.cfi_startproc
 3093              		@ args = 0, pretend = 0, frame = 0
 3094              		@ frame_needed = 0, uses_anonymous_args = 0
2574:Core/Src/FAT/ff.c **** 	FRESULT res;
 3095              		.loc 1 2574 1 is_stmt 0 view .LVU1032
 3096 0000 38B5     		push	{r3, r4, r5, lr}
 3097              	.LCFI16:
 3098              		.cfi_def_cfa_offset 16
 3099              		.cfi_offset 3, -16
 3100              		.cfi_offset 4, -12
 3101              		.cfi_offset 5, -8
 3102              		.cfi_offset 14, -4
 3103 0002 0446     		mov	r4, r0
2575:Core/Src/FAT/ff.c **** 	FATFS *fs = dp->obj.fs;
 3104              		.loc 1 2575 2 is_stmt 1 view .LVU1033
2576:Core/Src/FAT/ff.c **** #if FF_USE_LFN		/* LFN configuration */
 3105              		.loc 1 2576 2 view .LVU1034
2576:Core/Src/FAT/ff.c **** #if FF_USE_LFN		/* LFN configuration */
 3106              		.loc 1 2576 9 is_stmt 0 view .LVU1035
 3107 0004 0568     		ldr	r5, [r0]
 3108              	.LVL389:
2598:Core/Src/FAT/ff.c **** 	if (res == FR_OK) {
 3109              		.loc 1 2598 2 is_stmt 1 view .LVU1036
2598:Core/Src/FAT/ff.c **** 	if (res == FR_OK) {
 3110              		.loc 1 2598 8 is_stmt 0 view .LVU1037
 3111 0006 8169     		ldr	r1, [r0, #24]
 3112 0008 2846     		mov	r0, r5
 3113              	.LVL390:
2598:Core/Src/FAT/ff.c **** 	if (res == FR_OK) {
 3114              		.loc 1 2598 8 view .LVU1038
 3115 000a FFF7FEFF 		bl	move_window
 3116              	.LVL391:
2599:Core/Src/FAT/ff.c **** 		dp->dir[DIR_Name] = DDEM;	/* Mark the entry 'deleted'.*/
 3117              		.loc 1 2599 2 is_stmt 1 view .LVU1039
2599:Core/Src/FAT/ff.c **** 		dp->dir[DIR_Name] = DDEM;	/* Mark the entry 'deleted'.*/
 3118              		.loc 1 2599 5 is_stmt 0 view .LVU1040
 3119 000e 20B9     		cbnz	r0, .L228
2600:Core/Src/FAT/ff.c **** 		fs->wflag = 1;
 3120              		.loc 1 2600 3 is_stmt 1 view .LVU1041
2600:Core/Src/FAT/ff.c **** 		fs->wflag = 1;
 3121              		.loc 1 2600 5 is_stmt 0 view .LVU1042
 3122 0010 E369     		ldr	r3, [r4, #28]
2600:Core/Src/FAT/ff.c **** 		fs->wflag = 1;
 3123              		.loc 1 2600 21 view .LVU1043
 3124 0012 E522     		movs	r2, #229
 3125 0014 1A70     		strb	r2, [r3]
2601:Core/Src/FAT/ff.c **** 	}
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 134


 3126              		.loc 1 2601 3 is_stmt 1 view .LVU1044
2601:Core/Src/FAT/ff.c **** 	}
 3127              		.loc 1 2601 13 is_stmt 0 view .LVU1045
 3128 0016 0123     		movs	r3, #1
 3129 0018 2B71     		strb	r3, [r5, #4]
 3130              	.L228:
2605:Core/Src/FAT/ff.c **** }
 3131              		.loc 1 2605 2 is_stmt 1 view .LVU1046
2606:Core/Src/FAT/ff.c **** 
 3132              		.loc 1 2606 1 is_stmt 0 view .LVU1047
 3133 001a 38BD     		pop	{r3, r4, r5, pc}
2606:Core/Src/FAT/ff.c **** 
 3134              		.loc 1 2606 1 view .LVU1048
 3135              		.cfi_endproc
 3136              	.LFE23:
 3138              		.section	.text.dir_clear,"ax",%progbits
 3139              		.align	1
 3140              		.syntax unified
 3141              		.thumb
 3142              		.thumb_func
 3144              	dir_clear:
 3145              	.LVL392:
 3146              	.LFB14:
1662:Core/Src/FAT/ff.c **** 	LBA_t sect;
 3147              		.loc 1 1662 1 is_stmt 1 view -0
 3148              		.cfi_startproc
 3149              		@ args = 0, pretend = 0, frame = 0
 3150              		@ frame_needed = 0, uses_anonymous_args = 0
1662:Core/Src/FAT/ff.c **** 	LBA_t sect;
 3151              		.loc 1 1662 1 is_stmt 0 view .LVU1050
 3152 0000 F8B5     		push	{r3, r4, r5, r6, r7, lr}
 3153              	.LCFI17:
 3154              		.cfi_def_cfa_offset 24
 3155              		.cfi_offset 3, -24
 3156              		.cfi_offset 4, -20
 3157              		.cfi_offset 5, -16
 3158              		.cfi_offset 6, -12
 3159              		.cfi_offset 7, -8
 3160              		.cfi_offset 14, -4
 3161 0002 0546     		mov	r5, r0
 3162 0004 0C46     		mov	r4, r1
1663:Core/Src/FAT/ff.c **** 	UINT n, szb;
 3163              		.loc 1 1663 2 is_stmt 1 view .LVU1051
1664:Core/Src/FAT/ff.c **** 	BYTE *ibuf;
 3164              		.loc 1 1664 2 view .LVU1052
1665:Core/Src/FAT/ff.c **** 
 3165              		.loc 1 1665 2 view .LVU1053
1668:Core/Src/FAT/ff.c **** 	sect = clst2sect(fs, clst);		/* Top of the cluster */
 3166              		.loc 1 1668 2 view .LVU1054
1668:Core/Src/FAT/ff.c **** 	sect = clst2sect(fs, clst);		/* Top of the cluster */
 3167              		.loc 1 1668 6 is_stmt 0 view .LVU1055
 3168 0006 FFF7FEFF 		bl	sync_window
 3169              	.LVL393:
1668:Core/Src/FAT/ff.c **** 	sect = clst2sect(fs, clst);		/* Top of the cluster */
 3170              		.loc 1 1668 5 view .LVU1056
 3171 000a 08B1     		cbz	r0, .L237
1668:Core/Src/FAT/ff.c **** 	sect = clst2sect(fs, clst);		/* Top of the cluster */
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 135


 3172              		.loc 1 1668 39 view .LVU1057
 3173 000c 0120     		movs	r0, #1
 3174              	.LVL394:
 3175              	.L231:
1687:Core/Src/FAT/ff.c **** #endif	/* !FF_FS_READONLY */
 3176              		.loc 1 1687 1 view .LVU1058
 3177 000e F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 3178              	.LVL395:
 3179              	.L237:
1669:Core/Src/FAT/ff.c **** 	fs->winsect = sect;				/* Set window to top of the cluster */
 3180              		.loc 1 1669 2 is_stmt 1 view .LVU1059
1669:Core/Src/FAT/ff.c **** 	fs->winsect = sect;				/* Set window to top of the cluster */
 3181              		.loc 1 1669 9 is_stmt 0 view .LVU1060
 3182 0010 2146     		mov	r1, r4
 3183 0012 2846     		mov	r0, r5
 3184 0014 FFF7FEFF 		bl	clst2sect
 3185              	.LVL396:
 3186 0018 0646     		mov	r6, r0
 3187              	.LVL397:
1670:Core/Src/FAT/ff.c **** 	memset(fs->win, 0, sizeof fs->win);	/* Clear window buffer */
 3188              		.loc 1 1670 2 is_stmt 1 view .LVU1061
1670:Core/Src/FAT/ff.c **** 	memset(fs->win, 0, sizeof fs->win);	/* Clear window buffer */
 3189              		.loc 1 1670 14 is_stmt 0 view .LVU1062
 3190 001a E862     		str	r0, [r5, #44]
1671:Core/Src/FAT/ff.c **** #if FF_USE_LFN == 3		/* Quick table clear by using multi-secter write */
 3191              		.loc 1 1671 2 is_stmt 1 view .LVU1063
1671:Core/Src/FAT/ff.c **** #if FF_USE_LFN == 3		/* Quick table clear by using multi-secter write */
 3192              		.loc 1 1671 11 is_stmt 0 view .LVU1064
 3193 001c 05F13007 		add	r7, r5, #48
1671:Core/Src/FAT/ff.c **** #if FF_USE_LFN == 3		/* Quick table clear by using multi-secter write */
 3194              		.loc 1 1671 2 view .LVU1065
 3195 0020 4FF40072 		mov	r2, #512
 3196 0024 0021     		movs	r1, #0
 3197 0026 3846     		mov	r0, r7
 3198              	.LVL398:
1671:Core/Src/FAT/ff.c **** #if FF_USE_LFN == 3		/* Quick table clear by using multi-secter write */
 3199              		.loc 1 1671 2 view .LVU1066
 3200 0028 FFF7FEFF 		bl	memset
 3201              	.LVL399:
1683:Core/Src/FAT/ff.c **** 		for (n = 0; n < fs->csize && disk_write(fs->pdrv, ibuf, sect + n, szb) == RES_OK; n += szb) ;	/* 
 3202              		.loc 1 1683 3 is_stmt 1 view .LVU1067
1683:Core/Src/FAT/ff.c **** 		for (n = 0; n < fs->csize && disk_write(fs->pdrv, ibuf, sect + n, szb) == RES_OK; n += szb) ;	/* 
 3203              		.loc 1 1683 19 view .LVU1068
1684:Core/Src/FAT/ff.c **** 	}
 3204              		.loc 1 1684 3 view .LVU1069
1684:Core/Src/FAT/ff.c **** 	}
 3205              		.loc 1 1684 10 is_stmt 0 view .LVU1070
 3206 002c 0024     		movs	r4, #0
 3207              	.LVL400:
1684:Core/Src/FAT/ff.c **** 	}
 3208              		.loc 1 1684 3 view .LVU1071
 3209 002e 00E0     		b	.L232
 3210              	.LVL401:
 3211              	.L234:
1684:Core/Src/FAT/ff.c **** 	}
 3212              		.loc 1 1684 95 is_stmt 1 discriminator 4 view .LVU1072
1684:Core/Src/FAT/ff.c **** 	}
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 136


 3213              		.loc 1 1684 85 discriminator 4 view .LVU1073
1684:Core/Src/FAT/ff.c **** 	}
 3214              		.loc 1 1684 87 is_stmt 0 discriminator 4 view .LVU1074
 3215 0030 0134     		adds	r4, r4, #1
 3216              	.LVL402:
 3217              	.L232:
1684:Core/Src/FAT/ff.c **** 	}
 3218              		.loc 1 1684 15 is_stmt 1 discriminator 1 view .LVU1075
1684:Core/Src/FAT/ff.c **** 	}
 3219              		.loc 1 1684 21 is_stmt 0 discriminator 1 view .LVU1076
 3220 0032 6B89     		ldrh	r3, [r5, #10]
1684:Core/Src/FAT/ff.c **** 	}
 3221              		.loc 1 1684 3 discriminator 1 view .LVU1077
 3222 0034 A342     		cmp	r3, r4
 3223 0036 07D9     		bls	.L233
1684:Core/Src/FAT/ff.c **** 	}
 3224              		.loc 1 1684 32 discriminator 3 view .LVU1078
 3225 0038 0123     		movs	r3, #1
 3226 003a A219     		adds	r2, r4, r6
 3227 003c 3946     		mov	r1, r7
 3228 003e 6878     		ldrb	r0, [r5, #1]	@ zero_extendqisi2
 3229 0040 FFF7FEFF 		bl	disk_write
 3230              	.LVL403:
1684:Core/Src/FAT/ff.c **** 	}
 3231              		.loc 1 1684 29 discriminator 3 view .LVU1079
 3232 0044 0028     		cmp	r0, #0
 3233 0046 F3D0     		beq	.L234
 3234              	.L233:
1686:Core/Src/FAT/ff.c **** }
 3235              		.loc 1 1686 2 is_stmt 1 view .LVU1080
1686:Core/Src/FAT/ff.c **** }
 3236              		.loc 1 1686 17 is_stmt 0 view .LVU1081
 3237 0048 6889     		ldrh	r0, [r5, #10]
1686:Core/Src/FAT/ff.c **** }
 3238              		.loc 1 1686 34 view .LVU1082
 3239 004a 001B     		subs	r0, r0, r4
 3240 004c 18BF     		it	ne
 3241 004e 0120     		movne	r0, #1
 3242 0050 DDE7     		b	.L231
 3243              		.cfi_endproc
 3244              	.LFE14:
 3246              		.section	.text.dir_next,"ax",%progbits
 3247              		.align	1
 3248              		.syntax unified
 3249              		.thumb
 3250              		.thumb_func
 3252              	dir_next:
 3253              	.LVL404:
 3254              	.LFB16:
1749:Core/Src/FAT/ff.c **** 	DWORD ofs, clst;
 3255              		.loc 1 1749 1 is_stmt 1 view -0
 3256              		.cfi_startproc
 3257              		@ args = 0, pretend = 0, frame = 0
 3258              		@ frame_needed = 0, uses_anonymous_args = 0
1749:Core/Src/FAT/ff.c **** 	DWORD ofs, clst;
 3259              		.loc 1 1749 1 is_stmt 0 view .LVU1084
 3260 0000 2DE9F843 		push	{r3, r4, r5, r6, r7, r8, r9, lr}
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 137


 3261              	.LCFI18:
 3262              		.cfi_def_cfa_offset 32
 3263              		.cfi_offset 3, -32
 3264              		.cfi_offset 4, -28
 3265              		.cfi_offset 5, -24
 3266              		.cfi_offset 6, -20
 3267              		.cfi_offset 7, -16
 3268              		.cfi_offset 8, -12
 3269              		.cfi_offset 9, -8
 3270              		.cfi_offset 14, -4
 3271 0004 0446     		mov	r4, r0
 3272 0006 8846     		mov	r8, r1
1750:Core/Src/FAT/ff.c **** 	FATFS *fs = dp->obj.fs;
 3273              		.loc 1 1750 2 is_stmt 1 view .LVU1085
1751:Core/Src/FAT/ff.c **** 
 3274              		.loc 1 1751 2 view .LVU1086
1751:Core/Src/FAT/ff.c **** 
 3275              		.loc 1 1751 9 is_stmt 0 view .LVU1087
 3276 0008 0768     		ldr	r7, [r0]
 3277              	.LVL405:
1754:Core/Src/FAT/ff.c **** 	if (ofs >= (DWORD)((FF_FS_EXFAT && fs->fs_type == FS_EXFAT) ? MAX_DIR_EX : MAX_DIR)) dp->sect = 0;
 3278              		.loc 1 1754 2 is_stmt 1 view .LVU1088
1754:Core/Src/FAT/ff.c **** 	if (ofs >= (DWORD)((FF_FS_EXFAT && fs->fs_type == FS_EXFAT) ? MAX_DIR_EX : MAX_DIR)) dp->sect = 0;
 3279              		.loc 1 1754 10 is_stmt 0 view .LVU1089
 3280 000a 0569     		ldr	r5, [r0, #16]
1754:Core/Src/FAT/ff.c **** 	if (ofs >= (DWORD)((FF_FS_EXFAT && fs->fs_type == FS_EXFAT) ? MAX_DIR_EX : MAX_DIR)) dp->sect = 0;
 3281              		.loc 1 1754 6 view .LVU1090
 3282 000c 2035     		adds	r5, r5, #32
 3283              	.LVL406:
1755:Core/Src/FAT/ff.c **** 	if (dp->sect == 0) return FR_NO_FILE;	/* Report EOT if it has been disabled */
 3284              		.loc 1 1755 2 is_stmt 1 view .LVU1091
1755:Core/Src/FAT/ff.c **** 	if (dp->sect == 0) return FR_NO_FILE;	/* Report EOT if it has been disabled */
 3285              		.loc 1 1755 5 is_stmt 0 view .LVU1092
 3286 000e B5F5001F 		cmp	r5, #2097152
 3287 0012 01D3     		bcc	.L239
1755:Core/Src/FAT/ff.c **** 	if (dp->sect == 0) return FR_NO_FILE;	/* Report EOT if it has been disabled */
 3288              		.loc 1 1755 87 is_stmt 1 discriminator 1 view .LVU1093
1755:Core/Src/FAT/ff.c **** 	if (dp->sect == 0) return FR_NO_FILE;	/* Report EOT if it has been disabled */
 3289              		.loc 1 1755 96 is_stmt 0 discriminator 1 view .LVU1094
 3290 0014 0023     		movs	r3, #0
 3291 0016 8361     		str	r3, [r0, #24]
 3292              	.L239:
1756:Core/Src/FAT/ff.c **** 
 3293              		.loc 1 1756 2 is_stmt 1 view .LVU1095
1756:Core/Src/FAT/ff.c **** 
 3294              		.loc 1 1756 8 is_stmt 0 view .LVU1096
 3295 0018 A369     		ldr	r3, [r4, #24]
1756:Core/Src/FAT/ff.c **** 
 3296              		.loc 1 1756 5 view .LVU1097
 3297 001a 002B     		cmp	r3, #0
 3298 001c 46D0     		beq	.L245
1758:Core/Src/FAT/ff.c **** 		dp->sect++;				/* Next sector */
 3299              		.loc 1 1758 2 is_stmt 1 view .LVU1098
1758:Core/Src/FAT/ff.c **** 		dp->sect++;				/* Next sector */
 3300              		.loc 1 1758 10 is_stmt 0 view .LVU1099
 3301 001e C5F30806 		ubfx	r6, r5, #0, #9
1758:Core/Src/FAT/ff.c **** 		dp->sect++;				/* Next sector */
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 138


 3302              		.loc 1 1758 5 view .LVU1100
 3303 0022 3EB9     		cbnz	r6, .L241
1759:Core/Src/FAT/ff.c **** 
 3304              		.loc 1 1759 3 is_stmt 1 view .LVU1101
1759:Core/Src/FAT/ff.c **** 
 3305              		.loc 1 1759 11 is_stmt 0 view .LVU1102
 3306 0024 0133     		adds	r3, r3, #1
 3307 0026 A361     		str	r3, [r4, #24]
1761:Core/Src/FAT/ff.c **** 			if (ofs / SZDIRE >= fs->n_rootdir) {	/* Report EOT if it reached end of static table */
 3308              		.loc 1 1761 3 is_stmt 1 view .LVU1103
1761:Core/Src/FAT/ff.c **** 			if (ofs / SZDIRE >= fs->n_rootdir) {	/* Report EOT if it reached end of static table */
 3309              		.loc 1 1761 9 is_stmt 0 view .LVU1104
 3310 0028 6169     		ldr	r1, [r4, #20]
 3311              	.LVL407:
1761:Core/Src/FAT/ff.c **** 			if (ofs / SZDIRE >= fs->n_rootdir) {	/* Report EOT if it reached end of static table */
 3312              		.loc 1 1761 6 view .LVU1105
 3313 002a 79B9     		cbnz	r1, .L242
1762:Core/Src/FAT/ff.c **** 				dp->sect = 0; return FR_NO_FILE;
 3314              		.loc 1 1762 4 is_stmt 1 view .LVU1106
1762:Core/Src/FAT/ff.c **** 				dp->sect = 0; return FR_NO_FILE;
 3315              		.loc 1 1762 26 is_stmt 0 view .LVU1107
 3316 002c 3B89     		ldrh	r3, [r7, #8]
1762:Core/Src/FAT/ff.c **** 				dp->sect = 0; return FR_NO_FILE;
 3317              		.loc 1 1762 7 view .LVU1108
 3318 002e B3EB551F 		cmp	r3, r5, lsr #5
 3319 0032 07D9     		bls	.L253
 3320              	.LVL408:
 3321              	.L241:
1792:Core/Src/FAT/ff.c **** 	dp->dir = fs->win + ofs % SS(fs);	/* Pointer to the entry in the win[] */
 3322              		.loc 1 1792 2 is_stmt 1 view .LVU1109
1792:Core/Src/FAT/ff.c **** 	dp->dir = fs->win + ofs % SS(fs);	/* Pointer to the entry in the win[] */
 3323              		.loc 1 1792 11 is_stmt 0 view .LVU1110
 3324 0034 2561     		str	r5, [r4, #16]
1793:Core/Src/FAT/ff.c **** 
 3325              		.loc 1 1793 2 is_stmt 1 view .LVU1111
1793:Core/Src/FAT/ff.c **** 
 3326              		.loc 1 1793 12 is_stmt 0 view .LVU1112
 3327 0036 07F13003 		add	r3, r7, #48
1793:Core/Src/FAT/ff.c **** 
 3328              		.loc 1 1793 20 view .LVU1113
 3329 003a 3344     		add	r3, r3, r6
1793:Core/Src/FAT/ff.c **** 
 3330              		.loc 1 1793 10 view .LVU1114
 3331 003c E361     		str	r3, [r4, #28]
1795:Core/Src/FAT/ff.c **** }
 3332              		.loc 1 1795 2 is_stmt 1 view .LVU1115
1795:Core/Src/FAT/ff.c **** }
 3333              		.loc 1 1795 9 is_stmt 0 view .LVU1116
 3334 003e 0020     		movs	r0, #0
 3335              	.L240:
1796:Core/Src/FAT/ff.c **** 
 3336              		.loc 1 1796 1 view .LVU1117
 3337 0040 BDE8F883 		pop	{r3, r4, r5, r6, r7, r8, r9, pc}
 3338              	.LVL409:
 3339              	.L253:
1763:Core/Src/FAT/ff.c **** 			}
 3340              		.loc 1 1763 5 is_stmt 1 view .LVU1118
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 139


1763:Core/Src/FAT/ff.c **** 			}
 3341              		.loc 1 1763 14 is_stmt 0 view .LVU1119
 3342 0044 0023     		movs	r3, #0
 3343 0046 A361     		str	r3, [r4, #24]
1763:Core/Src/FAT/ff.c **** 			}
 3344              		.loc 1 1763 19 is_stmt 1 view .LVU1120
1763:Core/Src/FAT/ff.c **** 			}
 3345              		.loc 1 1763 26 is_stmt 0 view .LVU1121
 3346 0048 0420     		movs	r0, #4
 3347              	.LVL410:
1763:Core/Src/FAT/ff.c **** 			}
 3348              		.loc 1 1763 26 view .LVU1122
 3349 004a F9E7     		b	.L240
 3350              	.LVL411:
 3351              	.L242:
1767:Core/Src/FAT/ff.c **** 				clst = get_fat(&dp->obj, dp->clust);		/* Get next cluster */
 3352              		.loc 1 1767 4 is_stmt 1 view .LVU1123
1767:Core/Src/FAT/ff.c **** 				clst = get_fat(&dp->obj, dp->clust);		/* Get next cluster */
 3353              		.loc 1 1767 27 is_stmt 0 view .LVU1124
 3354 004c 7B89     		ldrh	r3, [r7, #10]
1767:Core/Src/FAT/ff.c **** 				clst = get_fat(&dp->obj, dp->clust);		/* Get next cluster */
 3355              		.loc 1 1767 35 view .LVU1125
 3356 004e 013B     		subs	r3, r3, #1
1767:Core/Src/FAT/ff.c **** 				clst = get_fat(&dp->obj, dp->clust);		/* Get next cluster */
 3357              		.loc 1 1767 7 view .LVU1126
 3358 0050 13EA5523 		ands	r3, r3, r5, lsr #9
 3359 0054 EED1     		bne	.L241
1768:Core/Src/FAT/ff.c **** 				if (clst <= 1) return FR_INT_ERR;			/* Internal error */
 3360              		.loc 1 1768 5 is_stmt 1 view .LVU1127
1768:Core/Src/FAT/ff.c **** 				if (clst <= 1) return FR_INT_ERR;			/* Internal error */
 3361              		.loc 1 1768 12 is_stmt 0 view .LVU1128
 3362 0056 2046     		mov	r0, r4
 3363              	.LVL412:
1768:Core/Src/FAT/ff.c **** 				if (clst <= 1) return FR_INT_ERR;			/* Internal error */
 3364              		.loc 1 1768 12 view .LVU1129
 3365 0058 FFF7FEFF 		bl	get_fat
 3366              	.LVL413:
 3367 005c 8146     		mov	r9, r0
 3368              	.LVL414:
1769:Core/Src/FAT/ff.c **** 				if (clst == 0xFFFFFFFF) return FR_DISK_ERR;	/* Disk error */
 3369              		.loc 1 1769 5 is_stmt 1 view .LVU1130
1769:Core/Src/FAT/ff.c **** 				if (clst == 0xFFFFFFFF) return FR_DISK_ERR;	/* Disk error */
 3370              		.loc 1 1769 8 is_stmt 0 view .LVU1131
 3371 005e 0128     		cmp	r0, #1
 3372 0060 26D9     		bls	.L246
1770:Core/Src/FAT/ff.c **** 				if (clst >= fs->n_fatent) {					/* It reached end of dynamic table */
 3373              		.loc 1 1770 5 is_stmt 1 view .LVU1132
1770:Core/Src/FAT/ff.c **** 				if (clst >= fs->n_fatent) {					/* It reached end of dynamic table */
 3374              		.loc 1 1770 8 is_stmt 0 view .LVU1133
 3375 0062 B0F1FF3F 		cmp	r0, #-1
 3376 0066 25D0     		beq	.L247
1771:Core/Src/FAT/ff.c **** #if !FF_FS_READONLY
 3377              		.loc 1 1771 5 is_stmt 1 view .LVU1134
1771:Core/Src/FAT/ff.c **** #if !FF_FS_READONLY
 3378              		.loc 1 1771 19 is_stmt 0 view .LVU1135
 3379 0068 7B69     		ldr	r3, [r7, #20]
1771:Core/Src/FAT/ff.c **** #if !FF_FS_READONLY
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 140


 3380              		.loc 1 1771 8 view .LVU1136
 3381 006a 8342     		cmp	r3, r0
 3382 006c 12D8     		bhi	.L243
1773:Core/Src/FAT/ff.c **** 						dp->sect = 0; return FR_NO_FILE;
 3383              		.loc 1 1773 6 is_stmt 1 view .LVU1137
1773:Core/Src/FAT/ff.c **** 						dp->sect = 0; return FR_NO_FILE;
 3384              		.loc 1 1773 9 is_stmt 0 view .LVU1138
 3385 006e B8F1000F 		cmp	r8, #0
 3386 0072 17D0     		beq	.L254
1776:Core/Src/FAT/ff.c **** 					if (clst == 0) return FR_DENIED;			/* No free cluster */
 3387              		.loc 1 1776 6 is_stmt 1 view .LVU1139
1776:Core/Src/FAT/ff.c **** 					if (clst == 0) return FR_DENIED;			/* No free cluster */
 3388              		.loc 1 1776 13 is_stmt 0 view .LVU1140
 3389 0074 6169     		ldr	r1, [r4, #20]
 3390 0076 2046     		mov	r0, r4
 3391              	.LVL415:
1776:Core/Src/FAT/ff.c **** 					if (clst == 0) return FR_DENIED;			/* No free cluster */
 3392              		.loc 1 1776 13 view .LVU1141
 3393 0078 FFF7FEFF 		bl	create_chain
 3394              	.LVL416:
1777:Core/Src/FAT/ff.c **** 					if (clst == 1) return FR_INT_ERR;			/* Internal error */
 3395              		.loc 1 1777 6 is_stmt 1 view .LVU1142
1777:Core/Src/FAT/ff.c **** 					if (clst == 1) return FR_INT_ERR;			/* Internal error */
 3396              		.loc 1 1777 9 is_stmt 0 view .LVU1143
 3397 007c 8146     		mov	r9, r0
 3398 007e D8B1     		cbz	r0, .L248
1778:Core/Src/FAT/ff.c **** 					if (clst == 0xFFFFFFFF) return FR_DISK_ERR;	/* Disk error */
 3399              		.loc 1 1778 6 is_stmt 1 view .LVU1144
1778:Core/Src/FAT/ff.c **** 					if (clst == 0xFFFFFFFF) return FR_DISK_ERR;	/* Disk error */
 3400              		.loc 1 1778 9 is_stmt 0 view .LVU1145
 3401 0080 0128     		cmp	r0, #1
 3402 0082 1BD0     		beq	.L249
1779:Core/Src/FAT/ff.c **** 					if (dir_clear(fs, clst) != FR_OK) return FR_DISK_ERR;	/* Clean up the stretched table */
 3403              		.loc 1 1779 6 is_stmt 1 view .LVU1146
1779:Core/Src/FAT/ff.c **** 					if (dir_clear(fs, clst) != FR_OK) return FR_DISK_ERR;	/* Clean up the stretched table */
 3404              		.loc 1 1779 9 is_stmt 0 view .LVU1147
 3405 0084 B0F1FF3F 		cmp	r0, #-1
 3406 0088 1AD0     		beq	.L250
1780:Core/Src/FAT/ff.c **** 					if (FF_FS_EXFAT) dp->obj.stat |= 4;			/* exFAT: The directory has been stretched */
 3407              		.loc 1 1780 6 is_stmt 1 view .LVU1148
1780:Core/Src/FAT/ff.c **** 					if (FF_FS_EXFAT) dp->obj.stat |= 4;			/* exFAT: The directory has been stretched */
 3408              		.loc 1 1780 10 is_stmt 0 view .LVU1149
 3409 008a 0146     		mov	r1, r0
 3410 008c 3846     		mov	r0, r7
 3411              	.LVL417:
1780:Core/Src/FAT/ff.c **** 					if (FF_FS_EXFAT) dp->obj.stat |= 4;			/* exFAT: The directory has been stretched */
 3412              		.loc 1 1780 10 view .LVU1150
 3413 008e FFF7FEFF 		bl	dir_clear
 3414              	.LVL418:
1780:Core/Src/FAT/ff.c **** 					if (FF_FS_EXFAT) dp->obj.stat |= 4;			/* exFAT: The directory has been stretched */
 3415              		.loc 1 1780 9 view .LVU1151
 3416 0092 B8B9     		cbnz	r0, .L251
 3417              	.L243:
1787:Core/Src/FAT/ff.c **** 				dp->sect = clst2sect(fs, clst);
 3418              		.loc 1 1787 5 is_stmt 1 view .LVU1152
1787:Core/Src/FAT/ff.c **** 				dp->sect = clst2sect(fs, clst);
 3419              		.loc 1 1787 15 is_stmt 0 view .LVU1153
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 141


 3420 0094 C4F81490 		str	r9, [r4, #20]
1788:Core/Src/FAT/ff.c **** 			}
 3421              		.loc 1 1788 5 is_stmt 1 view .LVU1154
1788:Core/Src/FAT/ff.c **** 			}
 3422              		.loc 1 1788 16 is_stmt 0 view .LVU1155
 3423 0098 4946     		mov	r1, r9
 3424 009a 3846     		mov	r0, r7
 3425 009c FFF7FEFF 		bl	clst2sect
 3426              	.LVL419:
1788:Core/Src/FAT/ff.c **** 			}
 3427              		.loc 1 1788 14 view .LVU1156
 3428 00a0 A061     		str	r0, [r4, #24]
 3429 00a2 C7E7     		b	.L241
 3430              	.LVL420:
 3431              	.L254:
1774:Core/Src/FAT/ff.c **** 					}
 3432              		.loc 1 1774 7 is_stmt 1 view .LVU1157
1774:Core/Src/FAT/ff.c **** 					}
 3433              		.loc 1 1774 16 is_stmt 0 view .LVU1158
 3434 00a4 0023     		movs	r3, #0
 3435 00a6 A361     		str	r3, [r4, #24]
1774:Core/Src/FAT/ff.c **** 					}
 3436              		.loc 1 1774 21 is_stmt 1 view .LVU1159
1774:Core/Src/FAT/ff.c **** 					}
 3437              		.loc 1 1774 28 is_stmt 0 view .LVU1160
 3438 00a8 0420     		movs	r0, #4
 3439              	.LVL421:
1774:Core/Src/FAT/ff.c **** 					}
 3440              		.loc 1 1774 28 view .LVU1161
 3441 00aa C9E7     		b	.L240
 3442              	.LVL422:
 3443              	.L245:
1756:Core/Src/FAT/ff.c **** 
 3444              		.loc 1 1756 28 view .LVU1162
 3445 00ac 0420     		movs	r0, #4
 3446              	.LVL423:
1756:Core/Src/FAT/ff.c **** 
 3447              		.loc 1 1756 28 view .LVU1163
 3448 00ae C7E7     		b	.L240
 3449              	.LVL424:
 3450              	.L246:
1769:Core/Src/FAT/ff.c **** 				if (clst == 0xFFFFFFFF) return FR_DISK_ERR;	/* Disk error */
 3451              		.loc 1 1769 27 view .LVU1164
 3452 00b0 0220     		movs	r0, #2
 3453              	.LVL425:
1769:Core/Src/FAT/ff.c **** 				if (clst == 0xFFFFFFFF) return FR_DISK_ERR;	/* Disk error */
 3454              		.loc 1 1769 27 view .LVU1165
 3455 00b2 C5E7     		b	.L240
 3456              	.LVL426:
 3457              	.L247:
1770:Core/Src/FAT/ff.c **** 				if (clst >= fs->n_fatent) {					/* It reached end of dynamic table */
 3458              		.loc 1 1770 36 view .LVU1166
 3459 00b4 0120     		movs	r0, #1
 3460              	.LVL427:
1770:Core/Src/FAT/ff.c **** 				if (clst >= fs->n_fatent) {					/* It reached end of dynamic table */
 3461              		.loc 1 1770 36 view .LVU1167
 3462 00b6 C3E7     		b	.L240
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 142


 3463              	.LVL428:
 3464              	.L248:
1777:Core/Src/FAT/ff.c **** 					if (clst == 1) return FR_INT_ERR;			/* Internal error */
 3465              		.loc 1 1777 28 view .LVU1168
 3466 00b8 0720     		movs	r0, #7
 3467              	.LVL429:
1777:Core/Src/FAT/ff.c **** 					if (clst == 1) return FR_INT_ERR;			/* Internal error */
 3468              		.loc 1 1777 28 view .LVU1169
 3469 00ba C1E7     		b	.L240
 3470              	.LVL430:
 3471              	.L249:
1778:Core/Src/FAT/ff.c **** 					if (clst == 0xFFFFFFFF) return FR_DISK_ERR;	/* Disk error */
 3472              		.loc 1 1778 28 view .LVU1170
 3473 00bc 0220     		movs	r0, #2
 3474              	.LVL431:
1778:Core/Src/FAT/ff.c **** 					if (clst == 0xFFFFFFFF) return FR_DISK_ERR;	/* Disk error */
 3475              		.loc 1 1778 28 view .LVU1171
 3476 00be BFE7     		b	.L240
 3477              	.LVL432:
 3478              	.L250:
1779:Core/Src/FAT/ff.c **** 					if (dir_clear(fs, clst) != FR_OK) return FR_DISK_ERR;	/* Clean up the stretched table */
 3479              		.loc 1 1779 37 view .LVU1172
 3480 00c0 0120     		movs	r0, #1
 3481              	.LVL433:
1779:Core/Src/FAT/ff.c **** 					if (dir_clear(fs, clst) != FR_OK) return FR_DISK_ERR;	/* Clean up the stretched table */
 3482              		.loc 1 1779 37 view .LVU1173
 3483 00c2 BDE7     		b	.L240
 3484              	.L251:
1780:Core/Src/FAT/ff.c **** 					if (FF_FS_EXFAT) dp->obj.stat |= 4;			/* exFAT: The directory has been stretched */
 3485              		.loc 1 1780 47 view .LVU1174
 3486 00c4 0120     		movs	r0, #1
 3487 00c6 BBE7     		b	.L240
 3488              		.cfi_endproc
 3489              	.LFE16:
 3491              		.section	.text.dir_find,"ax",%progbits
 3492              		.align	1
 3493              		.syntax unified
 3494              		.thumb
 3495              		.thumb_func
 3497              	dir_find:
 3498              	.LVL434:
 3499              	.LFB21:
2387:Core/Src/FAT/ff.c **** 	FRESULT res;
 3500              		.loc 1 2387 1 is_stmt 1 view -0
 3501              		.cfi_startproc
 3502              		@ args = 0, pretend = 0, frame = 0
 3503              		@ frame_needed = 0, uses_anonymous_args = 0
2387:Core/Src/FAT/ff.c **** 	FRESULT res;
 3504              		.loc 1 2387 1 is_stmt 0 view .LVU1176
 3505 0000 70B5     		push	{r4, r5, r6, lr}
 3506              	.LCFI19:
 3507              		.cfi_def_cfa_offset 16
 3508              		.cfi_offset 4, -16
 3509              		.cfi_offset 5, -12
 3510              		.cfi_offset 6, -8
 3511              		.cfi_offset 14, -4
 3512 0002 0446     		mov	r4, r0
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 143


2388:Core/Src/FAT/ff.c **** 	FATFS *fs = dp->obj.fs;
 3513              		.loc 1 2388 2 is_stmt 1 view .LVU1177
2389:Core/Src/FAT/ff.c **** 	BYTE c;
 3514              		.loc 1 2389 2 view .LVU1178
2389:Core/Src/FAT/ff.c **** 	BYTE c;
 3515              		.loc 1 2389 9 is_stmt 0 view .LVU1179
 3516 0004 0668     		ldr	r6, [r0]
 3517              	.LVL435:
2390:Core/Src/FAT/ff.c **** #if FF_USE_LFN
 3518              		.loc 1 2390 2 is_stmt 1 view .LVU1180
2395:Core/Src/FAT/ff.c **** 	if (res != FR_OK) return res;
 3519              		.loc 1 2395 2 view .LVU1181
2395:Core/Src/FAT/ff.c **** 	if (res != FR_OK) return res;
 3520              		.loc 1 2395 8 is_stmt 0 view .LVU1182
 3521 0006 0021     		movs	r1, #0
 3522 0008 FFF7FEFF 		bl	dir_sdi
 3523              	.LVL436:
2396:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT
 3524              		.loc 1 2396 2 is_stmt 1 view .LVU1183
2396:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT
 3525              		.loc 1 2396 5 is_stmt 0 view .LVU1184
 3526 000c 0546     		mov	r5, r0
 3527 000e 40B1     		cbz	r0, .L258
 3528              	.LVL437:
 3529              	.L256:
2455:Core/Src/FAT/ff.c **** 
 3530              		.loc 1 2455 1 view .LVU1185
 3531 0010 2846     		mov	r0, r5
 3532 0012 70BD     		pop	{r4, r5, r6, pc}
 3533              	.LVL438:
 3534              	.L257:
2451:Core/Src/FAT/ff.c **** 	} while (res == FR_OK);
 3535              		.loc 1 2451 3 is_stmt 1 view .LVU1186
2451:Core/Src/FAT/ff.c **** 	} while (res == FR_OK);
 3536              		.loc 1 2451 9 is_stmt 0 view .LVU1187
 3537 0014 0021     		movs	r1, #0
 3538 0016 2046     		mov	r0, r4
 3539 0018 FFF7FEFF 		bl	dir_next
 3540              	.LVL439:
2452:Core/Src/FAT/ff.c **** 
 3541              		.loc 1 2452 10 is_stmt 1 view .LVU1188
2452:Core/Src/FAT/ff.c **** 
 3542              		.loc 1 2452 2 is_stmt 0 view .LVU1189
 3543 001c 0546     		mov	r5, r0
 3544 001e 0028     		cmp	r0, #0
 3545 0020 F6D1     		bne	.L256
 3546              	.L258:
2421:Core/Src/FAT/ff.c **** 		res = move_window(fs, dp->sect);
 3547              		.loc 1 2421 2 is_stmt 1 view .LVU1190
2422:Core/Src/FAT/ff.c **** 		if (res != FR_OK) break;
 3548              		.loc 1 2422 3 view .LVU1191
2422:Core/Src/FAT/ff.c **** 		if (res != FR_OK) break;
 3549              		.loc 1 2422 9 is_stmt 0 view .LVU1192
 3550 0022 A169     		ldr	r1, [r4, #24]
 3551 0024 3046     		mov	r0, r6
 3552              	.LVL440:
2422:Core/Src/FAT/ff.c **** 		if (res != FR_OK) break;
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 144


 3553              		.loc 1 2422 9 view .LVU1193
 3554 0026 FFF7FEFF 		bl	move_window
 3555              	.LVL441:
2423:Core/Src/FAT/ff.c **** 		c = dp->dir[DIR_Name];
 3556              		.loc 1 2423 3 is_stmt 1 view .LVU1194
2423:Core/Src/FAT/ff.c **** 		c = dp->dir[DIR_Name];
 3557              		.loc 1 2423 6 is_stmt 0 view .LVU1195
 3558 002a 0546     		mov	r5, r0
 3559 002c 0028     		cmp	r0, #0
 3560 002e EFD1     		bne	.L256
2424:Core/Src/FAT/ff.c **** 		if (c == 0) { res = FR_NO_FILE; break; }	/* Reached to end of table */
 3561              		.loc 1 2424 3 is_stmt 1 view .LVU1196
2424:Core/Src/FAT/ff.c **** 		if (c == 0) { res = FR_NO_FILE; break; }	/* Reached to end of table */
 3562              		.loc 1 2424 9 is_stmt 0 view .LVU1197
 3563 0030 E069     		ldr	r0, [r4, #28]
 3564              	.LVL442:
2424:Core/Src/FAT/ff.c **** 		if (c == 0) { res = FR_NO_FILE; break; }	/* Reached to end of table */
 3565              		.loc 1 2424 5 view .LVU1198
 3566 0032 0378     		ldrb	r3, [r0]	@ zero_extendqisi2
 3567              	.LVL443:
2425:Core/Src/FAT/ff.c **** #if FF_USE_LFN		/* LFN configuration */
 3568              		.loc 1 2425 3 is_stmt 1 view .LVU1199
2425:Core/Src/FAT/ff.c **** #if FF_USE_LFN		/* LFN configuration */
 3569              		.loc 1 2425 6 is_stmt 0 view .LVU1200
 3570 0034 7BB1     		cbz	r3, .L259
2448:Core/Src/FAT/ff.c **** 		if (!(dp->dir[DIR_Attr] & AM_VOL) && !memcmp(dp->dir, dp->fn, 11)) break;	/* Is it a valid entry?
 3571              		.loc 1 2448 3 is_stmt 1 view .LVU1201
2448:Core/Src/FAT/ff.c **** 		if (!(dp->dir[DIR_Attr] & AM_VOL) && !memcmp(dp->dir, dp->fn, 11)) break;	/* Is it a valid entry?
 3572              		.loc 1 2448 25 is_stmt 0 view .LVU1202
 3573 0036 C37A     		ldrb	r3, [r0, #11]	@ zero_extendqisi2
 3574              	.LVL444:
2448:Core/Src/FAT/ff.c **** 		if (!(dp->dir[DIR_Attr] & AM_VOL) && !memcmp(dp->dir, dp->fn, 11)) break;	/* Is it a valid entry?
 3575              		.loc 1 2448 36 view .LVU1203
 3576 0038 03F03F03 		and	r3, r3, #63
2448:Core/Src/FAT/ff.c **** 		if (!(dp->dir[DIR_Attr] & AM_VOL) && !memcmp(dp->dir, dp->fn, 11)) break;	/* Is it a valid entry?
 3577              		.loc 1 2448 16 view .LVU1204
 3578 003c A371     		strb	r3, [r4, #6]
 3579              	.LVL445:
2449:Core/Src/FAT/ff.c **** #endif
 3580              		.loc 1 2449 3 is_stmt 1 view .LVU1205
2449:Core/Src/FAT/ff.c **** #endif
 3581              		.loc 1 2449 16 is_stmt 0 view .LVU1206
 3582 003e C37A     		ldrb	r3, [r0, #11]	@ zero_extendqisi2
2449:Core/Src/FAT/ff.c **** #endif
 3583              		.loc 1 2449 6 view .LVU1207
 3584 0040 13F0080F 		tst	r3, #8
 3585 0044 E6D1     		bne	.L257
2449:Core/Src/FAT/ff.c **** #endif
 3586              		.loc 1 2449 41 discriminator 1 view .LVU1208
 3587 0046 0B22     		movs	r2, #11
 3588 0048 04F12001 		add	r1, r4, #32
 3589 004c FFF7FEFF 		bl	memcmp
 3590              	.LVL446:
2449:Core/Src/FAT/ff.c **** #endif
 3591              		.loc 1 2449 37 discriminator 1 view .LVU1209
 3592 0050 0028     		cmp	r0, #0
 3593 0052 DFD1     		bne	.L257
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 145


 3594 0054 DCE7     		b	.L256
 3595              	.LVL447:
 3596              	.L259:
2425:Core/Src/FAT/ff.c **** #if FF_USE_LFN		/* LFN configuration */
 3597              		.loc 1 2425 21 view .LVU1210
 3598 0056 0425     		movs	r5, #4
 3599 0058 DAE7     		b	.L256
 3600              		.cfi_endproc
 3601              	.LFE21:
 3603              		.section	.text.dir_alloc,"ax",%progbits
 3604              		.align	1
 3605              		.syntax unified
 3606              		.thumb
 3607              		.thumb_func
 3609              	dir_alloc:
 3610              	.LVL448:
 3611              	.LFB17:
1810:Core/Src/FAT/ff.c **** 	FRESULT res;
 3612              		.loc 1 1810 1 is_stmt 1 view -0
 3613              		.cfi_startproc
 3614              		@ args = 0, pretend = 0, frame = 0
 3615              		@ frame_needed = 0, uses_anonymous_args = 0
1810:Core/Src/FAT/ff.c **** 	FRESULT res;
 3616              		.loc 1 1810 1 is_stmt 0 view .LVU1212
 3617 0000 F8B5     		push	{r3, r4, r5, r6, r7, lr}
 3618              	.LCFI20:
 3619              		.cfi_def_cfa_offset 24
 3620              		.cfi_offset 3, -24
 3621              		.cfi_offset 4, -20
 3622              		.cfi_offset 5, -16
 3623              		.cfi_offset 6, -12
 3624              		.cfi_offset 7, -8
 3625              		.cfi_offset 14, -4
 3626 0002 0446     		mov	r4, r0
 3627 0004 0E46     		mov	r6, r1
1811:Core/Src/FAT/ff.c **** 	UINT n;
 3628              		.loc 1 1811 2 is_stmt 1 view .LVU1213
1812:Core/Src/FAT/ff.c **** 	FATFS *fs = dp->obj.fs;
 3629              		.loc 1 1812 2 view .LVU1214
1813:Core/Src/FAT/ff.c **** 
 3630              		.loc 1 1813 2 view .LVU1215
1813:Core/Src/FAT/ff.c **** 
 3631              		.loc 1 1813 9 is_stmt 0 view .LVU1216
 3632 0006 0768     		ldr	r7, [r0]
 3633              	.LVL449:
1816:Core/Src/FAT/ff.c **** 	if (res == FR_OK) {
 3634              		.loc 1 1816 2 is_stmt 1 view .LVU1217
1816:Core/Src/FAT/ff.c **** 	if (res == FR_OK) {
 3635              		.loc 1 1816 8 is_stmt 0 view .LVU1218
 3636 0008 0021     		movs	r1, #0
 3637              	.LVL450:
1816:Core/Src/FAT/ff.c **** 	if (res == FR_OK) {
 3638              		.loc 1 1816 8 view .LVU1219
 3639 000a FFF7FEFF 		bl	dir_sdi
 3640              	.LVL451:
1817:Core/Src/FAT/ff.c **** 		n = 0;
 3641              		.loc 1 1817 2 is_stmt 1 view .LVU1220
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 146


1817:Core/Src/FAT/ff.c **** 		n = 0;
 3642              		.loc 1 1817 5 is_stmt 0 view .LVU1221
 3643 000e 0246     		mov	r2, r0
 3644 0010 C0B9     		cbnz	r0, .L262
1818:Core/Src/FAT/ff.c **** 		do {
 3645              		.loc 1 1818 5 view .LVU1222
 3646 0012 0025     		movs	r5, #0
 3647 0014 08E0     		b	.L265
 3648              	.LVL452:
 3649              	.L263:
1827:Core/Src/FAT/ff.c **** 			} else {
 3650              		.loc 1 1827 5 is_stmt 1 view .LVU1223
1827:Core/Src/FAT/ff.c **** 			} else {
 3651              		.loc 1 1827 8 is_stmt 0 view .LVU1224
 3652 0016 0135     		adds	r5, r5, #1
 3653              	.LVL453:
1827:Core/Src/FAT/ff.c **** 			} else {
 3654              		.loc 1 1827 8 view .LVU1225
 3655 0018 B542     		cmp	r5, r6
 3656 001a 13D0     		beq	.L262
 3657              	.LVL454:
 3658              	.L264:
1831:Core/Src/FAT/ff.c **** 		} while (res == FR_OK);
 3659              		.loc 1 1831 4 is_stmt 1 view .LVU1226
1831:Core/Src/FAT/ff.c **** 		} while (res == FR_OK);
 3660              		.loc 1 1831 10 is_stmt 0 view .LVU1227
 3661 001c 0121     		movs	r1, #1
 3662 001e 2046     		mov	r0, r4
 3663              	.LVL455:
1831:Core/Src/FAT/ff.c **** 		} while (res == FR_OK);
 3664              		.loc 1 1831 10 view .LVU1228
 3665 0020 FFF7FEFF 		bl	dir_next
 3666              	.LVL456:
1832:Core/Src/FAT/ff.c **** 	}
 3667              		.loc 1 1832 11 is_stmt 1 view .LVU1229
1832:Core/Src/FAT/ff.c **** 	}
 3668              		.loc 1 1832 3 is_stmt 0 view .LVU1230
 3669 0024 0246     		mov	r2, r0
 3670 0026 68B9     		cbnz	r0, .L262
 3671              	.LVL457:
 3672              	.L265:
1819:Core/Src/FAT/ff.c **** 			res = move_window(fs, dp->sect);
 3673              		.loc 1 1819 3 is_stmt 1 view .LVU1231
1820:Core/Src/FAT/ff.c **** 			if (res != FR_OK) break;
 3674              		.loc 1 1820 4 view .LVU1232
1820:Core/Src/FAT/ff.c **** 			if (res != FR_OK) break;
 3675              		.loc 1 1820 10 is_stmt 0 view .LVU1233
 3676 0028 A169     		ldr	r1, [r4, #24]
 3677 002a 3846     		mov	r0, r7
 3678              	.LVL458:
1820:Core/Src/FAT/ff.c **** 			if (res != FR_OK) break;
 3679              		.loc 1 1820 10 view .LVU1234
 3680 002c FFF7FEFF 		bl	move_window
 3681              	.LVL459:
1821:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT
 3682              		.loc 1 1821 4 is_stmt 1 view .LVU1235
1821:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 147


 3683              		.loc 1 1821 7 is_stmt 0 view .LVU1236
 3684 0030 0246     		mov	r2, r0
 3685 0032 38B9     		cbnz	r0, .L262
1825:Core/Src/FAT/ff.c **** #endif
 3686              		.loc 1 1825 4 is_stmt 1 view .LVU1237
1825:Core/Src/FAT/ff.c **** #endif
 3687              		.loc 1 1825 10 is_stmt 0 view .LVU1238
 3688 0034 E369     		ldr	r3, [r4, #28]
1825:Core/Src/FAT/ff.c **** #endif
 3689              		.loc 1 1825 15 view .LVU1239
 3690 0036 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
1825:Core/Src/FAT/ff.c **** #endif
 3691              		.loc 1 1825 7 view .LVU1240
 3692 0038 E52B     		cmp	r3, #229
 3693 003a ECD0     		beq	.L263
1825:Core/Src/FAT/ff.c **** #endif
 3694              		.loc 1 1825 34 discriminator 1 view .LVU1241
 3695 003c 002B     		cmp	r3, #0
 3696 003e EAD0     		beq	.L263
1829:Core/Src/FAT/ff.c **** 			}
 3697              		.loc 1 1829 7 view .LVU1242
 3698 0040 0025     		movs	r5, #0
 3699              	.LVL460:
1829:Core/Src/FAT/ff.c **** 			}
 3700              		.loc 1 1829 7 view .LVU1243
 3701 0042 EBE7     		b	.L264
 3702              	.L262:
 3703              	.LVL461:
1835:Core/Src/FAT/ff.c **** 	return res;
 3704              		.loc 1 1835 2 is_stmt 1 view .LVU1244
1835:Core/Src/FAT/ff.c **** 	return res;
 3705              		.loc 1 1835 5 is_stmt 0 view .LVU1245
 3706 0044 042A     		cmp	r2, #4
 3707 0046 01D0     		beq	.L270
 3708              	.LVL462:
 3709              	.L266:
1836:Core/Src/FAT/ff.c **** }
 3710              		.loc 1 1836 2 is_stmt 1 view .LVU1246
1837:Core/Src/FAT/ff.c **** 
 3711              		.loc 1 1837 1 is_stmt 0 view .LVU1247
 3712 0048 1046     		mov	r0, r2
 3713 004a F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 3714              	.LVL463:
 3715              	.L270:
1835:Core/Src/FAT/ff.c **** 	return res;
 3716              		.loc 1 1835 29 view .LVU1248
 3717 004c 0722     		movs	r2, #7
 3718              	.LVL464:
1835:Core/Src/FAT/ff.c **** 	return res;
 3719              		.loc 1 1835 29 view .LVU1249
 3720 004e FBE7     		b	.L266
 3721              		.cfi_endproc
 3722              	.LFE17:
 3724              		.section	.text.dir_read,"ax",%progbits
 3725              		.align	1
 3726              		.syntax unified
 3727              		.thumb
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 148


 3728              		.thumb_func
 3730              	dir_read:
 3731              	.LVL465:
 3732              	.LFB20:
2310:Core/Src/FAT/ff.c **** 	FRESULT res = FR_NO_FILE;
 3733              		.loc 1 2310 1 is_stmt 1 view -0
 3734              		.cfi_startproc
 3735              		@ args = 0, pretend = 0, frame = 0
 3736              		@ frame_needed = 0, uses_anonymous_args = 0
2310:Core/Src/FAT/ff.c **** 	FRESULT res = FR_NO_FILE;
 3737              		.loc 1 2310 1 is_stmt 0 view .LVU1251
 3738 0000 F8B5     		push	{r3, r4, r5, r6, r7, lr}
 3739              	.LCFI21:
 3740              		.cfi_def_cfa_offset 24
 3741              		.cfi_offset 3, -24
 3742              		.cfi_offset 4, -20
 3743              		.cfi_offset 5, -16
 3744              		.cfi_offset 6, -12
 3745              		.cfi_offset 7, -8
 3746              		.cfi_offset 14, -4
 3747 0002 0446     		mov	r4, r0
 3748 0004 0E46     		mov	r6, r1
2311:Core/Src/FAT/ff.c **** 	FATFS *fs = dp->obj.fs;
 3749              		.loc 1 2311 2 is_stmt 1 view .LVU1252
 3750              	.LVL466:
2312:Core/Src/FAT/ff.c **** 	BYTE attr, b;
 3751              		.loc 1 2312 2 view .LVU1253
2312:Core/Src/FAT/ff.c **** 	BYTE attr, b;
 3752              		.loc 1 2312 9 is_stmt 0 view .LVU1254
 3753 0006 0568     		ldr	r5, [r0]
 3754              	.LVL467:
2313:Core/Src/FAT/ff.c **** #if FF_USE_LFN
 3755              		.loc 1 2313 2 is_stmt 1 view .LVU1255
2318:Core/Src/FAT/ff.c **** 		res = move_window(fs, dp->sect);
 3756              		.loc 1 2318 2 view .LVU1256
2311:Core/Src/FAT/ff.c **** 	FATFS *fs = dp->obj.fs;
 3757              		.loc 1 2311 10 is_stmt 0 view .LVU1257
 3758 0008 0427     		movs	r7, #4
2318:Core/Src/FAT/ff.c **** 		res = move_window(fs, dp->sect);
 3759              		.loc 1 2318 8 view .LVU1258
 3760 000a 05E0     		b	.L272
 3761              	.LVL468:
 3762              	.L274:
2368:Core/Src/FAT/ff.c **** 		if (res != FR_OK) break;
 3763              		.loc 1 2368 3 is_stmt 1 view .LVU1259
2368:Core/Src/FAT/ff.c **** 		if (res != FR_OK) break;
 3764              		.loc 1 2368 9 is_stmt 0 view .LVU1260
 3765 000c 0021     		movs	r1, #0
 3766 000e 2046     		mov	r0, r4
 3767              	.LVL469:
2368:Core/Src/FAT/ff.c **** 		if (res != FR_OK) break;
 3768              		.loc 1 2368 9 view .LVU1261
 3769 0010 FFF7FEFF 		bl	dir_next
 3770              	.LVL470:
2369:Core/Src/FAT/ff.c **** 	}
 3771              		.loc 1 2369 3 is_stmt 1 view .LVU1262
2369:Core/Src/FAT/ff.c **** 	}
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 149


 3772              		.loc 1 2369 6 is_stmt 0 view .LVU1263
 3773 0014 0746     		mov	r7, r0
 3774 0016 E8B9     		cbnz	r0, .L273
 3775              	.LVL471:
 3776              	.L272:
2318:Core/Src/FAT/ff.c **** 		res = move_window(fs, dp->sect);
 3777              		.loc 1 2318 8 is_stmt 1 view .LVU1264
2318:Core/Src/FAT/ff.c **** 		res = move_window(fs, dp->sect);
 3778              		.loc 1 2318 11 is_stmt 0 view .LVU1265
 3779 0018 A169     		ldr	r1, [r4, #24]
2318:Core/Src/FAT/ff.c **** 		res = move_window(fs, dp->sect);
 3780              		.loc 1 2318 8 view .LVU1266
 3781 001a D9B1     		cbz	r1, .L273
2319:Core/Src/FAT/ff.c **** 		if (res != FR_OK) break;
 3782              		.loc 1 2319 3 is_stmt 1 view .LVU1267
2319:Core/Src/FAT/ff.c **** 		if (res != FR_OK) break;
 3783              		.loc 1 2319 9 is_stmt 0 view .LVU1268
 3784 001c 2846     		mov	r0, r5
 3785 001e FFF7FEFF 		bl	move_window
 3786              	.LVL472:
2320:Core/Src/FAT/ff.c **** 		b = dp->dir[DIR_Name];	/* Test for the entry type */
 3787              		.loc 1 2320 3 is_stmt 1 view .LVU1269
2320:Core/Src/FAT/ff.c **** 		b = dp->dir[DIR_Name];	/* Test for the entry type */
 3788              		.loc 1 2320 6 is_stmt 0 view .LVU1270
 3789 0022 0746     		mov	r7, r0
 3790 0024 B0B9     		cbnz	r0, .L273
2321:Core/Src/FAT/ff.c **** 		if (b == 0) {
 3791              		.loc 1 2321 3 is_stmt 1 view .LVU1271
2321:Core/Src/FAT/ff.c **** 		if (b == 0) {
 3792              		.loc 1 2321 9 is_stmt 0 view .LVU1272
 3793 0026 E369     		ldr	r3, [r4, #28]
2321:Core/Src/FAT/ff.c **** 		if (b == 0) {
 3794              		.loc 1 2321 5 view .LVU1273
 3795 0028 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
 3796              	.LVL473:
2322:Core/Src/FAT/ff.c **** 			res = FR_NO_FILE; break; /* Reached to end of the directory */
 3797              		.loc 1 2322 3 is_stmt 1 view .LVU1274
2322:Core/Src/FAT/ff.c **** 			res = FR_NO_FILE; break; /* Reached to end of the directory */
 3798              		.loc 1 2322 6 is_stmt 0 view .LVU1275
 3799 002a 92B1     		cbz	r2, .L277
2342:Core/Src/FAT/ff.c **** #if FF_USE_LFN		/* LFN configuration */
 3800              		.loc 1 2342 4 is_stmt 1 view .LVU1276
2342:Core/Src/FAT/ff.c **** #if FF_USE_LFN		/* LFN configuration */
 3801              		.loc 1 2342 33 is_stmt 0 view .LVU1277
 3802 002c DB7A     		ldrb	r3, [r3, #11]	@ zero_extendqisi2
2342:Core/Src/FAT/ff.c **** #if FF_USE_LFN		/* LFN configuration */
 3803              		.loc 1 2342 24 view .LVU1278
 3804 002e 03F03F03 		and	r3, r3, #63
 3805              	.LVL474:
2342:Core/Src/FAT/ff.c **** #if FF_USE_LFN		/* LFN configuration */
 3806              		.loc 1 2342 17 view .LVU1279
 3807 0032 A371     		strb	r3, [r4, #6]
2363:Core/Src/FAT/ff.c **** 				break;
 3808              		.loc 1 2363 4 is_stmt 1 view .LVU1280
2363:Core/Src/FAT/ff.c **** 				break;
 3809              		.loc 1 2363 7 is_stmt 0 view .LVU1281
 3810 0034 E52A     		cmp	r2, #229
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 150


 3811 0036 E9D0     		beq	.L274
2363:Core/Src/FAT/ff.c **** 				break;
 3812              		.loc 1 2363 18 discriminator 1 view .LVU1282
 3813 0038 2E2A     		cmp	r2, #46
 3814 003a E7D0     		beq	.L274
2363:Core/Src/FAT/ff.c **** 				break;
 3815              		.loc 1 2363 30 discriminator 2 view .LVU1283
 3816 003c 0F2B     		cmp	r3, #15
 3817 003e E5D0     		beq	.L274
2363:Core/Src/FAT/ff.c **** 				break;
 3818              		.loc 1 2363 63 discriminator 3 view .LVU1284
 3819 0040 23F02003 		bic	r3, r3, #32
 3820              	.LVL475:
2363:Core/Src/FAT/ff.c **** 				break;
 3821              		.loc 1 2363 51 discriminator 3 view .LVU1285
 3822 0044 082B     		cmp	r3, #8
 3823 0046 14BF     		ite	ne
 3824 0048 0023     		movne	r3, #0
 3825 004a 0123     		moveq	r3, #1
2363:Core/Src/FAT/ff.c **** 				break;
 3826              		.loc 1 2363 48 discriminator 3 view .LVU1286
 3827 004c B342     		cmp	r3, r6
 3828 004e DDD1     		bne	.L274
 3829 0050 00E0     		b	.L273
 3830              	.LVL476:
 3831              	.L277:
2323:Core/Src/FAT/ff.c **** 		}
 3832              		.loc 1 2323 8 view .LVU1287
 3833 0052 0427     		movs	r7, #4
 3834              	.LVL477:
 3835              	.L273:
2372:Core/Src/FAT/ff.c **** 	return res;
 3836              		.loc 1 2372 2 is_stmt 1 view .LVU1288
2372:Core/Src/FAT/ff.c **** 	return res;
 3837              		.loc 1 2372 5 is_stmt 0 view .LVU1289
 3838 0054 0FB1     		cbz	r7, .L276
2372:Core/Src/FAT/ff.c **** 	return res;
 3839              		.loc 1 2372 20 is_stmt 1 discriminator 1 view .LVU1290
2372:Core/Src/FAT/ff.c **** 	return res;
 3840              		.loc 1 2372 29 is_stmt 0 discriminator 1 view .LVU1291
 3841 0056 0023     		movs	r3, #0
 3842 0058 A361     		str	r3, [r4, #24]
 3843              	.L276:
2373:Core/Src/FAT/ff.c **** }
 3844              		.loc 1 2373 2 is_stmt 1 view .LVU1292
2374:Core/Src/FAT/ff.c **** 
 3845              		.loc 1 2374 1 is_stmt 0 view .LVU1293
 3846 005a 3846     		mov	r0, r7
 3847 005c F8BD     		pop	{r3, r4, r5, r6, r7, pc}
2374:Core/Src/FAT/ff.c **** 
 3848              		.loc 1 2374 1 view .LVU1294
 3849              		.cfi_endproc
 3850              	.LFE20:
 3852              		.section	.rodata.create_name.str1.4,"aMS",%progbits,1
 3853              		.align	2
 3854              	.LC1:
 3855 0000 2A2B2C3A 		.ascii	"*+,:;<=>[]|\"?\177\000"
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 151


 3855      3B3C3D3E 
 3855      5B5D7C22 
 3855      3F7F00
 3856              		.section	.text.create_name,"ax",%progbits
 3857              		.align	1
 3858              		.syntax unified
 3859              		.thumb
 3860              		.thumb_func
 3862              	create_name:
 3863              	.LVL478:
 3864              	.LFB25:
2851:Core/Src/FAT/ff.c **** #if FF_USE_LFN		/* LFN configuration */
 3865              		.loc 1 2851 1 is_stmt 1 view -0
 3866              		.cfi_startproc
 3867              		@ args = 0, pretend = 0, frame = 8
 3868              		@ frame_needed = 0, uses_anonymous_args = 0
2851:Core/Src/FAT/ff.c **** #if FF_USE_LFN		/* LFN configuration */
 3869              		.loc 1 2851 1 is_stmt 0 view .LVU1296
 3870 0000 2DE9F04F 		push	{r4, r5, r6, r7, r8, r9, r10, fp, lr}
 3871              	.LCFI22:
 3872              		.cfi_def_cfa_offset 36
 3873              		.cfi_offset 4, -36
 3874              		.cfi_offset 5, -32
 3875              		.cfi_offset 6, -28
 3876              		.cfi_offset 7, -24
 3877              		.cfi_offset 8, -20
 3878              		.cfi_offset 9, -16
 3879              		.cfi_offset 10, -12
 3880              		.cfi_offset 11, -8
 3881              		.cfi_offset 14, -4
 3882 0004 83B0     		sub	sp, sp, #12
 3883              	.LCFI23:
 3884              		.cfi_def_cfa_offset 48
 3885 0006 8046     		mov	r8, r0
 3886 0008 0191     		str	r1, [sp, #4]
2980:Core/Src/FAT/ff.c **** 	BYTE *sfn;
 3887              		.loc 1 2980 2 is_stmt 1 view .LVU1297
2981:Core/Src/FAT/ff.c **** 	UINT ni, si, i;
 3888              		.loc 1 2981 2 view .LVU1298
2982:Core/Src/FAT/ff.c **** 	const char *p;
 3889              		.loc 1 2982 2 view .LVU1299
2983:Core/Src/FAT/ff.c **** 
 3890              		.loc 1 2983 2 view .LVU1300
2986:Core/Src/FAT/ff.c **** 	memset(sfn, ' ', 11);
 3891              		.loc 1 2986 2 view .LVU1301
2986:Core/Src/FAT/ff.c **** 	memset(sfn, ' ', 11);
 3892              		.loc 1 2986 4 is_stmt 0 view .LVU1302
 3893 000a D1F80090 		ldr	r9, [r1]
 3894              	.LVL479:
2986:Core/Src/FAT/ff.c **** 	memset(sfn, ' ', 11);
 3895              		.loc 1 2986 13 is_stmt 1 view .LVU1303
2986:Core/Src/FAT/ff.c **** 	memset(sfn, ' ', 11);
 3896              		.loc 1 2986 17 is_stmt 0 view .LVU1304
 3897 000e 00F1200B 		add	fp, r0, #32
 3898              	.LVL480:
2987:Core/Src/FAT/ff.c **** 	si = i = 0; ni = 8;
 3899              		.loc 1 2987 2 is_stmt 1 view .LVU1305
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 152


 3900 0012 4FF02033 		mov	r3, #538976288
 3901 0016 0362     		str	r3, [r0, #32]	@ unaligned
 3902 0018 4362     		str	r3, [r0, #36]	@ unaligned
 3903 001a C0F82730 		str	r3, [r0, #39]	@ unaligned
2988:Core/Src/FAT/ff.c **** #if FF_FS_RPATH != 0
 3904              		.loc 1 2988 2 view .LVU1306
 3905              	.LVL481:
2988:Core/Src/FAT/ff.c **** #if FF_FS_RPATH != 0
 3906              		.loc 1 2988 14 view .LVU1307
2988:Core/Src/FAT/ff.c **** #if FF_FS_RPATH != 0
 3907              		.loc 1 2988 9 is_stmt 0 view .LVU1308
 3908 001e 0027     		movs	r7, #0
2988:Core/Src/FAT/ff.c **** #if FF_FS_RPATH != 0
 3909              		.loc 1 2988 5 view .LVU1309
 3910 0020 3E46     		mov	r6, r7
2988:Core/Src/FAT/ff.c **** #if FF_FS_RPATH != 0
 3911              		.loc 1 2988 17 view .LVU1310
 3912 0022 4FF0080A 		mov	r10, #8
 3913 0026 1AE0     		b	.L280
 3914              	.LVL482:
 3915              	.L285:
3006:Core/Src/FAT/ff.c **** 			break;
 3916              		.loc 1 3006 31 is_stmt 1 discriminator 4 view .LVU1311
3006:Core/Src/FAT/ff.c **** 			break;
 3917              		.loc 1 3006 33 is_stmt 0 discriminator 4 view .LVU1312
 3918 0028 0135     		adds	r5, r5, #1
 3919              	.LVL483:
 3920              	.L284:
3006:Core/Src/FAT/ff.c **** 			break;
 3921              		.loc 1 3006 10 is_stmt 1 discriminator 1 view .LVU1313
3006:Core/Src/FAT/ff.c **** 			break;
 3922              		.loc 1 3006 11 is_stmt 0 discriminator 1 view .LVU1314
 3923 002a 19F80530 		ldrb	r3, [r9, r5]	@ zero_extendqisi2
3006:Core/Src/FAT/ff.c **** 			break;
 3924              		.loc 1 3006 10 discriminator 1 view .LVU1315
 3925 002e 2F2B     		cmp	r3, #47
 3926 0030 FAD0     		beq	.L285
3006:Core/Src/FAT/ff.c **** 			break;
 3927              		.loc 1 3006 11 discriminator 3 view .LVU1316
 3928 0032 5C2B     		cmp	r3, #92
 3929 0034 F8D0     		beq	.L285
 3930              	.L281:
3034:Core/Src/FAT/ff.c **** 	if (i == 0) return FR_INVALID_NAME;	/* Reject nul string */
 3931              		.loc 1 3034 2 is_stmt 1 view .LVU1317
3034:Core/Src/FAT/ff.c **** 	if (i == 0) return FR_INVALID_NAME;	/* Reject nul string */
 3932              		.loc 1 3034 10 is_stmt 0 view .LVU1318
 3933 0036 4D44     		add	r5, r5, r9
 3934              	.LVL484:
3034:Core/Src/FAT/ff.c **** 	if (i == 0) return FR_INVALID_NAME;	/* Reject nul string */
 3935              		.loc 1 3034 8 view .LVU1319
 3936 0038 019B     		ldr	r3, [sp, #4]
 3937 003a 1D60     		str	r5, [r3]
3035:Core/Src/FAT/ff.c **** 
 3938              		.loc 1 3035 2 is_stmt 1 view .LVU1320
3035:Core/Src/FAT/ff.c **** 
 3939              		.loc 1 3035 5 is_stmt 0 view .LVU1321
 3940 003c 002F     		cmp	r7, #0
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 153


 3941 003e 5ED0     		beq	.L299
3037:Core/Src/FAT/ff.c **** 	sfn[NSFLAG] = (c <= ' ' || p[si] <= ' ') ? NS_LAST : 0;	/* Set last segment flag if end of the pat
 3942              		.loc 1 3037 2 is_stmt 1 view .LVU1322
3037:Core/Src/FAT/ff.c **** 	sfn[NSFLAG] = (c <= ' ' || p[si] <= ' ') ? NS_LAST : 0;	/* Set last segment flag if end of the pat
 3943              		.loc 1 3037 9 is_stmt 0 view .LVU1323
 3944 0040 98F82030 		ldrb	r3, [r8, #32]	@ zero_extendqisi2
3037:Core/Src/FAT/ff.c **** 	sfn[NSFLAG] = (c <= ' ' || p[si] <= ' ') ? NS_LAST : 0;	/* Set last segment flag if end of the pat
 3945              		.loc 1 3037 5 view .LVU1324
 3946 0044 E52B     		cmp	r3, #229
 3947 0046 47D0     		beq	.L304
 3948              	.L292:
3038:Core/Src/FAT/ff.c **** 
 3949              		.loc 1 3038 2 is_stmt 1 view .LVU1325
3038:Core/Src/FAT/ff.c **** 
 3950              		.loc 1 3038 14 is_stmt 0 view .LVU1326
 3951 0048 202C     		cmp	r4, #32
 3952 004a 49D9     		bls	.L300
3038:Core/Src/FAT/ff.c **** 
 3953              		.loc 1 3038 30 discriminator 2 view .LVU1327
 3954 004c 2B78     		ldrb	r3, [r5]	@ zero_extendqisi2
3038:Core/Src/FAT/ff.c **** 
 3955              		.loc 1 3038 26 discriminator 2 view .LVU1328
 3956 004e 202B     		cmp	r3, #32
 3957 0050 4BD8     		bhi	.L301
3038:Core/Src/FAT/ff.c **** 
 3958              		.loc 1 3038 14 view .LVU1329
 3959 0052 0423     		movs	r3, #4
 3960 0054 45E0     		b	.L293
 3961              	.LVL485:
 3962              	.L305:
3011:Core/Src/FAT/ff.c **** 			continue;
 3963              		.loc 1 3011 6 view .LVU1330
 3964 0056 0827     		movs	r7, #8
 3965              	.LVL486:
3011:Core/Src/FAT/ff.c **** 			continue;
 3966              		.loc 1 3011 14 view .LVU1331
 3967 0058 4FF00B0A 		mov	r10, #11
 3968              	.LVL487:
 3969              	.L289:
3011:Core/Src/FAT/ff.c **** 			continue;
 3970              		.loc 1 3011 14 view .LVU1332
 3971 005c 2E46     		mov	r6, r5
 3972              	.LVL488:
 3973              	.L280:
3002:Core/Src/FAT/ff.c **** 		c = (BYTE)p[si++];				/* Get a byte */
 3974              		.loc 1 3002 2 is_stmt 1 view .LVU1333
3003:Core/Src/FAT/ff.c **** 		if (c <= ' ') break; 			/* Break if end of the path name */
 3975              		.loc 1 3003 3 view .LVU1334
3003:Core/Src/FAT/ff.c **** 		if (c <= ' ') break; 			/* Break if end of the path name */
 3976              		.loc 1 3003 17 is_stmt 0 view .LVU1335
 3977 005e 751C     		adds	r5, r6, #1
 3978              	.LVL489:
3003:Core/Src/FAT/ff.c **** 		if (c <= ' ') break; 			/* Break if end of the path name */
 3979              		.loc 1 3003 5 view .LVU1336
 3980 0060 19F80640 		ldrb	r4, [r9, r6]	@ zero_extendqisi2
 3981              	.LVL490:
3004:Core/Src/FAT/ff.c **** 		if (IsSeparator(c)) {			/* Break if a separator is found */
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 154


 3982              		.loc 1 3004 3 is_stmt 1 view .LVU1337
3004:Core/Src/FAT/ff.c **** 		if (IsSeparator(c)) {			/* Break if a separator is found */
 3983              		.loc 1 3004 6 is_stmt 0 view .LVU1338
 3984 0064 202C     		cmp	r4, #32
 3985 0066 E6D9     		bls	.L281
3005:Core/Src/FAT/ff.c **** 			while (IsSeparator(p[si])) si++;	/* Skip duplicated separator if exist */
 3986              		.loc 1 3005 3 is_stmt 1 view .LVU1339
3005:Core/Src/FAT/ff.c **** 			while (IsSeparator(p[si])) si++;	/* Skip duplicated separator if exist */
 3987              		.loc 1 3005 6 is_stmt 0 view .LVU1340
 3988 0068 2F2C     		cmp	r4, #47
 3989 006a DED0     		beq	.L284
3005:Core/Src/FAT/ff.c **** 			while (IsSeparator(p[si])) si++;	/* Skip duplicated separator if exist */
 3990              		.loc 1 3005 7 discriminator 1 view .LVU1341
 3991 006c 5C2C     		cmp	r4, #92
 3992 006e DCD0     		beq	.L284
3009:Core/Src/FAT/ff.c **** 			if (ni == 11 || c != '.') return FR_INVALID_NAME;	/* Field overflow or invalid dot? */
 3993              		.loc 1 3009 3 is_stmt 1 view .LVU1342
3009:Core/Src/FAT/ff.c **** 			if (ni == 11 || c != '.') return FR_INVALID_NAME;	/* Field overflow or invalid dot? */
 3994              		.loc 1 3009 6 is_stmt 0 view .LVU1343
 3995 0070 2E2C     		cmp	r4, #46
 3996 0072 01D0     		beq	.L286
3009:Core/Src/FAT/ff.c **** 			if (ni == 11 || c != '.') return FR_INVALID_NAME;	/* Field overflow or invalid dot? */
 3997              		.loc 1 3009 16 discriminator 1 view .LVU1344
 3998 0074 BA45     		cmp	r10, r7
 3999 0076 08D8     		bhi	.L287
 4000              	.L286:
3010:Core/Src/FAT/ff.c **** 			i = 8; ni = 11;				/* Enter file extension field */
 4001              		.loc 1 3010 4 is_stmt 1 view .LVU1345
3010:Core/Src/FAT/ff.c **** 			i = 8; ni = 11;				/* Enter file extension field */
 4002              		.loc 1 3010 7 is_stmt 0 view .LVU1346
 4003 0078 BAF10B0F 		cmp	r10, #11
 4004 007c 37D0     		beq	.L294
3010:Core/Src/FAT/ff.c **** 			i = 8; ni = 11;				/* Enter file extension field */
 4005              		.loc 1 3010 17 discriminator 2 view .LVU1347
 4006 007e 2E2C     		cmp	r4, #46
 4007 0080 E9D0     		beq	.L305
3010:Core/Src/FAT/ff.c **** 			i = 8; ni = 11;				/* Enter file extension field */
 4008              		.loc 1 3010 37 view .LVU1348
 4009 0082 0620     		movs	r0, #6
 4010              	.LVL491:
 4011              	.L288:
3042:Core/Src/FAT/ff.c **** 
 4012              		.loc 1 3042 1 view .LVU1349
 4013 0084 03B0     		add	sp, sp, #12
 4014              	.LCFI24:
 4015              		.cfi_remember_state
 4016              		.cfi_def_cfa_offset 36
 4017              		@ sp needed
 4018 0086 BDE8F08F 		pop	{r4, r5, r6, r7, r8, r9, r10, fp, pc}
 4019              	.LVL492:
 4020              	.L287:
 4021              	.LCFI25:
 4022              		.cfi_restore_state
3023:Core/Src/FAT/ff.c **** 			d = (BYTE)p[si++];			/* Get 2nd byte */
 4023              		.loc 1 3023 3 is_stmt 1 view .LVU1350
3023:Core/Src/FAT/ff.c **** 			d = (BYTE)p[si++];			/* Get 2nd byte */
 4024              		.loc 1 3023 7 is_stmt 0 view .LVU1351
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 155


 4025 008a 2046     		mov	r0, r4
 4026 008c FFF7FEFF 		bl	dbc_1st
 4027              	.LVL493:
3023:Core/Src/FAT/ff.c **** 			d = (BYTE)p[si++];			/* Get 2nd byte */
 4028              		.loc 1 3023 6 view .LVU1352
 4029 0090 90B1     		cbz	r0, .L290
3024:Core/Src/FAT/ff.c **** 			if (!dbc_2nd(d) || i >= ni - 1) return FR_INVALID_NAME;	/* Reject invalid DBC */
 4030              		.loc 1 3024 4 is_stmt 1 view .LVU1353
3024:Core/Src/FAT/ff.c **** 			if (!dbc_2nd(d) || i >= ni - 1) return FR_INVALID_NAME;	/* Reject invalid DBC */
 4031              		.loc 1 3024 18 is_stmt 0 view .LVU1354
 4032 0092 0236     		adds	r6, r6, #2
 4033              	.LVL494:
3024:Core/Src/FAT/ff.c **** 			if (!dbc_2nd(d) || i >= ni - 1) return FR_INVALID_NAME;	/* Reject invalid DBC */
 4034              		.loc 1 3024 6 view .LVU1355
 4035 0094 19F80550 		ldrb	r5, [r9, r5]	@ zero_extendqisi2
 4036              	.LVL495:
3025:Core/Src/FAT/ff.c **** 			sfn[i++] = c;
 4037              		.loc 1 3025 4 is_stmt 1 view .LVU1356
3025:Core/Src/FAT/ff.c **** 			sfn[i++] = c;
 4038              		.loc 1 3025 9 is_stmt 0 view .LVU1357
 4039 0098 2846     		mov	r0, r5
 4040 009a FFF7FEFF 		bl	dbc_2nd
 4041              	.LVL496:
3025:Core/Src/FAT/ff.c **** 			sfn[i++] = c;
 4042              		.loc 1 3025 7 view .LVU1358
 4043 009e 40B3     		cbz	r0, .L296
3025:Core/Src/FAT/ff.c **** 			sfn[i++] = c;
 4044              		.loc 1 3025 31 discriminator 2 view .LVU1359
 4045 00a0 0AF1FF33 		add	r3, r10, #-1
3025:Core/Src/FAT/ff.c **** 			sfn[i++] = c;
 4046              		.loc 1 3025 20 discriminator 2 view .LVU1360
 4047 00a4 BB42     		cmp	r3, r7
 4048 00a6 26D9     		bls	.L297
3026:Core/Src/FAT/ff.c **** 			sfn[i++] = d;
 4049              		.loc 1 3026 4 is_stmt 1 view .LVU1361
3026:Core/Src/FAT/ff.c **** 			sfn[i++] = d;
 4050              		.loc 1 3026 9 is_stmt 0 view .LVU1362
 4051 00a8 7B1C     		adds	r3, r7, #1
 4052              	.LVL497:
3026:Core/Src/FAT/ff.c **** 			sfn[i++] = d;
 4053              		.loc 1 3026 13 view .LVU1363
 4054 00aa 0BF80740 		strb	r4, [fp, r7]
3027:Core/Src/FAT/ff.c **** 		} else {						/* SBC */
 4055              		.loc 1 3027 4 is_stmt 1 view .LVU1364
 4056              	.LVL498:
3027:Core/Src/FAT/ff.c **** 		} else {						/* SBC */
 4057              		.loc 1 3027 13 is_stmt 0 view .LVU1365
 4058 00ae 0BF80350 		strb	r5, [fp, r3]
 4059 00b2 0237     		adds	r7, r7, #2
 4060              	.LVL499:
3024:Core/Src/FAT/ff.c **** 			if (!dbc_2nd(d) || i >= ni - 1) return FR_INVALID_NAME;	/* Reject invalid DBC */
 4061              		.loc 1 3024 18 view .LVU1366
 4062 00b4 3546     		mov	r5, r6
 4063              	.LVL500:
3024:Core/Src/FAT/ff.c **** 			if (!dbc_2nd(d) || i >= ni - 1) return FR_INVALID_NAME;	/* Reject invalid DBC */
 4064              		.loc 1 3024 18 view .LVU1367
 4065 00b6 D1E7     		b	.L289
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 156


 4066              	.LVL501:
 4067              	.L290:
3029:Core/Src/FAT/ff.c **** 			if (IsLower(c)) c -= 0x20;	/* To upper */
 4068              		.loc 1 3029 4 is_stmt 1 view .LVU1368
3029:Core/Src/FAT/ff.c **** 			if (IsLower(c)) c -= 0x20;	/* To upper */
 4069              		.loc 1 3029 8 is_stmt 0 view .LVU1369
 4070 00b8 2146     		mov	r1, r4
 4071 00ba 1248     		ldr	r0, .L306
 4072 00bc FFF7FEFF 		bl	strchr
 4073              	.LVL502:
3029:Core/Src/FAT/ff.c **** 			if (IsLower(c)) c -= 0x20;	/* To upper */
 4074              		.loc 1 3029 7 view .LVU1370
 4075 00c0 D8B9     		cbnz	r0, .L298
3030:Core/Src/FAT/ff.c **** 			sfn[i++] = c;
 4076              		.loc 1 3030 4 is_stmt 1 view .LVU1371
3030:Core/Src/FAT/ff.c **** 			sfn[i++] = c;
 4077              		.loc 1 3030 8 is_stmt 0 view .LVU1372
 4078 00c2 A4F16103 		sub	r3, r4, #97
 4079 00c6 DBB2     		uxtb	r3, r3
3030:Core/Src/FAT/ff.c **** 			sfn[i++] = c;
 4080              		.loc 1 3030 7 view .LVU1373
 4081 00c8 192B     		cmp	r3, #25
 4082 00ca 01D8     		bhi	.L291
3030:Core/Src/FAT/ff.c **** 			sfn[i++] = c;
 4083              		.loc 1 3030 20 is_stmt 1 discriminator 1 view .LVU1374
3030:Core/Src/FAT/ff.c **** 			sfn[i++] = c;
 4084              		.loc 1 3030 22 is_stmt 0 discriminator 1 view .LVU1375
 4085 00cc 203C     		subs	r4, r4, #32
 4086              	.LVL503:
3030:Core/Src/FAT/ff.c **** 			sfn[i++] = c;
 4087              		.loc 1 3030 22 discriminator 1 view .LVU1376
 4088 00ce E4B2     		uxtb	r4, r4
 4089              	.LVL504:
 4090              	.L291:
3031:Core/Src/FAT/ff.c **** 		}
 4091              		.loc 1 3031 4 is_stmt 1 view .LVU1377
3031:Core/Src/FAT/ff.c **** 		}
 4092              		.loc 1 3031 13 is_stmt 0 view .LVU1378
 4093 00d0 0BF80740 		strb	r4, [fp, r7]
3031:Core/Src/FAT/ff.c **** 		}
 4094              		.loc 1 3031 9 view .LVU1379
 4095 00d4 0137     		adds	r7, r7, #1
 4096              	.LVL505:
3031:Core/Src/FAT/ff.c **** 		}
 4097              		.loc 1 3031 9 view .LVU1380
 4098 00d6 C1E7     		b	.L289
 4099              	.LVL506:
 4100              	.L304:
3037:Core/Src/FAT/ff.c **** 	sfn[NSFLAG] = (c <= ' ' || p[si] <= ' ') ? NS_LAST : 0;	/* Set last segment flag if end of the pat
 4101              		.loc 1 3037 22 is_stmt 1 discriminator 1 view .LVU1381
3037:Core/Src/FAT/ff.c **** 	sfn[NSFLAG] = (c <= ' ' || p[si] <= ' ') ? NS_LAST : 0;	/* Set last segment flag if end of the pat
 4102              		.loc 1 3037 29 is_stmt 0 discriminator 1 view .LVU1382
 4103 00d8 0523     		movs	r3, #5
 4104 00da 88F82030 		strb	r3, [r8, #32]
 4105 00de B3E7     		b	.L292
 4106              	.L300:
3038:Core/Src/FAT/ff.c **** 
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 157


 4107              		.loc 1 3038 14 view .LVU1383
 4108 00e0 0423     		movs	r3, #4
 4109              	.L293:
3038:Core/Src/FAT/ff.c **** 
 4110              		.loc 1 3038 14 discriminator 6 view .LVU1384
 4111 00e2 88F82B30 		strb	r3, [r8, #43]
3040:Core/Src/FAT/ff.c **** #endif /* FF_USE_LFN */
 4112              		.loc 1 3040 2 is_stmt 1 discriminator 6 view .LVU1385
3040:Core/Src/FAT/ff.c **** #endif /* FF_USE_LFN */
 4113              		.loc 1 3040 9 is_stmt 0 discriminator 6 view .LVU1386
 4114 00e6 0020     		movs	r0, #0
 4115 00e8 CCE7     		b	.L288
 4116              	.L301:
3038:Core/Src/FAT/ff.c **** 
 4117              		.loc 1 3038 14 view .LVU1387
 4118 00ea 0023     		movs	r3, #0
 4119 00ec F9E7     		b	.L293
 4120              	.LVL507:
 4121              	.L294:
3010:Core/Src/FAT/ff.c **** 			i = 8; ni = 11;				/* Enter file extension field */
 4122              		.loc 1 3010 37 view .LVU1388
 4123 00ee 0620     		movs	r0, #6
 4124 00f0 C8E7     		b	.L288
 4125              	.LVL508:
 4126              	.L296:
3025:Core/Src/FAT/ff.c **** 			sfn[i++] = c;
 4127              		.loc 1 3025 43 view .LVU1389
 4128 00f2 0620     		movs	r0, #6
 4129 00f4 C6E7     		b	.L288
 4130              	.L297:
3025:Core/Src/FAT/ff.c **** 			sfn[i++] = c;
 4131              		.loc 1 3025 43 view .LVU1390
 4132 00f6 0620     		movs	r0, #6
 4133 00f8 C4E7     		b	.L288
 4134              	.LVL509:
 4135              	.L298:
3029:Core/Src/FAT/ff.c **** 			if (IsLower(c)) c -= 0x20;	/* To upper */
 4136              		.loc 1 3029 54 view .LVU1391
 4137 00fa 0620     		movs	r0, #6
 4138 00fc C2E7     		b	.L288
 4139              	.LVL510:
 4140              	.L299:
3035:Core/Src/FAT/ff.c **** 
 4141              		.loc 1 3035 21 view .LVU1392
 4142 00fe 0620     		movs	r0, #6
 4143 0100 C0E7     		b	.L288
 4144              	.L307:
 4145 0102 00BF     		.align	2
 4146              	.L306:
 4147 0104 00000000 		.word	.LC1
 4148              		.cfi_endproc
 4149              	.LFE25:
 4151              		.section	.text.follow_path,"ax",%progbits
 4152              		.align	1
 4153              		.syntax unified
 4154              		.thumb
 4155              		.thumb_func
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 158


 4157              	follow_path:
 4158              	.LVL511:
 4159              	.LFB26:
3055:Core/Src/FAT/ff.c **** 	FRESULT res;
 4160              		.loc 1 3055 1 is_stmt 1 view -0
 4161              		.cfi_startproc
 4162              		@ args = 0, pretend = 0, frame = 8
 4163              		@ frame_needed = 0, uses_anonymous_args = 0
3055:Core/Src/FAT/ff.c **** 	FRESULT res;
 4164              		.loc 1 3055 1 is_stmt 0 view .LVU1394
 4165 0000 30B5     		push	{r4, r5, lr}
 4166              	.LCFI26:
 4167              		.cfi_def_cfa_offset 12
 4168              		.cfi_offset 4, -12
 4169              		.cfi_offset 5, -8
 4170              		.cfi_offset 14, -4
 4171 0002 83B0     		sub	sp, sp, #12
 4172              	.LCFI27:
 4173              		.cfi_def_cfa_offset 24
 4174 0004 0446     		mov	r4, r0
 4175 0006 0191     		str	r1, [sp, #4]
3056:Core/Src/FAT/ff.c **** 	BYTE ns;
 4176              		.loc 1 3056 2 is_stmt 1 view .LVU1395
3057:Core/Src/FAT/ff.c **** 	FATFS *fs = dp->obj.fs;
 4177              		.loc 1 3057 2 view .LVU1396
3058:Core/Src/FAT/ff.c **** 
 4178              		.loc 1 3058 2 view .LVU1397
3058:Core/Src/FAT/ff.c **** 
 4179              		.loc 1 3058 9 is_stmt 0 view .LVU1398
 4180 0008 0568     		ldr	r5, [r0]
 4181              	.LVL512:
3067:Core/Src/FAT/ff.c **** 		dp->obj.sclust = 0;					/* Start from the root directory */
 4182              		.loc 1 3067 3 is_stmt 1 view .LVU1399
3067:Core/Src/FAT/ff.c **** 		dp->obj.sclust = 0;					/* Start from the root directory */
 4183              		.loc 1 3067 9 is_stmt 0 view .LVU1400
 4184 000a 01E0     		b	.L309
 4185              	.L310:
3067:Core/Src/FAT/ff.c **** 		dp->obj.sclust = 0;					/* Start from the root directory */
 4186              		.loc 1 3067 30 is_stmt 1 discriminator 4 view .LVU1401
3067:Core/Src/FAT/ff.c **** 		dp->obj.sclust = 0;					/* Start from the root directory */
 4187              		.loc 1 3067 34 is_stmt 0 discriminator 4 view .LVU1402
 4188 000c 0133     		adds	r3, r3, #1
 4189 000e 0193     		str	r3, [sp, #4]
 4190              	.L309:
3067:Core/Src/FAT/ff.c **** 		dp->obj.sclust = 0;					/* Start from the root directory */
 4191              		.loc 1 3067 9 is_stmt 1 discriminator 1 view .LVU1403
3067:Core/Src/FAT/ff.c **** 		dp->obj.sclust = 0;					/* Start from the root directory */
 4192              		.loc 1 3067 10 is_stmt 0 discriminator 1 view .LVU1404
 4193 0010 019B     		ldr	r3, [sp, #4]
 4194 0012 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
3067:Core/Src/FAT/ff.c **** 		dp->obj.sclust = 0;					/* Start from the root directory */
 4195              		.loc 1 3067 9 discriminator 1 view .LVU1405
 4196 0014 2F2A     		cmp	r2, #47
 4197 0016 F9D0     		beq	.L310
3067:Core/Src/FAT/ff.c **** 		dp->obj.sclust = 0;					/* Start from the root directory */
 4198              		.loc 1 3067 10 discriminator 3 view .LVU1406
 4199 0018 5C2A     		cmp	r2, #92
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 159


 4200 001a F7D0     		beq	.L310
3068:Core/Src/FAT/ff.c **** 	}
 4201              		.loc 1 3068 3 is_stmt 1 view .LVU1407
3068:Core/Src/FAT/ff.c **** 	}
 4202              		.loc 1 3068 18 is_stmt 0 view .LVU1408
 4203 001c 0022     		movs	r2, #0
 4204 001e A260     		str	r2, [r4, #8]
3087:Core/Src/FAT/ff.c **** 		dp->fn[NSFLAG] = NS_NONAME;
 4205              		.loc 1 3087 2 is_stmt 1 view .LVU1409
3087:Core/Src/FAT/ff.c **** 		dp->fn[NSFLAG] = NS_NONAME;
 4206              		.loc 1 3087 12 is_stmt 0 view .LVU1410
 4207 0020 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
3087:Core/Src/FAT/ff.c **** 		dp->fn[NSFLAG] = NS_NONAME;
 4208              		.loc 1 3087 5 view .LVU1411
 4209 0022 1F2B     		cmp	r3, #31
 4210 0024 1ED9     		bls	.L317
 4211              	.LVL513:
 4212              	.L311:
3092:Core/Src/FAT/ff.c **** 			res = create_name(dp, &path);	/* Get a segment name of the path */
 4213              		.loc 1 3092 3 is_stmt 1 view .LVU1412
3093:Core/Src/FAT/ff.c **** 			if (res != FR_OK) break;
 4214              		.loc 1 3093 4 view .LVU1413
3093:Core/Src/FAT/ff.c **** 			if (res != FR_OK) break;
 4215              		.loc 1 3093 10 is_stmt 0 view .LVU1414
 4216 0026 01A9     		add	r1, sp, #4
 4217 0028 2046     		mov	r0, r4
 4218 002a FFF7FEFF 		bl	create_name
 4219              	.LVL514:
3094:Core/Src/FAT/ff.c **** 			res = dir_find(dp);				/* Find an object with the segment name */
 4220              		.loc 1 3094 4 is_stmt 1 view .LVU1415
3094:Core/Src/FAT/ff.c **** 			res = dir_find(dp);				/* Find an object with the segment name */
 4221              		.loc 1 3094 7 is_stmt 0 view .LVU1416
 4222 002e 0346     		mov	r3, r0
 4223 0030 00BB     		cbnz	r0, .L312
3095:Core/Src/FAT/ff.c **** 			ns = dp->fn[NSFLAG];
 4224              		.loc 1 3095 4 is_stmt 1 view .LVU1417
3095:Core/Src/FAT/ff.c **** 			ns = dp->fn[NSFLAG];
 4225              		.loc 1 3095 10 is_stmt 0 view .LVU1418
 4226 0032 2046     		mov	r0, r4
 4227              	.LVL515:
3095:Core/Src/FAT/ff.c **** 			ns = dp->fn[NSFLAG];
 4228              		.loc 1 3095 10 view .LVU1419
 4229 0034 FFF7FEFF 		bl	dir_find
 4230              	.LVL516:
3096:Core/Src/FAT/ff.c **** 			if (res != FR_OK) {				/* Failed to find the object */
 4231              		.loc 1 3096 4 is_stmt 1 view .LVU1420
3096:Core/Src/FAT/ff.c **** 			if (res != FR_OK) {				/* Failed to find the object */
 4232              		.loc 1 3096 7 is_stmt 0 view .LVU1421
 4233 0038 94F82B20 		ldrb	r2, [r4, #43]	@ zero_extendqisi2
 4234              	.LVL517:
3097:Core/Src/FAT/ff.c **** 				if (res == FR_NO_FILE) {	/* Object is not found */
 4235              		.loc 1 3097 4 is_stmt 1 view .LVU1422
3097:Core/Src/FAT/ff.c **** 				if (res == FR_NO_FILE) {	/* Object is not found */
 4236              		.loc 1 3097 7 is_stmt 0 view .LVU1423
 4237 003c 0346     		mov	r3, r0
 4238 003e E0B9     		cbnz	r0, .L318
3109:Core/Src/FAT/ff.c **** 			/* Get into the sub-directory */
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 160


 4239              		.loc 1 3109 4 is_stmt 1 view .LVU1424
3109:Core/Src/FAT/ff.c **** 			/* Get into the sub-directory */
 4240              		.loc 1 3109 7 is_stmt 0 view .LVU1425
 4241 0040 12F0040F 		tst	r2, #4
 4242 0044 16D1     		bne	.L312
3111:Core/Src/FAT/ff.c **** 				res = FR_NO_PATH; break;
 4243              		.loc 1 3111 4 is_stmt 1 view .LVU1426
3111:Core/Src/FAT/ff.c **** 				res = FR_NO_PATH; break;
 4244              		.loc 1 3111 17 is_stmt 0 view .LVU1427
 4245 0046 A379     		ldrb	r3, [r4, #6]	@ zero_extendqisi2
3111:Core/Src/FAT/ff.c **** 				res = FR_NO_PATH; break;
 4246              		.loc 1 3111 7 view .LVU1428
 4247 0048 13F0100F 		tst	r3, #16
 4248 004c 1CD0     		beq	.L315
3123:Core/Src/FAT/ff.c **** 			}
 4249              		.loc 1 3123 5 is_stmt 1 view .LVU1429
3123:Core/Src/FAT/ff.c **** 			}
 4250              		.loc 1 3123 35 is_stmt 0 view .LVU1430
 4251 004e 05F13003 		add	r3, r5, #48
3123:Core/Src/FAT/ff.c **** 			}
 4252              		.loc 1 3123 47 view .LVU1431
 4253 0052 2169     		ldr	r1, [r4, #16]
3123:Core/Src/FAT/ff.c **** 			}
 4254              		.loc 1 3123 54 view .LVU1432
 4255 0054 C1F30801 		ubfx	r1, r1, #0, #9
3123:Core/Src/FAT/ff.c **** 			}
 4256              		.loc 1 3123 22 view .LVU1433
 4257 0058 1944     		add	r1, r1, r3
 4258 005a 2846     		mov	r0, r5
 4259              	.LVL518:
3123:Core/Src/FAT/ff.c **** 			}
 4260              		.loc 1 3123 22 view .LVU1434
 4261 005c FFF7FEFF 		bl	ld_clust
 4262              	.LVL519:
3123:Core/Src/FAT/ff.c **** 			}
 4263              		.loc 1 3123 20 view .LVU1435
 4264 0060 A060     		str	r0, [r4, #8]
3092:Core/Src/FAT/ff.c **** 			res = create_name(dp, &path);	/* Get a segment name of the path */
 4265              		.loc 1 3092 9 is_stmt 1 view .LVU1436
3093:Core/Src/FAT/ff.c **** 			if (res != FR_OK) break;
 4266              		.loc 1 3093 8 is_stmt 0 view .LVU1437
 4267 0062 E0E7     		b	.L311
 4268              	.LVL520:
 4269              	.L317:
3088:Core/Src/FAT/ff.c **** 		res = dir_sdi(dp, 0);
 4270              		.loc 1 3088 3 is_stmt 1 view .LVU1438
3088:Core/Src/FAT/ff.c **** 		res = dir_sdi(dp, 0);
 4271              		.loc 1 3088 18 is_stmt 0 view .LVU1439
 4272 0064 8023     		movs	r3, #128
 4273 0066 84F82B30 		strb	r3, [r4, #43]
3089:Core/Src/FAT/ff.c **** 
 4274              		.loc 1 3089 3 is_stmt 1 view .LVU1440
3089:Core/Src/FAT/ff.c **** 
 4275              		.loc 1 3089 9 is_stmt 0 view .LVU1441
 4276 006a 1146     		mov	r1, r2
 4277              	.LVL521:
3089:Core/Src/FAT/ff.c **** 
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 161


 4278              		.loc 1 3089 9 view .LVU1442
 4279 006c 2046     		mov	r0, r4
 4280              	.LVL522:
3089:Core/Src/FAT/ff.c **** 
 4281              		.loc 1 3089 9 view .LVU1443
 4282 006e FFF7FEFF 		bl	dir_sdi
 4283              	.LVL523:
 4284 0072 0346     		mov	r3, r0
 4285              	.LVL524:
 4286              	.L312:
3128:Core/Src/FAT/ff.c **** }
 4287              		.loc 1 3128 2 is_stmt 1 view .LVU1444
3129:Core/Src/FAT/ff.c **** 
 4288              		.loc 1 3129 1 is_stmt 0 view .LVU1445
 4289 0074 1846     		mov	r0, r3
 4290 0076 03B0     		add	sp, sp, #12
 4291              	.LCFI28:
 4292              		.cfi_remember_state
 4293              		.cfi_def_cfa_offset 12
 4294              		@ sp needed
 4295 0078 30BD     		pop	{r4, r5, pc}
 4296              	.LVL525:
 4297              	.L318:
 4298              	.LCFI29:
 4299              		.cfi_restore_state
3098:Core/Src/FAT/ff.c **** 					if (FF_FS_RPATH && (ns & NS_DOT)) {	/* If dot entry is not exist, stay there */
 4300              		.loc 1 3098 5 is_stmt 1 view .LVU1446
3098:Core/Src/FAT/ff.c **** 					if (FF_FS_RPATH && (ns & NS_DOT)) {	/* If dot entry is not exist, stay there */
 4301              		.loc 1 3098 8 is_stmt 0 view .LVU1447
 4302 007a 0428     		cmp	r0, #4
 4303 007c FAD1     		bne	.L312
3099:Core/Src/FAT/ff.c **** 						if (!(ns & NS_LAST)) continue;	/* Continue to follow if not last segment */
 4304              		.loc 1 3099 6 is_stmt 1 view .LVU1448
3104:Core/Src/FAT/ff.c **** 					}
 4305              		.loc 1 3104 7 view .LVU1449
3104:Core/Src/FAT/ff.c **** 					}
 4306              		.loc 1 3104 10 is_stmt 0 view .LVU1450
 4307 007e 12F0040F 		tst	r2, #4
 4308 0082 F7D1     		bne	.L312
3104:Core/Src/FAT/ff.c **** 					}
 4309              		.loc 1 3104 32 view .LVU1451
 4310 0084 0523     		movs	r3, #5
 4311 0086 F5E7     		b	.L312
 4312              	.L315:
3112:Core/Src/FAT/ff.c **** 			}
 4313              		.loc 1 3112 9 view .LVU1452
 4314 0088 0523     		movs	r3, #5
 4315 008a F3E7     		b	.L312
 4316              		.cfi_endproc
 4317              	.LFE26:
 4319              		.section	.text.dir_register,"ax",%progbits
 4320              		.align	1
 4321              		.syntax unified
 4322              		.thumb
 4323              		.thumb_func
 4325              	dir_register:
 4326              	.LVL526:
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 162


 4327              	.LFB22:
2468:Core/Src/FAT/ff.c **** 	FRESULT res;
 4328              		.loc 1 2468 1 is_stmt 1 view -0
 4329              		.cfi_startproc
 4330              		@ args = 0, pretend = 0, frame = 0
 4331              		@ frame_needed = 0, uses_anonymous_args = 0
2468:Core/Src/FAT/ff.c **** 	FRESULT res;
 4332              		.loc 1 2468 1 is_stmt 0 view .LVU1454
 4333 0000 70B5     		push	{r4, r5, r6, lr}
 4334              	.LCFI30:
 4335              		.cfi_def_cfa_offset 16
 4336              		.cfi_offset 4, -16
 4337              		.cfi_offset 5, -12
 4338              		.cfi_offset 6, -8
 4339              		.cfi_offset 14, -4
 4340 0002 0446     		mov	r4, r0
2469:Core/Src/FAT/ff.c **** 	FATFS *fs = dp->obj.fs;
 4341              		.loc 1 2469 2 is_stmt 1 view .LVU1455
2470:Core/Src/FAT/ff.c **** #if FF_USE_LFN		/* LFN configuration */
 4342              		.loc 1 2470 2 view .LVU1456
2470:Core/Src/FAT/ff.c **** #if FF_USE_LFN		/* LFN configuration */
 4343              		.loc 1 2470 9 is_stmt 0 view .LVU1457
 4344 0004 0668     		ldr	r6, [r0]
 4345              	.LVL527:
2542:Core/Src/FAT/ff.c **** 
 4346              		.loc 1 2542 2 is_stmt 1 view .LVU1458
2542:Core/Src/FAT/ff.c **** 
 4347              		.loc 1 2542 8 is_stmt 0 view .LVU1459
 4348 0006 0121     		movs	r1, #1
 4349 0008 FFF7FEFF 		bl	dir_alloc
 4350              	.LVL528:
2547:Core/Src/FAT/ff.c **** 		res = move_window(fs, dp->sect);
 4351              		.loc 1 2547 2 is_stmt 1 view .LVU1460
2547:Core/Src/FAT/ff.c **** 		res = move_window(fs, dp->sect);
 4352              		.loc 1 2547 5 is_stmt 0 view .LVU1461
 4353 000c 0546     		mov	r5, r0
 4354 000e 08B1     		cbz	r0, .L322
 4355              	.LVL529:
 4356              	.L320:
2559:Core/Src/FAT/ff.c **** }
 4357              		.loc 1 2559 2 is_stmt 1 view .LVU1462
2560:Core/Src/FAT/ff.c **** 
 4358              		.loc 1 2560 1 is_stmt 0 view .LVU1463
 4359 0010 2846     		mov	r0, r5
 4360 0012 70BD     		pop	{r4, r5, r6, pc}
 4361              	.LVL530:
 4362              	.L322:
2548:Core/Src/FAT/ff.c **** 		if (res == FR_OK) {
 4363              		.loc 1 2548 3 is_stmt 1 view .LVU1464
2548:Core/Src/FAT/ff.c **** 		if (res == FR_OK) {
 4364              		.loc 1 2548 9 is_stmt 0 view .LVU1465
 4365 0014 A169     		ldr	r1, [r4, #24]
 4366 0016 3046     		mov	r0, r6
 4367              	.LVL531:
2548:Core/Src/FAT/ff.c **** 		if (res == FR_OK) {
 4368              		.loc 1 2548 9 view .LVU1466
 4369 0018 FFF7FEFF 		bl	move_window
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 163


 4370              	.LVL532:
2549:Core/Src/FAT/ff.c **** 			memset(dp->dir, 0, SZDIRE);	/* Clean the entry */
 4371              		.loc 1 2549 3 is_stmt 1 view .LVU1467
2549:Core/Src/FAT/ff.c **** 			memset(dp->dir, 0, SZDIRE);	/* Clean the entry */
 4372              		.loc 1 2549 6 is_stmt 0 view .LVU1468
 4373 001c 0546     		mov	r5, r0
 4374 001e 0028     		cmp	r0, #0
 4375 0020 F6D1     		bne	.L320
2550:Core/Src/FAT/ff.c **** 			memcpy(dp->dir + DIR_Name, dp->fn, 11);	/* Put SFN */
 4376              		.loc 1 2550 4 is_stmt 1 view .LVU1469
 4377 0022 2022     		movs	r2, #32
 4378 0024 0021     		movs	r1, #0
 4379 0026 E069     		ldr	r0, [r4, #28]
 4380              	.LVL533:
2550:Core/Src/FAT/ff.c **** 			memcpy(dp->dir + DIR_Name, dp->fn, 11);	/* Put SFN */
 4381              		.loc 1 2550 4 is_stmt 0 view .LVU1470
 4382 0028 FFF7FEFF 		bl	memset
 4383              	.LVL534:
2551:Core/Src/FAT/ff.c **** #if FF_USE_LFN
 4384              		.loc 1 2551 4 is_stmt 1 view .LVU1471
2551:Core/Src/FAT/ff.c **** #if FF_USE_LFN
 4385              		.loc 1 2551 19 is_stmt 0 view .LVU1472
 4386 002c E369     		ldr	r3, [r4, #28]
2551:Core/Src/FAT/ff.c **** #if FF_USE_LFN
 4387              		.loc 1 2551 4 view .LVU1473
 4388 002e 216A     		ldr	r1, [r4, #32]	@ unaligned
 4389 0030 626A     		ldr	r2, [r4, #36]	@ unaligned
 4390 0032 1960     		str	r1, [r3]	@ unaligned
 4391 0034 5A60     		str	r2, [r3, #4]	@ unaligned
 4392 0036 218D     		ldrh	r1, [r4, #40]	@ unaligned
 4393 0038 94F82A20 		ldrb	r2, [r4, #42]	@ zero_extendqisi2
 4394 003c 1981     		strh	r1, [r3, #8]	@ unaligned
 4395 003e 9A72     		strb	r2, [r3, #10]
2555:Core/Src/FAT/ff.c **** 		}
 4396              		.loc 1 2555 4 is_stmt 1 view .LVU1474
2555:Core/Src/FAT/ff.c **** 		}
 4397              		.loc 1 2555 14 is_stmt 0 view .LVU1475
 4398 0040 0123     		movs	r3, #1
 4399 0042 3371     		strb	r3, [r6, #4]
 4400 0044 E4E7     		b	.L320
 4401              		.cfi_endproc
 4402              	.LFE22:
 4404              		.section	.text.sync_fs,"ax",%progbits
 4405              		.align	1
 4406              		.syntax unified
 4407              		.thumb
 4408              		.thumb_func
 4410              	sync_fs:
 4411              	.LVL535:
 4412              	.LFB8:
1111:Core/Src/FAT/ff.c **** 	FRESULT res;
 4413              		.loc 1 1111 1 is_stmt 1 view -0
 4414              		.cfi_startproc
 4415              		@ args = 0, pretend = 0, frame = 0
 4416              		@ frame_needed = 0, uses_anonymous_args = 0
1111:Core/Src/FAT/ff.c **** 	FRESULT res;
 4417              		.loc 1 1111 1 is_stmt 0 view .LVU1477
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 164


 4418 0000 70B5     		push	{r4, r5, r6, lr}
 4419              	.LCFI31:
 4420              		.cfi_def_cfa_offset 16
 4421              		.cfi_offset 4, -16
 4422              		.cfi_offset 5, -12
 4423              		.cfi_offset 6, -8
 4424              		.cfi_offset 14, -4
 4425 0002 0446     		mov	r4, r0
1112:Core/Src/FAT/ff.c **** 
 4426              		.loc 1 1112 2 is_stmt 1 view .LVU1478
1115:Core/Src/FAT/ff.c **** 	if (res == FR_OK) {
 4427              		.loc 1 1115 2 view .LVU1479
1115:Core/Src/FAT/ff.c **** 	if (res == FR_OK) {
 4428              		.loc 1 1115 8 is_stmt 0 view .LVU1480
 4429 0004 FFF7FEFF 		bl	sync_window
 4430              	.LVL536:
1116:Core/Src/FAT/ff.c **** 		if (fs->fs_type == FS_FAT32 && fs->fsi_flag == 1) {	/* FAT32: Update FSInfo sector if needed */
 4431              		.loc 1 1116 2 is_stmt 1 view .LVU1481
1116:Core/Src/FAT/ff.c **** 		if (fs->fs_type == FS_FAT32 && fs->fsi_flag == 1) {	/* FAT32: Update FSInfo sector if needed */
 4432              		.loc 1 1116 5 is_stmt 0 view .LVU1482
 4433 0008 0546     		mov	r5, r0
 4434 000a 48B9     		cbnz	r0, .L324
1117:Core/Src/FAT/ff.c **** 			/* Create FSInfo structure */
 4435              		.loc 1 1117 3 is_stmt 1 view .LVU1483
1117:Core/Src/FAT/ff.c **** 			/* Create FSInfo structure */
 4436              		.loc 1 1117 9 is_stmt 0 view .LVU1484
 4437 000c 2378     		ldrb	r3, [r4]	@ zero_extendqisi2
1117:Core/Src/FAT/ff.c **** 			/* Create FSInfo structure */
 4438              		.loc 1 1117 6 view .LVU1485
 4439 000e 032B     		cmp	r3, #3
 4440 0010 08D0     		beq	.L328
 4441              	.LVL537:
 4442              	.L325:
1130:Core/Src/FAT/ff.c **** 	}
 4443              		.loc 1 1130 3 is_stmt 1 view .LVU1486
1130:Core/Src/FAT/ff.c **** 	}
 4444              		.loc 1 1130 7 is_stmt 0 view .LVU1487
 4445 0012 0022     		movs	r2, #0
 4446 0014 1146     		mov	r1, r2
 4447 0016 6078     		ldrb	r0, [r4, #1]	@ zero_extendqisi2
 4448 0018 FFF7FEFF 		bl	disk_ioctl
 4449              	.LVL538:
1130:Core/Src/FAT/ff.c **** 	}
 4450              		.loc 1 1130 6 view .LVU1488
 4451 001c 00B1     		cbz	r0, .L324
1130:Core/Src/FAT/ff.c **** 	}
 4452              		.loc 1 1130 57 view .LVU1489
 4453 001e 0125     		movs	r5, #1
 4454              	.L324:
 4455              	.LVL539:
1133:Core/Src/FAT/ff.c **** }
 4456              		.loc 1 1133 2 is_stmt 1 view .LVU1490
1134:Core/Src/FAT/ff.c **** 
 4457              		.loc 1 1134 1 is_stmt 0 view .LVU1491
 4458 0020 2846     		mov	r0, r5
 4459 0022 70BD     		pop	{r4, r5, r6, pc}
 4460              	.LVL540:
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 165


 4461              	.L328:
1117:Core/Src/FAT/ff.c **** 			/* Create FSInfo structure */
 4462              		.loc 1 1117 36 discriminator 1 view .LVU1492
 4463 0024 6379     		ldrb	r3, [r4, #5]	@ zero_extendqisi2
1117:Core/Src/FAT/ff.c **** 			/* Create FSInfo structure */
 4464              		.loc 1 1117 31 discriminator 1 view .LVU1493
 4465 0026 012B     		cmp	r3, #1
 4466 0028 F3D1     		bne	.L325
1119:Core/Src/FAT/ff.c **** 			st_word(fs->win + BS_55AA, 0xAA55);					/* Boot signature */
 4467              		.loc 1 1119 4 is_stmt 1 view .LVU1494
1119:Core/Src/FAT/ff.c **** 			st_word(fs->win + BS_55AA, 0xAA55);					/* Boot signature */
 4468              		.loc 1 1119 13 is_stmt 0 view .LVU1495
 4469 002a 04F13006 		add	r6, r4, #48
1119:Core/Src/FAT/ff.c **** 			st_word(fs->win + BS_55AA, 0xAA55);					/* Boot signature */
 4470              		.loc 1 1119 4 view .LVU1496
 4471 002e 4FF40072 		mov	r2, #512
 4472 0032 0021     		movs	r1, #0
 4473 0034 3046     		mov	r0, r6
 4474              	.LVL541:
1119:Core/Src/FAT/ff.c **** 			st_word(fs->win + BS_55AA, 0xAA55);					/* Boot signature */
 4475              		.loc 1 1119 4 view .LVU1497
 4476 0036 FFF7FEFF 		bl	memset
 4477              	.LVL542:
1120:Core/Src/FAT/ff.c **** 			st_dword(fs->win + FSI_LeadSig, 0x41615252);		/* Leading signature */
 4478              		.loc 1 1120 4 is_stmt 1 view .LVU1498
 4479 003a 4AF65521 		movw	r1, #43605
 4480 003e 04F22E20 		addw	r0, r4, #558
 4481 0042 FFF7FEFF 		bl	st_word
 4482              	.LVL543:
1121:Core/Src/FAT/ff.c **** 			st_dword(fs->win + FSI_StrucSig, 0x61417272);		/* Structure signature */
 4483              		.loc 1 1121 4 view .LVU1499
 4484 0046 0F49     		ldr	r1, .L329
 4485 0048 3046     		mov	r0, r6
 4486 004a FFF7FEFF 		bl	st_dword
 4487              	.LVL544:
1122:Core/Src/FAT/ff.c **** 			st_dword(fs->win + FSI_Free_Count, fs->free_clst);	/* Number of free clusters */
 4488              		.loc 1 1122 4 view .LVU1500
 4489 004e 0E49     		ldr	r1, .L329+4
 4490 0050 04F50570 		add	r0, r4, #532
 4491 0054 FFF7FEFF 		bl	st_dword
 4492              	.LVL545:
1123:Core/Src/FAT/ff.c **** 			st_dword(fs->win + FSI_Nxt_Free, fs->last_clst);	/* Last allocated culuster */
 4493              		.loc 1 1123 4 view .LVU1501
 4494 0058 2169     		ldr	r1, [r4, #16]
 4495 005a 04F50670 		add	r0, r4, #536
 4496 005e FFF7FEFF 		bl	st_dword
 4497              	.LVL546:
1124:Core/Src/FAT/ff.c **** 			fs->winsect = fs->volbase + 1;						/* Write it into the FSInfo sector (Next to VBR) */
 4498              		.loc 1 1124 4 view .LVU1502
 4499 0062 E168     		ldr	r1, [r4, #12]
 4500 0064 04F50770 		add	r0, r4, #540
 4501 0068 FFF7FEFF 		bl	st_dword
 4502              	.LVL547:
1125:Core/Src/FAT/ff.c **** 			disk_write(fs->pdrv, fs->win, fs->winsect, 1);
 4503              		.loc 1 1125 4 view .LVU1503
1125:Core/Src/FAT/ff.c **** 			disk_write(fs->pdrv, fs->win, fs->winsect, 1);
 4504              		.loc 1 1125 20 is_stmt 0 view .LVU1504
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 166


 4505 006c E269     		ldr	r2, [r4, #28]
1125:Core/Src/FAT/ff.c **** 			disk_write(fs->pdrv, fs->win, fs->winsect, 1);
 4506              		.loc 1 1125 30 view .LVU1505
 4507 006e 0132     		adds	r2, r2, #1
1125:Core/Src/FAT/ff.c **** 			disk_write(fs->pdrv, fs->win, fs->winsect, 1);
 4508              		.loc 1 1125 16 view .LVU1506
 4509 0070 E262     		str	r2, [r4, #44]
1126:Core/Src/FAT/ff.c **** 			fs->fsi_flag = 0;
 4510              		.loc 1 1126 4 is_stmt 1 view .LVU1507
 4511 0072 0123     		movs	r3, #1
 4512 0074 3146     		mov	r1, r6
 4513 0076 6078     		ldrb	r0, [r4, #1]	@ zero_extendqisi2
 4514 0078 FFF7FEFF 		bl	disk_write
 4515              	.LVL548:
1127:Core/Src/FAT/ff.c **** 		}
 4516              		.loc 1 1127 4 view .LVU1508
1127:Core/Src/FAT/ff.c **** 		}
 4517              		.loc 1 1127 17 is_stmt 0 view .LVU1509
 4518 007c 0023     		movs	r3, #0
 4519 007e 6371     		strb	r3, [r4, #5]
 4520 0080 C7E7     		b	.L325
 4521              	.L330:
 4522 0082 00BF     		.align	2
 4523              	.L329:
 4524 0084 52526141 		.word	1096897106
 4525 0088 72724161 		.word	1631679090
 4526              		.cfi_endproc
 4527              	.LFE8:
 4529              		.section	.text.create_partition,"ax",%progbits
 4530              		.align	1
 4531              		.syntax unified
 4532              		.thumb
 4533              		.thumb_func
 4535              	create_partition:
 4536              	.LVL549:
 4537              	.LFB48:
3641:Core/Src/FAT/ff.c **** 
3642:Core/Src/FAT/ff.c **** 
3643:Core/Src/FAT/ff.c **** 
3644:Core/Src/FAT/ff.c **** 
3645:Core/Src/FAT/ff.c **** /*---------------------------------------------------------------------------
3646:Core/Src/FAT/ff.c **** 
3647:Core/Src/FAT/ff.c ****    Public Functions (FatFs API)
3648:Core/Src/FAT/ff.c **** 
3649:Core/Src/FAT/ff.c **** ----------------------------------------------------------------------------*/
3650:Core/Src/FAT/ff.c **** 
3651:Core/Src/FAT/ff.c **** 
3652:Core/Src/FAT/ff.c **** 
3653:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
3654:Core/Src/FAT/ff.c **** /* Mount/Unmount a Logical Drive                                         */
3655:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
3656:Core/Src/FAT/ff.c **** 
3657:Core/Src/FAT/ff.c **** FRESULT f_mount (
3658:Core/Src/FAT/ff.c **** 	FATFS* fs,			/* Pointer to the filesystem object to be registered (NULL:unmount)*/
3659:Core/Src/FAT/ff.c **** 	const TCHAR* path,	/* Logical drive number to be mounted/unmounted */
3660:Core/Src/FAT/ff.c **** 	BYTE opt			/* Mount option: 0=Do not mount (delayed mount), 1=Mount immediately */
3661:Core/Src/FAT/ff.c **** )
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 167


3662:Core/Src/FAT/ff.c **** {
3663:Core/Src/FAT/ff.c **** 	FATFS *cfs;
3664:Core/Src/FAT/ff.c **** 	int vol;
3665:Core/Src/FAT/ff.c **** 	FRESULT res;
3666:Core/Src/FAT/ff.c **** 	const TCHAR *rp = path;
3667:Core/Src/FAT/ff.c **** 
3668:Core/Src/FAT/ff.c **** 
3669:Core/Src/FAT/ff.c **** 	/* Get volume ID (logical drive number) */
3670:Core/Src/FAT/ff.c **** 	vol = get_ldnumber(&rp);
3671:Core/Src/FAT/ff.c **** 	if (vol < 0) return FR_INVALID_DRIVE;
3672:Core/Src/FAT/ff.c **** 	cfs = FatFs[vol];			/* Pointer to the filesystem object of the volume */
3673:Core/Src/FAT/ff.c **** 
3674:Core/Src/FAT/ff.c **** 	if (cfs) {					/* Unregister current filesystem object if regsitered */
3675:Core/Src/FAT/ff.c **** 		FatFs[vol] = 0;
3676:Core/Src/FAT/ff.c **** #if FF_FS_LOCK
3677:Core/Src/FAT/ff.c **** 		clear_share(cfs);
3678:Core/Src/FAT/ff.c **** #endif
3679:Core/Src/FAT/ff.c **** #if FF_FS_REENTRANT				/* Discard mutex of the current volume */
3680:Core/Src/FAT/ff.c **** 		ff_mutex_delete(vol);
3681:Core/Src/FAT/ff.c **** #endif
3682:Core/Src/FAT/ff.c **** 		cfs->fs_type = 0;		/* Invalidate the filesystem object to be unregistered */
3683:Core/Src/FAT/ff.c **** 	}
3684:Core/Src/FAT/ff.c **** 
3685:Core/Src/FAT/ff.c **** 	if (fs) {					/* Register new filesystem object */
3686:Core/Src/FAT/ff.c **** 		fs->pdrv = LD2PD(vol);	/* Volume hosting physical drive */
3687:Core/Src/FAT/ff.c **** #if FF_FS_REENTRANT				/* Create a volume mutex */
3688:Core/Src/FAT/ff.c **** 		fs->ldrv = (BYTE)vol;	/* Owner volume ID */
3689:Core/Src/FAT/ff.c **** 		if (!ff_mutex_create(vol)) return FR_INT_ERR;
3690:Core/Src/FAT/ff.c **** #if FF_FS_LOCK
3691:Core/Src/FAT/ff.c **** 		if (SysLock == 0) {		/* Create a system mutex if needed */
3692:Core/Src/FAT/ff.c **** 			if (!ff_mutex_create(FF_VOLUMES)) {
3693:Core/Src/FAT/ff.c **** 				ff_mutex_delete(vol);
3694:Core/Src/FAT/ff.c **** 				return FR_INT_ERR;
3695:Core/Src/FAT/ff.c **** 			}
3696:Core/Src/FAT/ff.c **** 			SysLock = 1;		/* System mutex is ready */
3697:Core/Src/FAT/ff.c **** 		}
3698:Core/Src/FAT/ff.c **** #endif
3699:Core/Src/FAT/ff.c **** #endif
3700:Core/Src/FAT/ff.c **** 		fs->fs_type = 0;		/* Invalidate the new filesystem object */
3701:Core/Src/FAT/ff.c **** 		FatFs[vol] = fs;		/* Register new fs object */
3702:Core/Src/FAT/ff.c **** 	}
3703:Core/Src/FAT/ff.c **** 
3704:Core/Src/FAT/ff.c **** 	if (opt == 0) return FR_OK;	/* Do not mount now, it will be mounted in subsequent file functions *
3705:Core/Src/FAT/ff.c **** 
3706:Core/Src/FAT/ff.c **** 	res = mount_volume(&path, &fs, 0);	/* Force mounted the volume */
3707:Core/Src/FAT/ff.c **** 	LEAVE_FF(fs, res);
3708:Core/Src/FAT/ff.c **** }
3709:Core/Src/FAT/ff.c **** 
3710:Core/Src/FAT/ff.c **** 
3711:Core/Src/FAT/ff.c **** 
3712:Core/Src/FAT/ff.c **** 
3713:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
3714:Core/Src/FAT/ff.c **** /* Open or Create a File                                                 */
3715:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
3716:Core/Src/FAT/ff.c **** 
3717:Core/Src/FAT/ff.c **** FRESULT f_open (
3718:Core/Src/FAT/ff.c **** 	FIL* fp,			/* Pointer to the blank file object */
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 168


3719:Core/Src/FAT/ff.c **** 	const TCHAR* path,	/* Pointer to the file name */
3720:Core/Src/FAT/ff.c **** 	BYTE mode			/* Access mode and open mode flags */
3721:Core/Src/FAT/ff.c **** )
3722:Core/Src/FAT/ff.c **** {
3723:Core/Src/FAT/ff.c **** 	FRESULT res;
3724:Core/Src/FAT/ff.c **** 	DIR dj;
3725:Core/Src/FAT/ff.c **** 	FATFS *fs;
3726:Core/Src/FAT/ff.c **** #if !FF_FS_READONLY
3727:Core/Src/FAT/ff.c **** 	DWORD cl, bcs, clst, tm;
3728:Core/Src/FAT/ff.c **** 	LBA_t sc;
3729:Core/Src/FAT/ff.c **** 	FSIZE_t ofs;
3730:Core/Src/FAT/ff.c **** #endif
3731:Core/Src/FAT/ff.c **** 	DEF_NAMBUF
3732:Core/Src/FAT/ff.c **** 
3733:Core/Src/FAT/ff.c **** 
3734:Core/Src/FAT/ff.c **** 	if (!fp) return FR_INVALID_OBJECT;
3735:Core/Src/FAT/ff.c **** 
3736:Core/Src/FAT/ff.c **** 	/* Get logical drive number */
3737:Core/Src/FAT/ff.c **** 	mode &= FF_FS_READONLY ? FA_READ : FA_READ | FA_WRITE | FA_CREATE_ALWAYS | FA_CREATE_NEW | FA_OPEN
3738:Core/Src/FAT/ff.c **** 	res = mount_volume(&path, &fs, mode);
3739:Core/Src/FAT/ff.c **** 	if (res == FR_OK) {
3740:Core/Src/FAT/ff.c **** 		dj.obj.fs = fs;
3741:Core/Src/FAT/ff.c **** 		INIT_NAMBUF(fs);
3742:Core/Src/FAT/ff.c **** 		res = follow_path(&dj, path);	/* Follow the file path */
3743:Core/Src/FAT/ff.c **** #if !FF_FS_READONLY	/* Read/Write configuration */
3744:Core/Src/FAT/ff.c **** 		if (res == FR_OK) {
3745:Core/Src/FAT/ff.c **** 			if (dj.fn[NSFLAG] & NS_NONAME) {	/* Origin directory itself? */
3746:Core/Src/FAT/ff.c **** 				res = FR_INVALID_NAME;
3747:Core/Src/FAT/ff.c **** 			}
3748:Core/Src/FAT/ff.c **** #if FF_FS_LOCK
3749:Core/Src/FAT/ff.c **** 			else {
3750:Core/Src/FAT/ff.c **** 				res = chk_share(&dj, (mode & ~FA_READ) ? 1 : 0);	/* Check if the file can be used */
3751:Core/Src/FAT/ff.c **** 			}
3752:Core/Src/FAT/ff.c **** #endif
3753:Core/Src/FAT/ff.c **** 		}
3754:Core/Src/FAT/ff.c **** 		/* Create or Open a file */
3755:Core/Src/FAT/ff.c **** 		if (mode & (FA_CREATE_ALWAYS | FA_OPEN_ALWAYS | FA_CREATE_NEW)) {
3756:Core/Src/FAT/ff.c **** 			if (res != FR_OK) {					/* No file, create new */
3757:Core/Src/FAT/ff.c **** 				if (res == FR_NO_FILE) {		/* There is no file to open, create a new entry */
3758:Core/Src/FAT/ff.c **** #if FF_FS_LOCK
3759:Core/Src/FAT/ff.c **** 					res = enq_share() ? dir_register(&dj) : FR_TOO_MANY_OPEN_FILES;
3760:Core/Src/FAT/ff.c **** #else
3761:Core/Src/FAT/ff.c **** 					res = dir_register(&dj);
3762:Core/Src/FAT/ff.c **** #endif
3763:Core/Src/FAT/ff.c **** 				}
3764:Core/Src/FAT/ff.c **** 				mode |= FA_CREATE_ALWAYS;		/* File is created */
3765:Core/Src/FAT/ff.c **** 			}
3766:Core/Src/FAT/ff.c **** 			else {								/* Any object with the same name is already existing */
3767:Core/Src/FAT/ff.c **** 				if (dj.obj.attr & (AM_RDO | AM_DIR)) {	/* Cannot overwrite it (R/O or DIR) */
3768:Core/Src/FAT/ff.c **** 					res = FR_DENIED;
3769:Core/Src/FAT/ff.c **** 				} else {
3770:Core/Src/FAT/ff.c **** 					if (mode & FA_CREATE_NEW) res = FR_EXIST;	/* Cannot create as new file */
3771:Core/Src/FAT/ff.c **** 				}
3772:Core/Src/FAT/ff.c **** 			}
3773:Core/Src/FAT/ff.c **** 			if (res == FR_OK && (mode & FA_CREATE_ALWAYS)) {	/* Truncate the file if overwrite mode */
3774:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT
3775:Core/Src/FAT/ff.c **** 				if (fs->fs_type == FS_EXFAT) {
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 169


3776:Core/Src/FAT/ff.c **** 					/* Get current allocation info */
3777:Core/Src/FAT/ff.c **** 					fp->obj.fs = fs;
3778:Core/Src/FAT/ff.c **** 					init_alloc_info(fs, &fp->obj);
3779:Core/Src/FAT/ff.c **** 					/* Set directory entry block initial state */
3780:Core/Src/FAT/ff.c **** 					memset(fs->dirbuf + 2, 0, 30);	/* Clear 85 entry except for NumSec */
3781:Core/Src/FAT/ff.c **** 					memset(fs->dirbuf + 38, 0, 26);	/* Clear C0 entry except for NumName and NameHash */
3782:Core/Src/FAT/ff.c **** 					fs->dirbuf[XDIR_Attr] = AM_ARC;
3783:Core/Src/FAT/ff.c **** 					st_dword(fs->dirbuf + XDIR_CrtTime, GET_FATTIME());
3784:Core/Src/FAT/ff.c **** 					fs->dirbuf[XDIR_GenFlags] = 1;
3785:Core/Src/FAT/ff.c **** 					res = store_xdir(&dj);
3786:Core/Src/FAT/ff.c **** 					if (res == FR_OK && fp->obj.sclust != 0) {	/* Remove the cluster chain if exist */
3787:Core/Src/FAT/ff.c **** 						res = remove_chain(&fp->obj, fp->obj.sclust, 0);
3788:Core/Src/FAT/ff.c **** 						fs->last_clst = fp->obj.sclust - 1;		/* Reuse the cluster hole */
3789:Core/Src/FAT/ff.c **** 					}
3790:Core/Src/FAT/ff.c **** 				} else
3791:Core/Src/FAT/ff.c **** #endif
3792:Core/Src/FAT/ff.c **** 				{
3793:Core/Src/FAT/ff.c **** 					/* Set directory entry initial state */
3794:Core/Src/FAT/ff.c **** 					tm = GET_FATTIME();					/* Set created time */
3795:Core/Src/FAT/ff.c **** 					st_dword(dj.dir + DIR_CrtTime, tm);
3796:Core/Src/FAT/ff.c **** 					st_dword(dj.dir + DIR_ModTime, tm);
3797:Core/Src/FAT/ff.c **** 					cl = ld_clust(fs, dj.dir);			/* Get current cluster chain */
3798:Core/Src/FAT/ff.c **** 					dj.dir[DIR_Attr] = AM_ARC;			/* Reset attribute */
3799:Core/Src/FAT/ff.c **** 					st_clust(fs, dj.dir, 0);			/* Reset file allocation info */
3800:Core/Src/FAT/ff.c **** 					st_dword(dj.dir + DIR_FileSize, 0);
3801:Core/Src/FAT/ff.c **** 					fs->wflag = 1;
3802:Core/Src/FAT/ff.c **** 					if (cl != 0) {						/* Remove the cluster chain if exist */
3803:Core/Src/FAT/ff.c **** 						sc = fs->winsect;
3804:Core/Src/FAT/ff.c **** 						res = remove_chain(&dj.obj, cl, 0);
3805:Core/Src/FAT/ff.c **** 						if (res == FR_OK) {
3806:Core/Src/FAT/ff.c **** 							res = move_window(fs, sc);
3807:Core/Src/FAT/ff.c **** 							fs->last_clst = cl - 1;		/* Reuse the cluster hole */
3808:Core/Src/FAT/ff.c **** 						}
3809:Core/Src/FAT/ff.c **** 					}
3810:Core/Src/FAT/ff.c **** 				}
3811:Core/Src/FAT/ff.c **** 			}
3812:Core/Src/FAT/ff.c **** 		}
3813:Core/Src/FAT/ff.c **** 		else {	/* Open an existing file */
3814:Core/Src/FAT/ff.c **** 			if (res == FR_OK) {					/* Is the object exsiting? */
3815:Core/Src/FAT/ff.c **** 				if (dj.obj.attr & AM_DIR) {		/* File open against a directory */
3816:Core/Src/FAT/ff.c **** 					res = FR_NO_FILE;
3817:Core/Src/FAT/ff.c **** 				} else {
3818:Core/Src/FAT/ff.c **** 					if ((mode & FA_WRITE) && (dj.obj.attr & AM_RDO)) { /* Write mode open against R/O file */
3819:Core/Src/FAT/ff.c **** 						res = FR_DENIED;
3820:Core/Src/FAT/ff.c **** 					}
3821:Core/Src/FAT/ff.c **** 				}
3822:Core/Src/FAT/ff.c **** 			}
3823:Core/Src/FAT/ff.c **** 		}
3824:Core/Src/FAT/ff.c **** 		if (res == FR_OK) {
3825:Core/Src/FAT/ff.c **** 			if (mode & FA_CREATE_ALWAYS) mode |= FA_MODIFIED;	/* Set file change flag if created or overwrit
3826:Core/Src/FAT/ff.c **** 			fp->dir_sect = fs->winsect;			/* Pointer to the directory entry */
3827:Core/Src/FAT/ff.c **** 			fp->dir_ptr = dj.dir;
3828:Core/Src/FAT/ff.c **** #if FF_FS_LOCK
3829:Core/Src/FAT/ff.c **** 			fp->obj.lockid = inc_share(&dj, (mode & ~FA_READ) ? 1 : 0);	/* Lock the file for this session */
3830:Core/Src/FAT/ff.c **** 			if (fp->obj.lockid == 0) res = FR_INT_ERR;
3831:Core/Src/FAT/ff.c **** #endif
3832:Core/Src/FAT/ff.c **** 		}
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 170


3833:Core/Src/FAT/ff.c **** #else		/* R/O configuration */
3834:Core/Src/FAT/ff.c **** 		if (res == FR_OK) {
3835:Core/Src/FAT/ff.c **** 			if (dj.fn[NSFLAG] & NS_NONAME) {	/* Is it origin directory itself? */
3836:Core/Src/FAT/ff.c **** 				res = FR_INVALID_NAME;
3837:Core/Src/FAT/ff.c **** 			} else {
3838:Core/Src/FAT/ff.c **** 				if (dj.obj.attr & AM_DIR) {		/* Is it a directory? */
3839:Core/Src/FAT/ff.c **** 					res = FR_NO_FILE;
3840:Core/Src/FAT/ff.c **** 				}
3841:Core/Src/FAT/ff.c **** 			}
3842:Core/Src/FAT/ff.c **** 		}
3843:Core/Src/FAT/ff.c **** #endif
3844:Core/Src/FAT/ff.c **** 
3845:Core/Src/FAT/ff.c **** 		if (res == FR_OK) {
3846:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT
3847:Core/Src/FAT/ff.c **** 			if (fs->fs_type == FS_EXFAT) {
3848:Core/Src/FAT/ff.c **** 				fp->obj.c_scl = dj.obj.sclust;							/* Get containing directory info */
3849:Core/Src/FAT/ff.c **** 				fp->obj.c_size = ((DWORD)dj.obj.objsize & 0xFFFFFF00) | dj.obj.stat;
3850:Core/Src/FAT/ff.c **** 				fp->obj.c_ofs = dj.blk_ofs;
3851:Core/Src/FAT/ff.c **** 				init_alloc_info(fs, &fp->obj);
3852:Core/Src/FAT/ff.c **** 			} else
3853:Core/Src/FAT/ff.c **** #endif
3854:Core/Src/FAT/ff.c **** 			{
3855:Core/Src/FAT/ff.c **** 				fp->obj.sclust = ld_clust(fs, dj.dir);					/* Get object allocation info */
3856:Core/Src/FAT/ff.c **** 				fp->obj.objsize = ld_dword(dj.dir + DIR_FileSize);
3857:Core/Src/FAT/ff.c **** 			}
3858:Core/Src/FAT/ff.c **** #if FF_USE_FASTSEEK
3859:Core/Src/FAT/ff.c **** 			fp->cltbl = 0;		/* Disable fast seek mode */
3860:Core/Src/FAT/ff.c **** #endif
3861:Core/Src/FAT/ff.c **** 			fp->obj.fs = fs;	/* Validate the file object */
3862:Core/Src/FAT/ff.c **** 			fp->obj.id = fs->id;
3863:Core/Src/FAT/ff.c **** 			fp->flag = mode;	/* Set file access mode */
3864:Core/Src/FAT/ff.c **** 			fp->err = 0;		/* Clear error flag */
3865:Core/Src/FAT/ff.c **** 			fp->sect = 0;		/* Invalidate current data sector */
3866:Core/Src/FAT/ff.c **** 			fp->fptr = 0;		/* Set file pointer top of the file */
3867:Core/Src/FAT/ff.c **** #if !FF_FS_READONLY
3868:Core/Src/FAT/ff.c **** #if !FF_FS_TINY
3869:Core/Src/FAT/ff.c **** 			memset(fp->buf, 0, sizeof fp->buf);	/* Clear sector buffer */
3870:Core/Src/FAT/ff.c **** #endif
3871:Core/Src/FAT/ff.c **** 			if ((mode & FA_SEEKEND) && fp->obj.objsize > 0) {	/* Seek to end of file if FA_OPEN_APPEND is sp
3872:Core/Src/FAT/ff.c **** 				fp->fptr = fp->obj.objsize;			/* Offset to seek */
3873:Core/Src/FAT/ff.c **** 				bcs = (DWORD)fs->csize * SS(fs);	/* Cluster size in byte */
3874:Core/Src/FAT/ff.c **** 				clst = fp->obj.sclust;				/* Follow the cluster chain */
3875:Core/Src/FAT/ff.c **** 				for (ofs = fp->obj.objsize; res == FR_OK && ofs > bcs; ofs -= bcs) {
3876:Core/Src/FAT/ff.c **** 					clst = get_fat(&fp->obj, clst);
3877:Core/Src/FAT/ff.c **** 					if (clst <= 1) res = FR_INT_ERR;
3878:Core/Src/FAT/ff.c **** 					if (clst == 0xFFFFFFFF) res = FR_DISK_ERR;
3879:Core/Src/FAT/ff.c **** 				}
3880:Core/Src/FAT/ff.c **** 				fp->clust = clst;
3881:Core/Src/FAT/ff.c **** 				if (res == FR_OK && ofs % SS(fs)) {	/* Fill sector buffer if not on the sector boundary */
3882:Core/Src/FAT/ff.c **** 					sc = clst2sect(fs, clst);
3883:Core/Src/FAT/ff.c **** 					if (sc == 0) {
3884:Core/Src/FAT/ff.c **** 						res = FR_INT_ERR;
3885:Core/Src/FAT/ff.c **** 					} else {
3886:Core/Src/FAT/ff.c **** 						fp->sect = sc + (DWORD)(ofs / SS(fs));
3887:Core/Src/FAT/ff.c **** #if !FF_FS_TINY
3888:Core/Src/FAT/ff.c **** 						if (disk_read(fs->pdrv, fp->buf, fp->sect, 1) != RES_OK) res = FR_DISK_ERR;
3889:Core/Src/FAT/ff.c **** #endif
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 171


3890:Core/Src/FAT/ff.c **** 					}
3891:Core/Src/FAT/ff.c **** 				}
3892:Core/Src/FAT/ff.c **** #if FF_FS_LOCK
3893:Core/Src/FAT/ff.c **** 				if (res != FR_OK) dec_share(fp->obj.lockid); /* Decrement file open counter if seek failed */
3894:Core/Src/FAT/ff.c **** #endif
3895:Core/Src/FAT/ff.c **** 			}
3896:Core/Src/FAT/ff.c **** #endif
3897:Core/Src/FAT/ff.c **** 		}
3898:Core/Src/FAT/ff.c **** 
3899:Core/Src/FAT/ff.c **** 		FREE_NAMBUF();
3900:Core/Src/FAT/ff.c **** 	}
3901:Core/Src/FAT/ff.c **** 
3902:Core/Src/FAT/ff.c **** 	if (res != FR_OK) fp->obj.fs = 0;	/* Invalidate file object on error */
3903:Core/Src/FAT/ff.c **** 
3904:Core/Src/FAT/ff.c **** 	LEAVE_FF(fs, res);
3905:Core/Src/FAT/ff.c **** }
3906:Core/Src/FAT/ff.c **** 
3907:Core/Src/FAT/ff.c **** 
3908:Core/Src/FAT/ff.c **** 
3909:Core/Src/FAT/ff.c **** 
3910:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
3911:Core/Src/FAT/ff.c **** /* Read File                                                             */
3912:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
3913:Core/Src/FAT/ff.c **** 
3914:Core/Src/FAT/ff.c **** FRESULT f_read (
3915:Core/Src/FAT/ff.c **** 	FIL* fp, 	/* Open file to be read */
3916:Core/Src/FAT/ff.c **** 	void* buff,	/* Data buffer to store the read data */
3917:Core/Src/FAT/ff.c **** 	UINT btr,	/* Number of bytes to read */
3918:Core/Src/FAT/ff.c **** 	UINT* br	/* Number of bytes read */
3919:Core/Src/FAT/ff.c **** )
3920:Core/Src/FAT/ff.c **** {
3921:Core/Src/FAT/ff.c **** 	FRESULT res;
3922:Core/Src/FAT/ff.c **** 	FATFS *fs;
3923:Core/Src/FAT/ff.c **** 	DWORD clst;
3924:Core/Src/FAT/ff.c **** 	LBA_t sect;
3925:Core/Src/FAT/ff.c **** 	FSIZE_t remain;
3926:Core/Src/FAT/ff.c **** 	UINT rcnt, cc, csect;
3927:Core/Src/FAT/ff.c **** 	BYTE *rbuff = (BYTE*)buff;
3928:Core/Src/FAT/ff.c **** 
3929:Core/Src/FAT/ff.c **** 
3930:Core/Src/FAT/ff.c **** 	*br = 0;	/* Clear read byte counter */
3931:Core/Src/FAT/ff.c **** 	res = validate(&fp->obj, &fs);				/* Check validity of the file object */
3932:Core/Src/FAT/ff.c **** 	if (res != FR_OK || (res = (FRESULT)fp->err) != FR_OK) LEAVE_FF(fs, res);	/* Check validity */
3933:Core/Src/FAT/ff.c **** 	if (!(fp->flag & FA_READ)) LEAVE_FF(fs, FR_DENIED); /* Check access mode */
3934:Core/Src/FAT/ff.c **** 	remain = fp->obj.objsize - fp->fptr;
3935:Core/Src/FAT/ff.c **** 	if (btr > remain) btr = (UINT)remain;		/* Truncate btr by remaining bytes */
3936:Core/Src/FAT/ff.c **** 
3937:Core/Src/FAT/ff.c **** 	for ( ; btr > 0; btr -= rcnt, *br += rcnt, rbuff += rcnt, fp->fptr += rcnt) {	/* Repeat until btr 
3938:Core/Src/FAT/ff.c **** 		if (fp->fptr % SS(fs) == 0) {			/* On the sector boundary? */
3939:Core/Src/FAT/ff.c **** 			csect = (UINT)(fp->fptr / SS(fs) & (fs->csize - 1));	/* Sector offset in the cluster */
3940:Core/Src/FAT/ff.c **** 			if (csect == 0) {					/* On the cluster boundary? */
3941:Core/Src/FAT/ff.c **** 				if (fp->fptr == 0) {			/* On the top of the file? */
3942:Core/Src/FAT/ff.c **** 					clst = fp->obj.sclust;		/* Follow cluster chain from the origin */
3943:Core/Src/FAT/ff.c **** 				} else {						/* Middle or end of the file */
3944:Core/Src/FAT/ff.c **** #if FF_USE_FASTSEEK
3945:Core/Src/FAT/ff.c **** 					if (fp->cltbl) {
3946:Core/Src/FAT/ff.c **** 						clst = clmt_clust(fp, fp->fptr);	/* Get cluster# from the CLMT */
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 172


3947:Core/Src/FAT/ff.c **** 					} else
3948:Core/Src/FAT/ff.c **** #endif
3949:Core/Src/FAT/ff.c **** 					{
3950:Core/Src/FAT/ff.c **** 						clst = get_fat(&fp->obj, fp->clust);	/* Follow cluster chain on the FAT */
3951:Core/Src/FAT/ff.c **** 					}
3952:Core/Src/FAT/ff.c **** 				}
3953:Core/Src/FAT/ff.c **** 				if (clst < 2) ABORT(fs, FR_INT_ERR);
3954:Core/Src/FAT/ff.c **** 				if (clst == 0xFFFFFFFF) ABORT(fs, FR_DISK_ERR);
3955:Core/Src/FAT/ff.c **** 				fp->clust = clst;				/* Update current cluster */
3956:Core/Src/FAT/ff.c **** 			}
3957:Core/Src/FAT/ff.c **** 			sect = clst2sect(fs, fp->clust);	/* Get current sector */
3958:Core/Src/FAT/ff.c **** 			if (sect == 0) ABORT(fs, FR_INT_ERR);
3959:Core/Src/FAT/ff.c **** 			sect += csect;
3960:Core/Src/FAT/ff.c **** 			cc = btr / SS(fs);					/* When remaining bytes >= sector size, */
3961:Core/Src/FAT/ff.c **** 			if (cc > 0) {						/* Read maximum contiguous sectors directly */
3962:Core/Src/FAT/ff.c **** 				if (csect + cc > fs->csize) {	/* Clip at cluster boundary */
3963:Core/Src/FAT/ff.c **** 					cc = fs->csize - csect;
3964:Core/Src/FAT/ff.c **** 				}
3965:Core/Src/FAT/ff.c **** 				if (disk_read(fs->pdrv, rbuff, sect, cc) != RES_OK) ABORT(fs, FR_DISK_ERR);
3966:Core/Src/FAT/ff.c **** #if !FF_FS_READONLY && FF_FS_MINIMIZE <= 2		/* Replace one of the read sectors with cached data if 
3967:Core/Src/FAT/ff.c **** #if FF_FS_TINY
3968:Core/Src/FAT/ff.c **** 				if (fs->wflag && fs->winsect - sect < cc) {
3969:Core/Src/FAT/ff.c **** 					memcpy(rbuff + ((fs->winsect - sect) * SS(fs)), fs->win, SS(fs));
3970:Core/Src/FAT/ff.c **** 				}
3971:Core/Src/FAT/ff.c **** #else
3972:Core/Src/FAT/ff.c **** 				if ((fp->flag & FA_DIRTY) && fp->sect - sect < cc) {
3973:Core/Src/FAT/ff.c **** 					memcpy(rbuff + ((fp->sect - sect) * SS(fs)), fp->buf, SS(fs));
3974:Core/Src/FAT/ff.c **** 				}
3975:Core/Src/FAT/ff.c **** #endif
3976:Core/Src/FAT/ff.c **** #endif
3977:Core/Src/FAT/ff.c **** 				rcnt = SS(fs) * cc;				/* Number of bytes transferred */
3978:Core/Src/FAT/ff.c **** 				continue;
3979:Core/Src/FAT/ff.c **** 			}
3980:Core/Src/FAT/ff.c **** #if !FF_FS_TINY
3981:Core/Src/FAT/ff.c **** 			if (fp->sect != sect) {			/* Load data sector if not in cache */
3982:Core/Src/FAT/ff.c **** #if !FF_FS_READONLY
3983:Core/Src/FAT/ff.c **** 				if (fp->flag & FA_DIRTY) {		/* Write-back dirty sector cache */
3984:Core/Src/FAT/ff.c **** 					if (disk_write(fs->pdrv, fp->buf, fp->sect, 1) != RES_OK) ABORT(fs, FR_DISK_ERR);
3985:Core/Src/FAT/ff.c **** 					fp->flag &= (BYTE)~FA_DIRTY;
3986:Core/Src/FAT/ff.c **** 				}
3987:Core/Src/FAT/ff.c **** #endif
3988:Core/Src/FAT/ff.c **** 				if (disk_read(fs->pdrv, fp->buf, sect, 1) != RES_OK) ABORT(fs, FR_DISK_ERR);	/* Fill sector cac
3989:Core/Src/FAT/ff.c **** 			}
3990:Core/Src/FAT/ff.c **** #endif
3991:Core/Src/FAT/ff.c **** 			fp->sect = sect;
3992:Core/Src/FAT/ff.c **** 		}
3993:Core/Src/FAT/ff.c **** 		rcnt = SS(fs) - (UINT)fp->fptr % SS(fs);	/* Number of bytes remains in the sector */
3994:Core/Src/FAT/ff.c **** 		if (rcnt > btr) rcnt = btr;					/* Clip it by btr if needed */
3995:Core/Src/FAT/ff.c **** #if FF_FS_TINY
3996:Core/Src/FAT/ff.c **** 		if (move_window(fs, fp->sect) != FR_OK) ABORT(fs, FR_DISK_ERR);	/* Move sector window */
3997:Core/Src/FAT/ff.c **** 		memcpy(rbuff, fs->win + fp->fptr % SS(fs), rcnt);	/* Extract partial sector */
3998:Core/Src/FAT/ff.c **** #else
3999:Core/Src/FAT/ff.c **** 		memcpy(rbuff, fp->buf + fp->fptr % SS(fs), rcnt);	/* Extract partial sector */
4000:Core/Src/FAT/ff.c **** #endif
4001:Core/Src/FAT/ff.c **** 	}
4002:Core/Src/FAT/ff.c **** 
4003:Core/Src/FAT/ff.c **** 	LEAVE_FF(fs, FR_OK);
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 173


4004:Core/Src/FAT/ff.c **** }
4005:Core/Src/FAT/ff.c **** 
4006:Core/Src/FAT/ff.c **** 
4007:Core/Src/FAT/ff.c **** 
4008:Core/Src/FAT/ff.c **** 
4009:Core/Src/FAT/ff.c **** #if !FF_FS_READONLY
4010:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
4011:Core/Src/FAT/ff.c **** /* Write File                                                            */
4012:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
4013:Core/Src/FAT/ff.c **** 
4014:Core/Src/FAT/ff.c **** FRESULT f_write (
4015:Core/Src/FAT/ff.c **** 	FIL* fp,			/* Open file to be written */
4016:Core/Src/FAT/ff.c **** 	const void* buff,	/* Data to be written */
4017:Core/Src/FAT/ff.c **** 	UINT btw,			/* Number of bytes to write */
4018:Core/Src/FAT/ff.c **** 	UINT* bw			/* Number of bytes written */
4019:Core/Src/FAT/ff.c **** )
4020:Core/Src/FAT/ff.c **** {
4021:Core/Src/FAT/ff.c **** 	FRESULT res;
4022:Core/Src/FAT/ff.c **** 	FATFS *fs;
4023:Core/Src/FAT/ff.c **** 	DWORD clst;
4024:Core/Src/FAT/ff.c **** 	LBA_t sect;
4025:Core/Src/FAT/ff.c **** 	UINT wcnt, cc, csect;
4026:Core/Src/FAT/ff.c **** 	const BYTE *wbuff = (const BYTE*)buff;
4027:Core/Src/FAT/ff.c **** 
4028:Core/Src/FAT/ff.c **** 
4029:Core/Src/FAT/ff.c **** 	*bw = 0;	/* Clear write byte counter */
4030:Core/Src/FAT/ff.c **** 	res = validate(&fp->obj, &fs);			/* Check validity of the file object */
4031:Core/Src/FAT/ff.c **** 	if (res != FR_OK || (res = (FRESULT)fp->err) != FR_OK) LEAVE_FF(fs, res);	/* Check validity */
4032:Core/Src/FAT/ff.c **** 	if (!(fp->flag & FA_WRITE)) LEAVE_FF(fs, FR_DENIED);	/* Check access mode */
4033:Core/Src/FAT/ff.c **** 
4034:Core/Src/FAT/ff.c **** 	/* Check fptr wrap-around (file size cannot reach 4 GiB at FAT volume) */
4035:Core/Src/FAT/ff.c **** 	if ((!FF_FS_EXFAT || fs->fs_type != FS_EXFAT) && (DWORD)(fp->fptr + btw) < (DWORD)fp->fptr) {
4036:Core/Src/FAT/ff.c **** 		btw = (UINT)(0xFFFFFFFF - (DWORD)fp->fptr);
4037:Core/Src/FAT/ff.c **** 	}
4038:Core/Src/FAT/ff.c **** 
4039:Core/Src/FAT/ff.c **** 	for ( ; btw > 0; btw -= wcnt, *bw += wcnt, wbuff += wcnt, fp->fptr += wcnt, fp->obj.objsize = (fp-
4040:Core/Src/FAT/ff.c **** 		if (fp->fptr % SS(fs) == 0) {		/* On the sector boundary? */
4041:Core/Src/FAT/ff.c **** 			csect = (UINT)(fp->fptr / SS(fs)) & (fs->csize - 1);	/* Sector offset in the cluster */
4042:Core/Src/FAT/ff.c **** 			if (csect == 0) {				/* On the cluster boundary? */
4043:Core/Src/FAT/ff.c **** 				if (fp->fptr == 0) {		/* On the top of the file? */
4044:Core/Src/FAT/ff.c **** 					clst = fp->obj.sclust;	/* Follow from the origin */
4045:Core/Src/FAT/ff.c **** 					if (clst == 0) {		/* If no cluster is allocated, */
4046:Core/Src/FAT/ff.c **** 						clst = create_chain(&fp->obj, 0);	/* create a new cluster chain */
4047:Core/Src/FAT/ff.c **** 					}
4048:Core/Src/FAT/ff.c **** 				} else {					/* On the middle or end of the file */
4049:Core/Src/FAT/ff.c **** #if FF_USE_FASTSEEK
4050:Core/Src/FAT/ff.c **** 					if (fp->cltbl) {
4051:Core/Src/FAT/ff.c **** 						clst = clmt_clust(fp, fp->fptr);	/* Get cluster# from the CLMT */
4052:Core/Src/FAT/ff.c **** 					} else
4053:Core/Src/FAT/ff.c **** #endif
4054:Core/Src/FAT/ff.c **** 					{
4055:Core/Src/FAT/ff.c **** 						clst = create_chain(&fp->obj, fp->clust);	/* Follow or stretch cluster chain on the FAT */
4056:Core/Src/FAT/ff.c **** 					}
4057:Core/Src/FAT/ff.c **** 				}
4058:Core/Src/FAT/ff.c **** 				if (clst == 0) break;		/* Could not allocate a new cluster (disk full) */
4059:Core/Src/FAT/ff.c **** 				if (clst == 1) ABORT(fs, FR_INT_ERR);
4060:Core/Src/FAT/ff.c **** 				if (clst == 0xFFFFFFFF) ABORT(fs, FR_DISK_ERR);
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 174


4061:Core/Src/FAT/ff.c **** 				fp->clust = clst;			/* Update current cluster */
4062:Core/Src/FAT/ff.c **** 				if (fp->obj.sclust == 0) fp->obj.sclust = clst;	/* Set start cluster if the first write */
4063:Core/Src/FAT/ff.c **** 			}
4064:Core/Src/FAT/ff.c **** #if FF_FS_TINY
4065:Core/Src/FAT/ff.c **** 			if (fs->winsect == fp->sect && sync_window(fs) != FR_OK) ABORT(fs, FR_DISK_ERR);	/* Write-back s
4066:Core/Src/FAT/ff.c **** #else
4067:Core/Src/FAT/ff.c **** 			if (fp->flag & FA_DIRTY) {		/* Write-back sector cache */
4068:Core/Src/FAT/ff.c **** 				if (disk_write(fs->pdrv, fp->buf, fp->sect, 1) != RES_OK) ABORT(fs, FR_DISK_ERR);
4069:Core/Src/FAT/ff.c **** 				fp->flag &= (BYTE)~FA_DIRTY;
4070:Core/Src/FAT/ff.c **** 			}
4071:Core/Src/FAT/ff.c **** #endif
4072:Core/Src/FAT/ff.c **** 			sect = clst2sect(fs, fp->clust);	/* Get current sector */
4073:Core/Src/FAT/ff.c **** 			if (sect == 0) ABORT(fs, FR_INT_ERR);
4074:Core/Src/FAT/ff.c **** 			sect += csect;
4075:Core/Src/FAT/ff.c **** 			cc = btw / SS(fs);				/* When remaining bytes >= sector size, */
4076:Core/Src/FAT/ff.c **** 			if (cc > 0) {					/* Write maximum contiguous sectors directly */
4077:Core/Src/FAT/ff.c **** 				if (csect + cc > fs->csize) {	/* Clip at cluster boundary */
4078:Core/Src/FAT/ff.c **** 					cc = fs->csize - csect;
4079:Core/Src/FAT/ff.c **** 				}
4080:Core/Src/FAT/ff.c **** 				if (disk_write(fs->pdrv, wbuff, sect, cc) != RES_OK) ABORT(fs, FR_DISK_ERR);
4081:Core/Src/FAT/ff.c **** #if FF_FS_MINIMIZE <= 2
4082:Core/Src/FAT/ff.c **** #if FF_FS_TINY
4083:Core/Src/FAT/ff.c **** 				if (fs->winsect - sect < cc) {	/* Refill sector cache if it gets invalidated by the direct writ
4084:Core/Src/FAT/ff.c **** 					memcpy(fs->win, wbuff + ((fs->winsect - sect) * SS(fs)), SS(fs));
4085:Core/Src/FAT/ff.c **** 					fs->wflag = 0;
4086:Core/Src/FAT/ff.c **** 				}
4087:Core/Src/FAT/ff.c **** #else
4088:Core/Src/FAT/ff.c **** 				if (fp->sect - sect < cc) { /* Refill sector cache if it gets invalidated by the direct write *
4089:Core/Src/FAT/ff.c **** 					memcpy(fp->buf, wbuff + ((fp->sect - sect) * SS(fs)), SS(fs));
4090:Core/Src/FAT/ff.c **** 					fp->flag &= (BYTE)~FA_DIRTY;
4091:Core/Src/FAT/ff.c **** 				}
4092:Core/Src/FAT/ff.c **** #endif
4093:Core/Src/FAT/ff.c **** #endif
4094:Core/Src/FAT/ff.c **** 				wcnt = SS(fs) * cc;		/* Number of bytes transferred */
4095:Core/Src/FAT/ff.c **** 				continue;
4096:Core/Src/FAT/ff.c **** 			}
4097:Core/Src/FAT/ff.c **** #if FF_FS_TINY
4098:Core/Src/FAT/ff.c **** 			if (fp->fptr >= fp->obj.objsize) {	/* Avoid silly cache filling on the growing edge */
4099:Core/Src/FAT/ff.c **** 				if (sync_window(fs) != FR_OK) ABORT(fs, FR_DISK_ERR);
4100:Core/Src/FAT/ff.c **** 				fs->winsect = sect;
4101:Core/Src/FAT/ff.c **** 			}
4102:Core/Src/FAT/ff.c **** #else
4103:Core/Src/FAT/ff.c **** 			if (fp->sect != sect && 		/* Fill sector cache with file data */
4104:Core/Src/FAT/ff.c **** 				fp->fptr < fp->obj.objsize &&
4105:Core/Src/FAT/ff.c **** 				disk_read(fs->pdrv, fp->buf, sect, 1) != RES_OK) {
4106:Core/Src/FAT/ff.c **** 					ABORT(fs, FR_DISK_ERR);
4107:Core/Src/FAT/ff.c **** 			}
4108:Core/Src/FAT/ff.c **** #endif
4109:Core/Src/FAT/ff.c **** 			fp->sect = sect;
4110:Core/Src/FAT/ff.c **** 		}
4111:Core/Src/FAT/ff.c **** 		wcnt = SS(fs) - (UINT)fp->fptr % SS(fs);	/* Number of bytes remains in the sector */
4112:Core/Src/FAT/ff.c **** 		if (wcnt > btw) wcnt = btw;					/* Clip it by btw if needed */
4113:Core/Src/FAT/ff.c **** #if FF_FS_TINY
4114:Core/Src/FAT/ff.c **** 		if (move_window(fs, fp->sect) != FR_OK) ABORT(fs, FR_DISK_ERR);	/* Move sector window */
4115:Core/Src/FAT/ff.c **** 		memcpy(fs->win + fp->fptr % SS(fs), wbuff, wcnt);	/* Fit data to the sector */
4116:Core/Src/FAT/ff.c **** 		fs->wflag = 1;
4117:Core/Src/FAT/ff.c **** #else
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 175


4118:Core/Src/FAT/ff.c **** 		memcpy(fp->buf + fp->fptr % SS(fs), wbuff, wcnt);	/* Fit data to the sector */
4119:Core/Src/FAT/ff.c **** 		fp->flag |= FA_DIRTY;
4120:Core/Src/FAT/ff.c **** #endif
4121:Core/Src/FAT/ff.c **** 	}
4122:Core/Src/FAT/ff.c **** 
4123:Core/Src/FAT/ff.c **** 	fp->flag |= FA_MODIFIED;				/* Set file change flag */
4124:Core/Src/FAT/ff.c **** 
4125:Core/Src/FAT/ff.c **** 	LEAVE_FF(fs, FR_OK);
4126:Core/Src/FAT/ff.c **** }
4127:Core/Src/FAT/ff.c **** 
4128:Core/Src/FAT/ff.c **** 
4129:Core/Src/FAT/ff.c **** 
4130:Core/Src/FAT/ff.c **** 
4131:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
4132:Core/Src/FAT/ff.c **** /* Synchronize the File                                                  */
4133:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
4134:Core/Src/FAT/ff.c **** 
4135:Core/Src/FAT/ff.c **** FRESULT f_sync (
4136:Core/Src/FAT/ff.c **** 	FIL* fp		/* Open file to be synced */
4137:Core/Src/FAT/ff.c **** )
4138:Core/Src/FAT/ff.c **** {
4139:Core/Src/FAT/ff.c **** 	FRESULT res;
4140:Core/Src/FAT/ff.c **** 	FATFS *fs;
4141:Core/Src/FAT/ff.c **** 	DWORD tm;
4142:Core/Src/FAT/ff.c **** 	BYTE *dir;
4143:Core/Src/FAT/ff.c **** 
4144:Core/Src/FAT/ff.c **** 
4145:Core/Src/FAT/ff.c **** 	res = validate(&fp->obj, &fs);	/* Check validity of the file object */
4146:Core/Src/FAT/ff.c **** 	if (res == FR_OK) {
4147:Core/Src/FAT/ff.c **** 		if (fp->flag & FA_MODIFIED) {	/* Is there any change to the file? */
4148:Core/Src/FAT/ff.c **** #if !FF_FS_TINY
4149:Core/Src/FAT/ff.c **** 			if (fp->flag & FA_DIRTY) {	/* Write-back cached data if needed */
4150:Core/Src/FAT/ff.c **** 				if (disk_write(fs->pdrv, fp->buf, fp->sect, 1) != RES_OK) LEAVE_FF(fs, FR_DISK_ERR);
4151:Core/Src/FAT/ff.c **** 				fp->flag &= (BYTE)~FA_DIRTY;
4152:Core/Src/FAT/ff.c **** 			}
4153:Core/Src/FAT/ff.c **** #endif
4154:Core/Src/FAT/ff.c **** 			/* Update the directory entry */
4155:Core/Src/FAT/ff.c **** 			tm = GET_FATTIME();				/* Modified time */
4156:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT
4157:Core/Src/FAT/ff.c **** 			if (fs->fs_type == FS_EXFAT) {
4158:Core/Src/FAT/ff.c **** 				res = fill_first_frag(&fp->obj);	/* Fill first fragment on the FAT if needed */
4159:Core/Src/FAT/ff.c **** 				if (res == FR_OK) {
4160:Core/Src/FAT/ff.c **** 					res = fill_last_frag(&fp->obj, fp->clust, 0xFFFFFFFF);	/* Fill last fragment on the FAT if nee
4161:Core/Src/FAT/ff.c **** 				}
4162:Core/Src/FAT/ff.c **** 				if (res == FR_OK) {
4163:Core/Src/FAT/ff.c **** 					DIR dj;
4164:Core/Src/FAT/ff.c **** 					DEF_NAMBUF
4165:Core/Src/FAT/ff.c **** 
4166:Core/Src/FAT/ff.c **** 					INIT_NAMBUF(fs);
4167:Core/Src/FAT/ff.c **** 					res = load_obj_xdir(&dj, &fp->obj);	/* Load directory entry block */
4168:Core/Src/FAT/ff.c **** 					if (res == FR_OK) {
4169:Core/Src/FAT/ff.c **** 						fs->dirbuf[XDIR_Attr] |= AM_ARC;				/* Set archive attribute to indicate that the file has be
4170:Core/Src/FAT/ff.c **** 						fs->dirbuf[XDIR_GenFlags] = fp->obj.stat | 1;	/* Update file allocation information */
4171:Core/Src/FAT/ff.c **** 						st_dword(fs->dirbuf + XDIR_FstClus, fp->obj.sclust);		/* Update start cluster */
4172:Core/Src/FAT/ff.c **** 						st_qword(fs->dirbuf + XDIR_FileSize, fp->obj.objsize);		/* Update file size */
4173:Core/Src/FAT/ff.c **** 						st_qword(fs->dirbuf + XDIR_ValidFileSize, fp->obj.objsize);	/* (FatFs does not support Valid 
4174:Core/Src/FAT/ff.c **** 						st_dword(fs->dirbuf + XDIR_ModTime, tm);		/* Update modified time */
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 176


4175:Core/Src/FAT/ff.c **** 						fs->dirbuf[XDIR_ModTime10] = 0;
4176:Core/Src/FAT/ff.c **** 						st_dword(fs->dirbuf + XDIR_AccTime, 0);
4177:Core/Src/FAT/ff.c **** 						res = store_xdir(&dj);	/* Restore it to the directory */
4178:Core/Src/FAT/ff.c **** 						if (res == FR_OK) {
4179:Core/Src/FAT/ff.c **** 							res = sync_fs(fs);
4180:Core/Src/FAT/ff.c **** 							fp->flag &= (BYTE)~FA_MODIFIED;
4181:Core/Src/FAT/ff.c **** 						}
4182:Core/Src/FAT/ff.c **** 					}
4183:Core/Src/FAT/ff.c **** 					FREE_NAMBUF();
4184:Core/Src/FAT/ff.c **** 				}
4185:Core/Src/FAT/ff.c **** 			} else
4186:Core/Src/FAT/ff.c **** #endif
4187:Core/Src/FAT/ff.c **** 			{
4188:Core/Src/FAT/ff.c **** 				res = move_window(fs, fp->dir_sect);
4189:Core/Src/FAT/ff.c **** 				if (res == FR_OK) {
4190:Core/Src/FAT/ff.c **** 					dir = fp->dir_ptr;
4191:Core/Src/FAT/ff.c **** 					dir[DIR_Attr] |= AM_ARC;						/* Set archive attribute to indicate that the file has been chan
4192:Core/Src/FAT/ff.c **** 					st_clust(fp->obj.fs, dir, fp->obj.sclust);		/* Update file allocation information  */
4193:Core/Src/FAT/ff.c **** 					st_dword(dir + DIR_FileSize, (DWORD)fp->obj.objsize);	/* Update file size */
4194:Core/Src/FAT/ff.c **** 					st_dword(dir + DIR_ModTime, tm);				/* Update modified time */
4195:Core/Src/FAT/ff.c **** 					st_word(dir + DIR_LstAccDate, 0);
4196:Core/Src/FAT/ff.c **** 					fs->wflag = 1;
4197:Core/Src/FAT/ff.c **** 					res = sync_fs(fs);					/* Restore it to the directory */
4198:Core/Src/FAT/ff.c **** 					fp->flag &= (BYTE)~FA_MODIFIED;
4199:Core/Src/FAT/ff.c **** 				}
4200:Core/Src/FAT/ff.c **** 			}
4201:Core/Src/FAT/ff.c **** 		}
4202:Core/Src/FAT/ff.c **** 	}
4203:Core/Src/FAT/ff.c **** 
4204:Core/Src/FAT/ff.c **** 	LEAVE_FF(fs, res);
4205:Core/Src/FAT/ff.c **** }
4206:Core/Src/FAT/ff.c **** 
4207:Core/Src/FAT/ff.c **** #endif /* !FF_FS_READONLY */
4208:Core/Src/FAT/ff.c **** 
4209:Core/Src/FAT/ff.c **** 
4210:Core/Src/FAT/ff.c **** 
4211:Core/Src/FAT/ff.c **** 
4212:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
4213:Core/Src/FAT/ff.c **** /* Close File                                                            */
4214:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
4215:Core/Src/FAT/ff.c **** 
4216:Core/Src/FAT/ff.c **** FRESULT f_close (
4217:Core/Src/FAT/ff.c **** 	FIL* fp		/* Open file to be closed */
4218:Core/Src/FAT/ff.c **** )
4219:Core/Src/FAT/ff.c **** {
4220:Core/Src/FAT/ff.c **** 	FRESULT res;
4221:Core/Src/FAT/ff.c **** 	FATFS *fs;
4222:Core/Src/FAT/ff.c **** 
4223:Core/Src/FAT/ff.c **** #if !FF_FS_READONLY
4224:Core/Src/FAT/ff.c **** 	res = f_sync(fp);					/* Flush cached data */
4225:Core/Src/FAT/ff.c **** 	if (res == FR_OK)
4226:Core/Src/FAT/ff.c **** #endif
4227:Core/Src/FAT/ff.c **** 	{
4228:Core/Src/FAT/ff.c **** 		res = validate(&fp->obj, &fs);	/* Lock volume */
4229:Core/Src/FAT/ff.c **** 		if (res == FR_OK) {
4230:Core/Src/FAT/ff.c **** #if FF_FS_LOCK
4231:Core/Src/FAT/ff.c **** 			res = dec_share(fp->obj.lockid);		/* Decrement file open counter */
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 177


4232:Core/Src/FAT/ff.c **** 			if (res == FR_OK) fp->obj.fs = 0;	/* Invalidate file object */
4233:Core/Src/FAT/ff.c **** #else
4234:Core/Src/FAT/ff.c **** 			fp->obj.fs = 0;	/* Invalidate file object */
4235:Core/Src/FAT/ff.c **** #endif
4236:Core/Src/FAT/ff.c **** #if FF_FS_REENTRANT
4237:Core/Src/FAT/ff.c **** 			unlock_volume(fs, FR_OK);		/* Unlock volume */
4238:Core/Src/FAT/ff.c **** #endif
4239:Core/Src/FAT/ff.c **** 		}
4240:Core/Src/FAT/ff.c **** 	}
4241:Core/Src/FAT/ff.c **** 	return res;
4242:Core/Src/FAT/ff.c **** }
4243:Core/Src/FAT/ff.c **** 
4244:Core/Src/FAT/ff.c **** 
4245:Core/Src/FAT/ff.c **** 
4246:Core/Src/FAT/ff.c **** 
4247:Core/Src/FAT/ff.c **** #if FF_FS_RPATH >= 1
4248:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
4249:Core/Src/FAT/ff.c **** /* Change Current Directory or Current Drive, Get Current Directory      */
4250:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
4251:Core/Src/FAT/ff.c **** 
4252:Core/Src/FAT/ff.c **** FRESULT f_chdrive (
4253:Core/Src/FAT/ff.c **** 	const TCHAR* path		/* Drive number to set */
4254:Core/Src/FAT/ff.c **** )
4255:Core/Src/FAT/ff.c **** {
4256:Core/Src/FAT/ff.c **** 	int vol;
4257:Core/Src/FAT/ff.c **** 
4258:Core/Src/FAT/ff.c **** 
4259:Core/Src/FAT/ff.c **** 	/* Get logical drive number */
4260:Core/Src/FAT/ff.c **** 	vol = get_ldnumber(&path);
4261:Core/Src/FAT/ff.c **** 	if (vol < 0) return FR_INVALID_DRIVE;
4262:Core/Src/FAT/ff.c **** 	CurrVol = (BYTE)vol;	/* Set it as current volume */
4263:Core/Src/FAT/ff.c **** 
4264:Core/Src/FAT/ff.c **** 	return FR_OK;
4265:Core/Src/FAT/ff.c **** }
4266:Core/Src/FAT/ff.c **** 
4267:Core/Src/FAT/ff.c **** 
4268:Core/Src/FAT/ff.c **** 
4269:Core/Src/FAT/ff.c **** FRESULT f_chdir (
4270:Core/Src/FAT/ff.c **** 	const TCHAR* path	/* Pointer to the directory path */
4271:Core/Src/FAT/ff.c **** )
4272:Core/Src/FAT/ff.c **** {
4273:Core/Src/FAT/ff.c **** #if FF_STR_VOLUME_ID == 2
4274:Core/Src/FAT/ff.c **** 	UINT i;
4275:Core/Src/FAT/ff.c **** #endif
4276:Core/Src/FAT/ff.c **** 	FRESULT res;
4277:Core/Src/FAT/ff.c **** 	DIR dj;
4278:Core/Src/FAT/ff.c **** 	FATFS *fs;
4279:Core/Src/FAT/ff.c **** 	DEF_NAMBUF
4280:Core/Src/FAT/ff.c **** 
4281:Core/Src/FAT/ff.c **** 
4282:Core/Src/FAT/ff.c **** 	/* Get logical drive */
4283:Core/Src/FAT/ff.c **** 	res = mount_volume(&path, &fs, 0);
4284:Core/Src/FAT/ff.c **** 	if (res == FR_OK) {
4285:Core/Src/FAT/ff.c **** 		dj.obj.fs = fs;
4286:Core/Src/FAT/ff.c **** 		INIT_NAMBUF(fs);
4287:Core/Src/FAT/ff.c **** 		res = follow_path(&dj, path);		/* Follow the path */
4288:Core/Src/FAT/ff.c **** 		if (res == FR_OK) {					/* Follow completed */
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 178


4289:Core/Src/FAT/ff.c **** 			if (dj.fn[NSFLAG] & NS_NONAME) {	/* Is it the start directory itself? */
4290:Core/Src/FAT/ff.c **** 				fs->cdir = dj.obj.sclust;
4291:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT
4292:Core/Src/FAT/ff.c **** 				if (fs->fs_type == FS_EXFAT) {
4293:Core/Src/FAT/ff.c **** 					fs->cdc_scl = dj.obj.c_scl;
4294:Core/Src/FAT/ff.c **** 					fs->cdc_size = dj.obj.c_size;
4295:Core/Src/FAT/ff.c **** 					fs->cdc_ofs = dj.obj.c_ofs;
4296:Core/Src/FAT/ff.c **** 				}
4297:Core/Src/FAT/ff.c **** #endif
4298:Core/Src/FAT/ff.c **** 			} else {
4299:Core/Src/FAT/ff.c **** 				if (dj.obj.attr & AM_DIR) {	/* It is a sub-directory */
4300:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT
4301:Core/Src/FAT/ff.c **** 					if (fs->fs_type == FS_EXFAT) {
4302:Core/Src/FAT/ff.c **** 						fs->cdir = ld_dword(fs->dirbuf + XDIR_FstClus);		/* Sub-directory cluster */
4303:Core/Src/FAT/ff.c **** 						fs->cdc_scl = dj.obj.sclust;						/* Save containing directory information */
4304:Core/Src/FAT/ff.c **** 						fs->cdc_size = ((DWORD)dj.obj.objsize & 0xFFFFFF00) | dj.obj.stat;
4305:Core/Src/FAT/ff.c **** 						fs->cdc_ofs = dj.blk_ofs;
4306:Core/Src/FAT/ff.c **** 					} else
4307:Core/Src/FAT/ff.c **** #endif
4308:Core/Src/FAT/ff.c **** 					{
4309:Core/Src/FAT/ff.c **** 						fs->cdir = ld_clust(fs, dj.dir);					/* Sub-directory cluster */
4310:Core/Src/FAT/ff.c **** 					}
4311:Core/Src/FAT/ff.c **** 				} else {
4312:Core/Src/FAT/ff.c **** 					res = FR_NO_PATH;		/* Reached but a file */
4313:Core/Src/FAT/ff.c **** 				}
4314:Core/Src/FAT/ff.c **** 			}
4315:Core/Src/FAT/ff.c **** 		}
4316:Core/Src/FAT/ff.c **** 		FREE_NAMBUF();
4317:Core/Src/FAT/ff.c **** 		if (res == FR_NO_FILE) res = FR_NO_PATH;
4318:Core/Src/FAT/ff.c **** #if FF_STR_VOLUME_ID == 2	/* Also current drive is changed if in Unix style volume ID */
4319:Core/Src/FAT/ff.c **** 		if (res == FR_OK) {
4320:Core/Src/FAT/ff.c **** 			for (i = FF_VOLUMES - 1; i && fs != FatFs[i]; i--) ;	/* Set current drive */
4321:Core/Src/FAT/ff.c **** 			CurrVol = (BYTE)i;
4322:Core/Src/FAT/ff.c **** 		}
4323:Core/Src/FAT/ff.c **** #endif
4324:Core/Src/FAT/ff.c **** 	}
4325:Core/Src/FAT/ff.c **** 
4326:Core/Src/FAT/ff.c **** 	LEAVE_FF(fs, res);
4327:Core/Src/FAT/ff.c **** }
4328:Core/Src/FAT/ff.c **** 
4329:Core/Src/FAT/ff.c **** 
4330:Core/Src/FAT/ff.c **** #if FF_FS_RPATH >= 2
4331:Core/Src/FAT/ff.c **** FRESULT f_getcwd (
4332:Core/Src/FAT/ff.c **** 	TCHAR* buff,	/* Pointer to the directory path */
4333:Core/Src/FAT/ff.c **** 	UINT len		/* Size of buff in unit of TCHAR */
4334:Core/Src/FAT/ff.c **** )
4335:Core/Src/FAT/ff.c **** {
4336:Core/Src/FAT/ff.c **** 	FRESULT res;
4337:Core/Src/FAT/ff.c **** 	DIR dj;
4338:Core/Src/FAT/ff.c **** 	FATFS *fs;
4339:Core/Src/FAT/ff.c **** 	UINT i, n;
4340:Core/Src/FAT/ff.c **** 	DWORD ccl;
4341:Core/Src/FAT/ff.c **** 	TCHAR *tp = buff;
4342:Core/Src/FAT/ff.c **** #if FF_VOLUMES >= 2
4343:Core/Src/FAT/ff.c **** 	UINT vl;
4344:Core/Src/FAT/ff.c **** #if FF_STR_VOLUME_ID
4345:Core/Src/FAT/ff.c **** 	const char *vp;
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 179


4346:Core/Src/FAT/ff.c **** #endif
4347:Core/Src/FAT/ff.c **** #endif
4348:Core/Src/FAT/ff.c **** 	FILINFO fno;
4349:Core/Src/FAT/ff.c **** 	DEF_NAMBUF
4350:Core/Src/FAT/ff.c **** 
4351:Core/Src/FAT/ff.c **** 
4352:Core/Src/FAT/ff.c **** 	/* Get logical drive */
4353:Core/Src/FAT/ff.c **** 	buff[0] = 0;	/* Set null string to get current volume */
4354:Core/Src/FAT/ff.c **** 	res = mount_volume((const TCHAR**)&buff, &fs, 0);	/* Get current volume */
4355:Core/Src/FAT/ff.c **** 	if (res == FR_OK) {
4356:Core/Src/FAT/ff.c **** 		dj.obj.fs = fs;
4357:Core/Src/FAT/ff.c **** 		INIT_NAMBUF(fs);
4358:Core/Src/FAT/ff.c **** 
4359:Core/Src/FAT/ff.c **** 		/* Follow parent directories and create the path */
4360:Core/Src/FAT/ff.c **** 		i = len;			/* Bottom of buffer (directory stack base) */
4361:Core/Src/FAT/ff.c **** 		if (!FF_FS_EXFAT || fs->fs_type != FS_EXFAT) {	/* (Cannot do getcwd on exFAT and returns root pat
4362:Core/Src/FAT/ff.c **** 			dj.obj.sclust = fs->cdir;				/* Start to follow upper directory from current directory */
4363:Core/Src/FAT/ff.c **** 			while ((ccl = dj.obj.sclust) != 0) {	/* Repeat while current directory is a sub-directory */
4364:Core/Src/FAT/ff.c **** 				res = dir_sdi(&dj, 1 * SZDIRE);	/* Get parent directory */
4365:Core/Src/FAT/ff.c **** 				if (res != FR_OK) break;
4366:Core/Src/FAT/ff.c **** 				res = move_window(fs, dj.sect);
4367:Core/Src/FAT/ff.c **** 				if (res != FR_OK) break;
4368:Core/Src/FAT/ff.c **** 				dj.obj.sclust = ld_clust(fs, dj.dir);	/* Goto parent directory */
4369:Core/Src/FAT/ff.c **** 				res = dir_sdi(&dj, 0);
4370:Core/Src/FAT/ff.c **** 				if (res != FR_OK) break;
4371:Core/Src/FAT/ff.c **** 				do {							/* Find the entry links to the child directory */
4372:Core/Src/FAT/ff.c **** 					res = DIR_READ_FILE(&dj);
4373:Core/Src/FAT/ff.c **** 					if (res != FR_OK) break;
4374:Core/Src/FAT/ff.c **** 					if (ccl == ld_clust(fs, dj.dir)) break;	/* Found the entry */
4375:Core/Src/FAT/ff.c **** 					res = dir_next(&dj, 0);
4376:Core/Src/FAT/ff.c **** 				} while (res == FR_OK);
4377:Core/Src/FAT/ff.c **** 				if (res == FR_NO_FILE) res = FR_INT_ERR;/* It cannot be 'not found'. */
4378:Core/Src/FAT/ff.c **** 				if (res != FR_OK) break;
4379:Core/Src/FAT/ff.c **** 				get_fileinfo(&dj, &fno);		/* Get the directory name and push it to the buffer */
4380:Core/Src/FAT/ff.c **** 				for (n = 0; fno.fname[n]; n++) ;	/* Name length */
4381:Core/Src/FAT/ff.c **** 				if (i < n + 1) {	/* Insufficient space to store the path name? */
4382:Core/Src/FAT/ff.c **** 					res = FR_NOT_ENOUGH_CORE; break;
4383:Core/Src/FAT/ff.c **** 				}
4384:Core/Src/FAT/ff.c **** 				while (n) buff[--i] = fno.fname[--n];	/* Stack the name */
4385:Core/Src/FAT/ff.c **** 				buff[--i] = '/';
4386:Core/Src/FAT/ff.c **** 			}
4387:Core/Src/FAT/ff.c **** 		}
4388:Core/Src/FAT/ff.c **** 		if (res == FR_OK) {
4389:Core/Src/FAT/ff.c **** 			if (i == len) buff[--i] = '/';	/* Is it the root-directory? */
4390:Core/Src/FAT/ff.c **** #if FF_VOLUMES >= 2			/* Put drive prefix */
4391:Core/Src/FAT/ff.c **** 			vl = 0;
4392:Core/Src/FAT/ff.c **** #if FF_STR_VOLUME_ID >= 1	/* String volume ID */
4393:Core/Src/FAT/ff.c **** 			for (n = 0, vp = (const char*)VolumeStr[CurrVol]; vp[n]; n++) ;
4394:Core/Src/FAT/ff.c **** 			if (i >= n + 2) {
4395:Core/Src/FAT/ff.c **** 				if (FF_STR_VOLUME_ID == 2) *tp++ = (TCHAR)'/';
4396:Core/Src/FAT/ff.c **** 				for (vl = 0; vl < n; *tp++ = (TCHAR)vp[vl], vl++) ;
4397:Core/Src/FAT/ff.c **** 				if (FF_STR_VOLUME_ID == 1) *tp++ = (TCHAR)':';
4398:Core/Src/FAT/ff.c **** 				vl++;
4399:Core/Src/FAT/ff.c **** 			}
4400:Core/Src/FAT/ff.c **** #else						/* Numeric volume ID */
4401:Core/Src/FAT/ff.c **** 			if (i >= 3) {
4402:Core/Src/FAT/ff.c **** 				*tp++ = (TCHAR)'0' + CurrVol;
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 180


4403:Core/Src/FAT/ff.c **** 				*tp++ = (TCHAR)':';
4404:Core/Src/FAT/ff.c **** 				vl = 2;
4405:Core/Src/FAT/ff.c **** 			}
4406:Core/Src/FAT/ff.c **** #endif
4407:Core/Src/FAT/ff.c **** 			if (vl == 0) res = FR_NOT_ENOUGH_CORE;
4408:Core/Src/FAT/ff.c **** #endif
4409:Core/Src/FAT/ff.c **** 			/* Add current directory path */
4410:Core/Src/FAT/ff.c **** 			if (res == FR_OK) {
4411:Core/Src/FAT/ff.c **** 				do {	/* Copy stacked path string */
4412:Core/Src/FAT/ff.c **** 					*tp++ = buff[i++];
4413:Core/Src/FAT/ff.c **** 				} while (i < len);
4414:Core/Src/FAT/ff.c **** 			}
4415:Core/Src/FAT/ff.c **** 		}
4416:Core/Src/FAT/ff.c **** 		FREE_NAMBUF();
4417:Core/Src/FAT/ff.c **** 	}
4418:Core/Src/FAT/ff.c **** 
4419:Core/Src/FAT/ff.c **** 	*tp = 0;
4420:Core/Src/FAT/ff.c **** 	LEAVE_FF(fs, res);
4421:Core/Src/FAT/ff.c **** }
4422:Core/Src/FAT/ff.c **** 
4423:Core/Src/FAT/ff.c **** #endif /* FF_FS_RPATH >= 2 */
4424:Core/Src/FAT/ff.c **** #endif /* FF_FS_RPATH >= 1 */
4425:Core/Src/FAT/ff.c **** 
4426:Core/Src/FAT/ff.c **** 
4427:Core/Src/FAT/ff.c **** 
4428:Core/Src/FAT/ff.c **** #if FF_FS_MINIMIZE <= 2
4429:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
4430:Core/Src/FAT/ff.c **** /* Seek File Read/Write Pointer                                          */
4431:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
4432:Core/Src/FAT/ff.c **** 
4433:Core/Src/FAT/ff.c **** FRESULT f_lseek (
4434:Core/Src/FAT/ff.c **** 	FIL* fp,		/* Pointer to the file object */
4435:Core/Src/FAT/ff.c **** 	FSIZE_t ofs		/* File pointer from top of file */
4436:Core/Src/FAT/ff.c **** )
4437:Core/Src/FAT/ff.c **** {
4438:Core/Src/FAT/ff.c **** 	FRESULT res;
4439:Core/Src/FAT/ff.c **** 	FATFS *fs;
4440:Core/Src/FAT/ff.c **** 	DWORD clst, bcs;
4441:Core/Src/FAT/ff.c **** 	LBA_t nsect;
4442:Core/Src/FAT/ff.c **** 	FSIZE_t ifptr;
4443:Core/Src/FAT/ff.c **** #if FF_USE_FASTSEEK
4444:Core/Src/FAT/ff.c **** 	DWORD cl, pcl, ncl, tcl, tlen, ulen;
4445:Core/Src/FAT/ff.c **** 	DWORD *tbl;
4446:Core/Src/FAT/ff.c **** 	LBA_t dsc;
4447:Core/Src/FAT/ff.c **** #endif
4448:Core/Src/FAT/ff.c **** 
4449:Core/Src/FAT/ff.c **** 	res = validate(&fp->obj, &fs);		/* Check validity of the file object */
4450:Core/Src/FAT/ff.c **** 	if (res == FR_OK) res = (FRESULT)fp->err;
4451:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT && !FF_FS_READONLY
4452:Core/Src/FAT/ff.c **** 	if (res == FR_OK && fs->fs_type == FS_EXFAT) {
4453:Core/Src/FAT/ff.c **** 		res = fill_last_frag(&fp->obj, fp->clust, 0xFFFFFFFF);	/* Fill last fragment on the FAT if needed
4454:Core/Src/FAT/ff.c **** 	}
4455:Core/Src/FAT/ff.c **** #endif
4456:Core/Src/FAT/ff.c **** 	if (res != FR_OK) LEAVE_FF(fs, res);
4457:Core/Src/FAT/ff.c **** 
4458:Core/Src/FAT/ff.c **** #if FF_USE_FASTSEEK
4459:Core/Src/FAT/ff.c **** 	if (fp->cltbl) {	/* Fast seek */
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 181


4460:Core/Src/FAT/ff.c **** 		if (ofs == CREATE_LINKMAP) {	/* Create CLMT */
4461:Core/Src/FAT/ff.c **** 			tbl = fp->cltbl;
4462:Core/Src/FAT/ff.c **** 			tlen = *tbl++; ulen = 2;	/* Given table size and required table size */
4463:Core/Src/FAT/ff.c **** 			cl = fp->obj.sclust;		/* Origin of the chain */
4464:Core/Src/FAT/ff.c **** 			if (cl != 0) {
4465:Core/Src/FAT/ff.c **** 				do {
4466:Core/Src/FAT/ff.c **** 					/* Get a fragment */
4467:Core/Src/FAT/ff.c **** 					tcl = cl; ncl = 0; ulen += 2;	/* Top, length and used items */
4468:Core/Src/FAT/ff.c **** 					do {
4469:Core/Src/FAT/ff.c **** 						pcl = cl; ncl++;
4470:Core/Src/FAT/ff.c **** 						cl = get_fat(&fp->obj, cl);
4471:Core/Src/FAT/ff.c **** 						if (cl <= 1) ABORT(fs, FR_INT_ERR);
4472:Core/Src/FAT/ff.c **** 						if (cl == 0xFFFFFFFF) ABORT(fs, FR_DISK_ERR);
4473:Core/Src/FAT/ff.c **** 					} while (cl == pcl + 1);
4474:Core/Src/FAT/ff.c **** 					if (ulen <= tlen) {		/* Store the length and top of the fragment */
4475:Core/Src/FAT/ff.c **** 						*tbl++ = ncl; *tbl++ = tcl;
4476:Core/Src/FAT/ff.c **** 					}
4477:Core/Src/FAT/ff.c **** 				} while (cl < fs->n_fatent);	/* Repeat until end of chain */
4478:Core/Src/FAT/ff.c **** 			}
4479:Core/Src/FAT/ff.c **** 			*fp->cltbl = ulen;	/* Number of items used */
4480:Core/Src/FAT/ff.c **** 			if (ulen <= tlen) {
4481:Core/Src/FAT/ff.c **** 				*tbl = 0;		/* Terminate table */
4482:Core/Src/FAT/ff.c **** 			} else {
4483:Core/Src/FAT/ff.c **** 				res = FR_NOT_ENOUGH_CORE;	/* Given table size is smaller than required */
4484:Core/Src/FAT/ff.c **** 			}
4485:Core/Src/FAT/ff.c **** 		} else {						/* Fast seek */
4486:Core/Src/FAT/ff.c **** 			if (ofs > fp->obj.objsize) ofs = fp->obj.objsize;	/* Clip offset at the file size */
4487:Core/Src/FAT/ff.c **** 			fp->fptr = ofs;				/* Set file pointer */
4488:Core/Src/FAT/ff.c **** 			if (ofs > 0) {
4489:Core/Src/FAT/ff.c **** 				fp->clust = clmt_clust(fp, ofs - 1);
4490:Core/Src/FAT/ff.c **** 				dsc = clst2sect(fs, fp->clust);
4491:Core/Src/FAT/ff.c **** 				if (dsc == 0) ABORT(fs, FR_INT_ERR);
4492:Core/Src/FAT/ff.c **** 				dsc += (DWORD)((ofs - 1) / SS(fs)) & (fs->csize - 1);
4493:Core/Src/FAT/ff.c **** 				if (fp->fptr % SS(fs) && dsc != fp->sect) {	/* Refill sector cache if needed */
4494:Core/Src/FAT/ff.c **** #if !FF_FS_TINY
4495:Core/Src/FAT/ff.c **** #if !FF_FS_READONLY
4496:Core/Src/FAT/ff.c **** 					if (fp->flag & FA_DIRTY) {		/* Write-back dirty sector cache */
4497:Core/Src/FAT/ff.c **** 						if (disk_write(fs->pdrv, fp->buf, fp->sect, 1) != RES_OK) ABORT(fs, FR_DISK_ERR);
4498:Core/Src/FAT/ff.c **** 						fp->flag &= (BYTE)~FA_DIRTY;
4499:Core/Src/FAT/ff.c **** 					}
4500:Core/Src/FAT/ff.c **** #endif
4501:Core/Src/FAT/ff.c **** 					if (disk_read(fs->pdrv, fp->buf, dsc, 1) != RES_OK) ABORT(fs, FR_DISK_ERR);	/* Load current se
4502:Core/Src/FAT/ff.c **** #endif
4503:Core/Src/FAT/ff.c **** 					fp->sect = dsc;
4504:Core/Src/FAT/ff.c **** 				}
4505:Core/Src/FAT/ff.c **** 			}
4506:Core/Src/FAT/ff.c **** 		}
4507:Core/Src/FAT/ff.c **** 	} else
4508:Core/Src/FAT/ff.c **** #endif
4509:Core/Src/FAT/ff.c **** 
4510:Core/Src/FAT/ff.c **** 	/* Normal Seek */
4511:Core/Src/FAT/ff.c **** 	{
4512:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT
4513:Core/Src/FAT/ff.c **** 		if (fs->fs_type != FS_EXFAT && ofs >= 0x100000000) ofs = 0xFFFFFFFF;	/* Clip at 4 GiB - 1 if at F
4514:Core/Src/FAT/ff.c **** #endif
4515:Core/Src/FAT/ff.c **** 		if (ofs > fp->obj.objsize && (FF_FS_READONLY || !(fp->flag & FA_WRITE))) {	/* In read-only mode, 
4516:Core/Src/FAT/ff.c **** 			ofs = fp->obj.objsize;
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 182


4517:Core/Src/FAT/ff.c **** 		}
4518:Core/Src/FAT/ff.c **** 		ifptr = fp->fptr;
4519:Core/Src/FAT/ff.c **** 		fp->fptr = nsect = 0;
4520:Core/Src/FAT/ff.c **** 		if (ofs > 0) {
4521:Core/Src/FAT/ff.c **** 			bcs = (DWORD)fs->csize * SS(fs);	/* Cluster size (byte) */
4522:Core/Src/FAT/ff.c **** 			if (ifptr > 0 &&
4523:Core/Src/FAT/ff.c **** 				(ofs - 1) / bcs >= (ifptr - 1) / bcs) {	/* When seek to same or following cluster, */
4524:Core/Src/FAT/ff.c **** 				fp->fptr = (ifptr - 1) & ~(FSIZE_t)(bcs - 1);	/* start from the current cluster */
4525:Core/Src/FAT/ff.c **** 				ofs -= fp->fptr;
4526:Core/Src/FAT/ff.c **** 				clst = fp->clust;
4527:Core/Src/FAT/ff.c **** 			} else {									/* When seek to back cluster, */
4528:Core/Src/FAT/ff.c **** 				clst = fp->obj.sclust;					/* start from the first cluster */
4529:Core/Src/FAT/ff.c **** #if !FF_FS_READONLY
4530:Core/Src/FAT/ff.c **** 				if (clst == 0) {						/* If no cluster chain, create a new chain */
4531:Core/Src/FAT/ff.c **** 					clst = create_chain(&fp->obj, 0);
4532:Core/Src/FAT/ff.c **** 					if (clst == 1) ABORT(fs, FR_INT_ERR);
4533:Core/Src/FAT/ff.c **** 					if (clst == 0xFFFFFFFF) ABORT(fs, FR_DISK_ERR);
4534:Core/Src/FAT/ff.c **** 					fp->obj.sclust = clst;
4535:Core/Src/FAT/ff.c **** 				}
4536:Core/Src/FAT/ff.c **** #endif
4537:Core/Src/FAT/ff.c **** 				fp->clust = clst;
4538:Core/Src/FAT/ff.c **** 			}
4539:Core/Src/FAT/ff.c **** 			if (clst != 0) {
4540:Core/Src/FAT/ff.c **** 				while (ofs > bcs) {						/* Cluster following loop */
4541:Core/Src/FAT/ff.c **** 					ofs -= bcs; fp->fptr += bcs;
4542:Core/Src/FAT/ff.c **** #if !FF_FS_READONLY
4543:Core/Src/FAT/ff.c **** 					if (fp->flag & FA_WRITE) {			/* Check if in write mode or not */
4544:Core/Src/FAT/ff.c **** 						if (FF_FS_EXFAT && fp->fptr > fp->obj.objsize) {	/* No FAT chain object needs correct objsize
4545:Core/Src/FAT/ff.c **** 							fp->obj.objsize = fp->fptr;
4546:Core/Src/FAT/ff.c **** 							fp->flag |= FA_MODIFIED;
4547:Core/Src/FAT/ff.c **** 						}
4548:Core/Src/FAT/ff.c **** 						clst = create_chain(&fp->obj, clst);	/* Follow chain with forceed stretch */
4549:Core/Src/FAT/ff.c **** 						if (clst == 0) {				/* Clip file size in case of disk full */
4550:Core/Src/FAT/ff.c **** 							ofs = 0; break;
4551:Core/Src/FAT/ff.c **** 						}
4552:Core/Src/FAT/ff.c **** 					} else
4553:Core/Src/FAT/ff.c **** #endif
4554:Core/Src/FAT/ff.c **** 					{
4555:Core/Src/FAT/ff.c **** 						clst = get_fat(&fp->obj, clst);	/* Follow cluster chain if not in write mode */
4556:Core/Src/FAT/ff.c **** 					}
4557:Core/Src/FAT/ff.c **** 					if (clst == 0xFFFFFFFF) ABORT(fs, FR_DISK_ERR);
4558:Core/Src/FAT/ff.c **** 					if (clst <= 1 || clst >= fs->n_fatent) ABORT(fs, FR_INT_ERR);
4559:Core/Src/FAT/ff.c **** 					fp->clust = clst;
4560:Core/Src/FAT/ff.c **** 				}
4561:Core/Src/FAT/ff.c **** 				fp->fptr += ofs;
4562:Core/Src/FAT/ff.c **** 				if (ofs % SS(fs)) {
4563:Core/Src/FAT/ff.c **** 					nsect = clst2sect(fs, clst);	/* Current sector */
4564:Core/Src/FAT/ff.c **** 					if (nsect == 0) ABORT(fs, FR_INT_ERR);
4565:Core/Src/FAT/ff.c **** 					nsect += (DWORD)(ofs / SS(fs));
4566:Core/Src/FAT/ff.c **** 				}
4567:Core/Src/FAT/ff.c **** 			}
4568:Core/Src/FAT/ff.c **** 		}
4569:Core/Src/FAT/ff.c **** 		if (!FF_FS_READONLY && fp->fptr > fp->obj.objsize) {	/* Set file change flag if the file size is 
4570:Core/Src/FAT/ff.c **** 			fp->obj.objsize = fp->fptr;
4571:Core/Src/FAT/ff.c **** 			fp->flag |= FA_MODIFIED;
4572:Core/Src/FAT/ff.c **** 		}
4573:Core/Src/FAT/ff.c **** 		if (fp->fptr % SS(fs) && nsect != fp->sect) {	/* Fill sector cache if needed */
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 183


4574:Core/Src/FAT/ff.c **** #if !FF_FS_TINY
4575:Core/Src/FAT/ff.c **** #if !FF_FS_READONLY
4576:Core/Src/FAT/ff.c **** 			if (fp->flag & FA_DIRTY) {			/* Write-back dirty sector cache */
4577:Core/Src/FAT/ff.c **** 				if (disk_write(fs->pdrv, fp->buf, fp->sect, 1) != RES_OK) ABORT(fs, FR_DISK_ERR);
4578:Core/Src/FAT/ff.c **** 				fp->flag &= (BYTE)~FA_DIRTY;
4579:Core/Src/FAT/ff.c **** 			}
4580:Core/Src/FAT/ff.c **** #endif
4581:Core/Src/FAT/ff.c **** 			if (disk_read(fs->pdrv, fp->buf, nsect, 1) != RES_OK) ABORT(fs, FR_DISK_ERR);	/* Fill sector cac
4582:Core/Src/FAT/ff.c **** #endif
4583:Core/Src/FAT/ff.c **** 			fp->sect = nsect;
4584:Core/Src/FAT/ff.c **** 		}
4585:Core/Src/FAT/ff.c **** 	}
4586:Core/Src/FAT/ff.c **** 
4587:Core/Src/FAT/ff.c **** 	LEAVE_FF(fs, res);
4588:Core/Src/FAT/ff.c **** }
4589:Core/Src/FAT/ff.c **** 
4590:Core/Src/FAT/ff.c **** 
4591:Core/Src/FAT/ff.c **** 
4592:Core/Src/FAT/ff.c **** #if FF_FS_MINIMIZE <= 1
4593:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
4594:Core/Src/FAT/ff.c **** /* Create a Directory Object                                             */
4595:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
4596:Core/Src/FAT/ff.c **** 
4597:Core/Src/FAT/ff.c **** FRESULT f_opendir (
4598:Core/Src/FAT/ff.c **** 	DIR* dp,			/* Pointer to directory object to create */
4599:Core/Src/FAT/ff.c **** 	const TCHAR* path	/* Pointer to the directory path */
4600:Core/Src/FAT/ff.c **** )
4601:Core/Src/FAT/ff.c **** {
4602:Core/Src/FAT/ff.c **** 	FRESULT res;
4603:Core/Src/FAT/ff.c **** 	FATFS *fs;
4604:Core/Src/FAT/ff.c **** 	DEF_NAMBUF
4605:Core/Src/FAT/ff.c **** 
4606:Core/Src/FAT/ff.c **** 
4607:Core/Src/FAT/ff.c **** 	if (!dp) return FR_INVALID_OBJECT;
4608:Core/Src/FAT/ff.c **** 
4609:Core/Src/FAT/ff.c **** 	/* Get logical drive */
4610:Core/Src/FAT/ff.c **** 	res = mount_volume(&path, &fs, 0);
4611:Core/Src/FAT/ff.c **** 	if (res == FR_OK) {
4612:Core/Src/FAT/ff.c **** 		dp->obj.fs = fs;
4613:Core/Src/FAT/ff.c **** 		INIT_NAMBUF(fs);
4614:Core/Src/FAT/ff.c **** 		res = follow_path(dp, path);			/* Follow the path to the directory */
4615:Core/Src/FAT/ff.c **** 		if (res == FR_OK) {						/* Follow completed */
4616:Core/Src/FAT/ff.c **** 			if (!(dp->fn[NSFLAG] & NS_NONAME)) {	/* It is not the origin directory itself */
4617:Core/Src/FAT/ff.c **** 				if (dp->obj.attr & AM_DIR) {		/* This object is a sub-directory */
4618:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT
4619:Core/Src/FAT/ff.c **** 					if (fs->fs_type == FS_EXFAT) {
4620:Core/Src/FAT/ff.c **** 						dp->obj.c_scl = dp->obj.sclust;	/* Get containing directory inforamation */
4621:Core/Src/FAT/ff.c **** 						dp->obj.c_size = ((DWORD)dp->obj.objsize & 0xFFFFFF00) | dp->obj.stat;
4622:Core/Src/FAT/ff.c **** 						dp->obj.c_ofs = dp->blk_ofs;
4623:Core/Src/FAT/ff.c **** 						init_alloc_info(fs, &dp->obj);	/* Get object allocation info */
4624:Core/Src/FAT/ff.c **** 					} else
4625:Core/Src/FAT/ff.c **** #endif
4626:Core/Src/FAT/ff.c **** 					{
4627:Core/Src/FAT/ff.c **** 						dp->obj.sclust = ld_clust(fs, dp->dir);	/* Get object allocation info */
4628:Core/Src/FAT/ff.c **** 					}
4629:Core/Src/FAT/ff.c **** 				} else {						/* This object is a file */
4630:Core/Src/FAT/ff.c **** 					res = FR_NO_PATH;
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 184


4631:Core/Src/FAT/ff.c **** 				}
4632:Core/Src/FAT/ff.c **** 			}
4633:Core/Src/FAT/ff.c **** 			if (res == FR_OK) {
4634:Core/Src/FAT/ff.c **** 				dp->obj.id = fs->id;
4635:Core/Src/FAT/ff.c **** 				res = dir_sdi(dp, 0);			/* Rewind directory */
4636:Core/Src/FAT/ff.c **** #if FF_FS_LOCK
4637:Core/Src/FAT/ff.c **** 				if (res == FR_OK) {
4638:Core/Src/FAT/ff.c **** 					if (dp->obj.sclust != 0) {
4639:Core/Src/FAT/ff.c **** 						dp->obj.lockid = inc_share(dp, 0);	/* Lock the sub directory */
4640:Core/Src/FAT/ff.c **** 						if (!dp->obj.lockid) res = FR_TOO_MANY_OPEN_FILES;
4641:Core/Src/FAT/ff.c **** 					} else {
4642:Core/Src/FAT/ff.c **** 						dp->obj.lockid = 0;	/* Root directory need not to be locked */
4643:Core/Src/FAT/ff.c **** 					}
4644:Core/Src/FAT/ff.c **** 				}
4645:Core/Src/FAT/ff.c **** #endif
4646:Core/Src/FAT/ff.c **** 			}
4647:Core/Src/FAT/ff.c **** 		}
4648:Core/Src/FAT/ff.c **** 		FREE_NAMBUF();
4649:Core/Src/FAT/ff.c **** 		if (res == FR_NO_FILE) res = FR_NO_PATH;
4650:Core/Src/FAT/ff.c **** 	}
4651:Core/Src/FAT/ff.c **** 	if (res != FR_OK) dp->obj.fs = 0;		/* Invalidate the directory object if function failed */
4652:Core/Src/FAT/ff.c **** 
4653:Core/Src/FAT/ff.c **** 	LEAVE_FF(fs, res);
4654:Core/Src/FAT/ff.c **** }
4655:Core/Src/FAT/ff.c **** 
4656:Core/Src/FAT/ff.c **** 
4657:Core/Src/FAT/ff.c **** 
4658:Core/Src/FAT/ff.c **** 
4659:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
4660:Core/Src/FAT/ff.c **** /* Close Directory                                                       */
4661:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
4662:Core/Src/FAT/ff.c **** 
4663:Core/Src/FAT/ff.c **** FRESULT f_closedir (
4664:Core/Src/FAT/ff.c **** 	DIR *dp		/* Pointer to the directory object to be closed */
4665:Core/Src/FAT/ff.c **** )
4666:Core/Src/FAT/ff.c **** {
4667:Core/Src/FAT/ff.c **** 	FRESULT res;
4668:Core/Src/FAT/ff.c **** 	FATFS *fs;
4669:Core/Src/FAT/ff.c **** 
4670:Core/Src/FAT/ff.c **** 
4671:Core/Src/FAT/ff.c **** 	res = validate(&dp->obj, &fs);	/* Check validity of the file object */
4672:Core/Src/FAT/ff.c **** 	if (res == FR_OK) {
4673:Core/Src/FAT/ff.c **** #if FF_FS_LOCK
4674:Core/Src/FAT/ff.c **** 		if (dp->obj.lockid) res = dec_share(dp->obj.lockid);	/* Decrement sub-directory open counter */
4675:Core/Src/FAT/ff.c **** 		if (res == FR_OK) dp->obj.fs = 0;	/* Invalidate directory object */
4676:Core/Src/FAT/ff.c **** #else
4677:Core/Src/FAT/ff.c **** 		dp->obj.fs = 0;	/* Invalidate directory object */
4678:Core/Src/FAT/ff.c **** #endif
4679:Core/Src/FAT/ff.c **** #if FF_FS_REENTRANT
4680:Core/Src/FAT/ff.c **** 		unlock_volume(fs, FR_OK);	/* Unlock volume */
4681:Core/Src/FAT/ff.c **** #endif
4682:Core/Src/FAT/ff.c **** 	}
4683:Core/Src/FAT/ff.c **** 	return res;
4684:Core/Src/FAT/ff.c **** }
4685:Core/Src/FAT/ff.c **** 
4686:Core/Src/FAT/ff.c **** 
4687:Core/Src/FAT/ff.c **** 
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 185


4688:Core/Src/FAT/ff.c **** 
4689:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
4690:Core/Src/FAT/ff.c **** /* Read Directory Entries in Sequence                                    */
4691:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
4692:Core/Src/FAT/ff.c **** 
4693:Core/Src/FAT/ff.c **** FRESULT f_readdir (
4694:Core/Src/FAT/ff.c **** 	DIR* dp,			/* Pointer to the open directory object */
4695:Core/Src/FAT/ff.c **** 	FILINFO* fno		/* Pointer to file information to return */
4696:Core/Src/FAT/ff.c **** )
4697:Core/Src/FAT/ff.c **** {
4698:Core/Src/FAT/ff.c **** 	FRESULT res;
4699:Core/Src/FAT/ff.c **** 	FATFS *fs;
4700:Core/Src/FAT/ff.c **** 	DEF_NAMBUF
4701:Core/Src/FAT/ff.c **** 
4702:Core/Src/FAT/ff.c **** 
4703:Core/Src/FAT/ff.c **** 	res = validate(&dp->obj, &fs);	/* Check validity of the directory object */
4704:Core/Src/FAT/ff.c **** 	if (res == FR_OK) {
4705:Core/Src/FAT/ff.c **** 		if (!fno) {
4706:Core/Src/FAT/ff.c **** 			res = dir_sdi(dp, 0);		/* Rewind the directory object */
4707:Core/Src/FAT/ff.c **** 		} else {
4708:Core/Src/FAT/ff.c **** 			INIT_NAMBUF(fs);
4709:Core/Src/FAT/ff.c **** 			res = DIR_READ_FILE(dp);		/* Read an item */
4710:Core/Src/FAT/ff.c **** 			if (res == FR_NO_FILE) res = FR_OK;	/* Ignore end of directory */
4711:Core/Src/FAT/ff.c **** 			if (res == FR_OK) {				/* A valid entry is found */
4712:Core/Src/FAT/ff.c **** 				get_fileinfo(dp, fno);		/* Get the object information */
4713:Core/Src/FAT/ff.c **** 				res = dir_next(dp, 0);		/* Increment index for next */
4714:Core/Src/FAT/ff.c **** 				if (res == FR_NO_FILE) res = FR_OK;	/* Ignore end of directory now */
4715:Core/Src/FAT/ff.c **** 			}
4716:Core/Src/FAT/ff.c **** 			FREE_NAMBUF();
4717:Core/Src/FAT/ff.c **** 		}
4718:Core/Src/FAT/ff.c **** 	}
4719:Core/Src/FAT/ff.c **** 	LEAVE_FF(fs, res);
4720:Core/Src/FAT/ff.c **** }
4721:Core/Src/FAT/ff.c **** 
4722:Core/Src/FAT/ff.c **** 
4723:Core/Src/FAT/ff.c **** 
4724:Core/Src/FAT/ff.c **** #if FF_USE_FIND
4725:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
4726:Core/Src/FAT/ff.c **** /* Find Next File                                                        */
4727:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
4728:Core/Src/FAT/ff.c **** 
4729:Core/Src/FAT/ff.c **** FRESULT f_findnext (
4730:Core/Src/FAT/ff.c **** 	DIR* dp,		/* Pointer to the open directory object */
4731:Core/Src/FAT/ff.c **** 	FILINFO* fno	/* Pointer to the file information structure */
4732:Core/Src/FAT/ff.c **** )
4733:Core/Src/FAT/ff.c **** {
4734:Core/Src/FAT/ff.c **** 	FRESULT res;
4735:Core/Src/FAT/ff.c **** 
4736:Core/Src/FAT/ff.c **** 
4737:Core/Src/FAT/ff.c **** 	for (;;) {
4738:Core/Src/FAT/ff.c **** 		res = f_readdir(dp, fno);		/* Get a directory item */
4739:Core/Src/FAT/ff.c **** 		if (res != FR_OK || !fno || !fno->fname[0]) break;	/* Terminate if any error or end of directory 
4740:Core/Src/FAT/ff.c **** 		if (pattern_match(dp->pat, fno->fname, 0, FIND_RECURS)) break;		/* Test for the file name */
4741:Core/Src/FAT/ff.c **** #if FF_USE_LFN && FF_USE_FIND == 2
4742:Core/Src/FAT/ff.c **** 		if (pattern_match(dp->pat, fno->altname, 0, FIND_RECURS)) break;	/* Test for alternative name if 
4743:Core/Src/FAT/ff.c **** #endif
4744:Core/Src/FAT/ff.c **** 	}
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 186


4745:Core/Src/FAT/ff.c **** 	return res;
4746:Core/Src/FAT/ff.c **** }
4747:Core/Src/FAT/ff.c **** 
4748:Core/Src/FAT/ff.c **** 
4749:Core/Src/FAT/ff.c **** 
4750:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
4751:Core/Src/FAT/ff.c **** /* Find First File                                                       */
4752:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
4753:Core/Src/FAT/ff.c **** 
4754:Core/Src/FAT/ff.c **** FRESULT f_findfirst (
4755:Core/Src/FAT/ff.c **** 	DIR* dp,				/* Pointer to the blank directory object */
4756:Core/Src/FAT/ff.c **** 	FILINFO* fno,			/* Pointer to the file information structure */
4757:Core/Src/FAT/ff.c **** 	const TCHAR* path,		/* Pointer to the directory to open */
4758:Core/Src/FAT/ff.c **** 	const TCHAR* pattern	/* Pointer to the matching pattern */
4759:Core/Src/FAT/ff.c **** )
4760:Core/Src/FAT/ff.c **** {
4761:Core/Src/FAT/ff.c **** 	FRESULT res;
4762:Core/Src/FAT/ff.c **** 
4763:Core/Src/FAT/ff.c **** 
4764:Core/Src/FAT/ff.c **** 	dp->pat = pattern;		/* Save pointer to pattern string */
4765:Core/Src/FAT/ff.c **** 	res = f_opendir(dp, path);		/* Open the target directory */
4766:Core/Src/FAT/ff.c **** 	if (res == FR_OK) {
4767:Core/Src/FAT/ff.c **** 		res = f_findnext(dp, fno);	/* Find the first item */
4768:Core/Src/FAT/ff.c **** 	}
4769:Core/Src/FAT/ff.c **** 	return res;
4770:Core/Src/FAT/ff.c **** }
4771:Core/Src/FAT/ff.c **** 
4772:Core/Src/FAT/ff.c **** #endif	/* FF_USE_FIND */
4773:Core/Src/FAT/ff.c **** 
4774:Core/Src/FAT/ff.c **** 
4775:Core/Src/FAT/ff.c **** 
4776:Core/Src/FAT/ff.c **** #if FF_FS_MINIMIZE == 0
4777:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
4778:Core/Src/FAT/ff.c **** /* Get File Status                                                       */
4779:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
4780:Core/Src/FAT/ff.c **** 
4781:Core/Src/FAT/ff.c **** FRESULT f_stat (
4782:Core/Src/FAT/ff.c **** 	const TCHAR* path,	/* Pointer to the file path */
4783:Core/Src/FAT/ff.c **** 	FILINFO* fno		/* Pointer to file information to return */
4784:Core/Src/FAT/ff.c **** )
4785:Core/Src/FAT/ff.c **** {
4786:Core/Src/FAT/ff.c **** 	FRESULT res;
4787:Core/Src/FAT/ff.c **** 	DIR dj;
4788:Core/Src/FAT/ff.c **** 	DEF_NAMBUF
4789:Core/Src/FAT/ff.c **** 
4790:Core/Src/FAT/ff.c **** 
4791:Core/Src/FAT/ff.c **** 	/* Get logical drive */
4792:Core/Src/FAT/ff.c **** 	res = mount_volume(&path, &dj.obj.fs, 0);
4793:Core/Src/FAT/ff.c **** 	if (res == FR_OK) {
4794:Core/Src/FAT/ff.c **** 		INIT_NAMBUF(dj.obj.fs);
4795:Core/Src/FAT/ff.c **** 		res = follow_path(&dj, path);	/* Follow the file path */
4796:Core/Src/FAT/ff.c **** 		if (res == FR_OK) {				/* Follow completed */
4797:Core/Src/FAT/ff.c **** 			if (dj.fn[NSFLAG] & NS_NONAME) {	/* It is origin directory */
4798:Core/Src/FAT/ff.c **** 				res = FR_INVALID_NAME;
4799:Core/Src/FAT/ff.c **** 			} else {							/* Found an object */
4800:Core/Src/FAT/ff.c **** 				if (fno) get_fileinfo(&dj, fno);
4801:Core/Src/FAT/ff.c **** 			}
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 187


4802:Core/Src/FAT/ff.c **** 		}
4803:Core/Src/FAT/ff.c **** 		FREE_NAMBUF();
4804:Core/Src/FAT/ff.c **** 	}
4805:Core/Src/FAT/ff.c **** 
4806:Core/Src/FAT/ff.c **** 	LEAVE_FF(dj.obj.fs, res);
4807:Core/Src/FAT/ff.c **** }
4808:Core/Src/FAT/ff.c **** 
4809:Core/Src/FAT/ff.c **** 
4810:Core/Src/FAT/ff.c **** 
4811:Core/Src/FAT/ff.c **** #if !FF_FS_READONLY
4812:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
4813:Core/Src/FAT/ff.c **** /* Get Number of Free Clusters                                           */
4814:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
4815:Core/Src/FAT/ff.c **** 
4816:Core/Src/FAT/ff.c **** FRESULT f_getfree (
4817:Core/Src/FAT/ff.c **** 	const TCHAR* path,	/* Logical drive number */
4818:Core/Src/FAT/ff.c **** 	DWORD* nclst,		/* Pointer to a variable to return number of free clusters */
4819:Core/Src/FAT/ff.c **** 	FATFS** fatfs		/* Pointer to return pointer to corresponding filesystem object */
4820:Core/Src/FAT/ff.c **** )
4821:Core/Src/FAT/ff.c **** {
4822:Core/Src/FAT/ff.c **** 	FRESULT res;
4823:Core/Src/FAT/ff.c **** 	FATFS *fs;
4824:Core/Src/FAT/ff.c **** 	DWORD nfree, clst, stat;
4825:Core/Src/FAT/ff.c **** 	LBA_t sect;
4826:Core/Src/FAT/ff.c **** 	UINT i;
4827:Core/Src/FAT/ff.c **** 	FFOBJID obj;
4828:Core/Src/FAT/ff.c **** 
4829:Core/Src/FAT/ff.c **** 
4830:Core/Src/FAT/ff.c **** 	/* Get logical drive */
4831:Core/Src/FAT/ff.c **** 	res = mount_volume(&path, &fs, 0);
4832:Core/Src/FAT/ff.c **** 	if (res == FR_OK) {
4833:Core/Src/FAT/ff.c **** 		*fatfs = fs;				/* Return ptr to the fs object */
4834:Core/Src/FAT/ff.c **** 		/* If free_clst is valid, return it without full FAT scan */
4835:Core/Src/FAT/ff.c **** 		if (fs->free_clst <= fs->n_fatent - 2) {
4836:Core/Src/FAT/ff.c **** 			*nclst = fs->free_clst;
4837:Core/Src/FAT/ff.c **** 		} else {
4838:Core/Src/FAT/ff.c **** 			/* Scan FAT to obtain number of free clusters */
4839:Core/Src/FAT/ff.c **** 			nfree = 0;
4840:Core/Src/FAT/ff.c **** 			if (fs->fs_type == FS_FAT12) {	/* FAT12: Scan bit field FAT entries */
4841:Core/Src/FAT/ff.c **** 				clst = 2; obj.fs = fs;
4842:Core/Src/FAT/ff.c **** 				do {
4843:Core/Src/FAT/ff.c **** 					stat = get_fat(&obj, clst);
4844:Core/Src/FAT/ff.c **** 					if (stat == 0xFFFFFFFF) {
4845:Core/Src/FAT/ff.c **** 						res = FR_DISK_ERR; break;
4846:Core/Src/FAT/ff.c **** 					}
4847:Core/Src/FAT/ff.c **** 					if (stat == 1) {
4848:Core/Src/FAT/ff.c **** 						res = FR_INT_ERR; break;
4849:Core/Src/FAT/ff.c **** 					}
4850:Core/Src/FAT/ff.c **** 					if (stat == 0) nfree++;
4851:Core/Src/FAT/ff.c **** 				} while (++clst < fs->n_fatent);
4852:Core/Src/FAT/ff.c **** 			} else {
4853:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT
4854:Core/Src/FAT/ff.c **** 				if (fs->fs_type == FS_EXFAT) {	/* exFAT: Scan allocation bitmap */
4855:Core/Src/FAT/ff.c **** 					BYTE bm;
4856:Core/Src/FAT/ff.c **** 					UINT b;
4857:Core/Src/FAT/ff.c **** 
4858:Core/Src/FAT/ff.c **** 					clst = fs->n_fatent - 2;	/* Number of clusters */
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 188


4859:Core/Src/FAT/ff.c **** 					sect = fs->bitbase;			/* Bitmap sector */
4860:Core/Src/FAT/ff.c **** 					i = 0;						/* Offset in the sector */
4861:Core/Src/FAT/ff.c **** 					do {	/* Counts numbuer of bits with zero in the bitmap */
4862:Core/Src/FAT/ff.c **** 						if (i == 0) {	/* New sector? */
4863:Core/Src/FAT/ff.c **** 							res = move_window(fs, sect++);
4864:Core/Src/FAT/ff.c **** 							if (res != FR_OK) break;
4865:Core/Src/FAT/ff.c **** 						}
4866:Core/Src/FAT/ff.c **** 						for (b = 8, bm = ~fs->win[i]; b && clst; b--, clst--) {
4867:Core/Src/FAT/ff.c **** 							nfree += bm & 1;
4868:Core/Src/FAT/ff.c **** 							bm >>= 1;
4869:Core/Src/FAT/ff.c **** 						}
4870:Core/Src/FAT/ff.c **** 						i = (i + 1) % SS(fs);
4871:Core/Src/FAT/ff.c **** 					} while (clst);
4872:Core/Src/FAT/ff.c **** 				} else
4873:Core/Src/FAT/ff.c **** #endif
4874:Core/Src/FAT/ff.c **** 				{	/* FAT16/32: Scan WORD/DWORD FAT entries */
4875:Core/Src/FAT/ff.c **** 					clst = fs->n_fatent;	/* Number of entries */
4876:Core/Src/FAT/ff.c **** 					sect = fs->fatbase;		/* Top of the FAT */
4877:Core/Src/FAT/ff.c **** 					i = 0;					/* Offset in the sector */
4878:Core/Src/FAT/ff.c **** 					do {	/* Counts numbuer of entries with zero in the FAT */
4879:Core/Src/FAT/ff.c **** 						if (i == 0) {	/* New sector? */
4880:Core/Src/FAT/ff.c **** 							res = move_window(fs, sect++);
4881:Core/Src/FAT/ff.c **** 							if (res != FR_OK) break;
4882:Core/Src/FAT/ff.c **** 						}
4883:Core/Src/FAT/ff.c **** 						if (fs->fs_type == FS_FAT16) {
4884:Core/Src/FAT/ff.c **** 							if (ld_word(fs->win + i) == 0) nfree++;
4885:Core/Src/FAT/ff.c **** 							i += 2;
4886:Core/Src/FAT/ff.c **** 						} else {
4887:Core/Src/FAT/ff.c **** 							if ((ld_dword(fs->win + i) & 0x0FFFFFFF) == 0) nfree++;
4888:Core/Src/FAT/ff.c **** 							i += 4;
4889:Core/Src/FAT/ff.c **** 						}
4890:Core/Src/FAT/ff.c **** 						i %= SS(fs);
4891:Core/Src/FAT/ff.c **** 					} while (--clst);
4892:Core/Src/FAT/ff.c **** 				}
4893:Core/Src/FAT/ff.c **** 			}
4894:Core/Src/FAT/ff.c **** 			if (res == FR_OK) {		/* Update parameters if succeeded */
4895:Core/Src/FAT/ff.c **** 				*nclst = nfree;			/* Return the free clusters */
4896:Core/Src/FAT/ff.c **** 				fs->free_clst = nfree;	/* Now free_clst is valid */
4897:Core/Src/FAT/ff.c **** 				fs->fsi_flag |= 1;		/* FAT32: FSInfo is to be updated */
4898:Core/Src/FAT/ff.c **** 			}
4899:Core/Src/FAT/ff.c **** 		}
4900:Core/Src/FAT/ff.c **** 	}
4901:Core/Src/FAT/ff.c **** 
4902:Core/Src/FAT/ff.c **** 	LEAVE_FF(fs, res);
4903:Core/Src/FAT/ff.c **** }
4904:Core/Src/FAT/ff.c **** 
4905:Core/Src/FAT/ff.c **** 
4906:Core/Src/FAT/ff.c **** 
4907:Core/Src/FAT/ff.c **** 
4908:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
4909:Core/Src/FAT/ff.c **** /* Truncate File                                                         */
4910:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
4911:Core/Src/FAT/ff.c **** 
4912:Core/Src/FAT/ff.c **** FRESULT f_truncate (
4913:Core/Src/FAT/ff.c **** 	FIL* fp		/* Pointer to the file object */
4914:Core/Src/FAT/ff.c **** )
4915:Core/Src/FAT/ff.c **** {
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 189


4916:Core/Src/FAT/ff.c **** 	FRESULT res;
4917:Core/Src/FAT/ff.c **** 	FATFS *fs;
4918:Core/Src/FAT/ff.c **** 	DWORD ncl;
4919:Core/Src/FAT/ff.c **** 
4920:Core/Src/FAT/ff.c **** 
4921:Core/Src/FAT/ff.c **** 	res = validate(&fp->obj, &fs);	/* Check validity of the file object */
4922:Core/Src/FAT/ff.c **** 	if (res != FR_OK || (res = (FRESULT)fp->err) != FR_OK) LEAVE_FF(fs, res);
4923:Core/Src/FAT/ff.c **** 	if (!(fp->flag & FA_WRITE)) LEAVE_FF(fs, FR_DENIED);	/* Check access mode */
4924:Core/Src/FAT/ff.c **** 
4925:Core/Src/FAT/ff.c **** 	if (fp->fptr < fp->obj.objsize) {	/* Process when fptr is not on the eof */
4926:Core/Src/FAT/ff.c **** 		if (fp->fptr == 0) {	/* When set file size to zero, remove entire cluster chain */
4927:Core/Src/FAT/ff.c **** 			res = remove_chain(&fp->obj, fp->obj.sclust, 0);
4928:Core/Src/FAT/ff.c **** 			fp->obj.sclust = 0;
4929:Core/Src/FAT/ff.c **** 		} else {				/* When truncate a part of the file, remove remaining clusters */
4930:Core/Src/FAT/ff.c **** 			ncl = get_fat(&fp->obj, fp->clust);
4931:Core/Src/FAT/ff.c **** 			res = FR_OK;
4932:Core/Src/FAT/ff.c **** 			if (ncl == 0xFFFFFFFF) res = FR_DISK_ERR;
4933:Core/Src/FAT/ff.c **** 			if (ncl == 1) res = FR_INT_ERR;
4934:Core/Src/FAT/ff.c **** 			if (res == FR_OK && ncl < fs->n_fatent) {
4935:Core/Src/FAT/ff.c **** 				res = remove_chain(&fp->obj, ncl, fp->clust);
4936:Core/Src/FAT/ff.c **** 			}
4937:Core/Src/FAT/ff.c **** 		}
4938:Core/Src/FAT/ff.c **** 		fp->obj.objsize = fp->fptr;	/* Set file size to current read/write point */
4939:Core/Src/FAT/ff.c **** 		fp->flag |= FA_MODIFIED;
4940:Core/Src/FAT/ff.c **** #if !FF_FS_TINY
4941:Core/Src/FAT/ff.c **** 		if (res == FR_OK && (fp->flag & FA_DIRTY)) {
4942:Core/Src/FAT/ff.c **** 			if (disk_write(fs->pdrv, fp->buf, fp->sect, 1) != RES_OK) {
4943:Core/Src/FAT/ff.c **** 				res = FR_DISK_ERR;
4944:Core/Src/FAT/ff.c **** 			} else {
4945:Core/Src/FAT/ff.c **** 				fp->flag &= (BYTE)~FA_DIRTY;
4946:Core/Src/FAT/ff.c **** 			}
4947:Core/Src/FAT/ff.c **** 		}
4948:Core/Src/FAT/ff.c **** #endif
4949:Core/Src/FAT/ff.c **** 		if (res != FR_OK) ABORT(fs, res);
4950:Core/Src/FAT/ff.c **** 	}
4951:Core/Src/FAT/ff.c **** 
4952:Core/Src/FAT/ff.c **** 	LEAVE_FF(fs, res);
4953:Core/Src/FAT/ff.c **** }
4954:Core/Src/FAT/ff.c **** 
4955:Core/Src/FAT/ff.c **** 
4956:Core/Src/FAT/ff.c **** 
4957:Core/Src/FAT/ff.c **** 
4958:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
4959:Core/Src/FAT/ff.c **** /* Delete a File/Directory                                               */
4960:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
4961:Core/Src/FAT/ff.c **** 
4962:Core/Src/FAT/ff.c **** FRESULT f_unlink (
4963:Core/Src/FAT/ff.c **** 	const TCHAR* path		/* Pointer to the file or directory path */
4964:Core/Src/FAT/ff.c **** )
4965:Core/Src/FAT/ff.c **** {
4966:Core/Src/FAT/ff.c **** 	FRESULT res;
4967:Core/Src/FAT/ff.c **** 	FATFS *fs;
4968:Core/Src/FAT/ff.c **** 	DIR dj, sdj;
4969:Core/Src/FAT/ff.c **** 	DWORD dclst = 0;
4970:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT
4971:Core/Src/FAT/ff.c **** 	FFOBJID obj;
4972:Core/Src/FAT/ff.c **** #endif
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 190


4973:Core/Src/FAT/ff.c **** 	DEF_NAMBUF
4974:Core/Src/FAT/ff.c **** 
4975:Core/Src/FAT/ff.c **** 
4976:Core/Src/FAT/ff.c **** 	/* Get logical drive */
4977:Core/Src/FAT/ff.c **** 	res = mount_volume(&path, &fs, FA_WRITE);
4978:Core/Src/FAT/ff.c **** 	if (res == FR_OK) {
4979:Core/Src/FAT/ff.c **** 		dj.obj.fs = fs;
4980:Core/Src/FAT/ff.c **** 		INIT_NAMBUF(fs);
4981:Core/Src/FAT/ff.c **** 		res = follow_path(&dj, path);		/* Follow the file path */
4982:Core/Src/FAT/ff.c **** 		if (FF_FS_RPATH && res == FR_OK && (dj.fn[NSFLAG] & NS_DOT)) {
4983:Core/Src/FAT/ff.c **** 			res = FR_INVALID_NAME;			/* Cannot remove dot entry */
4984:Core/Src/FAT/ff.c **** 		}
4985:Core/Src/FAT/ff.c **** #if FF_FS_LOCK
4986:Core/Src/FAT/ff.c **** 		if (res == FR_OK) res = chk_share(&dj, 2);	/* Check if it is an open object */
4987:Core/Src/FAT/ff.c **** #endif
4988:Core/Src/FAT/ff.c **** 		if (res == FR_OK) {					/* The object is accessible */
4989:Core/Src/FAT/ff.c **** 			if (dj.fn[NSFLAG] & NS_NONAME) {
4990:Core/Src/FAT/ff.c **** 				res = FR_INVALID_NAME;		/* Cannot remove the origin directory */
4991:Core/Src/FAT/ff.c **** 			} else {
4992:Core/Src/FAT/ff.c **** 				if (dj.obj.attr & AM_RDO) {
4993:Core/Src/FAT/ff.c **** 					res = FR_DENIED;		/* Cannot remove R/O object */
4994:Core/Src/FAT/ff.c **** 				}
4995:Core/Src/FAT/ff.c **** 			}
4996:Core/Src/FAT/ff.c **** 			if (res == FR_OK) {
4997:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT
4998:Core/Src/FAT/ff.c **** 				obj.fs = fs;
4999:Core/Src/FAT/ff.c **** 				if (fs->fs_type == FS_EXFAT) {
5000:Core/Src/FAT/ff.c **** 					init_alloc_info(fs, &obj);
5001:Core/Src/FAT/ff.c **** 					dclst = obj.sclust;
5002:Core/Src/FAT/ff.c **** 				} else
5003:Core/Src/FAT/ff.c **** #endif
5004:Core/Src/FAT/ff.c **** 				{
5005:Core/Src/FAT/ff.c **** 					dclst = ld_clust(fs, dj.dir);
5006:Core/Src/FAT/ff.c **** 				}
5007:Core/Src/FAT/ff.c **** 				if (dj.obj.attr & AM_DIR) {			/* Is it a sub-directory? */
5008:Core/Src/FAT/ff.c **** #if FF_FS_RPATH != 0
5009:Core/Src/FAT/ff.c **** 					if (dclst == fs->cdir) {	 	/* Is it the current directory? */
5010:Core/Src/FAT/ff.c **** 						res = FR_DENIED;
5011:Core/Src/FAT/ff.c **** 					} else
5012:Core/Src/FAT/ff.c **** #endif
5013:Core/Src/FAT/ff.c **** 					{
5014:Core/Src/FAT/ff.c **** 						sdj.obj.fs = fs;			/* Open the sub-directory */
5015:Core/Src/FAT/ff.c **** 						sdj.obj.sclust = dclst;
5016:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT
5017:Core/Src/FAT/ff.c **** 						if (fs->fs_type == FS_EXFAT) {
5018:Core/Src/FAT/ff.c **** 							sdj.obj.objsize = obj.objsize;
5019:Core/Src/FAT/ff.c **** 							sdj.obj.stat = obj.stat;
5020:Core/Src/FAT/ff.c **** 						}
5021:Core/Src/FAT/ff.c **** #endif
5022:Core/Src/FAT/ff.c **** 						res = dir_sdi(&sdj, 0);
5023:Core/Src/FAT/ff.c **** 						if (res == FR_OK) {
5024:Core/Src/FAT/ff.c **** 							res = DIR_READ_FILE(&sdj);			/* Test if the directory is empty */
5025:Core/Src/FAT/ff.c **** 							if (res == FR_OK) res = FR_DENIED;	/* Not empty? */
5026:Core/Src/FAT/ff.c **** 							if (res == FR_NO_FILE) res = FR_OK;	/* Empty? */
5027:Core/Src/FAT/ff.c **** 						}
5028:Core/Src/FAT/ff.c **** 					}
5029:Core/Src/FAT/ff.c **** 				}
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 191


5030:Core/Src/FAT/ff.c **** 			}
5031:Core/Src/FAT/ff.c **** 			if (res == FR_OK) {
5032:Core/Src/FAT/ff.c **** 				res = dir_remove(&dj);			/* Remove the directory entry */
5033:Core/Src/FAT/ff.c **** 				if (res == FR_OK && dclst != 0) {	/* Remove the cluster chain if exist */
5034:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT
5035:Core/Src/FAT/ff.c **** 					res = remove_chain(&obj, dclst, 0);
5036:Core/Src/FAT/ff.c **** #else
5037:Core/Src/FAT/ff.c **** 					res = remove_chain(&dj.obj, dclst, 0);
5038:Core/Src/FAT/ff.c **** #endif
5039:Core/Src/FAT/ff.c **** 				}
5040:Core/Src/FAT/ff.c **** 				if (res == FR_OK) res = sync_fs(fs);
5041:Core/Src/FAT/ff.c **** 			}
5042:Core/Src/FAT/ff.c **** 		}
5043:Core/Src/FAT/ff.c **** 		FREE_NAMBUF();
5044:Core/Src/FAT/ff.c **** 	}
5045:Core/Src/FAT/ff.c **** 
5046:Core/Src/FAT/ff.c **** 	LEAVE_FF(fs, res);
5047:Core/Src/FAT/ff.c **** }
5048:Core/Src/FAT/ff.c **** 
5049:Core/Src/FAT/ff.c **** 
5050:Core/Src/FAT/ff.c **** 
5051:Core/Src/FAT/ff.c **** 
5052:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
5053:Core/Src/FAT/ff.c **** /* Create a Directory                                                    */
5054:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
5055:Core/Src/FAT/ff.c **** 
5056:Core/Src/FAT/ff.c **** FRESULT f_mkdir (
5057:Core/Src/FAT/ff.c **** 	const TCHAR* path		/* Pointer to the directory path */
5058:Core/Src/FAT/ff.c **** )
5059:Core/Src/FAT/ff.c **** {
5060:Core/Src/FAT/ff.c **** 	FRESULT res;
5061:Core/Src/FAT/ff.c **** 	FATFS *fs;
5062:Core/Src/FAT/ff.c **** 	DIR dj;
5063:Core/Src/FAT/ff.c **** 	FFOBJID sobj;
5064:Core/Src/FAT/ff.c **** 	DWORD dcl, pcl, tm;
5065:Core/Src/FAT/ff.c **** 	DEF_NAMBUF
5066:Core/Src/FAT/ff.c **** 
5067:Core/Src/FAT/ff.c **** 
5068:Core/Src/FAT/ff.c **** 	res = mount_volume(&path, &fs, FA_WRITE);	/* Get logical drive */
5069:Core/Src/FAT/ff.c **** 	if (res == FR_OK) {
5070:Core/Src/FAT/ff.c **** 		dj.obj.fs = fs;
5071:Core/Src/FAT/ff.c **** 		INIT_NAMBUF(fs);
5072:Core/Src/FAT/ff.c **** 		res = follow_path(&dj, path);			/* Follow the file path */
5073:Core/Src/FAT/ff.c **** 		if (res == FR_OK) res = FR_EXIST;		/* Name collision? */
5074:Core/Src/FAT/ff.c **** 		if (FF_FS_RPATH && res == FR_NO_FILE && (dj.fn[NSFLAG] & NS_DOT)) {	/* Invalid name? */
5075:Core/Src/FAT/ff.c **** 			res = FR_INVALID_NAME;
5076:Core/Src/FAT/ff.c **** 		}
5077:Core/Src/FAT/ff.c **** 		if (res == FR_NO_FILE) {				/* It is clear to create a new directory */
5078:Core/Src/FAT/ff.c **** 			sobj.fs = fs;						/* New object id to create a new chain */
5079:Core/Src/FAT/ff.c **** 			dcl = create_chain(&sobj, 0);		/* Allocate a cluster for the new directory */
5080:Core/Src/FAT/ff.c **** 			res = FR_OK;
5081:Core/Src/FAT/ff.c **** 			if (dcl == 0) res = FR_DENIED;		/* No space to allocate a new cluster? */
5082:Core/Src/FAT/ff.c **** 			if (dcl == 1) res = FR_INT_ERR;		/* Any insanity? */
5083:Core/Src/FAT/ff.c **** 			if (dcl == 0xFFFFFFFF) res = FR_DISK_ERR;	/* Disk error? */
5084:Core/Src/FAT/ff.c **** 			tm = GET_FATTIME();
5085:Core/Src/FAT/ff.c **** 			if (res == FR_OK) {
5086:Core/Src/FAT/ff.c **** 				res = dir_clear(fs, dcl);		/* Clean up the new table */
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 192


5087:Core/Src/FAT/ff.c **** 				if (res == FR_OK) {
5088:Core/Src/FAT/ff.c **** 					if (!FF_FS_EXFAT || fs->fs_type != FS_EXFAT) {	/* Create dot entries (FAT only) */
5089:Core/Src/FAT/ff.c **** 						memset(fs->win + DIR_Name, ' ', 11);	/* Create "." entry */
5090:Core/Src/FAT/ff.c **** 						fs->win[DIR_Name] = '.';
5091:Core/Src/FAT/ff.c **** 						fs->win[DIR_Attr] = AM_DIR;
5092:Core/Src/FAT/ff.c **** 						st_dword(fs->win + DIR_ModTime, tm);
5093:Core/Src/FAT/ff.c **** 						st_clust(fs, fs->win, dcl);
5094:Core/Src/FAT/ff.c **** 						memcpy(fs->win + SZDIRE, fs->win, SZDIRE);	/* Create ".." entry */
5095:Core/Src/FAT/ff.c **** 						fs->win[SZDIRE + 1] = '.'; pcl = dj.obj.sclust;
5096:Core/Src/FAT/ff.c **** 						st_clust(fs, fs->win + SZDIRE, pcl);
5097:Core/Src/FAT/ff.c **** 						fs->wflag = 1;
5098:Core/Src/FAT/ff.c **** 					}
5099:Core/Src/FAT/ff.c **** 					res = dir_register(&dj);	/* Register the object to the parent directoy */
5100:Core/Src/FAT/ff.c **** 				}
5101:Core/Src/FAT/ff.c **** 			}
5102:Core/Src/FAT/ff.c **** 			if (res == FR_OK) {
5103:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT
5104:Core/Src/FAT/ff.c **** 				if (fs->fs_type == FS_EXFAT) {	/* Initialize directory entry block */
5105:Core/Src/FAT/ff.c **** 					st_dword(fs->dirbuf + XDIR_ModTime, tm);	/* Created time */
5106:Core/Src/FAT/ff.c **** 					st_dword(fs->dirbuf + XDIR_FstClus, dcl);	/* Table start cluster */
5107:Core/Src/FAT/ff.c **** 					st_dword(fs->dirbuf + XDIR_FileSize, (DWORD)fs->csize * SS(fs));	/* Directory size needs to be
5108:Core/Src/FAT/ff.c **** 					st_dword(fs->dirbuf + XDIR_ValidFileSize, (DWORD)fs->csize * SS(fs));
5109:Core/Src/FAT/ff.c **** 					fs->dirbuf[XDIR_GenFlags] = 3;				/* Initialize the object flag */
5110:Core/Src/FAT/ff.c **** 					fs->dirbuf[XDIR_Attr] = AM_DIR;				/* Attribute */
5111:Core/Src/FAT/ff.c **** 					res = store_xdir(&dj);
5112:Core/Src/FAT/ff.c **** 				} else
5113:Core/Src/FAT/ff.c **** #endif
5114:Core/Src/FAT/ff.c **** 				{
5115:Core/Src/FAT/ff.c **** 					st_dword(dj.dir + DIR_ModTime, tm);	/* Created time */
5116:Core/Src/FAT/ff.c **** 					st_clust(fs, dj.dir, dcl);			/* Table start cluster */
5117:Core/Src/FAT/ff.c **** 					dj.dir[DIR_Attr] = AM_DIR;			/* Attribute */
5118:Core/Src/FAT/ff.c **** 					fs->wflag = 1;
5119:Core/Src/FAT/ff.c **** 				}
5120:Core/Src/FAT/ff.c **** 				if (res == FR_OK) {
5121:Core/Src/FAT/ff.c **** 					res = sync_fs(fs);
5122:Core/Src/FAT/ff.c **** 				}
5123:Core/Src/FAT/ff.c **** 			} else {
5124:Core/Src/FAT/ff.c **** 				remove_chain(&sobj, dcl, 0);		/* Could not register, remove the allocated cluster */
5125:Core/Src/FAT/ff.c **** 			}
5126:Core/Src/FAT/ff.c **** 		}
5127:Core/Src/FAT/ff.c **** 		FREE_NAMBUF();
5128:Core/Src/FAT/ff.c **** 	}
5129:Core/Src/FAT/ff.c **** 
5130:Core/Src/FAT/ff.c **** 	LEAVE_FF(fs, res);
5131:Core/Src/FAT/ff.c **** }
5132:Core/Src/FAT/ff.c **** 
5133:Core/Src/FAT/ff.c **** 
5134:Core/Src/FAT/ff.c **** 
5135:Core/Src/FAT/ff.c **** 
5136:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
5137:Core/Src/FAT/ff.c **** /* Rename a File/Directory                                               */
5138:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
5139:Core/Src/FAT/ff.c **** 
5140:Core/Src/FAT/ff.c **** FRESULT f_rename (
5141:Core/Src/FAT/ff.c **** 	const TCHAR* path_old,	/* Pointer to the object name to be renamed */
5142:Core/Src/FAT/ff.c **** 	const TCHAR* path_new	/* Pointer to the new name */
5143:Core/Src/FAT/ff.c **** )
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 193


5144:Core/Src/FAT/ff.c **** {
5145:Core/Src/FAT/ff.c **** 	FRESULT res;
5146:Core/Src/FAT/ff.c **** 	FATFS *fs;
5147:Core/Src/FAT/ff.c **** 	DIR djo, djn;
5148:Core/Src/FAT/ff.c **** 	BYTE buf[FF_FS_EXFAT ? SZDIRE * 2 : SZDIRE], *dir;
5149:Core/Src/FAT/ff.c **** 	LBA_t sect;
5150:Core/Src/FAT/ff.c **** 	DEF_NAMBUF
5151:Core/Src/FAT/ff.c **** 
5152:Core/Src/FAT/ff.c **** 
5153:Core/Src/FAT/ff.c **** 	get_ldnumber(&path_new);						/* Snip the drive number of new name off */
5154:Core/Src/FAT/ff.c **** 	res = mount_volume(&path_old, &fs, FA_WRITE);	/* Get logical drive of the old object */
5155:Core/Src/FAT/ff.c **** 	if (res == FR_OK) {
5156:Core/Src/FAT/ff.c **** 		djo.obj.fs = fs;
5157:Core/Src/FAT/ff.c **** 		INIT_NAMBUF(fs);
5158:Core/Src/FAT/ff.c **** 		res = follow_path(&djo, path_old);			/* Check old object */
5159:Core/Src/FAT/ff.c **** 		if (res == FR_OK && (djo.fn[NSFLAG] & (NS_DOT | NS_NONAME))) res = FR_INVALID_NAME;	/* Check vali
5160:Core/Src/FAT/ff.c **** #if FF_FS_LOCK
5161:Core/Src/FAT/ff.c **** 		if (res == FR_OK) {
5162:Core/Src/FAT/ff.c **** 			res = chk_share(&djo, 2);
5163:Core/Src/FAT/ff.c **** 		}
5164:Core/Src/FAT/ff.c **** #endif
5165:Core/Src/FAT/ff.c **** 		if (res == FR_OK) {					/* Object to be renamed is found */
5166:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT
5167:Core/Src/FAT/ff.c **** 			if (fs->fs_type == FS_EXFAT) {	/* At exFAT volume */
5168:Core/Src/FAT/ff.c **** 				BYTE nf, nn;
5169:Core/Src/FAT/ff.c **** 				WORD nh;
5170:Core/Src/FAT/ff.c **** 
5171:Core/Src/FAT/ff.c **** 				memcpy(buf, fs->dirbuf, SZDIRE * 2);	/* Save 85+C0 entry of old object */
5172:Core/Src/FAT/ff.c **** 				memcpy(&djn, &djo, sizeof djo);
5173:Core/Src/FAT/ff.c **** 				res = follow_path(&djn, path_new);		/* Make sure if new object name is not in use */
5174:Core/Src/FAT/ff.c **** 				if (res == FR_OK) {						/* Is new name already in use by any other object? */
5175:Core/Src/FAT/ff.c **** 					res = (djn.obj.sclust == djo.obj.sclust && djn.dptr == djo.dptr) ? FR_NO_FILE : FR_EXIST;
5176:Core/Src/FAT/ff.c **** 				}
5177:Core/Src/FAT/ff.c **** 				if (res == FR_NO_FILE) { 				/* It is a valid path and no name collision */
5178:Core/Src/FAT/ff.c **** 					res = dir_register(&djn);			/* Register the new entry */
5179:Core/Src/FAT/ff.c **** 					if (res == FR_OK) {
5180:Core/Src/FAT/ff.c **** 						nf = fs->dirbuf[XDIR_NumSec]; nn = fs->dirbuf[XDIR_NumName];
5181:Core/Src/FAT/ff.c **** 						nh = ld_word(fs->dirbuf + XDIR_NameHash);
5182:Core/Src/FAT/ff.c **** 						memcpy(fs->dirbuf, buf, SZDIRE * 2);	/* Restore 85+C0 entry */
5183:Core/Src/FAT/ff.c **** 						fs->dirbuf[XDIR_NumSec] = nf; fs->dirbuf[XDIR_NumName] = nn;
5184:Core/Src/FAT/ff.c **** 						st_word(fs->dirbuf + XDIR_NameHash, nh);
5185:Core/Src/FAT/ff.c **** 						if (!(fs->dirbuf[XDIR_Attr] & AM_DIR)) fs->dirbuf[XDIR_Attr] |= AM_ARC;	/* Set archive attrib
5186:Core/Src/FAT/ff.c **** /* Start of critical section where an interruption can cause a cross-link */
5187:Core/Src/FAT/ff.c **** 						res = store_xdir(&djn);
5188:Core/Src/FAT/ff.c **** 					}
5189:Core/Src/FAT/ff.c **** 				}
5190:Core/Src/FAT/ff.c **** 			} else
5191:Core/Src/FAT/ff.c **** #endif
5192:Core/Src/FAT/ff.c **** 			{	/* At FAT/FAT32 volume */
5193:Core/Src/FAT/ff.c **** 				memcpy(buf, djo.dir, SZDIRE);			/* Save directory entry of the object */
5194:Core/Src/FAT/ff.c **** 				memcpy(&djn, &djo, sizeof (DIR));		/* Duplicate the directory object */
5195:Core/Src/FAT/ff.c **** 				res = follow_path(&djn, path_new);		/* Make sure if new object name is not in use */
5196:Core/Src/FAT/ff.c **** 				if (res == FR_OK) {						/* Is new name already in use by any other object? */
5197:Core/Src/FAT/ff.c **** 					res = (djn.obj.sclust == djo.obj.sclust && djn.dptr == djo.dptr) ? FR_NO_FILE : FR_EXIST;
5198:Core/Src/FAT/ff.c **** 				}
5199:Core/Src/FAT/ff.c **** 				if (res == FR_NO_FILE) { 				/* It is a valid path and no name collision */
5200:Core/Src/FAT/ff.c **** 					res = dir_register(&djn);			/* Register the new entry */
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 194


5201:Core/Src/FAT/ff.c **** 					if (res == FR_OK) {
5202:Core/Src/FAT/ff.c **** 						dir = djn.dir;					/* Copy directory entry of the object except name */
5203:Core/Src/FAT/ff.c **** 						memcpy(dir + 13, buf + 13, SZDIRE - 13);
5204:Core/Src/FAT/ff.c **** 						dir[DIR_Attr] = buf[DIR_Attr];
5205:Core/Src/FAT/ff.c **** 						if (!(dir[DIR_Attr] & AM_DIR)) dir[DIR_Attr] |= AM_ARC;	/* Set archive attribute if it is a f
5206:Core/Src/FAT/ff.c **** 						fs->wflag = 1;
5207:Core/Src/FAT/ff.c **** 						if ((dir[DIR_Attr] & AM_DIR) && djo.obj.sclust != djn.obj.sclust) {	/* Update .. entry in the
5208:Core/Src/FAT/ff.c **** 							sect = clst2sect(fs, ld_clust(fs, dir));
5209:Core/Src/FAT/ff.c **** 							if (sect == 0) {
5210:Core/Src/FAT/ff.c **** 								res = FR_INT_ERR;
5211:Core/Src/FAT/ff.c **** 							} else {
5212:Core/Src/FAT/ff.c **** /* Start of critical section where an interruption can cause a cross-link */
5213:Core/Src/FAT/ff.c **** 								res = move_window(fs, sect);
5214:Core/Src/FAT/ff.c **** 								dir = fs->win + SZDIRE * 1;	/* Ptr to .. entry */
5215:Core/Src/FAT/ff.c **** 								if (res == FR_OK && dir[1] == '.') {
5216:Core/Src/FAT/ff.c **** 									st_clust(fs, dir, djn.obj.sclust);
5217:Core/Src/FAT/ff.c **** 									fs->wflag = 1;
5218:Core/Src/FAT/ff.c **** 								}
5219:Core/Src/FAT/ff.c **** 							}
5220:Core/Src/FAT/ff.c **** 						}
5221:Core/Src/FAT/ff.c **** 					}
5222:Core/Src/FAT/ff.c **** 				}
5223:Core/Src/FAT/ff.c **** 			}
5224:Core/Src/FAT/ff.c **** 			if (res == FR_OK) {
5225:Core/Src/FAT/ff.c **** 				res = dir_remove(&djo);		/* Remove old entry */
5226:Core/Src/FAT/ff.c **** 				if (res == FR_OK) {
5227:Core/Src/FAT/ff.c **** 					res = sync_fs(fs);
5228:Core/Src/FAT/ff.c **** 				}
5229:Core/Src/FAT/ff.c **** 			}
5230:Core/Src/FAT/ff.c **** /* End of the critical section */
5231:Core/Src/FAT/ff.c **** 		}
5232:Core/Src/FAT/ff.c **** 		FREE_NAMBUF();
5233:Core/Src/FAT/ff.c **** 	}
5234:Core/Src/FAT/ff.c **** 
5235:Core/Src/FAT/ff.c **** 	LEAVE_FF(fs, res);
5236:Core/Src/FAT/ff.c **** }
5237:Core/Src/FAT/ff.c **** 
5238:Core/Src/FAT/ff.c **** #endif /* !FF_FS_READONLY */
5239:Core/Src/FAT/ff.c **** #endif /* FF_FS_MINIMIZE == 0 */
5240:Core/Src/FAT/ff.c **** #endif /* FF_FS_MINIMIZE <= 1 */
5241:Core/Src/FAT/ff.c **** #endif /* FF_FS_MINIMIZE <= 2 */
5242:Core/Src/FAT/ff.c **** 
5243:Core/Src/FAT/ff.c **** 
5244:Core/Src/FAT/ff.c **** 
5245:Core/Src/FAT/ff.c **** #if FF_USE_CHMOD && !FF_FS_READONLY
5246:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
5247:Core/Src/FAT/ff.c **** /* Change Attribute                                                      */
5248:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
5249:Core/Src/FAT/ff.c **** 
5250:Core/Src/FAT/ff.c **** FRESULT f_chmod (
5251:Core/Src/FAT/ff.c **** 	const TCHAR* path,	/* Pointer to the file path */
5252:Core/Src/FAT/ff.c **** 	BYTE attr,			/* Attribute bits */
5253:Core/Src/FAT/ff.c **** 	BYTE mask			/* Attribute mask to change */
5254:Core/Src/FAT/ff.c **** )
5255:Core/Src/FAT/ff.c **** {
5256:Core/Src/FAT/ff.c **** 	FRESULT res;
5257:Core/Src/FAT/ff.c **** 	FATFS *fs;
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 195


5258:Core/Src/FAT/ff.c **** 	DIR dj;
5259:Core/Src/FAT/ff.c **** 	DEF_NAMBUF
5260:Core/Src/FAT/ff.c **** 
5261:Core/Src/FAT/ff.c **** 
5262:Core/Src/FAT/ff.c **** 	res = mount_volume(&path, &fs, FA_WRITE);	/* Get logical drive */
5263:Core/Src/FAT/ff.c **** 	if (res == FR_OK) {
5264:Core/Src/FAT/ff.c **** 		dj.obj.fs = fs;
5265:Core/Src/FAT/ff.c **** 		INIT_NAMBUF(fs);
5266:Core/Src/FAT/ff.c **** 		res = follow_path(&dj, path);	/* Follow the file path */
5267:Core/Src/FAT/ff.c **** 		if (res == FR_OK && (dj.fn[NSFLAG] & (NS_DOT | NS_NONAME))) res = FR_INVALID_NAME;	/* Check objec
5268:Core/Src/FAT/ff.c **** 		if (res == FR_OK) {
5269:Core/Src/FAT/ff.c **** 			mask &= AM_RDO|AM_HID|AM_SYS|AM_ARC;	/* Valid attribute mask */
5270:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT
5271:Core/Src/FAT/ff.c **** 			if (fs->fs_type == FS_EXFAT) {
5272:Core/Src/FAT/ff.c **** 				fs->dirbuf[XDIR_Attr] = (attr & mask) | (fs->dirbuf[XDIR_Attr] & (BYTE)~mask);	/* Apply attribu
5273:Core/Src/FAT/ff.c **** 				res = store_xdir(&dj);
5274:Core/Src/FAT/ff.c **** 			} else
5275:Core/Src/FAT/ff.c **** #endif
5276:Core/Src/FAT/ff.c **** 			{
5277:Core/Src/FAT/ff.c **** 				dj.dir[DIR_Attr] = (attr & mask) | (dj.dir[DIR_Attr] & (BYTE)~mask);	/* Apply attribute change 
5278:Core/Src/FAT/ff.c **** 				fs->wflag = 1;
5279:Core/Src/FAT/ff.c **** 			}
5280:Core/Src/FAT/ff.c **** 			if (res == FR_OK) {
5281:Core/Src/FAT/ff.c **** 				res = sync_fs(fs);
5282:Core/Src/FAT/ff.c **** 			}
5283:Core/Src/FAT/ff.c **** 		}
5284:Core/Src/FAT/ff.c **** 		FREE_NAMBUF();
5285:Core/Src/FAT/ff.c **** 	}
5286:Core/Src/FAT/ff.c **** 
5287:Core/Src/FAT/ff.c **** 	LEAVE_FF(fs, res);
5288:Core/Src/FAT/ff.c **** }
5289:Core/Src/FAT/ff.c **** 
5290:Core/Src/FAT/ff.c **** 
5291:Core/Src/FAT/ff.c **** 
5292:Core/Src/FAT/ff.c **** 
5293:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
5294:Core/Src/FAT/ff.c **** /* Change Timestamp                                                      */
5295:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
5296:Core/Src/FAT/ff.c **** 
5297:Core/Src/FAT/ff.c **** FRESULT f_utime (
5298:Core/Src/FAT/ff.c **** 	const TCHAR* path,	/* Pointer to the file/directory name */
5299:Core/Src/FAT/ff.c **** 	const FILINFO* fno	/* Pointer to the timestamp to be set */
5300:Core/Src/FAT/ff.c **** )
5301:Core/Src/FAT/ff.c **** {
5302:Core/Src/FAT/ff.c **** 	FRESULT res;
5303:Core/Src/FAT/ff.c **** 	FATFS *fs;
5304:Core/Src/FAT/ff.c **** 	DIR dj;
5305:Core/Src/FAT/ff.c **** 	DEF_NAMBUF
5306:Core/Src/FAT/ff.c **** 
5307:Core/Src/FAT/ff.c **** 
5308:Core/Src/FAT/ff.c **** 	res = mount_volume(&path, &fs, FA_WRITE);	/* Get logical drive */
5309:Core/Src/FAT/ff.c **** 	if (res == FR_OK) {
5310:Core/Src/FAT/ff.c **** 		dj.obj.fs = fs;
5311:Core/Src/FAT/ff.c **** 		INIT_NAMBUF(fs);
5312:Core/Src/FAT/ff.c **** 		res = follow_path(&dj, path);	/* Follow the file path */
5313:Core/Src/FAT/ff.c **** 		if (res == FR_OK && (dj.fn[NSFLAG] & (NS_DOT | NS_NONAME))) res = FR_INVALID_NAME;	/* Check objec
5314:Core/Src/FAT/ff.c **** 		if (res == FR_OK) {
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 196


5315:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT
5316:Core/Src/FAT/ff.c **** 			if (fs->fs_type == FS_EXFAT) {
5317:Core/Src/FAT/ff.c **** 				st_dword(fs->dirbuf + XDIR_ModTime, (DWORD)fno->fdate << 16 | fno->ftime);
5318:Core/Src/FAT/ff.c **** 				res = store_xdir(&dj);
5319:Core/Src/FAT/ff.c **** 			} else
5320:Core/Src/FAT/ff.c **** #endif
5321:Core/Src/FAT/ff.c **** 			{
5322:Core/Src/FAT/ff.c **** 				st_dword(dj.dir + DIR_ModTime, (DWORD)fno->fdate << 16 | fno->ftime);
5323:Core/Src/FAT/ff.c **** 				fs->wflag = 1;
5324:Core/Src/FAT/ff.c **** 			}
5325:Core/Src/FAT/ff.c **** 			if (res == FR_OK) {
5326:Core/Src/FAT/ff.c **** 				res = sync_fs(fs);
5327:Core/Src/FAT/ff.c **** 			}
5328:Core/Src/FAT/ff.c **** 		}
5329:Core/Src/FAT/ff.c **** 		FREE_NAMBUF();
5330:Core/Src/FAT/ff.c **** 	}
5331:Core/Src/FAT/ff.c **** 
5332:Core/Src/FAT/ff.c **** 	LEAVE_FF(fs, res);
5333:Core/Src/FAT/ff.c **** }
5334:Core/Src/FAT/ff.c **** 
5335:Core/Src/FAT/ff.c **** #endif	/* FF_USE_CHMOD && !FF_FS_READONLY */
5336:Core/Src/FAT/ff.c **** 
5337:Core/Src/FAT/ff.c **** 
5338:Core/Src/FAT/ff.c **** 
5339:Core/Src/FAT/ff.c **** #if FF_USE_LABEL
5340:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
5341:Core/Src/FAT/ff.c **** /* Get Volume Label                                                      */
5342:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
5343:Core/Src/FAT/ff.c **** 
5344:Core/Src/FAT/ff.c **** FRESULT f_getlabel (
5345:Core/Src/FAT/ff.c **** 	const TCHAR* path,	/* Logical drive number */
5346:Core/Src/FAT/ff.c **** 	TCHAR* label,		/* Buffer to store the volume label */
5347:Core/Src/FAT/ff.c **** 	DWORD* vsn			/* Variable to store the volume serial number */
5348:Core/Src/FAT/ff.c **** )
5349:Core/Src/FAT/ff.c **** {
5350:Core/Src/FAT/ff.c **** 	FRESULT res;
5351:Core/Src/FAT/ff.c **** 	FATFS *fs;
5352:Core/Src/FAT/ff.c **** 	DIR dj;
5353:Core/Src/FAT/ff.c **** 	UINT si, di;
5354:Core/Src/FAT/ff.c **** 	WCHAR wc;
5355:Core/Src/FAT/ff.c **** 
5356:Core/Src/FAT/ff.c **** 	/* Get logical drive */
5357:Core/Src/FAT/ff.c **** 	res = mount_volume(&path, &fs, 0);
5358:Core/Src/FAT/ff.c **** 
5359:Core/Src/FAT/ff.c **** 	/* Get volume label */
5360:Core/Src/FAT/ff.c **** 	if (res == FR_OK && label) {
5361:Core/Src/FAT/ff.c **** 		dj.obj.fs = fs; dj.obj.sclust = 0;	/* Open root directory */
5362:Core/Src/FAT/ff.c **** 		res = dir_sdi(&dj, 0);
5363:Core/Src/FAT/ff.c **** 		if (res == FR_OK) {
5364:Core/Src/FAT/ff.c **** 		 	res = DIR_READ_LABEL(&dj);		/* Find a volume label entry */
5365:Core/Src/FAT/ff.c **** 		 	if (res == FR_OK) {
5366:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT
5367:Core/Src/FAT/ff.c **** 				if (fs->fs_type == FS_EXFAT) {
5368:Core/Src/FAT/ff.c **** 					WCHAR hs;
5369:Core/Src/FAT/ff.c **** 					UINT nw;
5370:Core/Src/FAT/ff.c **** 
5371:Core/Src/FAT/ff.c **** 					for (si = di = hs = 0; si < dj.dir[XDIR_NumLabel]; si++) {	/* Extract volume label from 83 ent
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 197


5372:Core/Src/FAT/ff.c **** 						wc = ld_word(dj.dir + XDIR_Label + si * 2);
5373:Core/Src/FAT/ff.c **** 						if (hs == 0 && IsSurrogate(wc)) {	/* Is the code a surrogate? */
5374:Core/Src/FAT/ff.c **** 							hs = wc; continue;
5375:Core/Src/FAT/ff.c **** 						}
5376:Core/Src/FAT/ff.c **** 						nw = put_utf((DWORD)hs << 16 | wc, &label[di], 4);	/* Store it in API encoding */
5377:Core/Src/FAT/ff.c **** 						if (nw == 0) {		/* Encode error? */
5378:Core/Src/FAT/ff.c **** 							di = 0; break;
5379:Core/Src/FAT/ff.c **** 						}
5380:Core/Src/FAT/ff.c **** 						di += nw;
5381:Core/Src/FAT/ff.c **** 						hs = 0;
5382:Core/Src/FAT/ff.c **** 					}
5383:Core/Src/FAT/ff.c **** 					if (hs != 0) di = 0;	/* Broken surrogate pair? */
5384:Core/Src/FAT/ff.c **** 					label[di] = 0;
5385:Core/Src/FAT/ff.c **** 				} else
5386:Core/Src/FAT/ff.c **** #endif
5387:Core/Src/FAT/ff.c **** 				{
5388:Core/Src/FAT/ff.c **** 					si = di = 0;		/* Extract volume label from AM_VOL entry */
5389:Core/Src/FAT/ff.c **** 					while (si < 11) {
5390:Core/Src/FAT/ff.c **** 						wc = dj.dir[si++];
5391:Core/Src/FAT/ff.c **** #if FF_USE_LFN && FF_LFN_UNICODE >= 1 	/* Unicode output */
5392:Core/Src/FAT/ff.c **** 						if (dbc_1st((BYTE)wc) && si < 11) wc = wc << 8 | dj.dir[si++];	/* Is it a DBC? */
5393:Core/Src/FAT/ff.c **** 						wc = ff_oem2uni(wc, CODEPAGE);		/* Convert it into Unicode */
5394:Core/Src/FAT/ff.c **** 						if (wc == 0) {		/* Invalid char in current code page? */
5395:Core/Src/FAT/ff.c **** 							di = 0; break;
5396:Core/Src/FAT/ff.c **** 						}
5397:Core/Src/FAT/ff.c **** 						di += put_utf(wc, &label[di], 4);	/* Store it in Unicode */
5398:Core/Src/FAT/ff.c **** #else									/* ANSI/OEM output */
5399:Core/Src/FAT/ff.c **** 						label[di++] = (TCHAR)wc;
5400:Core/Src/FAT/ff.c **** #endif
5401:Core/Src/FAT/ff.c **** 					}
5402:Core/Src/FAT/ff.c **** 					do {				/* Truncate trailing spaces */
5403:Core/Src/FAT/ff.c **** 						label[di] = 0;
5404:Core/Src/FAT/ff.c **** 						if (di == 0) break;
5405:Core/Src/FAT/ff.c **** 					} while (label[--di] == ' ');
5406:Core/Src/FAT/ff.c **** 				}
5407:Core/Src/FAT/ff.c **** 			}
5408:Core/Src/FAT/ff.c **** 		}
5409:Core/Src/FAT/ff.c **** 		if (res == FR_NO_FILE) {	/* No label entry and return nul string */
5410:Core/Src/FAT/ff.c **** 			label[0] = 0;
5411:Core/Src/FAT/ff.c **** 			res = FR_OK;
5412:Core/Src/FAT/ff.c **** 		}
5413:Core/Src/FAT/ff.c **** 	}
5414:Core/Src/FAT/ff.c **** 
5415:Core/Src/FAT/ff.c **** 	/* Get volume serial number */
5416:Core/Src/FAT/ff.c **** 	if (res == FR_OK && vsn) {
5417:Core/Src/FAT/ff.c **** 		res = move_window(fs, fs->volbase);
5418:Core/Src/FAT/ff.c **** 		if (res == FR_OK) {
5419:Core/Src/FAT/ff.c **** 			switch (fs->fs_type) {
5420:Core/Src/FAT/ff.c **** 			case FS_EXFAT:
5421:Core/Src/FAT/ff.c **** 				di = BPB_VolIDEx;
5422:Core/Src/FAT/ff.c **** 				break;
5423:Core/Src/FAT/ff.c **** 
5424:Core/Src/FAT/ff.c **** 			case FS_FAT32:
5425:Core/Src/FAT/ff.c **** 				di = BS_VolID32;
5426:Core/Src/FAT/ff.c **** 				break;
5427:Core/Src/FAT/ff.c **** 
5428:Core/Src/FAT/ff.c **** 			default:
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 198


5429:Core/Src/FAT/ff.c **** 				di = BS_VolID;
5430:Core/Src/FAT/ff.c **** 			}
5431:Core/Src/FAT/ff.c **** 			*vsn = ld_dword(fs->win + di);
5432:Core/Src/FAT/ff.c **** 		}
5433:Core/Src/FAT/ff.c **** 	}
5434:Core/Src/FAT/ff.c **** 
5435:Core/Src/FAT/ff.c **** 	LEAVE_FF(fs, res);
5436:Core/Src/FAT/ff.c **** }
5437:Core/Src/FAT/ff.c **** 
5438:Core/Src/FAT/ff.c **** 
5439:Core/Src/FAT/ff.c **** 
5440:Core/Src/FAT/ff.c **** #if !FF_FS_READONLY
5441:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
5442:Core/Src/FAT/ff.c **** /* Set Volume Label                                                      */
5443:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
5444:Core/Src/FAT/ff.c **** 
5445:Core/Src/FAT/ff.c **** FRESULT f_setlabel (
5446:Core/Src/FAT/ff.c **** 	const TCHAR* label	/* Volume label to set with heading logical drive number */
5447:Core/Src/FAT/ff.c **** )
5448:Core/Src/FAT/ff.c **** {
5449:Core/Src/FAT/ff.c **** 	FRESULT res;
5450:Core/Src/FAT/ff.c **** 	FATFS *fs;
5451:Core/Src/FAT/ff.c **** 	DIR dj;
5452:Core/Src/FAT/ff.c **** 	BYTE dirvn[22];
5453:Core/Src/FAT/ff.c **** 	UINT di;
5454:Core/Src/FAT/ff.c **** 	WCHAR wc;
5455:Core/Src/FAT/ff.c **** 	static const char badchr[18] = "+.,;=[]" "/*:<>|\\\"\?\x7F";	/* [0..16] for FAT, [7..16] for exFAT
5456:Core/Src/FAT/ff.c **** #if FF_USE_LFN
5457:Core/Src/FAT/ff.c **** 	DWORD dc;
5458:Core/Src/FAT/ff.c **** #endif
5459:Core/Src/FAT/ff.c **** 
5460:Core/Src/FAT/ff.c **** 	/* Get logical drive */
5461:Core/Src/FAT/ff.c **** 	res = mount_volume(&label, &fs, FA_WRITE);
5462:Core/Src/FAT/ff.c **** 	if (res != FR_OK) LEAVE_FF(fs, res);
5463:Core/Src/FAT/ff.c **** 
5464:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT
5465:Core/Src/FAT/ff.c **** 	if (fs->fs_type == FS_EXFAT) {	/* On the exFAT volume */
5466:Core/Src/FAT/ff.c **** 		memset(dirvn, 0, 22);
5467:Core/Src/FAT/ff.c **** 		di = 0;
5468:Core/Src/FAT/ff.c **** 		while ((UINT)*label >= ' ') {	/* Create volume label */
5469:Core/Src/FAT/ff.c **** 			dc = tchar2uni(&label);	/* Get a Unicode character */
5470:Core/Src/FAT/ff.c **** 			if (dc >= 0x10000) {
5471:Core/Src/FAT/ff.c **** 				if (dc == 0xFFFFFFFF || di >= 10) {	/* Wrong surrogate or buffer overflow */
5472:Core/Src/FAT/ff.c **** 					dc = 0;
5473:Core/Src/FAT/ff.c **** 				} else {
5474:Core/Src/FAT/ff.c **** 					st_word(dirvn + di * 2, (WCHAR)(dc >> 16)); di++;
5475:Core/Src/FAT/ff.c **** 				}
5476:Core/Src/FAT/ff.c **** 			}
5477:Core/Src/FAT/ff.c **** 			if (dc == 0 || strchr(&badchr[7], (int)dc) || di >= 11) {	/* Check validity of the volume label 
5478:Core/Src/FAT/ff.c **** 				LEAVE_FF(fs, FR_INVALID_NAME);
5479:Core/Src/FAT/ff.c **** 			}
5480:Core/Src/FAT/ff.c **** 			st_word(dirvn + di * 2, (WCHAR)dc); di++;
5481:Core/Src/FAT/ff.c **** 		}
5482:Core/Src/FAT/ff.c **** 	} else
5483:Core/Src/FAT/ff.c **** #endif
5484:Core/Src/FAT/ff.c **** 	{	/* On the FAT/FAT32 volume */
5485:Core/Src/FAT/ff.c **** 		memset(dirvn, ' ', 11);
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 199


5486:Core/Src/FAT/ff.c **** 		di = 0;
5487:Core/Src/FAT/ff.c **** 		while ((UINT)*label >= ' ') {	/* Create volume label */
5488:Core/Src/FAT/ff.c **** #if FF_USE_LFN
5489:Core/Src/FAT/ff.c **** 			dc = tchar2uni(&label);
5490:Core/Src/FAT/ff.c **** 			wc = (dc < 0x10000) ? ff_uni2oem(ff_wtoupper(dc), CODEPAGE) : 0;
5491:Core/Src/FAT/ff.c **** #else									/* ANSI/OEM input */
5492:Core/Src/FAT/ff.c **** 			wc = (BYTE)*label++;
5493:Core/Src/FAT/ff.c **** 			if (dbc_1st((BYTE)wc)) wc = dbc_2nd((BYTE)*label) ? wc << 8 | (BYTE)*label++ : 0;
5494:Core/Src/FAT/ff.c **** 			if (IsLower(wc)) wc -= 0x20;		/* To upper ASCII characters */
5495:Core/Src/FAT/ff.c **** #if FF_CODE_PAGE == 0
5496:Core/Src/FAT/ff.c **** 			if (ExCvt && wc >= 0x80) wc = ExCvt[wc - 0x80];	/* To upper extended characters (SBCS cfg) */
5497:Core/Src/FAT/ff.c **** #elif FF_CODE_PAGE < 900
5498:Core/Src/FAT/ff.c **** 			if (wc >= 0x80) wc = ExCvt[wc - 0x80];	/* To upper extended characters (SBCS cfg) */
5499:Core/Src/FAT/ff.c **** #endif
5500:Core/Src/FAT/ff.c **** #endif
5501:Core/Src/FAT/ff.c **** 			if (wc == 0 || strchr(&badchr[0], (int)wc) || di >= (UINT)((wc >= 0x100) ? 10 : 11)) {	/* Reject
5502:Core/Src/FAT/ff.c **** 				LEAVE_FF(fs, FR_INVALID_NAME);
5503:Core/Src/FAT/ff.c **** 			}
5504:Core/Src/FAT/ff.c **** 			if (wc >= 0x100) dirvn[di++] = (BYTE)(wc >> 8);
5505:Core/Src/FAT/ff.c **** 			dirvn[di++] = (BYTE)wc;
5506:Core/Src/FAT/ff.c **** 		}
5507:Core/Src/FAT/ff.c **** 		if (dirvn[0] == DDEM) LEAVE_FF(fs, FR_INVALID_NAME);	/* Reject illegal name (heading DDEM) */
5508:Core/Src/FAT/ff.c **** 		while (di && dirvn[di - 1] == ' ') di--;				/* Snip trailing spaces */
5509:Core/Src/FAT/ff.c **** 	}
5510:Core/Src/FAT/ff.c **** 
5511:Core/Src/FAT/ff.c **** 	/* Set volume label */
5512:Core/Src/FAT/ff.c **** 	dj.obj.fs = fs; dj.obj.sclust = 0;	/* Open root directory */
5513:Core/Src/FAT/ff.c **** 	res = dir_sdi(&dj, 0);
5514:Core/Src/FAT/ff.c **** 	if (res == FR_OK) {
5515:Core/Src/FAT/ff.c **** 		res = DIR_READ_LABEL(&dj);	/* Get volume label entry */
5516:Core/Src/FAT/ff.c **** 		if (res == FR_OK) {
5517:Core/Src/FAT/ff.c **** 			if (FF_FS_EXFAT && fs->fs_type == FS_EXFAT) {
5518:Core/Src/FAT/ff.c **** 				dj.dir[XDIR_NumLabel] = (BYTE)di;	/* Change the volume label */
5519:Core/Src/FAT/ff.c **** 				memcpy(dj.dir + XDIR_Label, dirvn, 22);
5520:Core/Src/FAT/ff.c **** 			} else {
5521:Core/Src/FAT/ff.c **** 				if (di != 0) {
5522:Core/Src/FAT/ff.c **** 					memcpy(dj.dir, dirvn, 11);	/* Change the volume label */
5523:Core/Src/FAT/ff.c **** 				} else {
5524:Core/Src/FAT/ff.c **** 					dj.dir[DIR_Name] = DDEM;	/* Remove the volume label */
5525:Core/Src/FAT/ff.c **** 				}
5526:Core/Src/FAT/ff.c **** 			}
5527:Core/Src/FAT/ff.c **** 			fs->wflag = 1;
5528:Core/Src/FAT/ff.c **** 			res = sync_fs(fs);
5529:Core/Src/FAT/ff.c **** 		} else {			/* No volume label entry or an error */
5530:Core/Src/FAT/ff.c **** 			if (res == FR_NO_FILE) {
5531:Core/Src/FAT/ff.c **** 				res = FR_OK;
5532:Core/Src/FAT/ff.c **** 				if (di != 0) {	/* Create a volume label entry */
5533:Core/Src/FAT/ff.c **** 					res = dir_alloc(&dj, 1);	/* Allocate an entry */
5534:Core/Src/FAT/ff.c **** 					if (res == FR_OK) {
5535:Core/Src/FAT/ff.c **** 						memset(dj.dir, 0, SZDIRE);	/* Clean the entry */
5536:Core/Src/FAT/ff.c **** 						if (FF_FS_EXFAT && fs->fs_type == FS_EXFAT) {
5537:Core/Src/FAT/ff.c **** 							dj.dir[XDIR_Type] = ET_VLABEL;	/* Create volume label entry */
5538:Core/Src/FAT/ff.c **** 							dj.dir[XDIR_NumLabel] = (BYTE)di;
5539:Core/Src/FAT/ff.c **** 							memcpy(dj.dir + XDIR_Label, dirvn, 22);
5540:Core/Src/FAT/ff.c **** 						} else {
5541:Core/Src/FAT/ff.c **** 							dj.dir[DIR_Attr] = AM_VOL;		/* Create volume label entry */
5542:Core/Src/FAT/ff.c **** 							memcpy(dj.dir, dirvn, 11);
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 200


5543:Core/Src/FAT/ff.c **** 						}
5544:Core/Src/FAT/ff.c **** 						fs->wflag = 1;
5545:Core/Src/FAT/ff.c **** 						res = sync_fs(fs);
5546:Core/Src/FAT/ff.c **** 					}
5547:Core/Src/FAT/ff.c **** 				}
5548:Core/Src/FAT/ff.c **** 			}
5549:Core/Src/FAT/ff.c **** 		}
5550:Core/Src/FAT/ff.c **** 	}
5551:Core/Src/FAT/ff.c **** 
5552:Core/Src/FAT/ff.c **** 	LEAVE_FF(fs, res);
5553:Core/Src/FAT/ff.c **** }
5554:Core/Src/FAT/ff.c **** 
5555:Core/Src/FAT/ff.c **** #endif /* !FF_FS_READONLY */
5556:Core/Src/FAT/ff.c **** #endif /* FF_USE_LABEL */
5557:Core/Src/FAT/ff.c **** 
5558:Core/Src/FAT/ff.c **** 
5559:Core/Src/FAT/ff.c **** 
5560:Core/Src/FAT/ff.c **** #if FF_USE_EXPAND && !FF_FS_READONLY
5561:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
5562:Core/Src/FAT/ff.c **** /* Allocate a Contiguous Blocks to the File                              */
5563:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
5564:Core/Src/FAT/ff.c **** 
5565:Core/Src/FAT/ff.c **** FRESULT f_expand (
5566:Core/Src/FAT/ff.c **** 	FIL* fp,		/* Pointer to the file object */
5567:Core/Src/FAT/ff.c **** 	FSIZE_t fsz,	/* File size to be expanded to */
5568:Core/Src/FAT/ff.c **** 	BYTE opt		/* Operation mode 0:Find and prepare or 1:Find and allocate */
5569:Core/Src/FAT/ff.c **** )
5570:Core/Src/FAT/ff.c **** {
5571:Core/Src/FAT/ff.c **** 	FRESULT res;
5572:Core/Src/FAT/ff.c **** 	FATFS *fs;
5573:Core/Src/FAT/ff.c **** 	DWORD n, clst, stcl, scl, ncl, tcl, lclst;
5574:Core/Src/FAT/ff.c **** 
5575:Core/Src/FAT/ff.c **** 
5576:Core/Src/FAT/ff.c **** 	res = validate(&fp->obj, &fs);		/* Check validity of the file object */
5577:Core/Src/FAT/ff.c **** 	if (res != FR_OK || (res = (FRESULT)fp->err) != FR_OK) LEAVE_FF(fs, res);
5578:Core/Src/FAT/ff.c **** 	if (fsz == 0 || fp->obj.objsize != 0 || !(fp->flag & FA_WRITE)) LEAVE_FF(fs, FR_DENIED);
5579:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT
5580:Core/Src/FAT/ff.c **** 	if (fs->fs_type != FS_EXFAT && fsz >= 0x100000000) LEAVE_FF(fs, FR_DENIED);	/* Check if in size li
5581:Core/Src/FAT/ff.c **** #endif
5582:Core/Src/FAT/ff.c **** 	n = (DWORD)fs->csize * SS(fs);	/* Cluster size */
5583:Core/Src/FAT/ff.c **** 	tcl = (DWORD)(fsz / n) + ((fsz & (n - 1)) ? 1 : 0);	/* Number of clusters required */
5584:Core/Src/FAT/ff.c **** 	stcl = fs->last_clst; lclst = 0;
5585:Core/Src/FAT/ff.c **** 	if (stcl < 2 || stcl >= fs->n_fatent) stcl = 2;
5586:Core/Src/FAT/ff.c **** 
5587:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT
5588:Core/Src/FAT/ff.c **** 	if (fs->fs_type == FS_EXFAT) {
5589:Core/Src/FAT/ff.c **** 		scl = find_bitmap(fs, stcl, tcl);			/* Find a contiguous cluster block */
5590:Core/Src/FAT/ff.c **** 		if (scl == 0) res = FR_DENIED;				/* No contiguous cluster block was found */
5591:Core/Src/FAT/ff.c **** 		if (scl == 0xFFFFFFFF) res = FR_DISK_ERR;
5592:Core/Src/FAT/ff.c **** 		if (res == FR_OK) {	/* A contiguous free area is found */
5593:Core/Src/FAT/ff.c **** 			if (opt) {		/* Allocate it now */
5594:Core/Src/FAT/ff.c **** 				res = change_bitmap(fs, scl, tcl, 1);	/* Mark the cluster block 'in use' */
5595:Core/Src/FAT/ff.c **** 				lclst = scl + tcl - 1;
5596:Core/Src/FAT/ff.c **** 			} else {		/* Set it as suggested point for next allocation */
5597:Core/Src/FAT/ff.c **** 				lclst = scl - 1;
5598:Core/Src/FAT/ff.c **** 			}
5599:Core/Src/FAT/ff.c **** 		}
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 201


5600:Core/Src/FAT/ff.c **** 	} else
5601:Core/Src/FAT/ff.c **** #endif
5602:Core/Src/FAT/ff.c **** 	{
5603:Core/Src/FAT/ff.c **** 		scl = clst = stcl; ncl = 0;
5604:Core/Src/FAT/ff.c **** 		for (;;) {	/* Find a contiguous cluster block */
5605:Core/Src/FAT/ff.c **** 			n = get_fat(&fp->obj, clst);
5606:Core/Src/FAT/ff.c **** 			if (++clst >= fs->n_fatent) clst = 2;
5607:Core/Src/FAT/ff.c **** 			if (n == 1) {
5608:Core/Src/FAT/ff.c **** 				res = FR_INT_ERR; break;
5609:Core/Src/FAT/ff.c **** 			}
5610:Core/Src/FAT/ff.c **** 			if (n == 0xFFFFFFFF) {
5611:Core/Src/FAT/ff.c **** 				res = FR_DISK_ERR; break;
5612:Core/Src/FAT/ff.c **** 			}
5613:Core/Src/FAT/ff.c **** 			if (n == 0) {	/* Is it a free cluster? */
5614:Core/Src/FAT/ff.c **** 				if (++ncl == tcl) break;	/* Break if a contiguous cluster block is found */
5615:Core/Src/FAT/ff.c **** 			} else {
5616:Core/Src/FAT/ff.c **** 				scl = clst; ncl = 0;		/* Not a free cluster */
5617:Core/Src/FAT/ff.c **** 			}
5618:Core/Src/FAT/ff.c **** 			if (clst == stcl) {		/* No contiguous cluster? */
5619:Core/Src/FAT/ff.c **** 				res = FR_DENIED; break;
5620:Core/Src/FAT/ff.c **** 			}
5621:Core/Src/FAT/ff.c **** 		}
5622:Core/Src/FAT/ff.c **** 		if (res == FR_OK) {	/* A contiguous free area is found */
5623:Core/Src/FAT/ff.c **** 			if (opt) {		/* Allocate it now */
5624:Core/Src/FAT/ff.c **** 				for (clst = scl, n = tcl; n; clst++, n--) {	/* Create a cluster chain on the FAT */
5625:Core/Src/FAT/ff.c **** 					res = put_fat(fs, clst, (n == 1) ? 0xFFFFFFFF : clst + 1);
5626:Core/Src/FAT/ff.c **** 					if (res != FR_OK) break;
5627:Core/Src/FAT/ff.c **** 					lclst = clst;
5628:Core/Src/FAT/ff.c **** 				}
5629:Core/Src/FAT/ff.c **** 			} else {		/* Set it as suggested point for next allocation */
5630:Core/Src/FAT/ff.c **** 				lclst = scl - 1;
5631:Core/Src/FAT/ff.c **** 			}
5632:Core/Src/FAT/ff.c **** 		}
5633:Core/Src/FAT/ff.c **** 	}
5634:Core/Src/FAT/ff.c **** 
5635:Core/Src/FAT/ff.c **** 	if (res == FR_OK) {
5636:Core/Src/FAT/ff.c **** 		fs->last_clst = lclst;		/* Set suggested start cluster to start next */
5637:Core/Src/FAT/ff.c **** 		if (opt) {	/* Is it allocated now? */
5638:Core/Src/FAT/ff.c **** 			fp->obj.sclust = scl;		/* Update object allocation information */
5639:Core/Src/FAT/ff.c **** 			fp->obj.objsize = fsz;
5640:Core/Src/FAT/ff.c **** 			if (FF_FS_EXFAT) fp->obj.stat = 2;	/* Set status 'contiguous chain' */
5641:Core/Src/FAT/ff.c **** 			fp->flag |= FA_MODIFIED;
5642:Core/Src/FAT/ff.c **** 			if (fs->free_clst <= fs->n_fatent - 2) {	/* Update FSINFO */
5643:Core/Src/FAT/ff.c **** 				fs->free_clst -= tcl;
5644:Core/Src/FAT/ff.c **** 				fs->fsi_flag |= 1;
5645:Core/Src/FAT/ff.c **** 			}
5646:Core/Src/FAT/ff.c **** 		}
5647:Core/Src/FAT/ff.c **** 	}
5648:Core/Src/FAT/ff.c **** 
5649:Core/Src/FAT/ff.c **** 	LEAVE_FF(fs, res);
5650:Core/Src/FAT/ff.c **** }
5651:Core/Src/FAT/ff.c **** 
5652:Core/Src/FAT/ff.c **** #endif /* FF_USE_EXPAND && !FF_FS_READONLY */
5653:Core/Src/FAT/ff.c **** 
5654:Core/Src/FAT/ff.c **** 
5655:Core/Src/FAT/ff.c **** 
5656:Core/Src/FAT/ff.c **** #if FF_USE_FORWARD
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 202


5657:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
5658:Core/Src/FAT/ff.c **** /* Forward Data to the Stream Directly                                   */
5659:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
5660:Core/Src/FAT/ff.c **** 
5661:Core/Src/FAT/ff.c **** FRESULT f_forward (
5662:Core/Src/FAT/ff.c **** 	FIL* fp, 						/* Pointer to the file object */
5663:Core/Src/FAT/ff.c **** 	UINT (*func)(const BYTE*,UINT),	/* Pointer to the streaming function */
5664:Core/Src/FAT/ff.c **** 	UINT btf,						/* Number of bytes to forward */
5665:Core/Src/FAT/ff.c **** 	UINT* bf						/* Pointer to number of bytes forwarded */
5666:Core/Src/FAT/ff.c **** )
5667:Core/Src/FAT/ff.c **** {
5668:Core/Src/FAT/ff.c **** 	FRESULT res;
5669:Core/Src/FAT/ff.c **** 	FATFS *fs;
5670:Core/Src/FAT/ff.c **** 	DWORD clst;
5671:Core/Src/FAT/ff.c **** 	LBA_t sect;
5672:Core/Src/FAT/ff.c **** 	FSIZE_t remain;
5673:Core/Src/FAT/ff.c **** 	UINT rcnt, csect;
5674:Core/Src/FAT/ff.c **** 	BYTE *dbuf;
5675:Core/Src/FAT/ff.c **** 
5676:Core/Src/FAT/ff.c **** 
5677:Core/Src/FAT/ff.c **** 	*bf = 0;	/* Clear transfer byte counter */
5678:Core/Src/FAT/ff.c **** 	res = validate(&fp->obj, &fs);		/* Check validity of the file object */
5679:Core/Src/FAT/ff.c **** 	if (res != FR_OK || (res = (FRESULT)fp->err) != FR_OK) LEAVE_FF(fs, res);
5680:Core/Src/FAT/ff.c **** 	if (!(fp->flag & FA_READ)) LEAVE_FF(fs, FR_DENIED);	/* Check access mode */
5681:Core/Src/FAT/ff.c **** 
5682:Core/Src/FAT/ff.c **** 	remain = fp->obj.objsize - fp->fptr;
5683:Core/Src/FAT/ff.c **** 	if (btf > remain) btf = (UINT)remain;			/* Truncate btf by remaining bytes */
5684:Core/Src/FAT/ff.c **** 
5685:Core/Src/FAT/ff.c **** 	for ( ; btf > 0 && (*func)(0, 0); fp->fptr += rcnt, *bf += rcnt, btf -= rcnt) {	/* Repeat until al
5686:Core/Src/FAT/ff.c **** 		csect = (UINT)(fp->fptr / SS(fs) & (fs->csize - 1));	/* Sector offset in the cluster */
5687:Core/Src/FAT/ff.c **** 		if (fp->fptr % SS(fs) == 0) {				/* On the sector boundary? */
5688:Core/Src/FAT/ff.c **** 			if (csect == 0) {						/* On the cluster boundary? */
5689:Core/Src/FAT/ff.c **** 				clst = (fp->fptr == 0) ?			/* On the top of the file? */
5690:Core/Src/FAT/ff.c **** 					fp->obj.sclust : get_fat(&fp->obj, fp->clust);
5691:Core/Src/FAT/ff.c **** 				if (clst <= 1) ABORT(fs, FR_INT_ERR);
5692:Core/Src/FAT/ff.c **** 				if (clst == 0xFFFFFFFF) ABORT(fs, FR_DISK_ERR);
5693:Core/Src/FAT/ff.c **** 				fp->clust = clst;					/* Update current cluster */
5694:Core/Src/FAT/ff.c **** 			}
5695:Core/Src/FAT/ff.c **** 		}
5696:Core/Src/FAT/ff.c **** 		sect = clst2sect(fs, fp->clust);			/* Get current data sector */
5697:Core/Src/FAT/ff.c **** 		if (sect == 0) ABORT(fs, FR_INT_ERR);
5698:Core/Src/FAT/ff.c **** 		sect += csect;
5699:Core/Src/FAT/ff.c **** #if FF_FS_TINY
5700:Core/Src/FAT/ff.c **** 		if (move_window(fs, sect) != FR_OK) ABORT(fs, FR_DISK_ERR);	/* Move sector window to the file dat
5701:Core/Src/FAT/ff.c **** 		dbuf = fs->win;
5702:Core/Src/FAT/ff.c **** #else
5703:Core/Src/FAT/ff.c **** 		if (fp->sect != sect) {		/* Fill sector cache with file data */
5704:Core/Src/FAT/ff.c **** #if !FF_FS_READONLY
5705:Core/Src/FAT/ff.c **** 			if (fp->flag & FA_DIRTY) {		/* Write-back dirty sector cache */
5706:Core/Src/FAT/ff.c **** 				if (disk_write(fs->pdrv, fp->buf, fp->sect, 1) != RES_OK) ABORT(fs, FR_DISK_ERR);
5707:Core/Src/FAT/ff.c **** 				fp->flag &= (BYTE)~FA_DIRTY;
5708:Core/Src/FAT/ff.c **** 			}
5709:Core/Src/FAT/ff.c **** #endif
5710:Core/Src/FAT/ff.c **** 			if (disk_read(fs->pdrv, fp->buf, sect, 1) != RES_OK) ABORT(fs, FR_DISK_ERR);
5711:Core/Src/FAT/ff.c **** 		}
5712:Core/Src/FAT/ff.c **** 		dbuf = fp->buf;
5713:Core/Src/FAT/ff.c **** #endif
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 203


5714:Core/Src/FAT/ff.c **** 		fp->sect = sect;
5715:Core/Src/FAT/ff.c **** 		rcnt = SS(fs) - (UINT)fp->fptr % SS(fs);	/* Number of bytes remains in the sector */
5716:Core/Src/FAT/ff.c **** 		if (rcnt > btf) rcnt = btf;					/* Clip it by btr if needed */
5717:Core/Src/FAT/ff.c **** 		rcnt = (*func)(dbuf + ((UINT)fp->fptr % SS(fs)), rcnt);	/* Forward the file data */
5718:Core/Src/FAT/ff.c **** 		if (rcnt == 0) ABORT(fs, FR_INT_ERR);
5719:Core/Src/FAT/ff.c **** 	}
5720:Core/Src/FAT/ff.c **** 
5721:Core/Src/FAT/ff.c **** 	LEAVE_FF(fs, FR_OK);
5722:Core/Src/FAT/ff.c **** }
5723:Core/Src/FAT/ff.c **** #endif /* FF_USE_FORWARD */
5724:Core/Src/FAT/ff.c **** 
5725:Core/Src/FAT/ff.c **** 
5726:Core/Src/FAT/ff.c **** 
5727:Core/Src/FAT/ff.c **** #if !FF_FS_READONLY && FF_USE_MKFS
5728:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
5729:Core/Src/FAT/ff.c **** /* Create FAT/exFAT volume (with sub-functions)                          */
5730:Core/Src/FAT/ff.c **** /*-----------------------------------------------------------------------*/
5731:Core/Src/FAT/ff.c **** 
5732:Core/Src/FAT/ff.c **** #define N_SEC_TRACK 63			/* Sectors per track for determination of drive CHS */
5733:Core/Src/FAT/ff.c **** #define	GPT_ALIGN	0x100000	/* Alignment of partitions in GPT [byte] (>=128KB) */
5734:Core/Src/FAT/ff.c **** #define GPT_ITEMS	128			/* Number of GPT table size (>=128, sector aligned) */
5735:Core/Src/FAT/ff.c **** 
5736:Core/Src/FAT/ff.c **** 
5737:Core/Src/FAT/ff.c **** /* Create partitions on the physical drive in format of MBR or GPT */
5738:Core/Src/FAT/ff.c **** 
5739:Core/Src/FAT/ff.c **** static FRESULT create_partition (
5740:Core/Src/FAT/ff.c **** 	BYTE drv,			/* Physical drive number */
5741:Core/Src/FAT/ff.c **** 	const LBA_t plst[],	/* Partition list */
5742:Core/Src/FAT/ff.c **** 	BYTE sys,			/* System ID for each partition (for only MBR) */
5743:Core/Src/FAT/ff.c **** 	BYTE *buf			/* Working buffer for a sector */
5744:Core/Src/FAT/ff.c **** )
5745:Core/Src/FAT/ff.c **** {
 4538              		.loc 1 5745 1 is_stmt 1 view -0
 4539              		.cfi_startproc
 4540              		@ args = 0, pretend = 0, frame = 16
 4541              		@ frame_needed = 0, uses_anonymous_args = 0
 4542              		.loc 1 5745 1 is_stmt 0 view .LVU1511
 4543 0000 2DE9F04F 		push	{r4, r5, r6, r7, r8, r9, r10, fp, lr}
 4544              	.LCFI32:
 4545              		.cfi_def_cfa_offset 36
 4546              		.cfi_offset 4, -36
 4547              		.cfi_offset 5, -32
 4548              		.cfi_offset 6, -28
 4549              		.cfi_offset 7, -24
 4550              		.cfi_offset 8, -20
 4551              		.cfi_offset 9, -16
 4552              		.cfi_offset 10, -12
 4553              		.cfi_offset 11, -8
 4554              		.cfi_offset 14, -4
 4555 0004 85B0     		sub	sp, sp, #20
 4556              	.LCFI33:
 4557              		.cfi_def_cfa_offset 56
 4558 0006 0190     		str	r0, [sp, #4]
 4559 0008 8B46     		mov	fp, r1
 4560 000a 0092     		str	r2, [sp]
 4561 000c 9A46     		mov	r10, r3
5746:Core/Src/FAT/ff.c **** 	UINT i, cy;
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 204


 4562              		.loc 1 5746 2 is_stmt 1 view .LVU1512
5747:Core/Src/FAT/ff.c **** 	LBA_t sz_drv;
 4563              		.loc 1 5747 2 view .LVU1513
5748:Core/Src/FAT/ff.c **** 	DWORD sz_drv32, nxt_alloc32, sz_part32;
 4564              		.loc 1 5748 2 view .LVU1514
5749:Core/Src/FAT/ff.c **** 	BYTE *pte;
 4565              		.loc 1 5749 2 view .LVU1515
5750:Core/Src/FAT/ff.c **** 	BYTE hd, n_hd, sc, n_sc;
 4566              		.loc 1 5750 2 view .LVU1516
5751:Core/Src/FAT/ff.c **** 
5752:Core/Src/FAT/ff.c **** 	/* Get physical drive size */
5753:Core/Src/FAT/ff.c **** 	if (disk_ioctl(drv, GET_SECTOR_COUNT, &sz_drv) != RES_OK) return FR_DISK_ERR;
 4567              		.loc 1 5753 2 view .LVU1517
 4568              		.loc 1 5753 6 is_stmt 0 view .LVU1518
 4569 000e 03AA     		add	r2, sp, #12
 4570              	.LVL550:
 4571              		.loc 1 5753 6 view .LVU1519
 4572 0010 0121     		movs	r1, #1
 4573              	.LVL551:
 4574              		.loc 1 5753 6 view .LVU1520
 4575 0012 FFF7FEFF 		bl	disk_ioctl
 4576              	.LVL552:
 4577              		.loc 1 5753 5 view .LVU1521
 4578 0016 0028     		cmp	r0, #0
 4579 0018 40F08880 		bne	.L343
5754:Core/Src/FAT/ff.c **** 
5755:Core/Src/FAT/ff.c **** #if FF_LBA64
5756:Core/Src/FAT/ff.c **** 	if (sz_drv >= FF_MIN_GPT) {	/* Create partitions in GPT format */
5757:Core/Src/FAT/ff.c **** 		WORD ss;
5758:Core/Src/FAT/ff.c **** 		UINT sz_ptbl, pi, si, ofs;
5759:Core/Src/FAT/ff.c **** 		DWORD bcc, rnd, align;
5760:Core/Src/FAT/ff.c **** 		QWORD nxt_alloc, sz_part, sz_pool, top_bpt;
5761:Core/Src/FAT/ff.c **** 		static const BYTE gpt_mbr[16] = {0x00, 0x00, 0x02, 0x00, 0xEE, 0xFE, 0xFF, 0x00, 0x01, 0x00, 0x00
5762:Core/Src/FAT/ff.c **** 
5763:Core/Src/FAT/ff.c **** #if FF_MAX_SS != FF_MIN_SS
5764:Core/Src/FAT/ff.c **** 		if (disk_ioctl(drv, GET_SECTOR_SIZE, &ss) != RES_OK) return FR_DISK_ERR;	/* Get sector size */
5765:Core/Src/FAT/ff.c **** 		if (ss > FF_MAX_SS || ss < FF_MIN_SS || (ss & (ss - 1))) return FR_DISK_ERR;
5766:Core/Src/FAT/ff.c **** #else
5767:Core/Src/FAT/ff.c **** 		ss = FF_MAX_SS;
5768:Core/Src/FAT/ff.c **** #endif
5769:Core/Src/FAT/ff.c **** 		rnd = (DWORD)sz_drv + GET_FATTIME();	/* Random seed */
5770:Core/Src/FAT/ff.c **** 		align = GPT_ALIGN / ss;				/* Partition alignment for GPT [sector] */
5771:Core/Src/FAT/ff.c **** 		sz_ptbl = GPT_ITEMS * SZ_GPTE / ss;	/* Size of partition table [sector] */
5772:Core/Src/FAT/ff.c **** 		top_bpt = sz_drv - sz_ptbl - 1;		/* Backup partition table start sector */
5773:Core/Src/FAT/ff.c **** 		nxt_alloc = 2 + sz_ptbl;			/* First allocatable sector */
5774:Core/Src/FAT/ff.c **** 		sz_pool = top_bpt - nxt_alloc;		/* Size of allocatable area */
5775:Core/Src/FAT/ff.c **** 		bcc = 0xFFFFFFFF; sz_part = 1;
5776:Core/Src/FAT/ff.c **** 		pi = si = 0;	/* partition table index, size table index */
5777:Core/Src/FAT/ff.c **** 		do {
5778:Core/Src/FAT/ff.c **** 			if (pi * SZ_GPTE % ss == 0) memset(buf, 0, ss);	/* Clean the buffer if needed */
5779:Core/Src/FAT/ff.c **** 			if (sz_part != 0) {				/* Is the size table not termintated? */
5780:Core/Src/FAT/ff.c **** 				nxt_alloc = (nxt_alloc + align - 1) & ((QWORD)0 - align);	/* Align partition start */
5781:Core/Src/FAT/ff.c **** 				sz_part = plst[si++];		/* Get a partition size */
5782:Core/Src/FAT/ff.c **** 				if (sz_part <= 100) {		/* Is the size in percentage? */
5783:Core/Src/FAT/ff.c **** 					sz_part = sz_pool * sz_part / 100;
5784:Core/Src/FAT/ff.c **** 					sz_part = (sz_part + align - 1) & ((QWORD)0 - align);	/* Align partition end (only if in perce
5785:Core/Src/FAT/ff.c **** 				}
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 205


5786:Core/Src/FAT/ff.c **** 				if (nxt_alloc + sz_part > top_bpt) {	/* Clip the size at end of the pool */
5787:Core/Src/FAT/ff.c **** 					sz_part = (nxt_alloc < top_bpt) ? top_bpt - nxt_alloc : 0;
5788:Core/Src/FAT/ff.c **** 				}
5789:Core/Src/FAT/ff.c **** 			}
5790:Core/Src/FAT/ff.c **** 			if (sz_part != 0) {				/* Add a partition? */
5791:Core/Src/FAT/ff.c **** 				ofs = pi * SZ_GPTE % ss;
5792:Core/Src/FAT/ff.c **** 				memcpy(buf + ofs + GPTE_PtGuid, GUID_MS_Basic, 16);	/* Set partition GUID (Microsoft Basic Data
5793:Core/Src/FAT/ff.c **** 				rnd = make_rand(rnd, buf + ofs + GPTE_UpGuid, 16);	/* Set unique partition GUID */
5794:Core/Src/FAT/ff.c **** 				st_qword(buf + ofs + GPTE_FstLba, nxt_alloc);		/* Set partition start sector */
5795:Core/Src/FAT/ff.c **** 				st_qword(buf + ofs + GPTE_LstLba, nxt_alloc + sz_part - 1);	/* Set partition end sector */
5796:Core/Src/FAT/ff.c **** 				nxt_alloc += sz_part;								/* Next allocatable sector */
5797:Core/Src/FAT/ff.c **** 			}
5798:Core/Src/FAT/ff.c **** 			if ((pi + 1) * SZ_GPTE % ss == 0) {		/* Write the buffer if it is filled up */
5799:Core/Src/FAT/ff.c **** 				for (i = 0; i < ss; bcc = crc32(bcc, buf[i++])) ;	/* Calculate table check sum */
5800:Core/Src/FAT/ff.c **** 				if (disk_write(drv, buf, 2 + pi * SZ_GPTE / ss, 1) != RES_OK) return FR_DISK_ERR;		/* Write to 
5801:Core/Src/FAT/ff.c **** 				if (disk_write(drv, buf, top_bpt + pi * SZ_GPTE / ss, 1) != RES_OK) return FR_DISK_ERR;	/* Writ
5802:Core/Src/FAT/ff.c **** 			}
5803:Core/Src/FAT/ff.c **** 		} while (++pi < GPT_ITEMS);
5804:Core/Src/FAT/ff.c **** 
5805:Core/Src/FAT/ff.c **** 		/* Create primary GPT header */
5806:Core/Src/FAT/ff.c **** 		memset(buf, 0, ss);
5807:Core/Src/FAT/ff.c **** 		memcpy(buf + GPTH_Sign, "EFI PART" "\0\0\1\0" "\x5C\0\0", 16);	/* Signature, version (1.0) and si
5808:Core/Src/FAT/ff.c **** 		st_dword(buf + GPTH_PtBcc, ~bcc);			/* Table check sum */
5809:Core/Src/FAT/ff.c **** 		st_qword(buf + GPTH_CurLba, 1);				/* LBA of this header */
5810:Core/Src/FAT/ff.c **** 		st_qword(buf + GPTH_BakLba, sz_drv - 1);	/* LBA of secondary header */
5811:Core/Src/FAT/ff.c **** 		st_qword(buf + GPTH_FstLba, 2 + sz_ptbl);	/* LBA of first allocatable sector */
5812:Core/Src/FAT/ff.c **** 		st_qword(buf + GPTH_LstLba, top_bpt - 1);	/* LBA of last allocatable sector */
5813:Core/Src/FAT/ff.c **** 		st_dword(buf + GPTH_PteSize, SZ_GPTE);		/* Size of a table entry */
5814:Core/Src/FAT/ff.c **** 		st_dword(buf + GPTH_PtNum, GPT_ITEMS);		/* Number of table entries */
5815:Core/Src/FAT/ff.c **** 		st_dword(buf + GPTH_PtOfs, 2);				/* LBA of this table */
5816:Core/Src/FAT/ff.c **** 		rnd = make_rand(rnd, buf + GPTH_DskGuid, 16);	/* Disk GUID */
5817:Core/Src/FAT/ff.c **** 		for (i = 0, bcc= 0xFFFFFFFF; i < 92; bcc = crc32(bcc, buf[i++])) ;	/* Calculate header check sum 
5818:Core/Src/FAT/ff.c **** 		st_dword(buf + GPTH_Bcc, ~bcc);				/* Header check sum */
5819:Core/Src/FAT/ff.c **** 		if (disk_write(drv, buf, 1, 1) != RES_OK) return FR_DISK_ERR;
5820:Core/Src/FAT/ff.c **** 
5821:Core/Src/FAT/ff.c **** 		/* Create secondary GPT header */
5822:Core/Src/FAT/ff.c **** 		st_qword(buf + GPTH_CurLba, sz_drv - 1);	/* LBA of this header */
5823:Core/Src/FAT/ff.c **** 		st_qword(buf + GPTH_BakLba, 1);				/* LBA of primary header */
5824:Core/Src/FAT/ff.c **** 		st_qword(buf + GPTH_PtOfs, top_bpt);		/* LBA of this table */
5825:Core/Src/FAT/ff.c **** 		st_dword(buf + GPTH_Bcc, 0);
5826:Core/Src/FAT/ff.c **** 		for (i = 0, bcc= 0xFFFFFFFF; i < 92; bcc = crc32(bcc, buf[i++])) ;	/* Calculate header check sum 
5827:Core/Src/FAT/ff.c **** 		st_dword(buf + GPTH_Bcc, ~bcc);				/* Header check sum */
5828:Core/Src/FAT/ff.c **** 		if (disk_write(drv, buf, sz_drv - 1, 1) != RES_OK) return FR_DISK_ERR;
5829:Core/Src/FAT/ff.c **** 
5830:Core/Src/FAT/ff.c **** 		/* Create protective MBR */
5831:Core/Src/FAT/ff.c **** 		memset(buf, 0, ss);
5832:Core/Src/FAT/ff.c **** 		memcpy(buf + MBR_Table, gpt_mbr, 16);		/* Create a GPT partition */
5833:Core/Src/FAT/ff.c **** 		st_word(buf + BS_55AA, 0xAA55);
5834:Core/Src/FAT/ff.c **** 		if (disk_write(drv, buf, 0, 1) != RES_OK) return FR_DISK_ERR;
5835:Core/Src/FAT/ff.c **** 
5836:Core/Src/FAT/ff.c **** 	} else
5837:Core/Src/FAT/ff.c **** #endif
5838:Core/Src/FAT/ff.c **** 	{	/* Create partitions in MBR format */
5839:Core/Src/FAT/ff.c **** 		sz_drv32 = (DWORD)sz_drv;
 4580              		.loc 1 5839 3 is_stmt 1 view .LVU1522
 4581              		.loc 1 5839 12 is_stmt 0 view .LVU1523
 4582 001c DDF80C80 		ldr	r8, [sp, #12]
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 206


 4583              	.LVL553:
5840:Core/Src/FAT/ff.c **** 		n_sc = N_SEC_TRACK;				/* Determine drive CHS without any consideration of the drive geometry */
 4584              		.loc 1 5840 3 is_stmt 1 view .LVU1524
5841:Core/Src/FAT/ff.c **** 		for (n_hd = 8; n_hd != 0 && sz_drv32 / n_hd / n_sc > 1024; n_hd *= 2) ;
 4585              		.loc 1 5841 3 view .LVU1525
 4586              		.loc 1 5841 13 is_stmt 0 view .LVU1526
 4587 0020 0824     		movs	r4, #8
 4588              	.LVL554:
 4589              	.L333:
 4590              		.loc 1 5841 18 is_stmt 1 discriminator 1 view .LVU1527
 4591              		.loc 1 5841 3 is_stmt 0 discriminator 1 view .LVU1528
 4592 0022 44B1     		cbz	r4, .L334
 4593              		.loc 1 5841 40 discriminator 3 view .LVU1529
 4594 0024 B8FBF4F2 		udiv	r2, r8, r4
 4595              		.loc 1 5841 28 discriminator 3 view .LVU1530
 4596 0028 4FF63E43 		movw	r3, #64574
 4597 002c 9A42     		cmp	r2, r3
 4598 002e 02D9     		bls	.L334
 4599              		.loc 1 5841 73 is_stmt 1 discriminator 4 view .LVU1531
 4600              		.loc 1 5841 62 discriminator 4 view .LVU1532
 4601              		.loc 1 5841 67 is_stmt 0 discriminator 4 view .LVU1533
 4602 0030 6400     		lsls	r4, r4, #1
 4603              	.LVL555:
 4604              		.loc 1 5841 67 discriminator 4 view .LVU1534
 4605 0032 E4B2     		uxtb	r4, r4
 4606              	.LVL556:
 4607              		.loc 1 5841 67 discriminator 4 view .LVU1535
 4608 0034 F5E7     		b	.L333
 4609              	.L334:
5842:Core/Src/FAT/ff.c **** 		if (n_hd == 0) n_hd = 255;		/* Number of heads needs to be <256 */
 4610              		.loc 1 5842 3 is_stmt 1 view .LVU1536
 4611              		.loc 1 5842 6 is_stmt 0 view .LVU1537
 4612 0036 04B9     		cbnz	r4, .L336
 4613              		.loc 1 5842 23 view .LVU1538
 4614 0038 FF24     		movs	r4, #255
 4615              	.LVL557:
 4616              	.L336:
5843:Core/Src/FAT/ff.c **** 
5844:Core/Src/FAT/ff.c **** 		memset(buf, 0, FF_MAX_SS);		/* Clear MBR */
 4617              		.loc 1 5844 3 is_stmt 1 view .LVU1539
 4618 003a 4FF40072 		mov	r2, #512
 4619 003e 0021     		movs	r1, #0
 4620 0040 5046     		mov	r0, r10
 4621 0042 FFF7FEFF 		bl	memset
 4622              	.LVL558:
5845:Core/Src/FAT/ff.c **** 		pte = buf + MBR_Table;	/* Partition table in the MBR */
 4623              		.loc 1 5845 3 view .LVU1540
 4624              		.loc 1 5845 7 is_stmt 0 view .LVU1541
 4625 0046 0AF5DF76 		add	r6, r10, #446
 4626              	.LVL559:
5846:Core/Src/FAT/ff.c **** 		for (i = 0, nxt_alloc32 = n_sc; i < 4 && nxt_alloc32 != 0 && nxt_alloc32 < sz_drv32; i++, nxt_all
 4627              		.loc 1 5846 3 is_stmt 1 view .LVU1542
 4628              		.loc 1 5846 27 is_stmt 0 view .LVU1543
 4629 004a 3F25     		movs	r5, #63
 4630              		.loc 1 5846 10 view .LVU1544
 4631 004c 4FF00009 		mov	r9, #0
 4632              		.loc 1 5846 3 view .LVU1545
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 207


 4633 0050 45E0     		b	.L337
 4634              	.LVL560:
 4635              	.L345:
5847:Core/Src/FAT/ff.c **** 			sz_part32 = (DWORD)plst[i];	/* Get partition size */
5848:Core/Src/FAT/ff.c **** 			if (sz_part32 <= 100) sz_part32 = (sz_part32 == 100) ? sz_drv32 : sz_drv32 / 100 * sz_part32;	/*
 4636              		.loc 1 5848 68 view .LVU1546
 4637 0052 4746     		mov	r7, r8
 4638              	.LVL561:
 4639              		.loc 1 5848 68 view .LVU1547
 4640 0054 54E0     		b	.L338
 4641              	.LVL562:
 4642              	.L339:
5849:Core/Src/FAT/ff.c **** 			if (nxt_alloc32 + sz_part32 > sz_drv32 || nxt_alloc32 + sz_part32 < nxt_alloc32) sz_part32 = sz_
 4643              		.loc 1 5849 85 is_stmt 1 discriminator 3 view .LVU1548
 4644              		.loc 1 5849 95 is_stmt 0 discriminator 3 view .LVU1549
 4645 0056 A8EB0507 		sub	r7, r8, r5
 4646              	.LVL563:
 4647              	.L340:
5850:Core/Src/FAT/ff.c **** 			if (sz_part32 == 0) break;	/* End of table or no sector to allocate? */
 4648              		.loc 1 5850 4 is_stmt 1 view .LVU1550
 4649              		.loc 1 5850 7 is_stmt 0 view .LVU1551
 4650 005a 002F     		cmp	r7, #0
 4651 005c 56D0     		beq	.L341
5851:Core/Src/FAT/ff.c **** 
5852:Core/Src/FAT/ff.c **** 			st_dword(pte + PTE_StLba, nxt_alloc32);	/* Start LBA */
 4652              		.loc 1 5852 4 is_stmt 1 discriminator 2 view .LVU1552
 4653 005e 2946     		mov	r1, r5
 4654 0060 06F10800 		add	r0, r6, #8
 4655 0064 FFF7FEFF 		bl	st_dword
 4656              	.LVL564:
5853:Core/Src/FAT/ff.c **** 			st_dword(pte + PTE_SizLba, sz_part32);	/* Number of sectors */
 4657              		.loc 1 5853 4 discriminator 2 view .LVU1553
 4658 0068 3946     		mov	r1, r7
 4659 006a 06F10C00 		add	r0, r6, #12
 4660 006e FFF7FEFF 		bl	st_dword
 4661              	.LVL565:
5854:Core/Src/FAT/ff.c **** 			pte[PTE_System] = sys;					/* System type */
 4662              		.loc 1 5854 4 discriminator 2 view .LVU1554
 4663              		.loc 1 5854 20 is_stmt 0 discriminator 2 view .LVU1555
 4664 0072 009B     		ldr	r3, [sp]
 4665 0074 3371     		strb	r3, [r6, #4]
5855:Core/Src/FAT/ff.c **** 
5856:Core/Src/FAT/ff.c **** 			cy = (UINT)(nxt_alloc32 / n_sc / n_hd);	/* Start cylinder */
 4666              		.loc 1 5856 4 is_stmt 1 discriminator 2 view .LVU1556
 4667              		.loc 1 5856 28 is_stmt 0 discriminator 2 view .LVU1557
 4668 0076 2F4A     		ldr	r2, .L349
 4669 0078 A2FB0513 		umull	r1, r3, r2, r5
 4670 007c E91A     		subs	r1, r5, r3
 4671 007e 03EB5103 		add	r3, r3, r1, lsr #1
 4672 0082 5B09     		lsrs	r3, r3, #5
 4673              		.loc 1 5856 7 discriminator 2 view .LVU1558
 4674 0084 B3FBF4F1 		udiv	r1, r3, r4
 4675              	.LVL566:
5857:Core/Src/FAT/ff.c **** 			hd = (BYTE)(nxt_alloc32 / n_sc % n_hd);	/* Start head */
 4676              		.loc 1 5857 4 is_stmt 1 discriminator 2 view .LVU1559
 4677              		.loc 1 5857 35 is_stmt 0 discriminator 2 view .LVU1560
 4678 0088 04FB1130 		mls	r0, r4, r1, r3
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 208


 4679              	.LVL567:
5858:Core/Src/FAT/ff.c **** 			sc = (BYTE)(nxt_alloc32 % n_sc + 1);	/* Start sector */
 4680              		.loc 1 5858 4 is_stmt 1 discriminator 2 view .LVU1561
 4681              		.loc 1 5858 28 is_stmt 0 discriminator 2 view .LVU1562
 4682 008c C3EB8313 		rsb	r3, r3, r3, lsl #6
 4683 0090 EB1A     		subs	r3, r5, r3
 4684              		.loc 1 5858 9 discriminator 2 view .LVU1563
 4685 0092 DBB2     		uxtb	r3, r3
 4686              		.loc 1 5858 7 discriminator 2 view .LVU1564
 4687 0094 0133     		adds	r3, r3, #1
 4688 0096 DBB2     		uxtb	r3, r3
 4689              	.LVL568:
5859:Core/Src/FAT/ff.c **** 			pte[PTE_StHead] = hd;
 4690              		.loc 1 5859 4 is_stmt 1 discriminator 2 view .LVU1565
 4691              		.loc 1 5859 20 is_stmt 0 discriminator 2 view .LVU1566
 4692 0098 7070     		strb	r0, [r6, #1]
5860:Core/Src/FAT/ff.c **** 			pte[PTE_StSec] = (BYTE)((cy >> 2 & 0xC0) | sc);
 4693              		.loc 1 5860 4 is_stmt 1 discriminator 2 view .LVU1567
 4694              		.loc 1 5860 32 is_stmt 0 discriminator 2 view .LVU1568
 4695 009a 8808     		lsrs	r0, r1, #2
 4696              	.LVL569:
 4697              		.loc 1 5860 37 discriminator 2 view .LVU1569
 4698 009c 00F0C000 		and	r0, r0, #192
 4699              		.loc 1 5860 21 discriminator 2 view .LVU1570
 4700 00a0 0343     		orrs	r3, r3, r0
 4701              	.LVL570:
 4702              		.loc 1 5860 19 discriminator 2 view .LVU1571
 4703 00a2 B370     		strb	r3, [r6, #2]
5861:Core/Src/FAT/ff.c **** 			pte[PTE_StCyl] = (BYTE)cy;
 4704              		.loc 1 5861 4 is_stmt 1 discriminator 2 view .LVU1572
 4705              		.loc 1 5861 19 is_stmt 0 discriminator 2 view .LVU1573
 4706 00a4 F170     		strb	r1, [r6, #3]
5862:Core/Src/FAT/ff.c **** 
5863:Core/Src/FAT/ff.c **** 			cy = (UINT)((nxt_alloc32 + sz_part32 - 1) / n_sc / n_hd);	/* End cylinder */
 4707              		.loc 1 5863 4 is_stmt 1 discriminator 2 view .LVU1574
 4708              		.loc 1 5863 29 is_stmt 0 discriminator 2 view .LVU1575
 4709 00a6 3D44     		add	r5, r5, r7
 4710              	.LVL571:
 4711              		.loc 1 5863 41 discriminator 2 view .LVU1576
 4712 00a8 6B1E     		subs	r3, r5, #1
 4713              		.loc 1 5863 46 discriminator 2 view .LVU1577
 4714 00aa A2FB0312 		umull	r1, r2, r2, r3
 4715              	.LVL572:
 4716              		.loc 1 5863 46 discriminator 2 view .LVU1578
 4717 00ae 991A     		subs	r1, r3, r2
 4718 00b0 02EB5102 		add	r2, r2, r1, lsr #1
 4719 00b4 5209     		lsrs	r2, r2, #5
 4720              		.loc 1 5863 7 discriminator 2 view .LVU1579
 4721 00b6 B2FBF4F1 		udiv	r1, r2, r4
 4722              	.LVL573:
5864:Core/Src/FAT/ff.c **** 			hd = (BYTE)((nxt_alloc32 + sz_part32 - 1) / n_sc % n_hd);	/* End head */
 4723              		.loc 1 5864 4 is_stmt 1 discriminator 2 view .LVU1580
 4724              		.loc 1 5864 53 is_stmt 0 discriminator 2 view .LVU1581
 4725 00ba 04FB1120 		mls	r0, r4, r1, r2
 4726              	.LVL574:
5865:Core/Src/FAT/ff.c **** 			sc = (BYTE)((nxt_alloc32 + sz_part32 - 1) % n_sc + 1);		/* End sector */
 4727              		.loc 1 5865 4 is_stmt 1 discriminator 2 view .LVU1582
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 209


 4728              		.loc 1 5865 46 is_stmt 0 discriminator 2 view .LVU1583
 4729 00be C2EB8212 		rsb	r2, r2, r2, lsl #6
 4730 00c2 9A1A     		subs	r2, r3, r2
 4731              		.loc 1 5865 9 discriminator 2 view .LVU1584
 4732 00c4 D2B2     		uxtb	r2, r2
 4733              		.loc 1 5865 7 discriminator 2 view .LVU1585
 4734 00c6 0132     		adds	r2, r2, #1
 4735 00c8 D2B2     		uxtb	r2, r2
 4736              	.LVL575:
5866:Core/Src/FAT/ff.c **** 			pte[PTE_EdHead] = hd;
 4737              		.loc 1 5866 4 is_stmt 1 discriminator 2 view .LVU1586
 4738              		.loc 1 5866 20 is_stmt 0 discriminator 2 view .LVU1587
 4739 00ca 7071     		strb	r0, [r6, #5]
5867:Core/Src/FAT/ff.c **** 			pte[PTE_EdSec] = (BYTE)((cy >> 2 & 0xC0) | sc);
 4740              		.loc 1 5867 4 is_stmt 1 discriminator 2 view .LVU1588
 4741              		.loc 1 5867 32 is_stmt 0 discriminator 2 view .LVU1589
 4742 00cc 8B08     		lsrs	r3, r1, #2
 4743              		.loc 1 5867 37 discriminator 2 view .LVU1590
 4744 00ce 03F0C003 		and	r3, r3, #192
 4745              		.loc 1 5867 21 discriminator 2 view .LVU1591
 4746 00d2 1A43     		orrs	r2, r2, r3
 4747              	.LVL576:
 4748              		.loc 1 5867 19 discriminator 2 view .LVU1592
 4749 00d4 B271     		strb	r2, [r6, #6]
5868:Core/Src/FAT/ff.c **** 			pte[PTE_EdCyl] = (BYTE)cy;
 4750              		.loc 1 5868 4 is_stmt 1 discriminator 2 view .LVU1593
 4751              		.loc 1 5868 19 is_stmt 0 discriminator 2 view .LVU1594
 4752 00d6 F171     		strb	r1, [r6, #7]
5869:Core/Src/FAT/ff.c **** 
5870:Core/Src/FAT/ff.c **** 			pte += SZ_PTE;		/* Next entry */
 4753              		.loc 1 5870 4 is_stmt 1 discriminator 2 view .LVU1595
 4754              		.loc 1 5870 8 is_stmt 0 discriminator 2 view .LVU1596
 4755 00d8 1036     		adds	r6, r6, #16
 4756              	.LVL577:
5846:Core/Src/FAT/ff.c **** 			sz_part32 = (DWORD)plst[i];	/* Get partition size */
 4757              		.loc 1 5846 88 is_stmt 1 discriminator 2 view .LVU1597
5846:Core/Src/FAT/ff.c **** 			sz_part32 = (DWORD)plst[i];	/* Get partition size */
 4758              		.loc 1 5846 89 is_stmt 0 discriminator 2 view .LVU1598
 4759 00da 09F10109 		add	r9, r9, #1
 4760              	.LVL578:
 4761              	.L337:
5846:Core/Src/FAT/ff.c **** 			sz_part32 = (DWORD)plst[i];	/* Get partition size */
 4762              		.loc 1 5846 35 is_stmt 1 discriminator 1 view .LVU1599
5846:Core/Src/FAT/ff.c **** 			sz_part32 = (DWORD)plst[i];	/* Get partition size */
 4763              		.loc 1 5846 3 is_stmt 0 discriminator 1 view .LVU1600
 4764 00de B9F1030F 		cmp	r9, #3
 4765 00e2 13D8     		bhi	.L341
5846:Core/Src/FAT/ff.c **** 			sz_part32 = (DWORD)plst[i];	/* Get partition size */
 4766              		.loc 1 5846 41 discriminator 3 view .LVU1601
 4767 00e4 95B1     		cbz	r5, .L341
5846:Core/Src/FAT/ff.c **** 			sz_part32 = (DWORD)plst[i];	/* Get partition size */
 4768              		.loc 1 5846 61 discriminator 4 view .LVU1602
 4769 00e6 4545     		cmp	r5, r8
 4770 00e8 10D2     		bcs	.L341
5847:Core/Src/FAT/ff.c **** 			if (sz_part32 <= 100) sz_part32 = (sz_part32 == 100) ? sz_drv32 : sz_drv32 / 100 * sz_part32;	/*
 4771              		.loc 1 5847 4 is_stmt 1 view .LVU1603
5847:Core/Src/FAT/ff.c **** 			if (sz_part32 <= 100) sz_part32 = (sz_part32 == 100) ? sz_drv32 : sz_drv32 / 100 * sz_part32;	/*
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 210


 4772              		.loc 1 5847 14 is_stmt 0 view .LVU1604
 4773 00ea 5BF82970 		ldr	r7, [fp, r9, lsl #2]
 4774              	.LVL579:
5848:Core/Src/FAT/ff.c **** 			if (nxt_alloc32 + sz_part32 > sz_drv32 || nxt_alloc32 + sz_part32 < nxt_alloc32) sz_part32 = sz_
 4775              		.loc 1 5848 4 is_stmt 1 view .LVU1605
5848:Core/Src/FAT/ff.c **** 			if (nxt_alloc32 + sz_part32 > sz_drv32 || nxt_alloc32 + sz_part32 < nxt_alloc32) sz_part32 = sz_
 4776              		.loc 1 5848 7 is_stmt 0 view .LVU1606
 4777 00ee 642F     		cmp	r7, #100
 4778 00f0 06D8     		bhi	.L338
5848:Core/Src/FAT/ff.c **** 			if (nxt_alloc32 + sz_part32 > sz_drv32 || nxt_alloc32 + sz_part32 < nxt_alloc32) sz_part32 = sz_
 4779              		.loc 1 5848 26 is_stmt 1 discriminator 1 view .LVU1607
5848:Core/Src/FAT/ff.c **** 			if (nxt_alloc32 + sz_part32 > sz_drv32 || nxt_alloc32 + sz_part32 < nxt_alloc32) sz_part32 = sz_
 4780              		.loc 1 5848 68 is_stmt 0 discriminator 1 view .LVU1608
 4781 00f2 AED0     		beq	.L345
5848:Core/Src/FAT/ff.c **** 			if (nxt_alloc32 + sz_part32 > sz_drv32 || nxt_alloc32 + sz_part32 < nxt_alloc32) sz_part32 = sz_
 4782              		.loc 1 5848 79 discriminator 2 view .LVU1609
 4783 00f4 104B     		ldr	r3, .L349+4
 4784 00f6 A3FB0823 		umull	r2, r3, r3, r8
 4785 00fa 5B09     		lsrs	r3, r3, #5
5848:Core/Src/FAT/ff.c **** 			if (nxt_alloc32 + sz_part32 > sz_drv32 || nxt_alloc32 + sz_part32 < nxt_alloc32) sz_part32 = sz_
 4786              		.loc 1 5848 68 discriminator 2 view .LVU1610
 4787 00fc 03FB07F7 		mul	r7, r3, r7
 4788              	.LVL580:
 4789              	.L338:
5849:Core/Src/FAT/ff.c **** 			if (sz_part32 == 0) break;	/* End of table or no sector to allocate? */
 4790              		.loc 1 5849 4 is_stmt 1 view .LVU1611
5849:Core/Src/FAT/ff.c **** 			if (sz_part32 == 0) break;	/* End of table or no sector to allocate? */
 4791              		.loc 1 5849 20 is_stmt 0 view .LVU1612
 4792 0100 EB19     		adds	r3, r5, r7
5849:Core/Src/FAT/ff.c **** 			if (sz_part32 == 0) break;	/* End of table or no sector to allocate? */
 4793              		.loc 1 5849 7 view .LVU1613
 4794 0102 4345     		cmp	r3, r8
 4795 0104 A7D8     		bhi	.L339
5849:Core/Src/FAT/ff.c **** 			if (sz_part32 == 0) break;	/* End of table or no sector to allocate? */
 4796              		.loc 1 5849 43 discriminator 2 view .LVU1614
 4797 0106 AB42     		cmp	r3, r5
 4798 0108 A7D2     		bcs	.L340
 4799 010a A4E7     		b	.L339
 4800              	.LVL581:
 4801              	.L341:
5871:Core/Src/FAT/ff.c **** 		}
5872:Core/Src/FAT/ff.c **** 
5873:Core/Src/FAT/ff.c **** 		st_word(buf + BS_55AA, 0xAA55);		/* MBR signature */
 4802              		.loc 1 5873 3 is_stmt 1 view .LVU1615
 4803 010c 4AF65521 		movw	r1, #43605
 4804 0110 0AF5FF70 		add	r0, r10, #510
 4805 0114 FFF7FEFF 		bl	st_word
 4806              	.LVL582:
5874:Core/Src/FAT/ff.c **** 		if (disk_write(drv, buf, 0, 1) != RES_OK) return FR_DISK_ERR;	/* Write it to the MBR */
 4807              		.loc 1 5874 3 view .LVU1616
 4808              		.loc 1 5874 7 is_stmt 0 view .LVU1617
 4809 0118 0123     		movs	r3, #1
 4810 011a 0022     		movs	r2, #0
 4811 011c 5146     		mov	r1, r10
 4812 011e 0198     		ldr	r0, [sp, #4]
 4813 0120 FFF7FEFF 		bl	disk_write
 4814              	.LVL583:
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 211


 4815              		.loc 1 5874 6 view .LVU1618
 4816 0124 20B9     		cbnz	r0, .L348
 4817              	.LVL584:
 4818              	.L332:
5875:Core/Src/FAT/ff.c **** 	}
5876:Core/Src/FAT/ff.c **** 
5877:Core/Src/FAT/ff.c **** 	return FR_OK;
5878:Core/Src/FAT/ff.c **** }
 4819              		.loc 1 5878 1 view .LVU1619
 4820 0126 05B0     		add	sp, sp, #20
 4821              	.LCFI34:
 4822              		.cfi_remember_state
 4823              		.cfi_def_cfa_offset 36
 4824              		@ sp needed
 4825 0128 BDE8F08F 		pop	{r4, r5, r6, r7, r8, r9, r10, fp, pc}
 4826              	.LVL585:
 4827              	.L343:
 4828              	.LCFI35:
 4829              		.cfi_restore_state
5753:Core/Src/FAT/ff.c **** 
 4830              		.loc 1 5753 67 view .LVU1620
 4831 012c 0120     		movs	r0, #1
 4832 012e FAE7     		b	.L332
 4833              	.LVL586:
 4834              	.L348:
5874:Core/Src/FAT/ff.c **** 		if (disk_write(drv, buf, 0, 1) != RES_OK) return FR_DISK_ERR;	/* Write it to the MBR */
 4835              		.loc 1 5874 52 view .LVU1621
 4836 0130 0120     		movs	r0, #1
 4837 0132 F8E7     		b	.L332
 4838              	.L350:
 4839              		.align	2
 4840              	.L349:
 4841 0134 05411004 		.word	68174085
 4842 0138 1F85EB51 		.word	1374389535
 4843              		.cfi_endproc
 4844              	.LFE48:
 4846              		.section	.text.f_mount,"ax",%progbits
 4847              		.align	1
 4848              		.global	f_mount
 4849              		.syntax unified
 4850              		.thumb
 4851              		.thumb_func
 4853              	f_mount:
 4854              	.LVL587:
 4855              	.LFB32:
3662:Core/Src/FAT/ff.c **** 	FATFS *cfs;
 4856              		.loc 1 3662 1 is_stmt 1 view -0
 4857              		.cfi_startproc
 4858              		@ args = 0, pretend = 0, frame = 16
 4859              		@ frame_needed = 0, uses_anonymous_args = 0
3662:Core/Src/FAT/ff.c **** 	FATFS *cfs;
 4860              		.loc 1 3662 1 is_stmt 0 view .LVU1623
 4861 0000 10B5     		push	{r4, lr}
 4862              	.LCFI36:
 4863              		.cfi_def_cfa_offset 8
 4864              		.cfi_offset 4, -8
 4865              		.cfi_offset 14, -4
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 212


 4866 0002 84B0     		sub	sp, sp, #16
 4867              	.LCFI37:
 4868              		.cfi_def_cfa_offset 24
 4869 0004 0190     		str	r0, [sp, #4]
 4870 0006 0091     		str	r1, [sp]
 4871 0008 1446     		mov	r4, r2
3663:Core/Src/FAT/ff.c **** 	int vol;
 4872              		.loc 1 3663 2 is_stmt 1 view .LVU1624
3664:Core/Src/FAT/ff.c **** 	FRESULT res;
 4873              		.loc 1 3664 2 view .LVU1625
3665:Core/Src/FAT/ff.c **** 	const TCHAR *rp = path;
 4874              		.loc 1 3665 2 view .LVU1626
3666:Core/Src/FAT/ff.c **** 
 4875              		.loc 1 3666 2 view .LVU1627
3666:Core/Src/FAT/ff.c **** 
 4876              		.loc 1 3666 15 is_stmt 0 view .LVU1628
 4877 000a 0391     		str	r1, [sp, #12]
3670:Core/Src/FAT/ff.c **** 	if (vol < 0) return FR_INVALID_DRIVE;
 4878              		.loc 1 3670 2 is_stmt 1 view .LVU1629
3670:Core/Src/FAT/ff.c **** 	if (vol < 0) return FR_INVALID_DRIVE;
 4879              		.loc 1 3670 8 is_stmt 0 view .LVU1630
 4880 000c 03A8     		add	r0, sp, #12
 4881              	.LVL588:
3670:Core/Src/FAT/ff.c **** 	if (vol < 0) return FR_INVALID_DRIVE;
 4882              		.loc 1 3670 8 view .LVU1631
 4883 000e FFF7FEFF 		bl	get_ldnumber
 4884              	.LVL589:
3671:Core/Src/FAT/ff.c **** 	cfs = FatFs[vol];			/* Pointer to the filesystem object of the volume */
 4885              		.loc 1 3671 2 is_stmt 1 view .LVU1632
3671:Core/Src/FAT/ff.c **** 	cfs = FatFs[vol];			/* Pointer to the filesystem object of the volume */
 4886              		.loc 1 3671 5 is_stmt 0 view .LVU1633
 4887 0012 0028     		cmp	r0, #0
3671:Core/Src/FAT/ff.c **** 	cfs = FatFs[vol];			/* Pointer to the filesystem object of the volume */
 4888              		.loc 1 3671 5 view .LVU1634
 4889 0014 1CDB     		blt	.L355
3672:Core/Src/FAT/ff.c **** 
 4890              		.loc 1 3672 2 is_stmt 1 view .LVU1635
3672:Core/Src/FAT/ff.c **** 
 4891              		.loc 1 3672 6 is_stmt 0 view .LVU1636
 4892 0016 0F4B     		ldr	r3, .L359
 4893 0018 53F82030 		ldr	r3, [r3, r0, lsl #2]
 4894              	.LVL590:
3674:Core/Src/FAT/ff.c **** 		FatFs[vol] = 0;
 4895              		.loc 1 3674 2 is_stmt 1 view .LVU1637
3674:Core/Src/FAT/ff.c **** 		FatFs[vol] = 0;
 4896              		.loc 1 3674 5 is_stmt 0 view .LVU1638
 4897 001c 23B1     		cbz	r3, .L353
3675:Core/Src/FAT/ff.c **** #if FF_FS_LOCK
 4898              		.loc 1 3675 3 is_stmt 1 view .LVU1639
3675:Core/Src/FAT/ff.c **** #if FF_FS_LOCK
 4899              		.loc 1 3675 14 is_stmt 0 view .LVU1640
 4900 001e 0022     		movs	r2, #0
 4901 0020 0C49     		ldr	r1, .L359
 4902 0022 41F82020 		str	r2, [r1, r0, lsl #2]
3682:Core/Src/FAT/ff.c **** 	}
 4903              		.loc 1 3682 3 is_stmt 1 view .LVU1641
3682:Core/Src/FAT/ff.c **** 	}
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 213


 4904              		.loc 1 3682 16 is_stmt 0 view .LVU1642
 4905 0026 1A70     		strb	r2, [r3]
 4906              	.L353:
3685:Core/Src/FAT/ff.c **** 		fs->pdrv = LD2PD(vol);	/* Volume hosting physical drive */
 4907              		.loc 1 3685 2 is_stmt 1 view .LVU1643
3685:Core/Src/FAT/ff.c **** 		fs->pdrv = LD2PD(vol);	/* Volume hosting physical drive */
 4908              		.loc 1 3685 6 is_stmt 0 view .LVU1644
 4909 0028 019B     		ldr	r3, [sp, #4]
 4910              	.LVL591:
3685:Core/Src/FAT/ff.c **** 		fs->pdrv = LD2PD(vol);	/* Volume hosting physical drive */
 4911              		.loc 1 3685 5 view .LVU1645
 4912 002a 3BB1     		cbz	r3, .L354
3686:Core/Src/FAT/ff.c **** #if FF_FS_REENTRANT				/* Create a volume mutex */
 4913              		.loc 1 3686 3 is_stmt 1 view .LVU1646
3686:Core/Src/FAT/ff.c **** #if FF_FS_REENTRANT				/* Create a volume mutex */
 4914              		.loc 1 3686 12 is_stmt 0 view .LVU1647
 4915 002c 5870     		strb	r0, [r3, #1]
3700:Core/Src/FAT/ff.c **** 		FatFs[vol] = fs;		/* Register new fs object */
 4916              		.loc 1 3700 3 is_stmt 1 view .LVU1648
3700:Core/Src/FAT/ff.c **** 		FatFs[vol] = fs;		/* Register new fs object */
 4917              		.loc 1 3700 15 is_stmt 0 view .LVU1649
 4918 002e 019B     		ldr	r3, [sp, #4]
 4919 0030 0022     		movs	r2, #0
 4920 0032 1A70     		strb	r2, [r3]
3701:Core/Src/FAT/ff.c **** 	}
 4921              		.loc 1 3701 3 is_stmt 1 view .LVU1650
3701:Core/Src/FAT/ff.c **** 	}
 4922              		.loc 1 3701 14 is_stmt 0 view .LVU1651
 4923 0034 074B     		ldr	r3, .L359
 4924 0036 019A     		ldr	r2, [sp, #4]
 4925 0038 43F82020 		str	r2, [r3, r0, lsl #2]
 4926              	.L354:
3704:Core/Src/FAT/ff.c **** 
 4927              		.loc 1 3704 2 is_stmt 1 view .LVU1652
3704:Core/Src/FAT/ff.c **** 
 4928              		.loc 1 3704 5 is_stmt 0 view .LVU1653
 4929 003c 14B9     		cbnz	r4, .L358
3704:Core/Src/FAT/ff.c **** 
 4930              		.loc 1 3704 23 view .LVU1654
 4931 003e 2046     		mov	r0, r4
 4932              	.LVL592:
 4933              	.L352:
3708:Core/Src/FAT/ff.c **** 
 4934              		.loc 1 3708 1 view .LVU1655
 4935 0040 04B0     		add	sp, sp, #16
 4936              	.LCFI38:
 4937              		.cfi_remember_state
 4938              		.cfi_def_cfa_offset 8
 4939              		@ sp needed
 4940 0042 10BD     		pop	{r4, pc}
 4941              	.LVL593:
 4942              	.L358:
 4943              	.LCFI39:
 4944              		.cfi_restore_state
3706:Core/Src/FAT/ff.c **** 	LEAVE_FF(fs, res);
 4945              		.loc 1 3706 2 is_stmt 1 view .LVU1656
3706:Core/Src/FAT/ff.c **** 	LEAVE_FF(fs, res);
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 214


 4946              		.loc 1 3706 8 is_stmt 0 view .LVU1657
 4947 0044 0022     		movs	r2, #0
 4948 0046 01A9     		add	r1, sp, #4
 4949 0048 6846     		mov	r0, sp
 4950              	.LVL594:
3706:Core/Src/FAT/ff.c **** 	LEAVE_FF(fs, res);
 4951              		.loc 1 3706 8 view .LVU1658
 4952 004a FFF7FEFF 		bl	mount_volume
 4953              	.LVL595:
3707:Core/Src/FAT/ff.c **** }
 4954              		.loc 1 3707 2 is_stmt 1 view .LVU1659
 4955 004e F7E7     		b	.L352
 4956              	.LVL596:
 4957              	.L355:
3671:Core/Src/FAT/ff.c **** 	cfs = FatFs[vol];			/* Pointer to the filesystem object of the volume */
 4958              		.loc 1 3671 22 is_stmt 0 view .LVU1660
 4959 0050 0B20     		movs	r0, #11
 4960              	.LVL597:
3671:Core/Src/FAT/ff.c **** 	cfs = FatFs[vol];			/* Pointer to the filesystem object of the volume */
 4961              		.loc 1 3671 22 view .LVU1661
 4962 0052 F5E7     		b	.L352
 4963              	.L360:
 4964              		.align	2
 4965              	.L359:
 4966 0054 00000000 		.word	.LANCHOR0
 4967              		.cfi_endproc
 4968              	.LFE32:
 4970              		.section	.text.f_open,"ax",%progbits
 4971              		.align	1
 4972              		.global	f_open
 4973              		.syntax unified
 4974              		.thumb
 4975              		.thumb_func
 4977              	f_open:
 4978              	.LVL598:
 4979              	.LFB33:
3722:Core/Src/FAT/ff.c **** 	FRESULT res;
 4980              		.loc 1 3722 1 is_stmt 1 view -0
 4981              		.cfi_startproc
 4982              		@ args = 0, pretend = 0, frame = 56
 4983              		@ frame_needed = 0, uses_anonymous_args = 0
3722:Core/Src/FAT/ff.c **** 	FRESULT res;
 4984              		.loc 1 3722 1 is_stmt 0 view .LVU1663
 4985 0000 2DE9F047 		push	{r4, r5, r6, r7, r8, r9, r10, lr}
 4986              	.LCFI40:
 4987              		.cfi_def_cfa_offset 32
 4988              		.cfi_offset 4, -32
 4989              		.cfi_offset 5, -28
 4990              		.cfi_offset 6, -24
 4991              		.cfi_offset 7, -20
 4992              		.cfi_offset 8, -16
 4993              		.cfi_offset 9, -12
 4994              		.cfi_offset 10, -8
 4995              		.cfi_offset 14, -4
 4996 0004 8EB0     		sub	sp, sp, #56
 4997              	.LCFI41:
 4998              		.cfi_def_cfa_offset 88
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 215


 4999 0006 0191     		str	r1, [sp, #4]
3723:Core/Src/FAT/ff.c **** 	DIR dj;
 5000              		.loc 1 3723 2 is_stmt 1 view .LVU1664
3724:Core/Src/FAT/ff.c **** 	FATFS *fs;
 5001              		.loc 1 3724 2 view .LVU1665
3725:Core/Src/FAT/ff.c **** #if !FF_FS_READONLY
 5002              		.loc 1 3725 2 view .LVU1666
3727:Core/Src/FAT/ff.c **** 	LBA_t sc;
 5003              		.loc 1 3727 2 view .LVU1667
3728:Core/Src/FAT/ff.c **** 	FSIZE_t ofs;
 5004              		.loc 1 3728 2 view .LVU1668
3729:Core/Src/FAT/ff.c **** #endif
 5005              		.loc 1 3729 2 view .LVU1669
3734:Core/Src/FAT/ff.c **** 
 5006              		.loc 1 3734 2 view .LVU1670
3734:Core/Src/FAT/ff.c **** 
 5007              		.loc 1 3734 5 is_stmt 0 view .LVU1671
 5008 0008 0028     		cmp	r0, #0
 5009 000a 00F0F580 		beq	.L378
 5010 000e 1546     		mov	r5, r2
 5011 0010 0646     		mov	r6, r0
3737:Core/Src/FAT/ff.c **** 	res = mount_volume(&path, &fs, mode);
 5012              		.loc 1 3737 2 is_stmt 1 view .LVU1672
3737:Core/Src/FAT/ff.c **** 	res = mount_volume(&path, &fs, mode);
 5013              		.loc 1 3737 7 is_stmt 0 view .LVU1673
 5014 0012 02F03F07 		and	r7, r2, #63
 5015              	.LVL599:
3738:Core/Src/FAT/ff.c **** 	if (res == FR_OK) {
 5016              		.loc 1 3738 2 is_stmt 1 view .LVU1674
3738:Core/Src/FAT/ff.c **** 	if (res == FR_OK) {
 5017              		.loc 1 3738 8 is_stmt 0 view .LVU1675
 5018 0016 3A46     		mov	r2, r7
 5019 0018 02A9     		add	r1, sp, #8
 5020              	.LVL600:
3738:Core/Src/FAT/ff.c **** 	if (res == FR_OK) {
 5021              		.loc 1 3738 8 view .LVU1676
 5022 001a 01A8     		add	r0, sp, #4
 5023              	.LVL601:
3738:Core/Src/FAT/ff.c **** 	if (res == FR_OK) {
 5024              		.loc 1 3738 8 view .LVU1677
 5025 001c FFF7FEFF 		bl	mount_volume
 5026              	.LVL602:
3739:Core/Src/FAT/ff.c **** 		dj.obj.fs = fs;
 5027              		.loc 1 3739 2 is_stmt 1 view .LVU1678
3739:Core/Src/FAT/ff.c **** 		dj.obj.fs = fs;
 5028              		.loc 1 3739 5 is_stmt 0 view .LVU1679
 5029 0020 0446     		mov	r4, r0
 5030 0022 30B1     		cbz	r0, .L389
 5031              	.LVL603:
 5032              	.L363:
3899:Core/Src/FAT/ff.c **** 	}
 5033              		.loc 1 3899 16 is_stmt 1 view .LVU1680
3902:Core/Src/FAT/ff.c **** 
 5034              		.loc 1 3902 2 view .LVU1681
3902:Core/Src/FAT/ff.c **** 
 5035              		.loc 1 3902 5 is_stmt 0 view .LVU1682
 5036 0024 0CB1     		cbz	r4, .L362
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 216


 5037              	.LVL604:
 5038              	.L377:
3902:Core/Src/FAT/ff.c **** 
 5039              		.loc 1 3902 20 is_stmt 1 discriminator 1 view .LVU1683
3902:Core/Src/FAT/ff.c **** 
 5040              		.loc 1 3902 31 is_stmt 0 discriminator 1 view .LVU1684
 5041 0026 0023     		movs	r3, #0
 5042 0028 3360     		str	r3, [r6]
 5043              	.LVL605:
 5044              	.L362:
3905:Core/Src/FAT/ff.c **** 
 5045              		.loc 1 3905 1 view .LVU1685
 5046 002a 2046     		mov	r0, r4
 5047 002c 0EB0     		add	sp, sp, #56
 5048              	.LCFI42:
 5049              		.cfi_remember_state
 5050              		.cfi_def_cfa_offset 32
 5051              		@ sp needed
 5052 002e BDE8F087 		pop	{r4, r5, r6, r7, r8, r9, r10, pc}
 5053              	.LVL606:
 5054              	.L389:
 5055              	.LCFI43:
 5056              		.cfi_restore_state
3740:Core/Src/FAT/ff.c **** 		INIT_NAMBUF(fs);
 5057              		.loc 1 3740 3 is_stmt 1 view .LVU1686
3740:Core/Src/FAT/ff.c **** 		INIT_NAMBUF(fs);
 5058              		.loc 1 3740 13 is_stmt 0 view .LVU1687
 5059 0032 029B     		ldr	r3, [sp, #8]
 5060 0034 0393     		str	r3, [sp, #12]
3741:Core/Src/FAT/ff.c **** 		res = follow_path(&dj, path);	/* Follow the file path */
 5061              		.loc 1 3741 18 is_stmt 1 view .LVU1688
3742:Core/Src/FAT/ff.c **** #if !FF_FS_READONLY	/* Read/Write configuration */
 5062              		.loc 1 3742 3 view .LVU1689
3742:Core/Src/FAT/ff.c **** #if !FF_FS_READONLY	/* Read/Write configuration */
 5063              		.loc 1 3742 9 is_stmt 0 view .LVU1690
 5064 0036 0199     		ldr	r1, [sp, #4]
 5065 0038 03A8     		add	r0, sp, #12
 5066              	.LVL607:
3742:Core/Src/FAT/ff.c **** #if !FF_FS_READONLY	/* Read/Write configuration */
 5067              		.loc 1 3742 9 view .LVU1691
 5068 003a FFF7FEFF 		bl	follow_path
 5069              	.LVL608:
3744:Core/Src/FAT/ff.c **** 			if (dj.fn[NSFLAG] & NS_NONAME) {	/* Origin directory itself? */
 5070              		.loc 1 3744 3 is_stmt 1 view .LVU1692
3744:Core/Src/FAT/ff.c **** 			if (dj.fn[NSFLAG] & NS_NONAME) {	/* Origin directory itself? */
 5071              		.loc 1 3744 6 is_stmt 0 view .LVU1693
 5072 003e 0446     		mov	r4, r0
 5073 0040 18B9     		cbnz	r0, .L364
3745:Core/Src/FAT/ff.c **** 				res = FR_INVALID_NAME;
 5074              		.loc 1 3745 4 is_stmt 1 view .LVU1694
3745:Core/Src/FAT/ff.c **** 				res = FR_INVALID_NAME;
 5075              		.loc 1 3745 8 is_stmt 0 view .LVU1695
 5076 0042 9DF93730 		ldrsb	r3, [sp, #55]
3745:Core/Src/FAT/ff.c **** 				res = FR_INVALID_NAME;
 5077              		.loc 1 3745 7 view .LVU1696
 5078 0046 002B     		cmp	r3, #0
 5079 0048 46DB     		blt	.L390
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 217


 5080              	.L364:
 5081              	.LVL609:
3755:Core/Src/FAT/ff.c **** 			if (res != FR_OK) {					/* No file, create new */
 5082              		.loc 1 3755 3 is_stmt 1 view .LVU1697
3755:Core/Src/FAT/ff.c **** 			if (res != FR_OK) {					/* No file, create new */
 5083              		.loc 1 3755 6 is_stmt 0 view .LVU1698
 5084 004a 15F01C0F 		tst	r5, #28
 5085 004e 54D0     		beq	.L365
3756:Core/Src/FAT/ff.c **** 				if (res == FR_NO_FILE) {		/* There is no file to open, create a new entry */
 5086              		.loc 1 3756 4 is_stmt 1 view .LVU1699
3756:Core/Src/FAT/ff.c **** 				if (res == FR_NO_FILE) {		/* There is no file to open, create a new entry */
 5087              		.loc 1 3756 7 is_stmt 0 view .LVU1700
 5088 0050 002C     		cmp	r4, #0
 5089 0052 48D0     		beq	.L366
3757:Core/Src/FAT/ff.c **** #if FF_FS_LOCK
 5090              		.loc 1 3757 5 is_stmt 1 view .LVU1701
3757:Core/Src/FAT/ff.c **** #if FF_FS_LOCK
 5091              		.loc 1 3757 8 is_stmt 0 view .LVU1702
 5092 0054 042C     		cmp	r4, #4
 5093 0056 41D0     		beq	.L391
 5094              	.L367:
3764:Core/Src/FAT/ff.c **** 			}
 5095              		.loc 1 3764 5 is_stmt 1 view .LVU1703
3764:Core/Src/FAT/ff.c **** 			}
 5096              		.loc 1 3764 10 is_stmt 0 view .LVU1704
 5097 0058 47F00807 		orr	r7, r7, #8
 5098              	.LVL610:
 5099              	.L368:
3773:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT
 5100              		.loc 1 3773 4 is_stmt 1 view .LVU1705
3773:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT
 5101              		.loc 1 3773 7 is_stmt 0 view .LVU1706
 5102 005c 002C     		cmp	r4, #0
 5103 005e 5BD1     		bne	.L369
3773:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT
 5104              		.loc 1 3773 21 discriminator 1 view .LVU1707
 5105 0060 17F0080F 		tst	r7, #8
 5106 0064 58D0     		beq	.L369
3794:Core/Src/FAT/ff.c **** 					st_dword(dj.dir + DIR_CrtTime, tm);
 5107              		.loc 1 3794 6 is_stmt 1 view .LVU1708
3794:Core/Src/FAT/ff.c **** 					st_dword(dj.dir + DIR_CrtTime, tm);
 5108              		.loc 1 3794 11 is_stmt 0 view .LVU1709
 5109 0066 FFF7FEFF 		bl	get_fattime
 5110              	.LVL611:
 5111 006a 0546     		mov	r5, r0
 5112              	.LVL612:
3795:Core/Src/FAT/ff.c **** 					st_dword(dj.dir + DIR_ModTime, tm);
 5113              		.loc 1 3795 6 is_stmt 1 view .LVU1710
 5114 006c 0146     		mov	r1, r0
 5115 006e 0A98     		ldr	r0, [sp, #40]
 5116              	.LVL613:
3795:Core/Src/FAT/ff.c **** 					st_dword(dj.dir + DIR_ModTime, tm);
 5117              		.loc 1 3795 6 is_stmt 0 view .LVU1711
 5118 0070 0E30     		adds	r0, r0, #14
 5119 0072 FFF7FEFF 		bl	st_dword
 5120              	.LVL614:
3796:Core/Src/FAT/ff.c **** 					cl = ld_clust(fs, dj.dir);			/* Get current cluster chain */
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 218


 5121              		.loc 1 3796 6 is_stmt 1 view .LVU1712
 5122 0076 2946     		mov	r1, r5
 5123 0078 0A98     		ldr	r0, [sp, #40]
 5124 007a 1630     		adds	r0, r0, #22
 5125 007c FFF7FEFF 		bl	st_dword
 5126              	.LVL615:
3797:Core/Src/FAT/ff.c **** 					dj.dir[DIR_Attr] = AM_ARC;			/* Reset attribute */
 5127              		.loc 1 3797 6 view .LVU1713
3797:Core/Src/FAT/ff.c **** 					dj.dir[DIR_Attr] = AM_ARC;			/* Reset attribute */
 5128              		.loc 1 3797 11 is_stmt 0 view .LVU1714
 5129 0080 DDF80880 		ldr	r8, [sp, #8]
3797:Core/Src/FAT/ff.c **** 					dj.dir[DIR_Attr] = AM_ARC;			/* Reset attribute */
 5130              		.loc 1 3797 26 view .LVU1715
 5131 0084 DDF82890 		ldr	r9, [sp, #40]
3797:Core/Src/FAT/ff.c **** 					dj.dir[DIR_Attr] = AM_ARC;			/* Reset attribute */
 5132              		.loc 1 3797 11 view .LVU1716
 5133 0088 4946     		mov	r1, r9
 5134 008a 4046     		mov	r0, r8
 5135 008c FFF7FEFF 		bl	ld_clust
 5136              	.LVL616:
 5137 0090 0546     		mov	r5, r0
 5138              	.LVL617:
3798:Core/Src/FAT/ff.c **** 					st_clust(fs, dj.dir, 0);			/* Reset file allocation info */
 5139              		.loc 1 3798 6 is_stmt 1 view .LVU1717
3798:Core/Src/FAT/ff.c **** 					st_clust(fs, dj.dir, 0);			/* Reset file allocation info */
 5140              		.loc 1 3798 23 is_stmt 0 view .LVU1718
 5141 0092 2023     		movs	r3, #32
 5142 0094 89F80B30 		strb	r3, [r9, #11]
3799:Core/Src/FAT/ff.c **** 					st_dword(dj.dir + DIR_FileSize, 0);
 5143              		.loc 1 3799 6 is_stmt 1 view .LVU1719
 5144 0098 0022     		movs	r2, #0
 5145 009a 0A99     		ldr	r1, [sp, #40]
 5146 009c 4046     		mov	r0, r8
 5147              	.LVL618:
3799:Core/Src/FAT/ff.c **** 					st_dword(dj.dir + DIR_FileSize, 0);
 5148              		.loc 1 3799 6 is_stmt 0 view .LVU1720
 5149 009e FFF7FEFF 		bl	st_clust
 5150              	.LVL619:
3800:Core/Src/FAT/ff.c **** 					fs->wflag = 1;
 5151              		.loc 1 3800 6 is_stmt 1 view .LVU1721
 5152 00a2 0021     		movs	r1, #0
 5153 00a4 0A98     		ldr	r0, [sp, #40]
 5154 00a6 1C30     		adds	r0, r0, #28
 5155 00a8 FFF7FEFF 		bl	st_dword
 5156              	.LVL620:
3801:Core/Src/FAT/ff.c **** 					if (cl != 0) {						/* Remove the cluster chain if exist */
 5157              		.loc 1 3801 6 view .LVU1722
3801:Core/Src/FAT/ff.c **** 					if (cl != 0) {						/* Remove the cluster chain if exist */
 5158              		.loc 1 3801 8 is_stmt 0 view .LVU1723
 5159 00ac 029B     		ldr	r3, [sp, #8]
3801:Core/Src/FAT/ff.c **** 					if (cl != 0) {						/* Remove the cluster chain if exist */
 5160              		.loc 1 3801 16 view .LVU1724
 5161 00ae 0122     		movs	r2, #1
 5162 00b0 1A71     		strb	r2, [r3, #4]
3802:Core/Src/FAT/ff.c **** 						sc = fs->winsect;
 5163              		.loc 1 3802 6 is_stmt 1 view .LVU1725
3802:Core/Src/FAT/ff.c **** 						sc = fs->winsect;
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 219


 5164              		.loc 1 3802 9 is_stmt 0 view .LVU1726
 5165 00b2 8DB3     		cbz	r5, .L369
3803:Core/Src/FAT/ff.c **** 						res = remove_chain(&dj.obj, cl, 0);
 5166              		.loc 1 3803 7 is_stmt 1 view .LVU1727
3803:Core/Src/FAT/ff.c **** 						res = remove_chain(&dj.obj, cl, 0);
 5167              		.loc 1 3803 10 is_stmt 0 view .LVU1728
 5168 00b4 D3F82C80 		ldr	r8, [r3, #44]
 5169              	.LVL621:
3804:Core/Src/FAT/ff.c **** 						if (res == FR_OK) {
 5170              		.loc 1 3804 7 is_stmt 1 view .LVU1729
3804:Core/Src/FAT/ff.c **** 						if (res == FR_OK) {
 5171              		.loc 1 3804 13 is_stmt 0 view .LVU1730
 5172 00b8 0022     		movs	r2, #0
 5173 00ba 2946     		mov	r1, r5
 5174 00bc 03A8     		add	r0, sp, #12
 5175 00be FFF7FEFF 		bl	remove_chain
 5176              	.LVL622:
3805:Core/Src/FAT/ff.c **** 							res = move_window(fs, sc);
 5177              		.loc 1 3805 7 is_stmt 1 view .LVU1731
3805:Core/Src/FAT/ff.c **** 							res = move_window(fs, sc);
 5178              		.loc 1 3805 10 is_stmt 0 view .LVU1732
 5179 00c2 0446     		mov	r4, r0
 5180 00c4 40BB     		cbnz	r0, .L369
3806:Core/Src/FAT/ff.c **** 							fs->last_clst = cl - 1;		/* Reuse the cluster hole */
 5181              		.loc 1 3806 8 is_stmt 1 view .LVU1733
3806:Core/Src/FAT/ff.c **** 							fs->last_clst = cl - 1;		/* Reuse the cluster hole */
 5182              		.loc 1 3806 14 is_stmt 0 view .LVU1734
 5183 00c6 4146     		mov	r1, r8
 5184 00c8 0298     		ldr	r0, [sp, #8]
 5185              	.LVL623:
3806:Core/Src/FAT/ff.c **** 							fs->last_clst = cl - 1;		/* Reuse the cluster hole */
 5186              		.loc 1 3806 14 view .LVU1735
 5187 00ca FFF7FEFF 		bl	move_window
 5188              	.LVL624:
 5189 00ce 0446     		mov	r4, r0
 5190              	.LVL625:
3807:Core/Src/FAT/ff.c **** 						}
 5191              		.loc 1 3807 8 is_stmt 1 view .LVU1736
3807:Core/Src/FAT/ff.c **** 						}
 5192              		.loc 1 3807 27 is_stmt 0 view .LVU1737
 5193 00d0 013D     		subs	r5, r5, #1
 5194              	.LVL626:
3807:Core/Src/FAT/ff.c **** 						}
 5195              		.loc 1 3807 22 view .LVU1738
 5196 00d2 029B     		ldr	r3, [sp, #8]
 5197 00d4 DD60     		str	r5, [r3, #12]
 5198 00d6 1FE0     		b	.L369
 5199              	.LVL627:
 5200              	.L390:
3746:Core/Src/FAT/ff.c **** 			}
 5201              		.loc 1 3746 9 view .LVU1739
 5202 00d8 0624     		movs	r4, #6
 5203 00da B6E7     		b	.L364
 5204              	.LVL628:
 5205              	.L391:
3761:Core/Src/FAT/ff.c **** #endif
 5206              		.loc 1 3761 6 is_stmt 1 view .LVU1740
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 220


3761:Core/Src/FAT/ff.c **** #endif
 5207              		.loc 1 3761 12 is_stmt 0 view .LVU1741
 5208 00dc 03A8     		add	r0, sp, #12
 5209 00de FFF7FEFF 		bl	dir_register
 5210              	.LVL629:
 5211 00e2 0446     		mov	r4, r0
 5212              	.LVL630:
3761:Core/Src/FAT/ff.c **** #endif
 5213              		.loc 1 3761 12 view .LVU1742
 5214 00e4 B8E7     		b	.L367
 5215              	.L366:
3767:Core/Src/FAT/ff.c **** 					res = FR_DENIED;
 5216              		.loc 1 3767 5 is_stmt 1 view .LVU1743
3767:Core/Src/FAT/ff.c **** 					res = FR_DENIED;
 5217              		.loc 1 3767 15 is_stmt 0 view .LVU1744
 5218 00e6 9DF81230 		ldrb	r3, [sp, #18]	@ zero_extendqisi2
3767:Core/Src/FAT/ff.c **** 					res = FR_DENIED;
 5219              		.loc 1 3767 8 view .LVU1745
 5220 00ea 13F0110F 		tst	r3, #17
 5221 00ee 12D1     		bne	.L380
3770:Core/Src/FAT/ff.c **** 				}
 5222              		.loc 1 3770 6 is_stmt 1 view .LVU1746
3770:Core/Src/FAT/ff.c **** 				}
 5223              		.loc 1 3770 9 is_stmt 0 view .LVU1747
 5224 00f0 15F0040F 		tst	r5, #4
 5225 00f4 B2D0     		beq	.L368
3770:Core/Src/FAT/ff.c **** 				}
 5226              		.loc 1 3770 36 view .LVU1748
 5227 00f6 0824     		movs	r4, #8
 5228              	.LVL631:
3770:Core/Src/FAT/ff.c **** 				}
 5229              		.loc 1 3770 36 view .LVU1749
 5230 00f8 0EE0     		b	.L369
 5231              	.LVL632:
 5232              	.L365:
3814:Core/Src/FAT/ff.c **** 				if (dj.obj.attr & AM_DIR) {		/* File open against a directory */
 5233              		.loc 1 3814 4 is_stmt 1 view .LVU1750
3814:Core/Src/FAT/ff.c **** 				if (dj.obj.attr & AM_DIR) {		/* File open against a directory */
 5234              		.loc 1 3814 7 is_stmt 0 view .LVU1751
 5235 00fa 6CB9     		cbnz	r4, .L369
3815:Core/Src/FAT/ff.c **** 					res = FR_NO_FILE;
 5236              		.loc 1 3815 5 is_stmt 1 view .LVU1752
3815:Core/Src/FAT/ff.c **** 					res = FR_NO_FILE;
 5237              		.loc 1 3815 15 is_stmt 0 view .LVU1753
 5238 00fc 9DF81230 		ldrb	r3, [sp, #18]	@ zero_extendqisi2
3815:Core/Src/FAT/ff.c **** 					res = FR_NO_FILE;
 5239              		.loc 1 3815 8 view .LVU1754
 5240 0100 13F0100F 		tst	r3, #16
 5241 0104 45D1     		bne	.L382
3818:Core/Src/FAT/ff.c **** 						res = FR_DENIED;
 5242              		.loc 1 3818 6 is_stmt 1 view .LVU1755
3818:Core/Src/FAT/ff.c **** 						res = FR_DENIED;
 5243              		.loc 1 3818 9 is_stmt 0 view .LVU1756
 5244 0106 15F0020F 		tst	r5, #2
 5245 010a 05D0     		beq	.L369
3818:Core/Src/FAT/ff.c **** 						res = FR_DENIED;
 5246              		.loc 1 3818 28 discriminator 1 view .LVU1757
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 221


 5247 010c 13F0010F 		tst	r3, #1
 5248 0110 02D0     		beq	.L369
3819:Core/Src/FAT/ff.c **** 					}
 5249              		.loc 1 3819 11 view .LVU1758
 5250 0112 0724     		movs	r4, #7
 5251              	.LVL633:
3819:Core/Src/FAT/ff.c **** 					}
 5252              		.loc 1 3819 11 view .LVU1759
 5253 0114 0BE0     		b	.L370
 5254              	.LVL634:
 5255              	.L380:
3768:Core/Src/FAT/ff.c **** 				} else {
 5256              		.loc 1 3768 10 view .LVU1760
 5257 0116 0724     		movs	r4, #7
 5258              	.LVL635:
 5259              	.L369:
3824:Core/Src/FAT/ff.c **** 			if (mode & FA_CREATE_ALWAYS) mode |= FA_MODIFIED;	/* Set file change flag if created or overwrit
 5260              		.loc 1 3824 3 is_stmt 1 view .LVU1761
3824:Core/Src/FAT/ff.c **** 			if (mode & FA_CREATE_ALWAYS) mode |= FA_MODIFIED;	/* Set file change flag if created or overwrit
 5261              		.loc 1 3824 6 is_stmt 0 view .LVU1762
 5262 0118 4CB9     		cbnz	r4, .L370
3825:Core/Src/FAT/ff.c **** 			fp->dir_sect = fs->winsect;			/* Pointer to the directory entry */
 5263              		.loc 1 3825 4 is_stmt 1 view .LVU1763
3825:Core/Src/FAT/ff.c **** 			fp->dir_sect = fs->winsect;			/* Pointer to the directory entry */
 5264              		.loc 1 3825 7 is_stmt 0 view .LVU1764
 5265 011a 17F0080F 		tst	r7, #8
 5266 011e 01D0     		beq	.L371
3825:Core/Src/FAT/ff.c **** 			fp->dir_sect = fs->winsect;			/* Pointer to the directory entry */
 5267              		.loc 1 3825 33 is_stmt 1 discriminator 1 view .LVU1765
3825:Core/Src/FAT/ff.c **** 			fp->dir_sect = fs->winsect;			/* Pointer to the directory entry */
 5268              		.loc 1 3825 38 is_stmt 0 discriminator 1 view .LVU1766
 5269 0120 47F04007 		orr	r7, r7, #64
 5270              	.LVL636:
 5271              	.L371:
3826:Core/Src/FAT/ff.c **** 			fp->dir_ptr = dj.dir;
 5272              		.loc 1 3826 4 is_stmt 1 view .LVU1767
3826:Core/Src/FAT/ff.c **** 			fp->dir_ptr = dj.dir;
 5273              		.loc 1 3826 21 is_stmt 0 view .LVU1768
 5274 0124 029B     		ldr	r3, [sp, #8]
 5275 0126 DB6A     		ldr	r3, [r3, #44]
3826:Core/Src/FAT/ff.c **** 			fp->dir_ptr = dj.dir;
 5276              		.loc 1 3826 17 view .LVU1769
 5277 0128 3362     		str	r3, [r6, #32]
3827:Core/Src/FAT/ff.c **** #if FF_FS_LOCK
 5278              		.loc 1 3827 4 is_stmt 1 view .LVU1770
3827:Core/Src/FAT/ff.c **** #if FF_FS_LOCK
 5279              		.loc 1 3827 20 is_stmt 0 view .LVU1771
 5280 012a 0A9B     		ldr	r3, [sp, #40]
3827:Core/Src/FAT/ff.c **** #if FF_FS_LOCK
 5281              		.loc 1 3827 16 view .LVU1772
 5282 012c 7362     		str	r3, [r6, #36]
 5283              	.LVL637:
 5284              	.L370:
3845:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT
 5285              		.loc 1 3845 3 is_stmt 1 view .LVU1773
3845:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT
 5286              		.loc 1 3845 6 is_stmt 0 view .LVU1774
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 222


 5287 012e 002C     		cmp	r4, #0
 5288 0130 7FF478AF 		bne	.L363
3855:Core/Src/FAT/ff.c **** 				fp->obj.objsize = ld_dword(dj.dir + DIR_FileSize);
 5289              		.loc 1 3855 5 is_stmt 1 view .LVU1775
3855:Core/Src/FAT/ff.c **** 				fp->obj.objsize = ld_dword(dj.dir + DIR_FileSize);
 5290              		.loc 1 3855 22 is_stmt 0 view .LVU1776
 5291 0134 DDF808A0 		ldr	r10, [sp, #8]
3855:Core/Src/FAT/ff.c **** 				fp->obj.objsize = ld_dword(dj.dir + DIR_FileSize);
 5292              		.loc 1 3855 37 view .LVU1777
 5293 0138 DDF82880 		ldr	r8, [sp, #40]
3855:Core/Src/FAT/ff.c **** 				fp->obj.objsize = ld_dword(dj.dir + DIR_FileSize);
 5294              		.loc 1 3855 22 view .LVU1778
 5295 013c 4146     		mov	r1, r8
 5296 013e 5046     		mov	r0, r10
 5297 0140 FFF7FEFF 		bl	ld_clust
 5298              	.LVL638:
 5299 0144 0546     		mov	r5, r0
3855:Core/Src/FAT/ff.c **** 				fp->obj.objsize = ld_dword(dj.dir + DIR_FileSize);
 5300              		.loc 1 3855 20 view .LVU1779
 5301 0146 B060     		str	r0, [r6, #8]
3856:Core/Src/FAT/ff.c **** 			}
 5302              		.loc 1 3856 5 is_stmt 1 view .LVU1780
3856:Core/Src/FAT/ff.c **** 			}
 5303              		.loc 1 3856 23 is_stmt 0 view .LVU1781
 5304 0148 08F11C00 		add	r0, r8, #28
 5305 014c FFF7FEFF 		bl	ld_dword
 5306              	.LVL639:
 5307 0150 8046     		mov	r8, r0
3856:Core/Src/FAT/ff.c **** 			}
 5308              		.loc 1 3856 21 view .LVU1782
 5309 0152 F060     		str	r0, [r6, #12]
3861:Core/Src/FAT/ff.c **** 			fp->obj.id = fs->id;
 5310              		.loc 1 3861 4 is_stmt 1 view .LVU1783
3861:Core/Src/FAT/ff.c **** 			fp->obj.id = fs->id;
 5311              		.loc 1 3861 15 is_stmt 0 view .LVU1784
 5312 0154 C6F800A0 		str	r10, [r6]
3862:Core/Src/FAT/ff.c **** 			fp->flag = mode;	/* Set file access mode */
 5313              		.loc 1 3862 4 is_stmt 1 view .LVU1785
3862:Core/Src/FAT/ff.c **** 			fp->flag = mode;	/* Set file access mode */
 5314              		.loc 1 3862 19 is_stmt 0 view .LVU1786
 5315 0158 BAF80630 		ldrh	r3, [r10, #6]
3862:Core/Src/FAT/ff.c **** 			fp->flag = mode;	/* Set file access mode */
 5316              		.loc 1 3862 15 view .LVU1787
 5317 015c B380     		strh	r3, [r6, #4]	@ movhi
3863:Core/Src/FAT/ff.c **** 			fp->err = 0;		/* Clear error flag */
 5318              		.loc 1 3863 4 is_stmt 1 view .LVU1788
3863:Core/Src/FAT/ff.c **** 			fp->err = 0;		/* Clear error flag */
 5319              		.loc 1 3863 13 is_stmt 0 view .LVU1789
 5320 015e 3774     		strb	r7, [r6, #16]
3864:Core/Src/FAT/ff.c **** 			fp->sect = 0;		/* Invalidate current data sector */
 5321              		.loc 1 3864 4 is_stmt 1 view .LVU1790
3864:Core/Src/FAT/ff.c **** 			fp->sect = 0;		/* Invalidate current data sector */
 5322              		.loc 1 3864 12 is_stmt 0 view .LVU1791
 5323 0160 0021     		movs	r1, #0
 5324 0162 7174     		strb	r1, [r6, #17]
3865:Core/Src/FAT/ff.c **** 			fp->fptr = 0;		/* Set file pointer top of the file */
 5325              		.loc 1 3865 4 is_stmt 1 view .LVU1792
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 223


3865:Core/Src/FAT/ff.c **** 			fp->fptr = 0;		/* Set file pointer top of the file */
 5326              		.loc 1 3865 13 is_stmt 0 view .LVU1793
 5327 0164 F161     		str	r1, [r6, #28]
3866:Core/Src/FAT/ff.c **** #if !FF_FS_READONLY
 5328              		.loc 1 3866 4 is_stmt 1 view .LVU1794
3866:Core/Src/FAT/ff.c **** #if !FF_FS_READONLY
 5329              		.loc 1 3866 13 is_stmt 0 view .LVU1795
 5330 0166 7161     		str	r1, [r6, #20]
3869:Core/Src/FAT/ff.c **** #endif
 5331              		.loc 1 3869 4 is_stmt 1 view .LVU1796
3869:Core/Src/FAT/ff.c **** #endif
 5332              		.loc 1 3869 13 is_stmt 0 view .LVU1797
 5333 0168 06F12809 		add	r9, r6, #40
3869:Core/Src/FAT/ff.c **** #endif
 5334              		.loc 1 3869 4 view .LVU1798
 5335 016c 4FF40072 		mov	r2, #512
 5336 0170 4846     		mov	r0, r9
 5337 0172 FFF7FEFF 		bl	memset
 5338              	.LVL640:
3871:Core/Src/FAT/ff.c **** 				fp->fptr = fp->obj.objsize;			/* Offset to seek */
 5339              		.loc 1 3871 4 is_stmt 1 view .LVU1799
3871:Core/Src/FAT/ff.c **** 				fp->fptr = fp->obj.objsize;			/* Offset to seek */
 5340              		.loc 1 3871 7 is_stmt 0 view .LVU1800
 5341 0176 17F0200F 		tst	r7, #32
 5342 017a 3FF453AF 		beq	.L363
3871:Core/Src/FAT/ff.c **** 				fp->fptr = fp->obj.objsize;			/* Offset to seek */
 5343              		.loc 1 3871 28 discriminator 1 view .LVU1801
 5344 017e B8F1000F 		cmp	r8, #0
 5345 0182 3FF44FAF 		beq	.L363
3872:Core/Src/FAT/ff.c **** 				bcs = (DWORD)fs->csize * SS(fs);	/* Cluster size in byte */
 5346              		.loc 1 3872 5 is_stmt 1 view .LVU1802
3872:Core/Src/FAT/ff.c **** 				bcs = (DWORD)fs->csize * SS(fs);	/* Cluster size in byte */
 5347              		.loc 1 3872 14 is_stmt 0 view .LVU1803
 5348 0186 C6F81480 		str	r8, [r6, #20]
3873:Core/Src/FAT/ff.c **** 				clst = fp->obj.sclust;				/* Follow the cluster chain */
 5349              		.loc 1 3873 5 is_stmt 1 view .LVU1804
3873:Core/Src/FAT/ff.c **** 				clst = fp->obj.sclust;				/* Follow the cluster chain */
 5350              		.loc 1 3873 20 is_stmt 0 view .LVU1805
 5351 018a BAF80A70 		ldrh	r7, [r10, #10]
 5352              	.LVL641:
3873:Core/Src/FAT/ff.c **** 				clst = fp->obj.sclust;				/* Follow the cluster chain */
 5353              		.loc 1 3873 9 view .LVU1806
 5354 018e 7F02     		lsls	r7, r7, #9
 5355              	.LVL642:
3874:Core/Src/FAT/ff.c **** 				for (ofs = fp->obj.objsize; res == FR_OK && ofs > bcs; ofs -= bcs) {
 5356              		.loc 1 3874 5 is_stmt 1 view .LVU1807
3875:Core/Src/FAT/ff.c **** 					clst = get_fat(&fp->obj, clst);
 5357              		.loc 1 3875 5 view .LVU1808
3875:Core/Src/FAT/ff.c **** 					clst = get_fat(&fp->obj, clst);
 5358              		.loc 1 3875 5 is_stmt 0 view .LVU1809
 5359 0190 06E0     		b	.L372
 5360              	.LVL643:
 5361              	.L382:
3816:Core/Src/FAT/ff.c **** 				} else {
 5362              		.loc 1 3816 10 view .LVU1810
 5363 0192 0424     		movs	r4, #4
 5364              	.LVL644:
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 224


3816:Core/Src/FAT/ff.c **** 				} else {
 5365              		.loc 1 3816 10 view .LVU1811
 5366 0194 CBE7     		b	.L370
 5367              	.LVL645:
 5368              	.L373:
3878:Core/Src/FAT/ff.c **** 				}
 5369              		.loc 1 3878 6 is_stmt 1 view .LVU1812
3878:Core/Src/FAT/ff.c **** 				}
 5370              		.loc 1 3878 9 is_stmt 0 view .LVU1813
 5371 0196 B5F1FF3F 		cmp	r5, #-1
 5372 019a 0DD0     		beq	.L392
 5373              	.LVL646:
 5374              	.L374:
3875:Core/Src/FAT/ff.c **** 					clst = get_fat(&fp->obj, clst);
 5375              		.loc 1 3875 60 is_stmt 1 discriminator 2 view .LVU1814
3875:Core/Src/FAT/ff.c **** 					clst = get_fat(&fp->obj, clst);
 5376              		.loc 1 3875 64 is_stmt 0 discriminator 2 view .LVU1815
 5377 019c A8EB0708 		sub	r8, r8, r7
 5378              	.LVL647:
 5379              	.L372:
3875:Core/Src/FAT/ff.c **** 					clst = get_fat(&fp->obj, clst);
 5380              		.loc 1 3875 33 is_stmt 1 discriminator 1 view .LVU1816
3875:Core/Src/FAT/ff.c **** 					clst = get_fat(&fp->obj, clst);
 5381              		.loc 1 3875 5 is_stmt 0 discriminator 1 view .LVU1817
 5382 01a0 64B9     		cbnz	r4, .L375
3875:Core/Src/FAT/ff.c **** 					clst = get_fat(&fp->obj, clst);
 5383              		.loc 1 3875 46 discriminator 3 view .LVU1818
 5384 01a2 B845     		cmp	r8, r7
 5385 01a4 0AD9     		bls	.L375
3876:Core/Src/FAT/ff.c **** 					if (clst <= 1) res = FR_INT_ERR;
 5386              		.loc 1 3876 6 is_stmt 1 view .LVU1819
3876:Core/Src/FAT/ff.c **** 					if (clst <= 1) res = FR_INT_ERR;
 5387              		.loc 1 3876 13 is_stmt 0 view .LVU1820
 5388 01a6 2946     		mov	r1, r5
 5389 01a8 3046     		mov	r0, r6
 5390 01aa FFF7FEFF 		bl	get_fat
 5391              	.LVL648:
 5392 01ae 0546     		mov	r5, r0
 5393              	.LVL649:
3877:Core/Src/FAT/ff.c **** 					if (clst == 0xFFFFFFFF) res = FR_DISK_ERR;
 5394              		.loc 1 3877 6 is_stmt 1 view .LVU1821
3877:Core/Src/FAT/ff.c **** 					if (clst == 0xFFFFFFFF) res = FR_DISK_ERR;
 5395              		.loc 1 3877 9 is_stmt 0 view .LVU1822
 5396 01b0 0128     		cmp	r0, #1
 5397 01b2 F0D8     		bhi	.L373
3877:Core/Src/FAT/ff.c **** 					if (clst == 0xFFFFFFFF) res = FR_DISK_ERR;
 5398              		.loc 1 3877 25 view .LVU1823
 5399 01b4 0224     		movs	r4, #2
 5400              	.LVL650:
3877:Core/Src/FAT/ff.c **** 					if (clst == 0xFFFFFFFF) res = FR_DISK_ERR;
 5401              		.loc 1 3877 25 view .LVU1824
 5402 01b6 EEE7     		b	.L373
 5403              	.LVL651:
 5404              	.L392:
3878:Core/Src/FAT/ff.c **** 				}
 5405              		.loc 1 3878 34 view .LVU1825
 5406 01b8 0124     		movs	r4, #1
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 225


 5407              	.LVL652:
3878:Core/Src/FAT/ff.c **** 				}
 5408              		.loc 1 3878 34 view .LVU1826
 5409 01ba EFE7     		b	.L374
 5410              	.LVL653:
 5411              	.L375:
3880:Core/Src/FAT/ff.c **** 				if (res == FR_OK && ofs % SS(fs)) {	/* Fill sector buffer if not on the sector boundary */
 5412              		.loc 1 3880 5 is_stmt 1 view .LVU1827
3880:Core/Src/FAT/ff.c **** 				if (res == FR_OK && ofs % SS(fs)) {	/* Fill sector buffer if not on the sector boundary */
 5413              		.loc 1 3880 15 is_stmt 0 view .LVU1828
 5414 01bc B561     		str	r5, [r6, #24]
3881:Core/Src/FAT/ff.c **** 					sc = clst2sect(fs, clst);
 5415              		.loc 1 3881 5 is_stmt 1 view .LVU1829
3881:Core/Src/FAT/ff.c **** 					sc = clst2sect(fs, clst);
 5416              		.loc 1 3881 8 is_stmt 0 view .LVU1830
 5417 01be 002C     		cmp	r4, #0
 5418 01c0 7FF430AF 		bne	.L363
3881:Core/Src/FAT/ff.c **** 					sc = clst2sect(fs, clst);
 5419              		.loc 1 3881 29 discriminator 1 view .LVU1831
 5420 01c4 C8F30803 		ubfx	r3, r8, #0, #9
3881:Core/Src/FAT/ff.c **** 					sc = clst2sect(fs, clst);
 5421              		.loc 1 3881 22 discriminator 1 view .LVU1832
 5422 01c8 002B     		cmp	r3, #0
 5423 01ca 3FF42BAF 		beq	.L363
3882:Core/Src/FAT/ff.c **** 					if (sc == 0) {
 5424              		.loc 1 3882 6 is_stmt 1 view .LVU1833
3882:Core/Src/FAT/ff.c **** 					if (sc == 0) {
 5425              		.loc 1 3882 11 is_stmt 0 view .LVU1834
 5426 01ce 029F     		ldr	r7, [sp, #8]
 5427              	.LVL654:
3882:Core/Src/FAT/ff.c **** 					if (sc == 0) {
 5428              		.loc 1 3882 11 view .LVU1835
 5429 01d0 2946     		mov	r1, r5
 5430 01d2 3846     		mov	r0, r7
 5431 01d4 FFF7FEFF 		bl	clst2sect
 5432              	.LVL655:
3883:Core/Src/FAT/ff.c **** 						res = FR_INT_ERR;
 5433              		.loc 1 3883 6 is_stmt 1 view .LVU1836
3883:Core/Src/FAT/ff.c **** 						res = FR_INT_ERR;
 5434              		.loc 1 3883 9 is_stmt 0 view .LVU1837
 5435 01d8 08B9     		cbnz	r0, .L393
3884:Core/Src/FAT/ff.c **** 					} else {
 5436              		.loc 1 3884 11 view .LVU1838
 5437 01da 0224     		movs	r4, #2
 5438              	.LVL656:
3884:Core/Src/FAT/ff.c **** 					} else {
 5439              		.loc 1 3884 11 view .LVU1839
 5440 01dc 23E7     		b	.L377
 5441              	.LVL657:
 5442              	.L393:
3886:Core/Src/FAT/ff.c **** #if !FF_FS_TINY
 5443              		.loc 1 3886 7 is_stmt 1 view .LVU1840
3886:Core/Src/FAT/ff.c **** #if !FF_FS_TINY
 5444              		.loc 1 3886 21 is_stmt 0 view .LVU1841
 5445 01de 00EB5822 		add	r2, r0, r8, lsr #9
3886:Core/Src/FAT/ff.c **** #if !FF_FS_TINY
 5446              		.loc 1 3886 16 view .LVU1842
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 226


 5447 01e2 F261     		str	r2, [r6, #28]
3888:Core/Src/FAT/ff.c **** #endif
 5448              		.loc 1 3888 7 is_stmt 1 view .LVU1843
3888:Core/Src/FAT/ff.c **** #endif
 5449              		.loc 1 3888 11 is_stmt 0 view .LVU1844
 5450 01e4 0123     		movs	r3, #1
 5451 01e6 4946     		mov	r1, r9
 5452 01e8 7878     		ldrb	r0, [r7, #1]	@ zero_extendqisi2
 5453              	.LVL658:
3888:Core/Src/FAT/ff.c **** #endif
 5454              		.loc 1 3888 11 view .LVU1845
 5455 01ea FFF7FEFF 		bl	disk_read
 5456              	.LVL659:
3888:Core/Src/FAT/ff.c **** #endif
 5457              		.loc 1 3888 10 view .LVU1846
 5458 01ee 0028     		cmp	r0, #0
 5459 01f0 3FF418AF 		beq	.L363
3888:Core/Src/FAT/ff.c **** #endif
 5460              		.loc 1 3888 68 view .LVU1847
 5461 01f4 0124     		movs	r4, #1
 5462              	.LVL660:
3888:Core/Src/FAT/ff.c **** #endif
 5463              		.loc 1 3888 68 view .LVU1848
 5464 01f6 16E7     		b	.L377
 5465              	.LVL661:
 5466              	.L378:
3734:Core/Src/FAT/ff.c **** 
 5467              		.loc 1 3734 18 view .LVU1849
 5468 01f8 0924     		movs	r4, #9
 5469 01fa 16E7     		b	.L362
 5470              		.cfi_endproc
 5471              	.LFE33:
 5473              		.section	.text.f_read,"ax",%progbits
 5474              		.align	1
 5475              		.global	f_read
 5476              		.syntax unified
 5477              		.thumb
 5478              		.thumb_func
 5480              	f_read:
 5481              	.LVL662:
 5482              	.LFB34:
3920:Core/Src/FAT/ff.c **** 	FRESULT res;
 5483              		.loc 1 3920 1 is_stmt 1 view -0
 5484              		.cfi_startproc
 5485              		@ args = 0, pretend = 0, frame = 16
 5486              		@ frame_needed = 0, uses_anonymous_args = 0
3920:Core/Src/FAT/ff.c **** 	FRESULT res;
 5487              		.loc 1 3920 1 is_stmt 0 view .LVU1851
 5488 0000 2DE9F04F 		push	{r4, r5, r6, r7, r8, r9, r10, fp, lr}
 5489              	.LCFI44:
 5490              		.cfi_def_cfa_offset 36
 5491              		.cfi_offset 4, -36
 5492              		.cfi_offset 5, -32
 5493              		.cfi_offset 6, -28
 5494              		.cfi_offset 7, -24
 5495              		.cfi_offset 8, -20
 5496              		.cfi_offset 9, -16
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 227


 5497              		.cfi_offset 10, -12
 5498              		.cfi_offset 11, -8
 5499              		.cfi_offset 14, -4
 5500 0004 85B0     		sub	sp, sp, #20
 5501              	.LCFI45:
 5502              		.cfi_def_cfa_offset 56
 5503 0006 0446     		mov	r4, r0
 5504 0008 0E46     		mov	r6, r1
 5505 000a 1746     		mov	r7, r2
 5506 000c 9846     		mov	r8, r3
3921:Core/Src/FAT/ff.c **** 	FATFS *fs;
 5507              		.loc 1 3921 2 is_stmt 1 view .LVU1852
3922:Core/Src/FAT/ff.c **** 	DWORD clst;
 5508              		.loc 1 3922 2 view .LVU1853
3923:Core/Src/FAT/ff.c **** 	LBA_t sect;
 5509              		.loc 1 3923 2 view .LVU1854
3924:Core/Src/FAT/ff.c **** 	FSIZE_t remain;
 5510              		.loc 1 3924 2 view .LVU1855
3925:Core/Src/FAT/ff.c **** 	UINT rcnt, cc, csect;
 5511              		.loc 1 3925 2 view .LVU1856
3926:Core/Src/FAT/ff.c **** 	BYTE *rbuff = (BYTE*)buff;
 5512              		.loc 1 3926 2 view .LVU1857
3927:Core/Src/FAT/ff.c **** 
 5513              		.loc 1 3927 2 view .LVU1858
 5514              	.LVL663:
3930:Core/Src/FAT/ff.c **** 	res = validate(&fp->obj, &fs);				/* Check validity of the file object */
 5515              		.loc 1 3930 2 view .LVU1859
3930:Core/Src/FAT/ff.c **** 	res = validate(&fp->obj, &fs);				/* Check validity of the file object */
 5516              		.loc 1 3930 6 is_stmt 0 view .LVU1860
 5517 000e 0023     		movs	r3, #0
 5518              	.LVL664:
3930:Core/Src/FAT/ff.c **** 	res = validate(&fp->obj, &fs);				/* Check validity of the file object */
 5519              		.loc 1 3930 6 view .LVU1861
 5520 0010 C8F80030 		str	r3, [r8]
3931:Core/Src/FAT/ff.c **** 	if (res != FR_OK || (res = (FRESULT)fp->err) != FR_OK) LEAVE_FF(fs, res);	/* Check validity */
 5521              		.loc 1 3931 2 is_stmt 1 view .LVU1862
3931:Core/Src/FAT/ff.c **** 	if (res != FR_OK || (res = (FRESULT)fp->err) != FR_OK) LEAVE_FF(fs, res);	/* Check validity */
 5522              		.loc 1 3931 8 is_stmt 0 view .LVU1863
 5523 0014 03A9     		add	r1, sp, #12
 5524              	.LVL665:
3931:Core/Src/FAT/ff.c **** 	if (res != FR_OK || (res = (FRESULT)fp->err) != FR_OK) LEAVE_FF(fs, res);	/* Check validity */
 5525              		.loc 1 3931 8 view .LVU1864
 5526 0016 FFF7FEFF 		bl	validate
 5527              	.LVL666:
3932:Core/Src/FAT/ff.c **** 	if (!(fp->flag & FA_READ)) LEAVE_FF(fs, FR_DENIED); /* Check access mode */
 5528              		.loc 1 3932 2 is_stmt 1 view .LVU1865
3932:Core/Src/FAT/ff.c **** 	if (!(fp->flag & FA_READ)) LEAVE_FF(fs, FR_DENIED); /* Check access mode */
 5529              		.loc 1 3932 5 is_stmt 0 view .LVU1866
 5530 001a 8246     		mov	r10, r0
 5531 001c 0028     		cmp	r0, #0
 5532 001e 40F0A280 		bne	.L397
3932:Core/Src/FAT/ff.c **** 	if (!(fp->flag & FA_READ)) LEAVE_FF(fs, FR_DENIED); /* Check access mode */
 5533              		.loc 1 3932 27 discriminator 2 view .LVU1867
 5534 0022 94F811A0 		ldrb	r10, [r4, #17]	@ zero_extendqisi2
 5535              	.LVL667:
3932:Core/Src/FAT/ff.c **** 	if (!(fp->flag & FA_READ)) LEAVE_FF(fs, FR_DENIED); /* Check access mode */
 5536              		.loc 1 3932 19 discriminator 2 view .LVU1868
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 228


 5537 0026 BAF1000F 		cmp	r10, #0
 5538 002a 40F09C80 		bne	.L397
3933:Core/Src/FAT/ff.c **** 	remain = fp->obj.objsize - fp->fptr;
 5539              		.loc 1 3933 2 is_stmt 1 view .LVU1869
3933:Core/Src/FAT/ff.c **** 	remain = fp->obj.objsize - fp->fptr;
 5540              		.loc 1 3933 10 is_stmt 0 view .LVU1870
 5541 002e 237C     		ldrb	r3, [r4, #16]	@ zero_extendqisi2
3933:Core/Src/FAT/ff.c **** 	remain = fp->obj.objsize - fp->fptr;
 5542              		.loc 1 3933 5 view .LVU1871
 5543 0030 13F0010F 		tst	r3, #1
 5544 0034 00F0B280 		beq	.L418
3934:Core/Src/FAT/ff.c **** 	if (btr > remain) btr = (UINT)remain;		/* Truncate btr by remaining bytes */
 5545              		.loc 1 3934 2 is_stmt 1 view .LVU1872
3934:Core/Src/FAT/ff.c **** 	if (btr > remain) btr = (UINT)remain;		/* Truncate btr by remaining bytes */
 5546              		.loc 1 3934 18 is_stmt 0 view .LVU1873
 5547 0038 E568     		ldr	r5, [r4, #12]
3934:Core/Src/FAT/ff.c **** 	if (btr > remain) btr = (UINT)remain;		/* Truncate btr by remaining bytes */
 5548              		.loc 1 3934 31 view .LVU1874
 5549 003a 6369     		ldr	r3, [r4, #20]
3934:Core/Src/FAT/ff.c **** 	if (btr > remain) btr = (UINT)remain;		/* Truncate btr by remaining bytes */
 5550              		.loc 1 3934 9 view .LVU1875
 5551 003c ED1A     		subs	r5, r5, r3
 5552              	.LVL668:
3935:Core/Src/FAT/ff.c **** 
 5553              		.loc 1 3935 2 is_stmt 1 view .LVU1876
3935:Core/Src/FAT/ff.c **** 
 5554              		.loc 1 3935 5 is_stmt 0 view .LVU1877
 5555 003e BD42     		cmp	r5, r7
 5556 0040 57D3     		bcc	.L416
 5557 0042 3D46     		mov	r5, r7
 5558              	.LVL669:
3935:Core/Src/FAT/ff.c **** 
 5559              		.loc 1 3935 5 view .LVU1878
 5560 0044 55E0     		b	.L416
 5561              	.LVL670:
 5562              	.L402:
3950:Core/Src/FAT/ff.c **** 					}
 5563              		.loc 1 3950 7 is_stmt 1 view .LVU1879
3950:Core/Src/FAT/ff.c **** 					}
 5564              		.loc 1 3950 14 is_stmt 0 view .LVU1880
 5565 0046 A169     		ldr	r1, [r4, #24]
 5566 0048 2046     		mov	r0, r4
 5567 004a FFF7FEFF 		bl	get_fat
 5568              	.LVL671:
3950:Core/Src/FAT/ff.c **** 					}
 5569              		.loc 1 3950 14 view .LVU1881
 5570 004e 60E0     		b	.L403
 5571              	.L425:
3953:Core/Src/FAT/ff.c **** 				if (clst == 0xFFFFFFFF) ABORT(fs, FR_DISK_ERR);
 5572              		.loc 1 3953 19 is_stmt 1 discriminator 1 view .LVU1882
 5573 0050 4FF0020A 		mov	r10, #2
 5574              	.LVL672:
3953:Core/Src/FAT/ff.c **** 				if (clst == 0xFFFFFFFF) ABORT(fs, FR_DISK_ERR);
 5575              		.loc 1 3953 19 is_stmt 0 discriminator 1 view .LVU1883
 5576 0054 84F811A0 		strb	r10, [r4, #17]
3953:Core/Src/FAT/ff.c **** 				if (clst == 0xFFFFFFFF) ABORT(fs, FR_DISK_ERR);
 5577              		.loc 1 3953 19 is_stmt 1 discriminator 1 view .LVU1884
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 229


 5578 0058 85E0     		b	.L397
 5579              	.LVL673:
 5580              	.L426:
3954:Core/Src/FAT/ff.c **** 				fp->clust = clst;				/* Update current cluster */
 5581              		.loc 1 3954 29 discriminator 1 view .LVU1885
 5582 005a 4FF0010A 		mov	r10, #1
 5583              	.LVL674:
3954:Core/Src/FAT/ff.c **** 				fp->clust = clst;				/* Update current cluster */
 5584              		.loc 1 3954 29 is_stmt 0 discriminator 1 view .LVU1886
 5585 005e 84F811A0 		strb	r10, [r4, #17]
3954:Core/Src/FAT/ff.c **** 				fp->clust = clst;				/* Update current cluster */
 5586              		.loc 1 3954 29 is_stmt 1 discriminator 1 view .LVU1887
 5587 0062 80E0     		b	.L397
 5588              	.LVL675:
 5589              	.L427:
3958:Core/Src/FAT/ff.c **** 			sect += csect;
 5590              		.loc 1 3958 19 discriminator 1 view .LVU1888
 5591 0064 4FF0020A 		mov	r10, #2
 5592              	.LVL676:
3958:Core/Src/FAT/ff.c **** 			sect += csect;
 5593              		.loc 1 3958 19 is_stmt 0 discriminator 1 view .LVU1889
 5594 0068 84F811A0 		strb	r10, [r4, #17]
3958:Core/Src/FAT/ff.c **** 			sect += csect;
 5595              		.loc 1 3958 19 is_stmt 1 discriminator 1 view .LVU1890
 5596 006c 7BE0     		b	.L397
 5597              	.LVL677:
 5598              	.L409:
3965:Core/Src/FAT/ff.c **** #if !FF_FS_READONLY && FF_FS_MINIMIZE <= 2		/* Replace one of the read sectors with cached data if 
 5599              		.loc 1 3965 79 discriminator 2 view .LVU1891
3972:Core/Src/FAT/ff.c **** 					memcpy(rbuff + ((fp->sect - sect) * SS(fs)), fp->buf, SS(fs));
 5600              		.loc 1 3972 5 discriminator 2 view .LVU1892
3972:Core/Src/FAT/ff.c **** 					memcpy(rbuff + ((fp->sect - sect) * SS(fs)), fp->buf, SS(fs));
 5601              		.loc 1 3972 9 is_stmt 0 discriminator 2 view .LVU1893
 5602 006e 94F91030 		ldrsb	r3, [r4, #16]
3972:Core/Src/FAT/ff.c **** 					memcpy(rbuff + ((fp->sect - sect) * SS(fs)), fp->buf, SS(fs));
 5603              		.loc 1 3972 8 discriminator 2 view .LVU1894
 5604 0072 002B     		cmp	r3, #0
 5605 0074 02DB     		blt	.L422
 5606              	.L410:
3977:Core/Src/FAT/ff.c **** 				continue;
 5607              		.loc 1 3977 5 is_stmt 1 view .LVU1895
3977:Core/Src/FAT/ff.c **** 				continue;
 5608              		.loc 1 3977 10 is_stmt 0 view .LVU1896
 5609 0076 019B     		ldr	r3, [sp, #4]
 5610 0078 5F02     		lsls	r7, r3, #9
 5611              	.LVL678:
3978:Core/Src/FAT/ff.c **** 			}
 5612              		.loc 1 3978 5 is_stmt 1 view .LVU1897
 5613 007a 30E0     		b	.L411
 5614              	.LVL679:
 5615              	.L422:
3972:Core/Src/FAT/ff.c **** 					memcpy(rbuff + ((fp->sect - sect) * SS(fs)), fp->buf, SS(fs));
 5616              		.loc 1 3972 36 is_stmt 0 discriminator 1 view .LVU1898
 5617 007c E069     		ldr	r0, [r4, #28]
3972:Core/Src/FAT/ff.c **** 					memcpy(rbuff + ((fp->sect - sect) * SS(fs)), fp->buf, SS(fs));
 5618              		.loc 1 3972 43 discriminator 1 view .LVU1899
 5619 007e A0EB0900 		sub	r0, r0, r9
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 230


3972:Core/Src/FAT/ff.c **** 					memcpy(rbuff + ((fp->sect - sect) * SS(fs)), fp->buf, SS(fs));
 5620              		.loc 1 3972 31 discriminator 1 view .LVU1900
 5621 0082 019B     		ldr	r3, [sp, #4]
 5622 0084 9842     		cmp	r0, r3
 5623 0086 F6D2     		bcs	.L410
3973:Core/Src/FAT/ff.c **** 				}
 5624              		.loc 1 3973 6 is_stmt 1 view .LVU1901
 5625 0088 4FF40072 		mov	r2, #512
 5626 008c 04F12801 		add	r1, r4, #40
 5627 0090 06EB4020 		add	r0, r6, r0, lsl #9
 5628 0094 FFF7FEFF 		bl	memcpy
 5629              	.LVL680:
 5630 0098 EDE7     		b	.L410
 5631              	.LVL681:
 5632              	.L407:
3981:Core/Src/FAT/ff.c **** #if !FF_FS_READONLY
 5633              		.loc 1 3981 4 view .LVU1902
3981:Core/Src/FAT/ff.c **** #if !FF_FS_READONLY
 5634              		.loc 1 3981 10 is_stmt 0 view .LVU1903
 5635 009a E269     		ldr	r2, [r4, #28]
3981:Core/Src/FAT/ff.c **** #if !FF_FS_READONLY
 5636              		.loc 1 3981 7 view .LVU1904
 5637 009c 4A45     		cmp	r2, r9
 5638 009e 0DD0     		beq	.L412
3983:Core/Src/FAT/ff.c **** 					if (disk_write(fs->pdrv, fp->buf, fp->sect, 1) != RES_OK) ABORT(fs, FR_DISK_ERR);
 5639              		.loc 1 3983 5 is_stmt 1 view .LVU1905
3983:Core/Src/FAT/ff.c **** 					if (disk_write(fs->pdrv, fp->buf, fp->sect, 1) != RES_OK) ABORT(fs, FR_DISK_ERR);
 5640              		.loc 1 3983 9 is_stmt 0 view .LVU1906
 5641 00a0 94F91030 		ldrsb	r3, [r4, #16]
 5642              	.LVL682:
3983:Core/Src/FAT/ff.c **** 					if (disk_write(fs->pdrv, fp->buf, fp->sect, 1) != RES_OK) ABORT(fs, FR_DISK_ERR);
 5643              		.loc 1 3983 8 view .LVU1907
 5644 00a4 002B     		cmp	r3, #0
 5645 00a6 62DB     		blt	.L423
 5646              	.L413:
3988:Core/Src/FAT/ff.c **** 			}
 5647              		.loc 1 3988 5 is_stmt 1 view .LVU1908
3988:Core/Src/FAT/ff.c **** 			}
 5648              		.loc 1 3988 9 is_stmt 0 view .LVU1909
 5649 00a8 0123     		movs	r3, #1
 5650 00aa 4A46     		mov	r2, r9
 5651 00ac 04F12801 		add	r1, r4, #40
 5652 00b0 0398     		ldr	r0, [sp, #12]
 5653 00b2 4078     		ldrb	r0, [r0, #1]	@ zero_extendqisi2
 5654 00b4 FFF7FEFF 		bl	disk_read
 5655              	.LVL683:
3988:Core/Src/FAT/ff.c **** 			}
 5656              		.loc 1 3988 8 view .LVU1910
 5657 00b8 0028     		cmp	r0, #0
 5658 00ba 6AD1     		bne	.L424
 5659              	.L412:
3988:Core/Src/FAT/ff.c **** 			}
 5660              		.loc 1 3988 80 is_stmt 1 discriminator 2 view .LVU1911
3991:Core/Src/FAT/ff.c **** 		}
 5661              		.loc 1 3991 4 discriminator 2 view .LVU1912
3991:Core/Src/FAT/ff.c **** 		}
 5662              		.loc 1 3991 13 is_stmt 0 discriminator 2 view .LVU1913
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 231


 5663 00bc C4F81C90 		str	r9, [r4, #28]
 5664              	.LVL684:
 5665              	.L400:
3993:Core/Src/FAT/ff.c **** 		if (rcnt > btr) rcnt = btr;					/* Clip it by btr if needed */
 5666              		.loc 1 3993 3 is_stmt 1 view .LVU1914
3993:Core/Src/FAT/ff.c **** 		if (rcnt > btr) rcnt = btr;					/* Clip it by btr if needed */
 5667              		.loc 1 3993 27 is_stmt 0 view .LVU1915
 5668 00c0 6369     		ldr	r3, [r4, #20]
3993:Core/Src/FAT/ff.c **** 		if (rcnt > btr) rcnt = btr;					/* Clip it by btr if needed */
 5669              		.loc 1 3993 34 view .LVU1916
 5670 00c2 C3F30803 		ubfx	r3, r3, #0, #9
3993:Core/Src/FAT/ff.c **** 		if (rcnt > btr) rcnt = btr;					/* Clip it by btr if needed */
 5671              		.loc 1 3993 8 view .LVU1917
 5672 00c6 C3F50077 		rsb	r7, r3, #512
 5673              	.LVL685:
3994:Core/Src/FAT/ff.c **** #if FF_FS_TINY
 5674              		.loc 1 3994 3 is_stmt 1 view .LVU1918
3994:Core/Src/FAT/ff.c **** #if FF_FS_TINY
 5675              		.loc 1 3994 6 is_stmt 0 view .LVU1919
 5676 00ca BD42     		cmp	r5, r7
 5677 00cc 00D2     		bcs	.L415
3994:Core/Src/FAT/ff.c **** #if FF_FS_TINY
 5678              		.loc 1 3994 24 view .LVU1920
 5679 00ce 2F46     		mov	r7, r5
 5680              	.LVL686:
 5681              	.L415:
3999:Core/Src/FAT/ff.c **** #endif
 5682              		.loc 1 3999 3 is_stmt 1 view .LVU1921
3999:Core/Src/FAT/ff.c **** #endif
 5683              		.loc 1 3999 17 is_stmt 0 view .LVU1922
 5684 00d0 04F12801 		add	r1, r4, #40
3999:Core/Src/FAT/ff.c **** #endif
 5685              		.loc 1 3999 3 view .LVU1923
 5686 00d4 3A46     		mov	r2, r7
 5687 00d6 1944     		add	r1, r1, r3
 5688 00d8 3046     		mov	r0, r6
 5689 00da FFF7FEFF 		bl	memcpy
 5690              	.LVL687:
 5691              	.L411:
3937:Core/Src/FAT/ff.c **** 		if (fp->fptr % SS(fs) == 0) {			/* On the sector boundary? */
 5692              		.loc 1 3937 19 is_stmt 1 view .LVU1924
3937:Core/Src/FAT/ff.c **** 		if (fp->fptr % SS(fs) == 0) {			/* On the sector boundary? */
 5693              		.loc 1 3937 23 is_stmt 0 view .LVU1925
 5694 00de ED1B     		subs	r5, r5, r7
 5695              	.LVL688:
3937:Core/Src/FAT/ff.c **** 		if (fp->fptr % SS(fs) == 0) {			/* On the sector boundary? */
 5696              		.loc 1 3937 36 view .LVU1926
 5697 00e0 D8F80030 		ldr	r3, [r8]
 5698 00e4 3B44     		add	r3, r3, r7
 5699 00e6 C8F80030 		str	r3, [r8]
3937:Core/Src/FAT/ff.c **** 		if (fp->fptr % SS(fs) == 0) {			/* On the sector boundary? */
 5700              		.loc 1 3937 51 view .LVU1927
 5701 00ea 3E44     		add	r6, r6, r7
 5702              	.LVL689:
3937:Core/Src/FAT/ff.c **** 		if (fp->fptr % SS(fs) == 0) {			/* On the sector boundary? */
 5703              		.loc 1 3937 69 view .LVU1928
 5704 00ec 6369     		ldr	r3, [r4, #20]
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 232


 5705 00ee 3B44     		add	r3, r3, r7
 5706 00f0 6361     		str	r3, [r4, #20]
 5707              	.LVL690:
 5708              	.L416:
3937:Core/Src/FAT/ff.c **** 		if (fp->fptr % SS(fs) == 0) {			/* On the sector boundary? */
 5709              		.loc 1 3937 10 is_stmt 1 discriminator 1 view .LVU1929
3937:Core/Src/FAT/ff.c **** 		if (fp->fptr % SS(fs) == 0) {			/* On the sector boundary? */
 5710              		.loc 1 3937 2 is_stmt 0 discriminator 1 view .LVU1930
 5711 00f2 002D     		cmp	r5, #0
 5712 00f4 37D0     		beq	.L397
3938:Core/Src/FAT/ff.c **** 			csect = (UINT)(fp->fptr / SS(fs) & (fs->csize - 1));	/* Sector offset in the cluster */
 5713              		.loc 1 3938 3 is_stmt 1 view .LVU1931
3938:Core/Src/FAT/ff.c **** 			csect = (UINT)(fp->fptr / SS(fs) & (fs->csize - 1));	/* Sector offset in the cluster */
 5714              		.loc 1 3938 9 is_stmt 0 view .LVU1932
 5715 00f6 6369     		ldr	r3, [r4, #20]
3938:Core/Src/FAT/ff.c **** 			csect = (UINT)(fp->fptr / SS(fs) & (fs->csize - 1));	/* Sector offset in the cluster */
 5716              		.loc 1 3938 16 view .LVU1933
 5717 00f8 C3F30802 		ubfx	r2, r3, #0, #9
3938:Core/Src/FAT/ff.c **** 			csect = (UINT)(fp->fptr / SS(fs) & (fs->csize - 1));	/* Sector offset in the cluster */
 5718              		.loc 1 3938 6 view .LVU1934
 5719 00fc 002A     		cmp	r2, #0
 5720 00fe DFD1     		bne	.L400
3939:Core/Src/FAT/ff.c **** 			if (csect == 0) {					/* On the cluster boundary? */
 5721              		.loc 1 3939 4 is_stmt 1 view .LVU1935
3939:Core/Src/FAT/ff.c **** 			if (csect == 0) {					/* On the cluster boundary? */
 5722              		.loc 1 3939 42 is_stmt 0 view .LVU1936
 5723 0100 039A     		ldr	r2, [sp, #12]
 5724 0102 5789     		ldrh	r7, [r2, #10]
3939:Core/Src/FAT/ff.c **** 			if (csect == 0) {					/* On the cluster boundary? */
 5725              		.loc 1 3939 50 view .LVU1937
 5726 0104 013F     		subs	r7, r7, #1
 5727              	.LVL691:
3940:Core/Src/FAT/ff.c **** 				if (fp->fptr == 0) {			/* On the top of the file? */
 5728              		.loc 1 3940 4 is_stmt 1 view .LVU1938
3940:Core/Src/FAT/ff.c **** 				if (fp->fptr == 0) {			/* On the top of the file? */
 5729              		.loc 1 3940 7 is_stmt 0 view .LVU1939
 5730 0106 17EA5327 		ands	r7, r7, r3, lsr #9
 5731              	.LVL692:
3940:Core/Src/FAT/ff.c **** 				if (fp->fptr == 0) {			/* On the top of the file? */
 5732              		.loc 1 3940 7 view .LVU1940
 5733 010a 08D1     		bne	.L401
3941:Core/Src/FAT/ff.c **** 					clst = fp->obj.sclust;		/* Follow cluster chain from the origin */
 5734              		.loc 1 3941 5 is_stmt 1 view .LVU1941
3941:Core/Src/FAT/ff.c **** 					clst = fp->obj.sclust;		/* Follow cluster chain from the origin */
 5735              		.loc 1 3941 8 is_stmt 0 view .LVU1942
 5736 010c 002B     		cmp	r3, #0
 5737 010e 9AD1     		bne	.L402
3942:Core/Src/FAT/ff.c **** 				} else {						/* Middle or end of the file */
 5738              		.loc 1 3942 6 is_stmt 1 view .LVU1943
3942:Core/Src/FAT/ff.c **** 				} else {						/* Middle or end of the file */
 5739              		.loc 1 3942 11 is_stmt 0 view .LVU1944
 5740 0110 A068     		ldr	r0, [r4, #8]
 5741              	.LVL693:
 5742              	.L403:
3953:Core/Src/FAT/ff.c **** 				if (clst == 0xFFFFFFFF) ABORT(fs, FR_DISK_ERR);
 5743              		.loc 1 3953 5 is_stmt 1 view .LVU1945
3953:Core/Src/FAT/ff.c **** 				if (clst == 0xFFFFFFFF) ABORT(fs, FR_DISK_ERR);
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 233


 5744              		.loc 1 3953 8 is_stmt 0 view .LVU1946
 5745 0112 0128     		cmp	r0, #1
 5746 0114 9CD9     		bls	.L425
3953:Core/Src/FAT/ff.c **** 				if (clst == 0xFFFFFFFF) ABORT(fs, FR_DISK_ERR);
 5747              		.loc 1 3953 40 is_stmt 1 discriminator 2 view .LVU1947
3954:Core/Src/FAT/ff.c **** 				fp->clust = clst;				/* Update current cluster */
 5748              		.loc 1 3954 5 discriminator 2 view .LVU1948
3954:Core/Src/FAT/ff.c **** 				fp->clust = clst;				/* Update current cluster */
 5749              		.loc 1 3954 8 is_stmt 0 discriminator 2 view .LVU1949
 5750 0116 B0F1FF3F 		cmp	r0, #-1
 5751 011a 9ED0     		beq	.L426
3954:Core/Src/FAT/ff.c **** 				fp->clust = clst;				/* Update current cluster */
 5752              		.loc 1 3954 51 is_stmt 1 discriminator 2 view .LVU1950
3955:Core/Src/FAT/ff.c **** 			}
 5753              		.loc 1 3955 5 discriminator 2 view .LVU1951
3955:Core/Src/FAT/ff.c **** 			}
 5754              		.loc 1 3955 15 is_stmt 0 discriminator 2 view .LVU1952
 5755 011c A061     		str	r0, [r4, #24]
 5756              	.LVL694:
 5757              	.L401:
3957:Core/Src/FAT/ff.c **** 			if (sect == 0) ABORT(fs, FR_INT_ERR);
 5758              		.loc 1 3957 4 is_stmt 1 view .LVU1953
3957:Core/Src/FAT/ff.c **** 			if (sect == 0) ABORT(fs, FR_INT_ERR);
 5759              		.loc 1 3957 11 is_stmt 0 view .LVU1954
 5760 011e DDF80CB0 		ldr	fp, [sp, #12]
 5761 0122 A169     		ldr	r1, [r4, #24]
 5762 0124 5846     		mov	r0, fp
 5763 0126 FFF7FEFF 		bl	clst2sect
 5764              	.LVL695:
3958:Core/Src/FAT/ff.c **** 			sect += csect;
 5765              		.loc 1 3958 4 is_stmt 1 view .LVU1955
3958:Core/Src/FAT/ff.c **** 			sect += csect;
 5766              		.loc 1 3958 7 is_stmt 0 view .LVU1956
 5767 012a 8146     		mov	r9, r0
 5768 012c 0028     		cmp	r0, #0
 5769 012e 99D0     		beq	.L427
3958:Core/Src/FAT/ff.c **** 			sect += csect;
 5770              		.loc 1 3958 40 is_stmt 1 discriminator 2 view .LVU1957
3959:Core/Src/FAT/ff.c **** 			cc = btr / SS(fs);					/* When remaining bytes >= sector size, */
 5771              		.loc 1 3959 4 discriminator 2 view .LVU1958
3959:Core/Src/FAT/ff.c **** 			cc = btr / SS(fs);					/* When remaining bytes >= sector size, */
 5772              		.loc 1 3959 9 is_stmt 0 discriminator 2 view .LVU1959
 5773 0130 B944     		add	r9, r9, r7
 5774              	.LVL696:
3960:Core/Src/FAT/ff.c **** 			if (cc > 0) {						/* Read maximum contiguous sectors directly */
 5775              		.loc 1 3960 4 is_stmt 1 discriminator 2 view .LVU1960
3960:Core/Src/FAT/ff.c **** 			if (cc > 0) {						/* Read maximum contiguous sectors directly */
 5776              		.loc 1 3960 7 is_stmt 0 discriminator 2 view .LVU1961
 5777 0132 6B0A     		lsrs	r3, r5, #9
 5778 0134 0193     		str	r3, [sp, #4]
 5779              	.LVL697:
3961:Core/Src/FAT/ff.c **** 				if (csect + cc > fs->csize) {	/* Clip at cluster boundary */
 5780              		.loc 1 3961 4 is_stmt 1 discriminator 2 view .LVU1962
3961:Core/Src/FAT/ff.c **** 				if (csect + cc > fs->csize) {	/* Clip at cluster boundary */
 5781              		.loc 1 3961 7 is_stmt 0 discriminator 2 view .LVU1963
 5782 0136 B5F5007F 		cmp	r5, #512
 5783 013a AED3     		bcc	.L407
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 234


3962:Core/Src/FAT/ff.c **** 					cc = fs->csize - csect;
 5784              		.loc 1 3962 5 is_stmt 1 view .LVU1964
3962:Core/Src/FAT/ff.c **** 					cc = fs->csize - csect;
 5785              		.loc 1 3962 15 is_stmt 0 view .LVU1965
 5786 013c FB18     		adds	r3, r7, r3
 5787              	.LVL698:
3962:Core/Src/FAT/ff.c **** 					cc = fs->csize - csect;
 5788              		.loc 1 3962 24 view .LVU1966
 5789 013e BBF80A20 		ldrh	r2, [fp, #10]
3962:Core/Src/FAT/ff.c **** 					cc = fs->csize - csect;
 5790              		.loc 1 3962 8 view .LVU1967
 5791 0142 9342     		cmp	r3, r2
 5792 0144 01D9     		bls	.L408
3963:Core/Src/FAT/ff.c **** 				}
 5793              		.loc 1 3963 6 is_stmt 1 view .LVU1968
3963:Core/Src/FAT/ff.c **** 				}
 5794              		.loc 1 3963 9 is_stmt 0 view .LVU1969
 5795 0146 D31B     		subs	r3, r2, r7
 5796 0148 0193     		str	r3, [sp, #4]
 5797              	.LVL699:
 5798              	.L408:
3965:Core/Src/FAT/ff.c **** #if !FF_FS_READONLY && FF_FS_MINIMIZE <= 2		/* Replace one of the read sectors with cached data if 
 5799              		.loc 1 3965 5 is_stmt 1 view .LVU1970
3965:Core/Src/FAT/ff.c **** #if !FF_FS_READONLY && FF_FS_MINIMIZE <= 2		/* Replace one of the read sectors with cached data if 
 5800              		.loc 1 3965 9 is_stmt 0 view .LVU1971
 5801 014a 9DF80430 		ldrb	r3, [sp, #4]	@ zero_extendqisi2
 5802 014e 4A46     		mov	r2, r9
 5803 0150 3146     		mov	r1, r6
 5804 0152 9BF80100 		ldrb	r0, [fp, #1]	@ zero_extendqisi2
 5805 0156 FFF7FEFF 		bl	disk_read
 5806              	.LVL700:
3965:Core/Src/FAT/ff.c **** #if !FF_FS_READONLY && FF_FS_MINIMIZE <= 2		/* Replace one of the read sectors with cached data if 
 5807              		.loc 1 3965 8 view .LVU1972
 5808 015a 0028     		cmp	r0, #0
 5809 015c 87D0     		beq	.L409
3965:Core/Src/FAT/ff.c **** #if !FF_FS_READONLY && FF_FS_MINIMIZE <= 2		/* Replace one of the read sectors with cached data if 
 5810              		.loc 1 3965 57 is_stmt 1 discriminator 1 view .LVU1973
 5811 015e 4FF0010A 		mov	r10, #1
 5812              	.LVL701:
3965:Core/Src/FAT/ff.c **** #if !FF_FS_READONLY && FF_FS_MINIMIZE <= 2		/* Replace one of the read sectors with cached data if 
 5813              		.loc 1 3965 57 is_stmt 0 discriminator 1 view .LVU1974
 5814 0162 84F811A0 		strb	r10, [r4, #17]
3965:Core/Src/FAT/ff.c **** #if !FF_FS_READONLY && FF_FS_MINIMIZE <= 2		/* Replace one of the read sectors with cached data if 
 5815              		.loc 1 3965 57 is_stmt 1 discriminator 1 view .LVU1975
 5816              	.LVL702:
 5817              	.L397:
4004:Core/Src/FAT/ff.c **** 
 5818              		.loc 1 4004 1 is_stmt 0 view .LVU1976
 5819 0166 5046     		mov	r0, r10
 5820 0168 05B0     		add	sp, sp, #20
 5821              	.LCFI46:
 5822              		.cfi_remember_state
 5823              		.cfi_def_cfa_offset 36
 5824              		@ sp needed
 5825 016a BDE8F08F 		pop	{r4, r5, r6, r7, r8, r9, r10, fp, pc}
 5826              	.LVL703:
 5827              	.L423:
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 235


 5828              	.LCFI47:
 5829              		.cfi_restore_state
3984:Core/Src/FAT/ff.c **** 					fp->flag &= (BYTE)~FA_DIRTY;
 5830              		.loc 1 3984 6 is_stmt 1 view .LVU1977
3984:Core/Src/FAT/ff.c **** 					fp->flag &= (BYTE)~FA_DIRTY;
 5831              		.loc 1 3984 10 is_stmt 0 view .LVU1978
 5832 016e 0123     		movs	r3, #1
 5833 0170 04F12801 		add	r1, r4, #40
 5834 0174 9BF80100 		ldrb	r0, [fp, #1]	@ zero_extendqisi2
 5835 0178 FFF7FEFF 		bl	disk_write
 5836              	.LVL704:
3984:Core/Src/FAT/ff.c **** 					fp->flag &= (BYTE)~FA_DIRTY;
 5837              		.loc 1 3984 9 view .LVU1979
 5838 017c 20B9     		cbnz	r0, .L428
3984:Core/Src/FAT/ff.c **** 					fp->flag &= (BYTE)~FA_DIRTY;
 5839              		.loc 1 3984 86 is_stmt 1 discriminator 2 view .LVU1980
3985:Core/Src/FAT/ff.c **** 				}
 5840              		.loc 1 3985 6 discriminator 2 view .LVU1981
3985:Core/Src/FAT/ff.c **** 				}
 5841              		.loc 1 3985 15 is_stmt 0 discriminator 2 view .LVU1982
 5842 017e 237C     		ldrb	r3, [r4, #16]	@ zero_extendqisi2
 5843 0180 03F07F03 		and	r3, r3, #127
 5844 0184 2374     		strb	r3, [r4, #16]
 5845 0186 8FE7     		b	.L413
 5846              	.L428:
3984:Core/Src/FAT/ff.c **** 					fp->flag &= (BYTE)~FA_DIRTY;
 5847              		.loc 1 3984 64 is_stmt 1 discriminator 1 view .LVU1983
 5848 0188 4FF0010A 		mov	r10, #1
 5849              	.LVL705:
3984:Core/Src/FAT/ff.c **** 					fp->flag &= (BYTE)~FA_DIRTY;
 5850              		.loc 1 3984 64 is_stmt 0 discriminator 1 view .LVU1984
 5851 018c 84F811A0 		strb	r10, [r4, #17]
3984:Core/Src/FAT/ff.c **** 					fp->flag &= (BYTE)~FA_DIRTY;
 5852              		.loc 1 3984 64 is_stmt 1 discriminator 1 view .LVU1985
 5853 0190 E9E7     		b	.L397
 5854              	.LVL706:
 5855              	.L424:
3988:Core/Src/FAT/ff.c **** 			}
 5856              		.loc 1 3988 58 discriminator 1 view .LVU1986
 5857 0192 4FF0010A 		mov	r10, #1
 5858              	.LVL707:
3988:Core/Src/FAT/ff.c **** 			}
 5859              		.loc 1 3988 58 is_stmt 0 discriminator 1 view .LVU1987
 5860 0196 84F811A0 		strb	r10, [r4, #17]
3988:Core/Src/FAT/ff.c **** 			}
 5861              		.loc 1 3988 58 is_stmt 1 discriminator 1 view .LVU1988
 5862 019a E4E7     		b	.L397
 5863              	.LVL708:
 5864              	.L418:
3933:Core/Src/FAT/ff.c **** 	remain = fp->obj.objsize - fp->fptr;
 5865              		.loc 1 3933 29 is_stmt 0 view .LVU1989
 5866 019c 4FF0070A 		mov	r10, #7
 5867              	.LVL709:
3933:Core/Src/FAT/ff.c **** 	remain = fp->obj.objsize - fp->fptr;
 5868              		.loc 1 3933 29 view .LVU1990
 5869 01a0 E1E7     		b	.L397
 5870              		.cfi_endproc
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 236


 5871              	.LFE34:
 5873              		.section	.text.f_write,"ax",%progbits
 5874              		.align	1
 5875              		.global	f_write
 5876              		.syntax unified
 5877              		.thumb
 5878              		.thumb_func
 5880              	f_write:
 5881              	.LVL710:
 5882              	.LFB35:
4020:Core/Src/FAT/ff.c **** 	FRESULT res;
 5883              		.loc 1 4020 1 is_stmt 1 view -0
 5884              		.cfi_startproc
 5885              		@ args = 0, pretend = 0, frame = 16
 5886              		@ frame_needed = 0, uses_anonymous_args = 0
4020:Core/Src/FAT/ff.c **** 	FRESULT res;
 5887              		.loc 1 4020 1 is_stmt 0 view .LVU1992
 5888 0000 2DE9F04F 		push	{r4, r5, r6, r7, r8, r9, r10, fp, lr}
 5889              	.LCFI48:
 5890              		.cfi_def_cfa_offset 36
 5891              		.cfi_offset 4, -36
 5892              		.cfi_offset 5, -32
 5893              		.cfi_offset 6, -28
 5894              		.cfi_offset 7, -24
 5895              		.cfi_offset 8, -20
 5896              		.cfi_offset 9, -16
 5897              		.cfi_offset 10, -12
 5898              		.cfi_offset 11, -8
 5899              		.cfi_offset 14, -4
 5900 0004 85B0     		sub	sp, sp, #20
 5901              	.LCFI49:
 5902              		.cfi_def_cfa_offset 56
 5903 0006 0446     		mov	r4, r0
 5904 0008 0E46     		mov	r6, r1
 5905 000a 1546     		mov	r5, r2
 5906 000c 9846     		mov	r8, r3
4021:Core/Src/FAT/ff.c **** 	FATFS *fs;
 5907              		.loc 1 4021 2 is_stmt 1 view .LVU1993
4022:Core/Src/FAT/ff.c **** 	DWORD clst;
 5908              		.loc 1 4022 2 view .LVU1994
4023:Core/Src/FAT/ff.c **** 	LBA_t sect;
 5909              		.loc 1 4023 2 view .LVU1995
4024:Core/Src/FAT/ff.c **** 	UINT wcnt, cc, csect;
 5910              		.loc 1 4024 2 view .LVU1996
4025:Core/Src/FAT/ff.c **** 	const BYTE *wbuff = (const BYTE*)buff;
 5911              		.loc 1 4025 2 view .LVU1997
4026:Core/Src/FAT/ff.c **** 
 5912              		.loc 1 4026 2 view .LVU1998
 5913              	.LVL711:
4029:Core/Src/FAT/ff.c **** 	res = validate(&fp->obj, &fs);			/* Check validity of the file object */
 5914              		.loc 1 4029 2 view .LVU1999
4029:Core/Src/FAT/ff.c **** 	res = validate(&fp->obj, &fs);			/* Check validity of the file object */
 5915              		.loc 1 4029 6 is_stmt 0 view .LVU2000
 5916 000e 0023     		movs	r3, #0
 5917              	.LVL712:
4029:Core/Src/FAT/ff.c **** 	res = validate(&fp->obj, &fs);			/* Check validity of the file object */
 5918              		.loc 1 4029 6 view .LVU2001
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 237


 5919 0010 C8F80030 		str	r3, [r8]
4030:Core/Src/FAT/ff.c **** 	if (res != FR_OK || (res = (FRESULT)fp->err) != FR_OK) LEAVE_FF(fs, res);	/* Check validity */
 5920              		.loc 1 4030 2 is_stmt 1 view .LVU2002
4030:Core/Src/FAT/ff.c **** 	if (res != FR_OK || (res = (FRESULT)fp->err) != FR_OK) LEAVE_FF(fs, res);	/* Check validity */
 5921              		.loc 1 4030 8 is_stmt 0 view .LVU2003
 5922 0014 03A9     		add	r1, sp, #12
 5923              	.LVL713:
4030:Core/Src/FAT/ff.c **** 	if (res != FR_OK || (res = (FRESULT)fp->err) != FR_OK) LEAVE_FF(fs, res);	/* Check validity */
 5924              		.loc 1 4030 8 view .LVU2004
 5925 0016 FFF7FEFF 		bl	validate
 5926              	.LVL714:
4031:Core/Src/FAT/ff.c **** 	if (!(fp->flag & FA_WRITE)) LEAVE_FF(fs, FR_DENIED);	/* Check access mode */
 5927              		.loc 1 4031 2 is_stmt 1 view .LVU2005
4031:Core/Src/FAT/ff.c **** 	if (!(fp->flag & FA_WRITE)) LEAVE_FF(fs, FR_DENIED);	/* Check access mode */
 5928              		.loc 1 4031 5 is_stmt 0 view .LVU2006
 5929 001a 8246     		mov	r10, r0
 5930 001c 0028     		cmp	r0, #0
 5931 001e 40F0C380 		bne	.L432
4031:Core/Src/FAT/ff.c **** 	if (!(fp->flag & FA_WRITE)) LEAVE_FF(fs, FR_DENIED);	/* Check access mode */
 5932              		.loc 1 4031 27 discriminator 2 view .LVU2007
 5933 0022 94F811A0 		ldrb	r10, [r4, #17]	@ zero_extendqisi2
 5934              	.LVL715:
4031:Core/Src/FAT/ff.c **** 	if (!(fp->flag & FA_WRITE)) LEAVE_FF(fs, FR_DENIED);	/* Check access mode */
 5935              		.loc 1 4031 19 discriminator 2 view .LVU2008
 5936 0026 BAF1000F 		cmp	r10, #0
 5937 002a 40F0BD80 		bne	.L432
4032:Core/Src/FAT/ff.c **** 
 5938              		.loc 1 4032 2 is_stmt 1 view .LVU2009
4032:Core/Src/FAT/ff.c **** 
 5939              		.loc 1 4032 10 is_stmt 0 view .LVU2010
 5940 002e 237C     		ldrb	r3, [r4, #16]	@ zero_extendqisi2
4032:Core/Src/FAT/ff.c **** 
 5941              		.loc 1 4032 5 view .LVU2011
 5942 0030 13F0020F 		tst	r3, #2
 5943 0034 00F0D080 		beq	.L453
4035:Core/Src/FAT/ff.c **** 		btw = (UINT)(0xFFFFFFFF - (DWORD)fp->fptr);
 5944              		.loc 1 4035 2 is_stmt 1 view .LVU2012
4035:Core/Src/FAT/ff.c **** 		btw = (UINT)(0xFFFFFFFF - (DWORD)fp->fptr);
 5945              		.loc 1 4035 61 is_stmt 0 view .LVU2013
 5946 0038 6369     		ldr	r3, [r4, #20]
4035:Core/Src/FAT/ff.c **** 		btw = (UINT)(0xFFFFFFFF - (DWORD)fp->fptr);
 5947              		.loc 1 4035 5 view .LVU2014
 5948 003a EB42     		cmn	r3, r5
 5949 003c 6ED3     		bcc	.L451
4036:Core/Src/FAT/ff.c **** 	}
 5950              		.loc 1 4036 3 is_stmt 1 view .LVU2015
4036:Core/Src/FAT/ff.c **** 	}
 5951              		.loc 1 4036 7 is_stmt 0 view .LVU2016
 5952 003e DD43     		mvns	r5, r3
 5953              	.LVL716:
4036:Core/Src/FAT/ff.c **** 	}
 5954              		.loc 1 4036 7 view .LVU2017
 5955 0040 6CE0     		b	.L451
 5956              	.LVL717:
 5957              	.L459:
4046:Core/Src/FAT/ff.c **** 					}
 5958              		.loc 1 4046 7 is_stmt 1 view .LVU2018
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 238


4046:Core/Src/FAT/ff.c **** 					}
 5959              		.loc 1 4046 14 is_stmt 0 view .LVU2019
 5960 0042 0021     		movs	r1, #0
 5961 0044 2046     		mov	r0, r4
 5962              	.LVL718:
4046:Core/Src/FAT/ff.c **** 					}
 5963              		.loc 1 4046 14 view .LVU2020
 5964 0046 FFF7FEFF 		bl	create_chain
 5965              	.LVL719:
4046:Core/Src/FAT/ff.c **** 					}
 5966              		.loc 1 4046 14 view .LVU2021
 5967 004a 79E0     		b	.L437
 5968              	.LVL720:
 5969              	.L436:
4055:Core/Src/FAT/ff.c **** 					}
 5970              		.loc 1 4055 7 is_stmt 1 view .LVU2022
4055:Core/Src/FAT/ff.c **** 					}
 5971              		.loc 1 4055 14 is_stmt 0 view .LVU2023
 5972 004c A169     		ldr	r1, [r4, #24]
 5973 004e 2046     		mov	r0, r4
 5974 0050 FFF7FEFF 		bl	create_chain
 5975              	.LVL721:
4055:Core/Src/FAT/ff.c **** 					}
 5976              		.loc 1 4055 14 view .LVU2024
 5977 0054 74E0     		b	.L437
 5978              	.L460:
4059:Core/Src/FAT/ff.c **** 				if (clst == 0xFFFFFFFF) ABORT(fs, FR_DISK_ERR);
 5979              		.loc 1 4059 20 is_stmt 1 discriminator 1 view .LVU2025
 5980 0056 4FF0020A 		mov	r10, #2
 5981              	.LVL722:
4059:Core/Src/FAT/ff.c **** 				if (clst == 0xFFFFFFFF) ABORT(fs, FR_DISK_ERR);
 5982              		.loc 1 4059 20 is_stmt 0 discriminator 1 view .LVU2026
 5983 005a 84F811A0 		strb	r10, [r4, #17]
4059:Core/Src/FAT/ff.c **** 				if (clst == 0xFFFFFFFF) ABORT(fs, FR_DISK_ERR);
 5984              		.loc 1 4059 20 is_stmt 1 discriminator 1 view .LVU2027
 5985 005e A3E0     		b	.L432
 5986              	.LVL723:
 5987              	.L461:
4060:Core/Src/FAT/ff.c **** 				fp->clust = clst;			/* Update current cluster */
 5988              		.loc 1 4060 29 discriminator 1 view .LVU2028
 5989 0060 4FF0010A 		mov	r10, #1
 5990              	.LVL724:
4060:Core/Src/FAT/ff.c **** 				fp->clust = clst;			/* Update current cluster */
 5991              		.loc 1 4060 29 is_stmt 0 discriminator 1 view .LVU2029
 5992 0064 84F811A0 		strb	r10, [r4, #17]
4060:Core/Src/FAT/ff.c **** 				fp->clust = clst;			/* Update current cluster */
 5993              		.loc 1 4060 29 is_stmt 1 discriminator 1 view .LVU2030
 5994 0068 9EE0     		b	.L432
 5995              	.LVL725:
 5996              	.L462:
4068:Core/Src/FAT/ff.c **** 				fp->flag &= (BYTE)~FA_DIRTY;
 5997              		.loc 1 4068 5 view .LVU2031
4068:Core/Src/FAT/ff.c **** 				fp->flag &= (BYTE)~FA_DIRTY;
 5998              		.loc 1 4068 9 is_stmt 0 view .LVU2032
 5999 006a 0123     		movs	r3, #1
 6000 006c E269     		ldr	r2, [r4, #28]
 6001 006e 04F12801 		add	r1, r4, #40
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 239


 6002 0072 0398     		ldr	r0, [sp, #12]
 6003 0074 4078     		ldrb	r0, [r0, #1]	@ zero_extendqisi2
 6004 0076 FFF7FEFF 		bl	disk_write
 6005              	.LVL726:
4068:Core/Src/FAT/ff.c **** 				fp->flag &= (BYTE)~FA_DIRTY;
 6006              		.loc 1 4068 8 view .LVU2033
 6007 007a 20B9     		cbnz	r0, .L456
4068:Core/Src/FAT/ff.c **** 				fp->flag &= (BYTE)~FA_DIRTY;
 6008              		.loc 1 4068 85 is_stmt 1 discriminator 2 view .LVU2034
4069:Core/Src/FAT/ff.c **** 			}
 6009              		.loc 1 4069 5 discriminator 2 view .LVU2035
4069:Core/Src/FAT/ff.c **** 			}
 6010              		.loc 1 4069 14 is_stmt 0 discriminator 2 view .LVU2036
 6011 007c 237C     		ldrb	r3, [r4, #16]	@ zero_extendqisi2
 6012 007e 03F07F03 		and	r3, r3, #127
 6013 0082 2374     		strb	r3, [r4, #16]
 6014 0084 6BE0     		b	.L441
 6015              	.L456:
4068:Core/Src/FAT/ff.c **** 				fp->flag &= (BYTE)~FA_DIRTY;
 6016              		.loc 1 4068 63 is_stmt 1 discriminator 1 view .LVU2037
 6017 0086 4FF0010A 		mov	r10, #1
 6018              	.LVL727:
4068:Core/Src/FAT/ff.c **** 				fp->flag &= (BYTE)~FA_DIRTY;
 6019              		.loc 1 4068 63 is_stmt 0 discriminator 1 view .LVU2038
 6020 008a 84F811A0 		strb	r10, [r4, #17]
4068:Core/Src/FAT/ff.c **** 				fp->flag &= (BYTE)~FA_DIRTY;
 6021              		.loc 1 4068 63 is_stmt 1 discriminator 1 view .LVU2039
 6022 008e 8BE0     		b	.L432
 6023              	.LVL728:
 6024              	.L463:
4073:Core/Src/FAT/ff.c **** 			sect += csect;
 6025              		.loc 1 4073 19 discriminator 1 view .LVU2040
 6026 0090 4FF0020A 		mov	r10, #2
 6027              	.LVL729:
4073:Core/Src/FAT/ff.c **** 			sect += csect;
 6028              		.loc 1 4073 19 is_stmt 0 discriminator 1 view .LVU2041
 6029 0094 84F811A0 		strb	r10, [r4, #17]
4073:Core/Src/FAT/ff.c **** 			sect += csect;
 6030              		.loc 1 4073 19 is_stmt 1 discriminator 1 view .LVU2042
 6031 0098 86E0     		b	.L432
 6032              	.LVL730:
 6033              	.L446:
4080:Core/Src/FAT/ff.c **** #if FF_FS_MINIMIZE <= 2
 6034              		.loc 1 4080 80 discriminator 2 view .LVU2043
4088:Core/Src/FAT/ff.c **** 					memcpy(fp->buf, wbuff + ((fp->sect - sect) * SS(fs)), SS(fs));
 6035              		.loc 1 4088 5 discriminator 2 view .LVU2044
4088:Core/Src/FAT/ff.c **** 					memcpy(fp->buf, wbuff + ((fp->sect - sect) * SS(fs)), SS(fs));
 6036              		.loc 1 4088 11 is_stmt 0 discriminator 2 view .LVU2045
 6037 009a E169     		ldr	r1, [r4, #28]
4088:Core/Src/FAT/ff.c **** 					memcpy(fp->buf, wbuff + ((fp->sect - sect) * SS(fs)), SS(fs));
 6038              		.loc 1 4088 18 discriminator 2 view .LVU2046
 6039 009c A1EB0901 		sub	r1, r1, r9
4088:Core/Src/FAT/ff.c **** 					memcpy(fp->buf, wbuff + ((fp->sect - sect) * SS(fs)), SS(fs));
 6040              		.loc 1 4088 8 discriminator 2 view .LVU2047
 6041 00a0 019B     		ldr	r3, [sp, #4]
 6042 00a2 9942     		cmp	r1, r3
 6043 00a4 02D3     		bcc	.L457
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 240


 6044              	.L447:
4094:Core/Src/FAT/ff.c **** 				continue;
 6045              		.loc 1 4094 5 is_stmt 1 view .LVU2048
4094:Core/Src/FAT/ff.c **** 				continue;
 6046              		.loc 1 4094 10 is_stmt 0 view .LVU2049
 6047 00a6 019B     		ldr	r3, [sp, #4]
 6048 00a8 5F02     		lsls	r7, r3, #9
 6049              	.LVL731:
4095:Core/Src/FAT/ff.c **** 			}
 6050              		.loc 1 4095 5 is_stmt 1 view .LVU2050
 6051 00aa 28E0     		b	.L448
 6052              	.LVL732:
 6053              	.L457:
4089:Core/Src/FAT/ff.c **** 					fp->flag &= (BYTE)~FA_DIRTY;
 6054              		.loc 1 4089 6 view .LVU2051
 6055 00ac 4FF40072 		mov	r2, #512
 6056 00b0 06EB4121 		add	r1, r6, r1, lsl #9
 6057 00b4 04F12800 		add	r0, r4, #40
 6058 00b8 FFF7FEFF 		bl	memcpy
 6059              	.LVL733:
4090:Core/Src/FAT/ff.c **** 				}
 6060              		.loc 1 4090 6 view .LVU2052
4090:Core/Src/FAT/ff.c **** 				}
 6061              		.loc 1 4090 15 is_stmt 0 view .LVU2053
 6062 00bc 237C     		ldrb	r3, [r4, #16]	@ zero_extendqisi2
 6063 00be 03F07F03 		and	r3, r3, #127
 6064 00c2 2374     		strb	r3, [r4, #16]
 6065 00c4 EFE7     		b	.L447
 6066              	.LVL734:
 6067              	.L444:
4103:Core/Src/FAT/ff.c **** 				fp->fptr < fp->obj.objsize &&
 6068              		.loc 1 4103 4 is_stmt 1 view .LVU2054
4103:Core/Src/FAT/ff.c **** 				fp->fptr < fp->obj.objsize &&
 6069              		.loc 1 4103 10 is_stmt 0 view .LVU2055
 6070 00c6 E369     		ldr	r3, [r4, #28]
 6071              	.LVL735:
4103:Core/Src/FAT/ff.c **** 				fp->fptr < fp->obj.objsize &&
 6072              		.loc 1 4103 7 view .LVU2056
 6073 00c8 4B45     		cmp	r3, r9
 6074 00ca 03D0     		beq	.L449
4104:Core/Src/FAT/ff.c **** 				disk_read(fs->pdrv, fp->buf, sect, 1) != RES_OK) {
 6075              		.loc 1 4104 7 discriminator 1 view .LVU2057
 6076 00cc 6269     		ldr	r2, [r4, #20]
4104:Core/Src/FAT/ff.c **** 				disk_read(fs->pdrv, fp->buf, sect, 1) != RES_OK) {
 6077              		.loc 1 4104 23 discriminator 1 view .LVU2058
 6078 00ce E368     		ldr	r3, [r4, #12]
4103:Core/Src/FAT/ff.c **** 				fp->fptr < fp->obj.objsize &&
 6079              		.loc 1 4103 25 discriminator 1 view .LVU2059
 6080 00d0 9A42     		cmp	r2, r3
 6081 00d2 6DD3     		bcc	.L458
 6082              	.L449:
4106:Core/Src/FAT/ff.c **** 			}
 6083              		.loc 1 4106 28 is_stmt 1 view .LVU2060
4109:Core/Src/FAT/ff.c **** 		}
 6084              		.loc 1 4109 4 view .LVU2061
4109:Core/Src/FAT/ff.c **** 		}
 6085              		.loc 1 4109 13 is_stmt 0 view .LVU2062
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 241


 6086 00d4 C4F81C90 		str	r9, [r4, #28]
 6087              	.LVL736:
 6088              	.L434:
4111:Core/Src/FAT/ff.c **** 		if (wcnt > btw) wcnt = btw;					/* Clip it by btw if needed */
 6089              		.loc 1 4111 3 is_stmt 1 view .LVU2063
4111:Core/Src/FAT/ff.c **** 		if (wcnt > btw) wcnt = btw;					/* Clip it by btw if needed */
 6090              		.loc 1 4111 27 is_stmt 0 view .LVU2064
 6091 00d8 6369     		ldr	r3, [r4, #20]
4111:Core/Src/FAT/ff.c **** 		if (wcnt > btw) wcnt = btw;					/* Clip it by btw if needed */
 6092              		.loc 1 4111 34 view .LVU2065
 6093 00da C3F30803 		ubfx	r3, r3, #0, #9
4111:Core/Src/FAT/ff.c **** 		if (wcnt > btw) wcnt = btw;					/* Clip it by btw if needed */
 6094              		.loc 1 4111 8 view .LVU2066
 6095 00de C3F50077 		rsb	r7, r3, #512
 6096              	.LVL737:
4112:Core/Src/FAT/ff.c **** #if FF_FS_TINY
 6097              		.loc 1 4112 3 is_stmt 1 view .LVU2067
4112:Core/Src/FAT/ff.c **** #if FF_FS_TINY
 6098              		.loc 1 4112 6 is_stmt 0 view .LVU2068
 6099 00e2 BD42     		cmp	r5, r7
 6100 00e4 00D2     		bcs	.L450
4112:Core/Src/FAT/ff.c **** #if FF_FS_TINY
 6101              		.loc 1 4112 24 view .LVU2069
 6102 00e6 2F46     		mov	r7, r5
 6103              	.LVL738:
 6104              	.L450:
4118:Core/Src/FAT/ff.c **** 		fp->flag |= FA_DIRTY;
 6105              		.loc 1 4118 3 is_stmt 1 view .LVU2070
4118:Core/Src/FAT/ff.c **** 		fp->flag |= FA_DIRTY;
 6106              		.loc 1 4118 10 is_stmt 0 view .LVU2071
 6107 00e8 04F12800 		add	r0, r4, #40
4118:Core/Src/FAT/ff.c **** 		fp->flag |= FA_DIRTY;
 6108              		.loc 1 4118 3 view .LVU2072
 6109 00ec 3A46     		mov	r2, r7
 6110 00ee 3146     		mov	r1, r6
 6111 00f0 1844     		add	r0, r0, r3
 6112 00f2 FFF7FEFF 		bl	memcpy
 6113              	.LVL739:
4119:Core/Src/FAT/ff.c **** #endif
 6114              		.loc 1 4119 3 is_stmt 1 view .LVU2073
4119:Core/Src/FAT/ff.c **** #endif
 6115              		.loc 1 4119 12 is_stmt 0 view .LVU2074
 6116 00f6 237C     		ldrb	r3, [r4, #16]	@ zero_extendqisi2
 6117 00f8 63F07F03 		orn	r3, r3, #127
 6118 00fc 2374     		strb	r3, [r4, #16]
 6119              	.L448:
4039:Core/Src/FAT/ff.c **** 		if (fp->fptr % SS(fs) == 0) {		/* On the sector boundary? */
 6120              		.loc 1 4039 19 is_stmt 1 view .LVU2075
4039:Core/Src/FAT/ff.c **** 		if (fp->fptr % SS(fs) == 0) {		/* On the sector boundary? */
 6121              		.loc 1 4039 23 is_stmt 0 view .LVU2076
 6122 00fe ED1B     		subs	r5, r5, r7
 6123              	.LVL740:
4039:Core/Src/FAT/ff.c **** 		if (fp->fptr % SS(fs) == 0) {		/* On the sector boundary? */
 6124              		.loc 1 4039 36 view .LVU2077
 6125 0100 D8F80030 		ldr	r3, [r8]
 6126 0104 3B44     		add	r3, r3, r7
 6127 0106 C8F80030 		str	r3, [r8]
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 242


4039:Core/Src/FAT/ff.c **** 		if (fp->fptr % SS(fs) == 0) {		/* On the sector boundary? */
 6128              		.loc 1 4039 51 view .LVU2078
 6129 010a 3E44     		add	r6, r6, r7
 6130              	.LVL741:
4039:Core/Src/FAT/ff.c **** 		if (fp->fptr % SS(fs) == 0) {		/* On the sector boundary? */
 6131              		.loc 1 4039 69 view .LVU2079
 6132 010c 6369     		ldr	r3, [r4, #20]
 6133 010e 1F44     		add	r7, r7, r3
 6134              	.LVL742:
4039:Core/Src/FAT/ff.c **** 		if (fp->fptr % SS(fs) == 0) {		/* On the sector boundary? */
 6135              		.loc 1 4039 69 view .LVU2080
 6136 0110 6761     		str	r7, [r4, #20]
4039:Core/Src/FAT/ff.c **** 		if (fp->fptr % SS(fs) == 0) {		/* On the sector boundary? */
 6137              		.loc 1 4039 115 view .LVU2081
 6138 0112 E368     		ldr	r3, [r4, #12]
4039:Core/Src/FAT/ff.c **** 		if (fp->fptr % SS(fs) == 0) {		/* On the sector boundary? */
 6139              		.loc 1 4039 136 view .LVU2082
 6140 0114 9F42     		cmp	r7, r3
 6141 0116 38BF     		it	cc
 6142 0118 1F46     		movcc	r7, r3
4039:Core/Src/FAT/ff.c **** 		if (fp->fptr % SS(fs) == 0) {		/* On the sector boundary? */
 6143              		.loc 1 4039 94 view .LVU2083
 6144 011a E760     		str	r7, [r4, #12]
 6145              	.L451:
4039:Core/Src/FAT/ff.c **** 		if (fp->fptr % SS(fs) == 0) {		/* On the sector boundary? */
 6146              		.loc 1 4039 10 is_stmt 1 discriminator 1 view .LVU2084
4039:Core/Src/FAT/ff.c **** 		if (fp->fptr % SS(fs) == 0) {		/* On the sector boundary? */
 6147              		.loc 1 4039 2 is_stmt 0 discriminator 1 view .LVU2085
 6148 011c 002D     		cmp	r5, #0
 6149 011e 56D0     		beq	.L438
4040:Core/Src/FAT/ff.c **** 			csect = (UINT)(fp->fptr / SS(fs)) & (fs->csize - 1);	/* Sector offset in the cluster */
 6150              		.loc 1 4040 3 is_stmt 1 view .LVU2086
4040:Core/Src/FAT/ff.c **** 			csect = (UINT)(fp->fptr / SS(fs)) & (fs->csize - 1);	/* Sector offset in the cluster */
 6151              		.loc 1 4040 9 is_stmt 0 view .LVU2087
 6152 0120 6369     		ldr	r3, [r4, #20]
4040:Core/Src/FAT/ff.c **** 			csect = (UINT)(fp->fptr / SS(fs)) & (fs->csize - 1);	/* Sector offset in the cluster */
 6153              		.loc 1 4040 16 view .LVU2088
 6154 0122 C3F30802 		ubfx	r2, r3, #0, #9
4040:Core/Src/FAT/ff.c **** 			csect = (UINT)(fp->fptr / SS(fs)) & (fs->csize - 1);	/* Sector offset in the cluster */
 6155              		.loc 1 4040 6 view .LVU2089
 6156 0126 002A     		cmp	r2, #0
 6157 0128 D6D1     		bne	.L434
4041:Core/Src/FAT/ff.c **** 			if (csect == 0) {				/* On the cluster boundary? */
 6158              		.loc 1 4041 4 is_stmt 1 view .LVU2090
4041:Core/Src/FAT/ff.c **** 			if (csect == 0) {				/* On the cluster boundary? */
 6159              		.loc 1 4041 43 is_stmt 0 view .LVU2091
 6160 012a 039A     		ldr	r2, [sp, #12]
 6161 012c 5789     		ldrh	r7, [r2, #10]
4041:Core/Src/FAT/ff.c **** 			if (csect == 0) {				/* On the cluster boundary? */
 6162              		.loc 1 4041 51 view .LVU2092
 6163 012e 013F     		subs	r7, r7, #1
 6164              	.LVL743:
4042:Core/Src/FAT/ff.c **** 				if (fp->fptr == 0) {		/* On the top of the file? */
 6165              		.loc 1 4042 4 is_stmt 1 view .LVU2093
4042:Core/Src/FAT/ff.c **** 				if (fp->fptr == 0) {		/* On the top of the file? */
 6166              		.loc 1 4042 7 is_stmt 0 view .LVU2094
 6167 0130 17EA5327 		ands	r7, r7, r3, lsr #9
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 243


 6168              	.LVL744:
4042:Core/Src/FAT/ff.c **** 				if (fp->fptr == 0) {		/* On the top of the file? */
 6169              		.loc 1 4042 7 view .LVU2095
 6170 0134 0FD1     		bne	.L435
4043:Core/Src/FAT/ff.c **** 					clst = fp->obj.sclust;	/* Follow from the origin */
 6171              		.loc 1 4043 5 is_stmt 1 view .LVU2096
4043:Core/Src/FAT/ff.c **** 					clst = fp->obj.sclust;	/* Follow from the origin */
 6172              		.loc 1 4043 8 is_stmt 0 view .LVU2097
 6173 0136 002B     		cmp	r3, #0
 6174 0138 88D1     		bne	.L436
4044:Core/Src/FAT/ff.c **** 					if (clst == 0) {		/* If no cluster is allocated, */
 6175              		.loc 1 4044 6 is_stmt 1 view .LVU2098
4044:Core/Src/FAT/ff.c **** 					if (clst == 0) {		/* If no cluster is allocated, */
 6176              		.loc 1 4044 11 is_stmt 0 view .LVU2099
 6177 013a A068     		ldr	r0, [r4, #8]
 6178              	.LVL745:
4045:Core/Src/FAT/ff.c **** 						clst = create_chain(&fp->obj, 0);	/* create a new cluster chain */
 6179              		.loc 1 4045 6 is_stmt 1 view .LVU2100
4045:Core/Src/FAT/ff.c **** 						clst = create_chain(&fp->obj, 0);	/* create a new cluster chain */
 6180              		.loc 1 4045 9 is_stmt 0 view .LVU2101
 6181 013c 0028     		cmp	r0, #0
 6182 013e 80D0     		beq	.L459
 6183              	.L437:
4058:Core/Src/FAT/ff.c **** 				if (clst == 1) ABORT(fs, FR_INT_ERR);
 6184              		.loc 1 4058 5 is_stmt 1 view .LVU2102
4058:Core/Src/FAT/ff.c **** 				if (clst == 1) ABORT(fs, FR_INT_ERR);
 6185              		.loc 1 4058 8 is_stmt 0 view .LVU2103
 6186 0140 0028     		cmp	r0, #0
 6187 0142 44D0     		beq	.L438
4059:Core/Src/FAT/ff.c **** 				if (clst == 0xFFFFFFFF) ABORT(fs, FR_DISK_ERR);
 6188              		.loc 1 4059 5 is_stmt 1 view .LVU2104
4059:Core/Src/FAT/ff.c **** 				if (clst == 0xFFFFFFFF) ABORT(fs, FR_DISK_ERR);
 6189              		.loc 1 4059 8 is_stmt 0 view .LVU2105
 6190 0144 0128     		cmp	r0, #1
 6191 0146 86D0     		beq	.L460
4059:Core/Src/FAT/ff.c **** 				if (clst == 0xFFFFFFFF) ABORT(fs, FR_DISK_ERR);
 6192              		.loc 1 4059 41 is_stmt 1 discriminator 2 view .LVU2106
4060:Core/Src/FAT/ff.c **** 				fp->clust = clst;			/* Update current cluster */
 6193              		.loc 1 4060 5 discriminator 2 view .LVU2107
4060:Core/Src/FAT/ff.c **** 				fp->clust = clst;			/* Update current cluster */
 6194              		.loc 1 4060 8 is_stmt 0 discriminator 2 view .LVU2108
 6195 0148 B0F1FF3F 		cmp	r0, #-1
 6196 014c 88D0     		beq	.L461
4060:Core/Src/FAT/ff.c **** 				fp->clust = clst;			/* Update current cluster */
 6197              		.loc 1 4060 51 is_stmt 1 discriminator 2 view .LVU2109
4061:Core/Src/FAT/ff.c **** 				if (fp->obj.sclust == 0) fp->obj.sclust = clst;	/* Set start cluster if the first write */
 6198              		.loc 1 4061 5 discriminator 2 view .LVU2110
4061:Core/Src/FAT/ff.c **** 				if (fp->obj.sclust == 0) fp->obj.sclust = clst;	/* Set start cluster if the first write */
 6199              		.loc 1 4061 15 is_stmt 0 discriminator 2 view .LVU2111
 6200 014e A061     		str	r0, [r4, #24]
4062:Core/Src/FAT/ff.c **** 			}
 6201              		.loc 1 4062 5 is_stmt 1 discriminator 2 view .LVU2112
4062:Core/Src/FAT/ff.c **** 			}
 6202              		.loc 1 4062 16 is_stmt 0 discriminator 2 view .LVU2113
 6203 0150 A368     		ldr	r3, [r4, #8]
4062:Core/Src/FAT/ff.c **** 			}
 6204              		.loc 1 4062 8 discriminator 2 view .LVU2114
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 244


 6205 0152 03B9     		cbnz	r3, .L435
4062:Core/Src/FAT/ff.c **** 			}
 6206              		.loc 1 4062 30 is_stmt 1 discriminator 1 view .LVU2115
4062:Core/Src/FAT/ff.c **** 			}
 6207              		.loc 1 4062 45 is_stmt 0 discriminator 1 view .LVU2116
 6208 0154 A060     		str	r0, [r4, #8]
 6209              	.LVL746:
 6210              	.L435:
4067:Core/Src/FAT/ff.c **** 				if (disk_write(fs->pdrv, fp->buf, fp->sect, 1) != RES_OK) ABORT(fs, FR_DISK_ERR);
 6211              		.loc 1 4067 4 is_stmt 1 view .LVU2117
4067:Core/Src/FAT/ff.c **** 				if (disk_write(fs->pdrv, fp->buf, fp->sect, 1) != RES_OK) ABORT(fs, FR_DISK_ERR);
 6212              		.loc 1 4067 8 is_stmt 0 view .LVU2118
 6213 0156 94F91030 		ldrsb	r3, [r4, #16]
4067:Core/Src/FAT/ff.c **** 				if (disk_write(fs->pdrv, fp->buf, fp->sect, 1) != RES_OK) ABORT(fs, FR_DISK_ERR);
 6214              		.loc 1 4067 7 view .LVU2119
 6215 015a 002B     		cmp	r3, #0
 6216 015c 85DB     		blt	.L462
 6217              	.L441:
4072:Core/Src/FAT/ff.c **** 			if (sect == 0) ABORT(fs, FR_INT_ERR);
 6218              		.loc 1 4072 4 is_stmt 1 view .LVU2120
4072:Core/Src/FAT/ff.c **** 			if (sect == 0) ABORT(fs, FR_INT_ERR);
 6219              		.loc 1 4072 11 is_stmt 0 view .LVU2121
 6220 015e DDF80CB0 		ldr	fp, [sp, #12]
 6221 0162 A169     		ldr	r1, [r4, #24]
 6222 0164 5846     		mov	r0, fp
 6223 0166 FFF7FEFF 		bl	clst2sect
 6224              	.LVL747:
4073:Core/Src/FAT/ff.c **** 			sect += csect;
 6225              		.loc 1 4073 4 is_stmt 1 view .LVU2122
4073:Core/Src/FAT/ff.c **** 			sect += csect;
 6226              		.loc 1 4073 7 is_stmt 0 view .LVU2123
 6227 016a 8146     		mov	r9, r0
 6228 016c 0028     		cmp	r0, #0
 6229 016e 8FD0     		beq	.L463
4073:Core/Src/FAT/ff.c **** 			sect += csect;
 6230              		.loc 1 4073 40 is_stmt 1 discriminator 2 view .LVU2124
4074:Core/Src/FAT/ff.c **** 			cc = btw / SS(fs);				/* When remaining bytes >= sector size, */
 6231              		.loc 1 4074 4 discriminator 2 view .LVU2125
4074:Core/Src/FAT/ff.c **** 			cc = btw / SS(fs);				/* When remaining bytes >= sector size, */
 6232              		.loc 1 4074 9 is_stmt 0 discriminator 2 view .LVU2126
 6233 0170 B944     		add	r9, r9, r7
 6234              	.LVL748:
4075:Core/Src/FAT/ff.c **** 			if (cc > 0) {					/* Write maximum contiguous sectors directly */
 6235              		.loc 1 4075 4 is_stmt 1 discriminator 2 view .LVU2127
4075:Core/Src/FAT/ff.c **** 			if (cc > 0) {					/* Write maximum contiguous sectors directly */
 6236              		.loc 1 4075 7 is_stmt 0 discriminator 2 view .LVU2128
 6237 0172 6B0A     		lsrs	r3, r5, #9
 6238 0174 0193     		str	r3, [sp, #4]
 6239              	.LVL749:
4076:Core/Src/FAT/ff.c **** 				if (csect + cc > fs->csize) {	/* Clip at cluster boundary */
 6240              		.loc 1 4076 4 is_stmt 1 discriminator 2 view .LVU2129
4076:Core/Src/FAT/ff.c **** 				if (csect + cc > fs->csize) {	/* Clip at cluster boundary */
 6241              		.loc 1 4076 7 is_stmt 0 discriminator 2 view .LVU2130
 6242 0176 B5F5007F 		cmp	r5, #512
 6243 017a A4D3     		bcc	.L444
4077:Core/Src/FAT/ff.c **** 					cc = fs->csize - csect;
 6244              		.loc 1 4077 5 is_stmt 1 view .LVU2131
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 245


4077:Core/Src/FAT/ff.c **** 					cc = fs->csize - csect;
 6245              		.loc 1 4077 15 is_stmt 0 view .LVU2132
 6246 017c FB18     		adds	r3, r7, r3
 6247              	.LVL750:
4077:Core/Src/FAT/ff.c **** 					cc = fs->csize - csect;
 6248              		.loc 1 4077 24 view .LVU2133
 6249 017e BBF80A20 		ldrh	r2, [fp, #10]
4077:Core/Src/FAT/ff.c **** 					cc = fs->csize - csect;
 6250              		.loc 1 4077 8 view .LVU2134
 6251 0182 9342     		cmp	r3, r2
 6252 0184 01D9     		bls	.L445
4078:Core/Src/FAT/ff.c **** 				}
 6253              		.loc 1 4078 6 is_stmt 1 view .LVU2135
4078:Core/Src/FAT/ff.c **** 				}
 6254              		.loc 1 4078 9 is_stmt 0 view .LVU2136
 6255 0186 D31B     		subs	r3, r2, r7
 6256 0188 0193     		str	r3, [sp, #4]
 6257              	.LVL751:
 6258              	.L445:
4080:Core/Src/FAT/ff.c **** #if FF_FS_MINIMIZE <= 2
 6259              		.loc 1 4080 5 is_stmt 1 view .LVU2137
4080:Core/Src/FAT/ff.c **** #if FF_FS_MINIMIZE <= 2
 6260              		.loc 1 4080 9 is_stmt 0 view .LVU2138
 6261 018a 9DF80430 		ldrb	r3, [sp, #4]	@ zero_extendqisi2
 6262 018e 4A46     		mov	r2, r9
 6263 0190 3146     		mov	r1, r6
 6264 0192 9BF80100 		ldrb	r0, [fp, #1]	@ zero_extendqisi2
 6265 0196 FFF7FEFF 		bl	disk_write
 6266              	.LVL752:
4080:Core/Src/FAT/ff.c **** #if FF_FS_MINIMIZE <= 2
 6267              		.loc 1 4080 8 view .LVU2139
 6268 019a 0028     		cmp	r0, #0
 6269 019c 3FF47DAF 		beq	.L446
4080:Core/Src/FAT/ff.c **** #if FF_FS_MINIMIZE <= 2
 6270              		.loc 1 4080 58 is_stmt 1 discriminator 1 view .LVU2140
 6271 01a0 4FF0010A 		mov	r10, #1
 6272              	.LVL753:
4080:Core/Src/FAT/ff.c **** #if FF_FS_MINIMIZE <= 2
 6273              		.loc 1 4080 58 is_stmt 0 discriminator 1 view .LVU2141
 6274 01a4 84F811A0 		strb	r10, [r4, #17]
4080:Core/Src/FAT/ff.c **** #if FF_FS_MINIMIZE <= 2
 6275              		.loc 1 4080 58 is_stmt 1 discriminator 1 view .LVU2142
 6276              	.LVL754:
 6277              	.L432:
4126:Core/Src/FAT/ff.c **** 
 6278              		.loc 1 4126 1 is_stmt 0 view .LVU2143
 6279 01a8 5046     		mov	r0, r10
 6280 01aa 05B0     		add	sp, sp, #20
 6281              	.LCFI50:
 6282              		.cfi_remember_state
 6283              		.cfi_def_cfa_offset 36
 6284              		@ sp needed
 6285 01ac BDE8F08F 		pop	{r4, r5, r6, r7, r8, r9, r10, fp, pc}
 6286              	.LVL755:
 6287              	.L458:
 6288              	.LCFI51:
 6289              		.cfi_restore_state
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 246


4105:Core/Src/FAT/ff.c **** 					ABORT(fs, FR_DISK_ERR);
 6290              		.loc 1 4105 5 view .LVU2144
 6291 01b0 0123     		movs	r3, #1
 6292 01b2 4A46     		mov	r2, r9
 6293 01b4 04F12801 		add	r1, r4, #40
 6294 01b8 9BF80100 		ldrb	r0, [fp, #1]	@ zero_extendqisi2
 6295 01bc FFF7FEFF 		bl	disk_read
 6296              	.LVL756:
4104:Core/Src/FAT/ff.c **** 				disk_read(fs->pdrv, fp->buf, sect, 1) != RES_OK) {
 6297              		.loc 1 4104 32 view .LVU2145
 6298 01c0 0028     		cmp	r0, #0
 6299 01c2 87D0     		beq	.L449
4106:Core/Src/FAT/ff.c **** 			}
 6300              		.loc 1 4106 6 is_stmt 1 view .LVU2146
 6301 01c4 4FF0010A 		mov	r10, #1
 6302              	.LVL757:
4106:Core/Src/FAT/ff.c **** 			}
 6303              		.loc 1 4106 6 is_stmt 0 view .LVU2147
 6304 01c8 84F811A0 		strb	r10, [r4, #17]
4106:Core/Src/FAT/ff.c **** 			}
 6305              		.loc 1 4106 6 is_stmt 1 view .LVU2148
 6306 01cc ECE7     		b	.L432
 6307              	.LVL758:
 6308              	.L438:
4123:Core/Src/FAT/ff.c **** 
 6309              		.loc 1 4123 2 view .LVU2149
4123:Core/Src/FAT/ff.c **** 
 6310              		.loc 1 4123 11 is_stmt 0 view .LVU2150
 6311 01ce 237C     		ldrb	r3, [r4, #16]	@ zero_extendqisi2
 6312 01d0 43F04003 		orr	r3, r3, #64
 6313 01d4 2374     		strb	r3, [r4, #16]
4125:Core/Src/FAT/ff.c **** }
 6314              		.loc 1 4125 2 is_stmt 1 view .LVU2151
 6315 01d6 E7E7     		b	.L432
 6316              	.LVL759:
 6317              	.L453:
4032:Core/Src/FAT/ff.c **** 
 6318              		.loc 1 4032 30 is_stmt 0 view .LVU2152
 6319 01d8 4FF0070A 		mov	r10, #7
 6320              	.LVL760:
4032:Core/Src/FAT/ff.c **** 
 6321              		.loc 1 4032 30 view .LVU2153
 6322 01dc E4E7     		b	.L432
 6323              		.cfi_endproc
 6324              	.LFE35:
 6326              		.section	.text.f_sync,"ax",%progbits
 6327              		.align	1
 6328              		.global	f_sync
 6329              		.syntax unified
 6330              		.thumb
 6331              		.thumb_func
 6333              	f_sync:
 6334              	.LVL761:
 6335              	.LFB36:
4138:Core/Src/FAT/ff.c **** 	FRESULT res;
 6336              		.loc 1 4138 1 is_stmt 1 view -0
 6337              		.cfi_startproc
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 247


 6338              		@ args = 0, pretend = 0, frame = 8
 6339              		@ frame_needed = 0, uses_anonymous_args = 0
4138:Core/Src/FAT/ff.c **** 	FRESULT res;
 6340              		.loc 1 4138 1 is_stmt 0 view .LVU2155
 6341 0000 70B5     		push	{r4, r5, r6, lr}
 6342              	.LCFI52:
 6343              		.cfi_def_cfa_offset 16
 6344              		.cfi_offset 4, -16
 6345              		.cfi_offset 5, -12
 6346              		.cfi_offset 6, -8
 6347              		.cfi_offset 14, -4
 6348 0002 82B0     		sub	sp, sp, #8
 6349              	.LCFI53:
 6350              		.cfi_def_cfa_offset 24
 6351 0004 0446     		mov	r4, r0
4139:Core/Src/FAT/ff.c **** 	FATFS *fs;
 6352              		.loc 1 4139 2 is_stmt 1 view .LVU2156
4140:Core/Src/FAT/ff.c **** 	DWORD tm;
 6353              		.loc 1 4140 2 view .LVU2157
4141:Core/Src/FAT/ff.c **** 	BYTE *dir;
 6354              		.loc 1 4141 2 view .LVU2158
4142:Core/Src/FAT/ff.c **** 
 6355              		.loc 1 4142 2 view .LVU2159
4145:Core/Src/FAT/ff.c **** 	if (res == FR_OK) {
 6356              		.loc 1 4145 2 view .LVU2160
4145:Core/Src/FAT/ff.c **** 	if (res == FR_OK) {
 6357              		.loc 1 4145 8 is_stmt 0 view .LVU2161
 6358 0006 01A9     		add	r1, sp, #4
 6359 0008 FFF7FEFF 		bl	validate
 6360              	.LVL762:
4146:Core/Src/FAT/ff.c **** 		if (fp->flag & FA_MODIFIED) {	/* Is there any change to the file? */
 6361              		.loc 1 4146 2 is_stmt 1 view .LVU2162
4146:Core/Src/FAT/ff.c **** 		if (fp->flag & FA_MODIFIED) {	/* Is there any change to the file? */
 6362              		.loc 1 4146 5 is_stmt 0 view .LVU2163
 6363 000c 70B9     		cbnz	r0, .L465
4147:Core/Src/FAT/ff.c **** #if !FF_FS_TINY
 6364              		.loc 1 4147 3 is_stmt 1 view .LVU2164
4147:Core/Src/FAT/ff.c **** #if !FF_FS_TINY
 6365              		.loc 1 4147 9 is_stmt 0 view .LVU2165
 6366 000e 237C     		ldrb	r3, [r4, #16]	@ zero_extendqisi2
4147:Core/Src/FAT/ff.c **** #if !FF_FS_TINY
 6367              		.loc 1 4147 6 view .LVU2166
 6368 0010 13F0400F 		tst	r3, #64
 6369 0014 0AD0     		beq	.L465
4149:Core/Src/FAT/ff.c **** 				if (disk_write(fs->pdrv, fp->buf, fp->sect, 1) != RES_OK) LEAVE_FF(fs, FR_DISK_ERR);
 6370              		.loc 1 4149 4 is_stmt 1 view .LVU2167
4149:Core/Src/FAT/ff.c **** 				if (disk_write(fs->pdrv, fp->buf, fp->sect, 1) != RES_OK) LEAVE_FF(fs, FR_DISK_ERR);
 6371              		.loc 1 4149 7 is_stmt 0 view .LVU2168
 6372 0016 13F0800F 		tst	r3, #128
 6373 001a 09D1     		bne	.L469
 6374              	.L466:
4155:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT
 6375              		.loc 1 4155 4 is_stmt 1 view .LVU2169
4155:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT
 6376              		.loc 1 4155 9 is_stmt 0 view .LVU2170
 6377 001c FFF7FEFF 		bl	get_fattime
 6378              	.LVL763:
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 248


 6379 0020 0546     		mov	r5, r0
 6380              	.LVL764:
4188:Core/Src/FAT/ff.c **** 				if (res == FR_OK) {
 6381              		.loc 1 4188 5 is_stmt 1 view .LVU2171
4188:Core/Src/FAT/ff.c **** 				if (res == FR_OK) {
 6382              		.loc 1 4188 11 is_stmt 0 view .LVU2172
 6383 0022 216A     		ldr	r1, [r4, #32]
 6384 0024 0198     		ldr	r0, [sp, #4]
 6385              	.LVL765:
4188:Core/Src/FAT/ff.c **** 				if (res == FR_OK) {
 6386              		.loc 1 4188 11 view .LVU2173
 6387 0026 FFF7FEFF 		bl	move_window
 6388              	.LVL766:
4189:Core/Src/FAT/ff.c **** 					dir = fp->dir_ptr;
 6389              		.loc 1 4189 5 is_stmt 1 view .LVU2174
4189:Core/Src/FAT/ff.c **** 					dir = fp->dir_ptr;
 6390              		.loc 1 4189 8 is_stmt 0 view .LVU2175
 6391 002a 78B1     		cbz	r0, .L470
 6392              	.LVL767:
 6393              	.L465:
4205:Core/Src/FAT/ff.c **** 
 6394              		.loc 1 4205 1 view .LVU2176
 6395 002c 02B0     		add	sp, sp, #8
 6396              	.LCFI54:
 6397              		.cfi_remember_state
 6398              		.cfi_def_cfa_offset 16
 6399              		@ sp needed
 6400 002e 70BD     		pop	{r4, r5, r6, pc}
 6401              	.LVL768:
 6402              	.L469:
 6403              	.LCFI55:
 6404              		.cfi_restore_state
4150:Core/Src/FAT/ff.c **** 				fp->flag &= (BYTE)~FA_DIRTY;
 6405              		.loc 1 4150 5 is_stmt 1 view .LVU2177
4150:Core/Src/FAT/ff.c **** 				fp->flag &= (BYTE)~FA_DIRTY;
 6406              		.loc 1 4150 9 is_stmt 0 view .LVU2178
 6407 0030 0123     		movs	r3, #1
 6408 0032 E269     		ldr	r2, [r4, #28]
 6409 0034 04F12801 		add	r1, r4, #40
 6410 0038 0198     		ldr	r0, [sp, #4]
 6411 003a 4078     		ldrb	r0, [r0, #1]	@ zero_extendqisi2
 6412 003c FFF7FEFF 		bl	disk_write
 6413              	.LVL769:
4150:Core/Src/FAT/ff.c **** 				fp->flag &= (BYTE)~FA_DIRTY;
 6414              		.loc 1 4150 8 view .LVU2179
 6415 0040 38BB     		cbnz	r0, .L467
4151:Core/Src/FAT/ff.c **** 			}
 6416              		.loc 1 4151 5 is_stmt 1 view .LVU2180
4151:Core/Src/FAT/ff.c **** 			}
 6417              		.loc 1 4151 14 is_stmt 0 view .LVU2181
 6418 0042 237C     		ldrb	r3, [r4, #16]	@ zero_extendqisi2
 6419 0044 03F07F03 		and	r3, r3, #127
 6420 0048 2374     		strb	r3, [r4, #16]
 6421 004a E7E7     		b	.L466
 6422              	.LVL770:
 6423              	.L470:
4190:Core/Src/FAT/ff.c **** 					dir[DIR_Attr] |= AM_ARC;						/* Set archive attribute to indicate that the file has been chan
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 249


 6424              		.loc 1 4190 6 is_stmt 1 view .LVU2182
4190:Core/Src/FAT/ff.c **** 					dir[DIR_Attr] |= AM_ARC;						/* Set archive attribute to indicate that the file has been chan
 6425              		.loc 1 4190 10 is_stmt 0 view .LVU2183
 6426 004c 666A     		ldr	r6, [r4, #36]
 6427              	.LVL771:
4191:Core/Src/FAT/ff.c **** 					st_clust(fp->obj.fs, dir, fp->obj.sclust);		/* Update file allocation information  */
 6428              		.loc 1 4191 6 is_stmt 1 view .LVU2184
4191:Core/Src/FAT/ff.c **** 					st_clust(fp->obj.fs, dir, fp->obj.sclust);		/* Update file allocation information  */
 6429              		.loc 1 4191 20 is_stmt 0 view .LVU2185
 6430 004e F37A     		ldrb	r3, [r6, #11]	@ zero_extendqisi2
 6431 0050 43F02003 		orr	r3, r3, #32
 6432 0054 F372     		strb	r3, [r6, #11]
4192:Core/Src/FAT/ff.c **** 					st_dword(dir + DIR_FileSize, (DWORD)fp->obj.objsize);	/* Update file size */
 6433              		.loc 1 4192 6 is_stmt 1 view .LVU2186
 6434 0056 A268     		ldr	r2, [r4, #8]
 6435 0058 3146     		mov	r1, r6
 6436 005a 2068     		ldr	r0, [r4]
 6437              	.LVL772:
4192:Core/Src/FAT/ff.c **** 					st_dword(dir + DIR_FileSize, (DWORD)fp->obj.objsize);	/* Update file size */
 6438              		.loc 1 4192 6 is_stmt 0 view .LVU2187
 6439 005c FFF7FEFF 		bl	st_clust
 6440              	.LVL773:
4193:Core/Src/FAT/ff.c **** 					st_dword(dir + DIR_ModTime, tm);				/* Update modified time */
 6441              		.loc 1 4193 6 is_stmt 1 view .LVU2188
 6442 0060 E168     		ldr	r1, [r4, #12]
 6443 0062 06F11C00 		add	r0, r6, #28
 6444 0066 FFF7FEFF 		bl	st_dword
 6445              	.LVL774:
4194:Core/Src/FAT/ff.c **** 					st_word(dir + DIR_LstAccDate, 0);
 6446              		.loc 1 4194 6 view .LVU2189
 6447 006a 2946     		mov	r1, r5
 6448 006c 06F11600 		add	r0, r6, #22
 6449 0070 FFF7FEFF 		bl	st_dword
 6450              	.LVL775:
4195:Core/Src/FAT/ff.c **** 					fs->wflag = 1;
 6451              		.loc 1 4195 6 view .LVU2190
 6452 0074 0021     		movs	r1, #0
 6453 0076 06F11200 		add	r0, r6, #18
 6454 007a FFF7FEFF 		bl	st_word
 6455              	.LVL776:
4196:Core/Src/FAT/ff.c **** 					res = sync_fs(fs);					/* Restore it to the directory */
 6456              		.loc 1 4196 6 view .LVU2191
4196:Core/Src/FAT/ff.c **** 					res = sync_fs(fs);					/* Restore it to the directory */
 6457              		.loc 1 4196 8 is_stmt 0 view .LVU2192
 6458 007e 0198     		ldr	r0, [sp, #4]
4196:Core/Src/FAT/ff.c **** 					res = sync_fs(fs);					/* Restore it to the directory */
 6459              		.loc 1 4196 16 view .LVU2193
 6460 0080 0123     		movs	r3, #1
 6461 0082 0371     		strb	r3, [r0, #4]
4197:Core/Src/FAT/ff.c **** 					fp->flag &= (BYTE)~FA_MODIFIED;
 6462              		.loc 1 4197 6 is_stmt 1 view .LVU2194
4197:Core/Src/FAT/ff.c **** 					fp->flag &= (BYTE)~FA_MODIFIED;
 6463              		.loc 1 4197 12 is_stmt 0 view .LVU2195
 6464 0084 FFF7FEFF 		bl	sync_fs
 6465              	.LVL777:
4198:Core/Src/FAT/ff.c **** 				}
 6466              		.loc 1 4198 6 is_stmt 1 view .LVU2196
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 250


4198:Core/Src/FAT/ff.c **** 				}
 6467              		.loc 1 4198 15 is_stmt 0 view .LVU2197
 6468 0088 237C     		ldrb	r3, [r4, #16]	@ zero_extendqisi2
 6469 008a 23F04003 		bic	r3, r3, #64
 6470 008e 2374     		strb	r3, [r4, #16]
 6471 0090 CCE7     		b	.L465
 6472              	.LVL778:
 6473              	.L467:
4150:Core/Src/FAT/ff.c **** 				fp->flag &= (BYTE)~FA_DIRTY;
 6474              		.loc 1 4150 63 view .LVU2198
 6475 0092 0120     		movs	r0, #1
 6476 0094 CAE7     		b	.L465
 6477              		.cfi_endproc
 6478              	.LFE36:
 6480              		.section	.text.f_close,"ax",%progbits
 6481              		.align	1
 6482              		.global	f_close
 6483              		.syntax unified
 6484              		.thumb
 6485              		.thumb_func
 6487              	f_close:
 6488              	.LVL779:
 6489              	.LFB37:
4219:Core/Src/FAT/ff.c **** 	FRESULT res;
 6490              		.loc 1 4219 1 is_stmt 1 view -0
 6491              		.cfi_startproc
 6492              		@ args = 0, pretend = 0, frame = 8
 6493              		@ frame_needed = 0, uses_anonymous_args = 0
4219:Core/Src/FAT/ff.c **** 	FRESULT res;
 6494              		.loc 1 4219 1 is_stmt 0 view .LVU2200
 6495 0000 10B5     		push	{r4, lr}
 6496              	.LCFI56:
 6497              		.cfi_def_cfa_offset 8
 6498              		.cfi_offset 4, -8
 6499              		.cfi_offset 14, -4
 6500 0002 82B0     		sub	sp, sp, #8
 6501              	.LCFI57:
 6502              		.cfi_def_cfa_offset 16
 6503 0004 0446     		mov	r4, r0
4220:Core/Src/FAT/ff.c **** 	FATFS *fs;
 6504              		.loc 1 4220 2 is_stmt 1 view .LVU2201
4221:Core/Src/FAT/ff.c **** 
 6505              		.loc 1 4221 2 view .LVU2202
4224:Core/Src/FAT/ff.c **** 	if (res == FR_OK)
 6506              		.loc 1 4224 2 view .LVU2203
4224:Core/Src/FAT/ff.c **** 	if (res == FR_OK)
 6507              		.loc 1 4224 8 is_stmt 0 view .LVU2204
 6508 0006 FFF7FEFF 		bl	f_sync
 6509              	.LVL780:
4225:Core/Src/FAT/ff.c **** #endif
 6510              		.loc 1 4225 2 is_stmt 1 view .LVU2205
4225:Core/Src/FAT/ff.c **** #endif
 6511              		.loc 1 4225 5 is_stmt 0 view .LVU2206
 6512 000a 08B1     		cbz	r0, .L474
 6513              	.L472:
 6514              	.LVL781:
4241:Core/Src/FAT/ff.c **** }
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 251


 6515              		.loc 1 4241 2 is_stmt 1 view .LVU2207
4242:Core/Src/FAT/ff.c **** 
 6516              		.loc 1 4242 1 is_stmt 0 view .LVU2208
 6517 000c 02B0     		add	sp, sp, #8
 6518              	.LCFI58:
 6519              		.cfi_remember_state
 6520              		.cfi_def_cfa_offset 8
 6521              		@ sp needed
 6522 000e 10BD     		pop	{r4, pc}
 6523              	.LVL782:
 6524              	.L474:
 6525              	.LCFI59:
 6526              		.cfi_restore_state
4228:Core/Src/FAT/ff.c **** 		if (res == FR_OK) {
 6527              		.loc 1 4228 3 is_stmt 1 view .LVU2209
4228:Core/Src/FAT/ff.c **** 		if (res == FR_OK) {
 6528              		.loc 1 4228 9 is_stmt 0 view .LVU2210
 6529 0010 01A9     		add	r1, sp, #4
 6530 0012 2046     		mov	r0, r4
 6531 0014 FFF7FEFF 		bl	validate
 6532              	.LVL783:
4229:Core/Src/FAT/ff.c **** #if FF_FS_LOCK
 6533              		.loc 1 4229 3 is_stmt 1 view .LVU2211
4229:Core/Src/FAT/ff.c **** #if FF_FS_LOCK
 6534              		.loc 1 4229 6 is_stmt 0 view .LVU2212
 6535 0018 0028     		cmp	r0, #0
 6536 001a F7D1     		bne	.L472
4234:Core/Src/FAT/ff.c **** #endif
 6537              		.loc 1 4234 4 is_stmt 1 view .LVU2213
4234:Core/Src/FAT/ff.c **** #endif
 6538              		.loc 1 4234 15 is_stmt 0 view .LVU2214
 6539 001c 2060     		str	r0, [r4]
 6540 001e F5E7     		b	.L472
 6541              		.cfi_endproc
 6542              	.LFE37:
 6544              		.section	.text.f_lseek,"ax",%progbits
 6545              		.align	1
 6546              		.global	f_lseek
 6547              		.syntax unified
 6548              		.thumb
 6549              		.thumb_func
 6551              	f_lseek:
 6552              	.LVL784:
 6553              	.LFB38:
4437:Core/Src/FAT/ff.c **** 	FRESULT res;
 6554              		.loc 1 4437 1 is_stmt 1 view -0
 6555              		.cfi_startproc
 6556              		@ args = 0, pretend = 0, frame = 8
 6557              		@ frame_needed = 0, uses_anonymous_args = 0
4437:Core/Src/FAT/ff.c **** 	FRESULT res;
 6558              		.loc 1 4437 1 is_stmt 0 view .LVU2216
 6559 0000 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 6560              	.LCFI60:
 6561              		.cfi_def_cfa_offset 24
 6562              		.cfi_offset 4, -24
 6563              		.cfi_offset 5, -20
 6564              		.cfi_offset 6, -16
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 252


 6565              		.cfi_offset 7, -12
 6566              		.cfi_offset 8, -8
 6567              		.cfi_offset 14, -4
 6568 0004 82B0     		sub	sp, sp, #8
 6569              	.LCFI61:
 6570              		.cfi_def_cfa_offset 32
 6571 0006 0446     		mov	r4, r0
 6572 0008 0D46     		mov	r5, r1
4438:Core/Src/FAT/ff.c **** 	FATFS *fs;
 6573              		.loc 1 4438 2 is_stmt 1 view .LVU2217
4439:Core/Src/FAT/ff.c **** 	DWORD clst, bcs;
 6574              		.loc 1 4439 2 view .LVU2218
4440:Core/Src/FAT/ff.c **** 	LBA_t nsect;
 6575              		.loc 1 4440 2 view .LVU2219
4441:Core/Src/FAT/ff.c **** 	FSIZE_t ifptr;
 6576              		.loc 1 4441 2 view .LVU2220
4442:Core/Src/FAT/ff.c **** #if FF_USE_FASTSEEK
 6577              		.loc 1 4442 2 view .LVU2221
4449:Core/Src/FAT/ff.c **** 	if (res == FR_OK) res = (FRESULT)fp->err;
 6578              		.loc 1 4449 2 view .LVU2222
4449:Core/Src/FAT/ff.c **** 	if (res == FR_OK) res = (FRESULT)fp->err;
 6579              		.loc 1 4449 8 is_stmt 0 view .LVU2223
 6580 000a 01A9     		add	r1, sp, #4
 6581              	.LVL785:
4449:Core/Src/FAT/ff.c **** 	if (res == FR_OK) res = (FRESULT)fp->err;
 6582              		.loc 1 4449 8 view .LVU2224
 6583 000c FFF7FEFF 		bl	validate
 6584              	.LVL786:
4450:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT && !FF_FS_READONLY
 6585              		.loc 1 4450 2 is_stmt 1 view .LVU2225
4450:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT && !FF_FS_READONLY
 6586              		.loc 1 4450 5 is_stmt 0 view .LVU2226
 6587 0010 8046     		mov	r8, r0
 6588 0012 08B9     		cbnz	r0, .L476
4450:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT && !FF_FS_READONLY
 6589              		.loc 1 4450 20 is_stmt 1 discriminator 1 view .LVU2227
4450:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT && !FF_FS_READONLY
 6590              		.loc 1 4450 24 is_stmt 0 discriminator 1 view .LVU2228
 6591 0014 94F81180 		ldrb	r8, [r4, #17]	@ zero_extendqisi2
 6592              	.LVL787:
 6593              	.L476:
4456:Core/Src/FAT/ff.c **** 
 6594              		.loc 1 4456 2 is_stmt 1 view .LVU2229
4456:Core/Src/FAT/ff.c **** 
 6595              		.loc 1 4456 5 is_stmt 0 view .LVU2230
 6596 0018 B8F1000F 		cmp	r8, #0
 6597 001c 42D1     		bne	.L477
4515:Core/Src/FAT/ff.c **** 			ofs = fp->obj.objsize;
 6598              		.loc 1 4515 3 is_stmt 1 view .LVU2231
4515:Core/Src/FAT/ff.c **** 			ofs = fp->obj.objsize;
 6599              		.loc 1 4515 20 is_stmt 0 view .LVU2232
 6600 001e E368     		ldr	r3, [r4, #12]
4515:Core/Src/FAT/ff.c **** 			ofs = fp->obj.objsize;
 6601              		.loc 1 4515 6 view .LVU2233
 6602 0020 AB42     		cmp	r3, r5
 6603 0022 04D2     		bcs	.L478
4515:Core/Src/FAT/ff.c **** 			ofs = fp->obj.objsize;
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 253


 6604              		.loc 1 4515 55 discriminator 1 view .LVU2234
 6605 0024 227C     		ldrb	r2, [r4, #16]	@ zero_extendqisi2
4515:Core/Src/FAT/ff.c **** 			ofs = fp->obj.objsize;
 6606              		.loc 1 4515 29 discriminator 1 view .LVU2235
 6607 0026 12F0020F 		tst	r2, #2
 6608 002a 00D1     		bne	.L478
4516:Core/Src/FAT/ff.c **** 		}
 6609              		.loc 1 4516 8 view .LVU2236
 6610 002c 1D46     		mov	r5, r3
 6611              	.LVL788:
 6612              	.L478:
4518:Core/Src/FAT/ff.c **** 		fp->fptr = nsect = 0;
 6613              		.loc 1 4518 3 is_stmt 1 view .LVU2237
4518:Core/Src/FAT/ff.c **** 		fp->fptr = nsect = 0;
 6614              		.loc 1 4518 9 is_stmt 0 view .LVU2238
 6615 002e 6669     		ldr	r6, [r4, #20]
 6616              	.LVL789:
4519:Core/Src/FAT/ff.c **** 		if (ofs > 0) {
 6617              		.loc 1 4519 3 is_stmt 1 view .LVU2239
4519:Core/Src/FAT/ff.c **** 		if (ofs > 0) {
 6618              		.loc 1 4519 12 is_stmt 0 view .LVU2240
 6619 0030 0023     		movs	r3, #0
 6620 0032 6361     		str	r3, [r4, #20]
4520:Core/Src/FAT/ff.c **** 			bcs = (DWORD)fs->csize * SS(fs);	/* Cluster size (byte) */
 6621              		.loc 1 4520 3 is_stmt 1 view .LVU2241
4520:Core/Src/FAT/ff.c **** 			bcs = (DWORD)fs->csize * SS(fs);	/* Cluster size (byte) */
 6622              		.loc 1 4520 6 is_stmt 0 view .LVU2242
 6623 0034 C5B1     		cbz	r5, .L479
4521:Core/Src/FAT/ff.c **** 			if (ifptr > 0 &&
 6624              		.loc 1 4521 4 is_stmt 1 view .LVU2243
4521:Core/Src/FAT/ff.c **** 			if (ifptr > 0 &&
 6625              		.loc 1 4521 19 is_stmt 0 view .LVU2244
 6626 0036 019B     		ldr	r3, [sp, #4]
 6627 0038 5F89     		ldrh	r7, [r3, #10]
4521:Core/Src/FAT/ff.c **** 			if (ifptr > 0 &&
 6628              		.loc 1 4521 8 view .LVU2245
 6629 003a 7F02     		lsls	r7, r7, #9
 6630              	.LVL790:
4522:Core/Src/FAT/ff.c **** 				(ofs - 1) / bcs >= (ifptr - 1) / bcs) {	/* When seek to same or following cluster, */
 6631              		.loc 1 4522 4 is_stmt 1 view .LVU2246
4522:Core/Src/FAT/ff.c **** 				(ofs - 1) / bcs >= (ifptr - 1) / bcs) {	/* When seek to same or following cluster, */
 6632              		.loc 1 4522 7 is_stmt 0 view .LVU2247
 6633 003c 6EB1     		cbz	r6, .L480
4523:Core/Src/FAT/ff.c **** 				fp->fptr = (ifptr - 1) & ~(FSIZE_t)(bcs - 1);	/* start from the current cluster */
 6634              		.loc 1 4523 10 discriminator 1 view .LVU2248
 6635 003e 6B1E     		subs	r3, r5, #1
4523:Core/Src/FAT/ff.c **** 				fp->fptr = (ifptr - 1) & ~(FSIZE_t)(bcs - 1);	/* start from the current cluster */
 6636              		.loc 1 4523 15 discriminator 1 view .LVU2249
 6637 0040 B3FBF7F3 		udiv	r3, r3, r7
4523:Core/Src/FAT/ff.c **** 				fp->fptr = (ifptr - 1) & ~(FSIZE_t)(bcs - 1);	/* start from the current cluster */
 6638              		.loc 1 4523 31 discriminator 1 view .LVU2250
 6639 0044 013E     		subs	r6, r6, #1
 6640              	.LVL791:
4523:Core/Src/FAT/ff.c **** 				fp->fptr = (ifptr - 1) & ~(FSIZE_t)(bcs - 1);	/* start from the current cluster */
 6641              		.loc 1 4523 36 discriminator 1 view .LVU2251
 6642 0046 B6FBF7F2 		udiv	r2, r6, r7
4522:Core/Src/FAT/ff.c **** 				(ofs - 1) / bcs >= (ifptr - 1) / bcs) {	/* When seek to same or following cluster, */
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 254


 6643              		.loc 1 4522 18 discriminator 1 view .LVU2252
 6644 004a 9342     		cmp	r3, r2
 6645 004c 05D3     		bcc	.L480
4524:Core/Src/FAT/ff.c **** 				ofs -= fp->fptr;
 6646              		.loc 1 4524 5 is_stmt 1 view .LVU2253
4524:Core/Src/FAT/ff.c **** 				ofs -= fp->fptr;
 6647              		.loc 1 4524 30 is_stmt 0 view .LVU2254
 6648 004e 7B42     		rsbs	r3, r7, #0
4524:Core/Src/FAT/ff.c **** 				ofs -= fp->fptr;
 6649              		.loc 1 4524 28 view .LVU2255
 6650 0050 1E40     		ands	r6, r6, r3
 6651              	.LVL792:
4524:Core/Src/FAT/ff.c **** 				ofs -= fp->fptr;
 6652              		.loc 1 4524 14 view .LVU2256
 6653 0052 6661     		str	r6, [r4, #20]
4525:Core/Src/FAT/ff.c **** 				clst = fp->clust;
 6654              		.loc 1 4525 5 is_stmt 1 view .LVU2257
4525:Core/Src/FAT/ff.c **** 				clst = fp->clust;
 6655              		.loc 1 4525 9 is_stmt 0 view .LVU2258
 6656 0054 AE1B     		subs	r6, r5, r6
 6657              	.LVL793:
4526:Core/Src/FAT/ff.c **** 			} else {									/* When seek to back cluster, */
 6658              		.loc 1 4526 5 is_stmt 1 view .LVU2259
4526:Core/Src/FAT/ff.c **** 			} else {									/* When seek to back cluster, */
 6659              		.loc 1 4526 10 is_stmt 0 view .LVU2260
 6660 0056 A569     		ldr	r5, [r4, #24]
 6661              	.LVL794:
4526:Core/Src/FAT/ff.c **** 			} else {									/* When seek to back cluster, */
 6662              		.loc 1 4526 10 view .LVU2261
 6663 0058 04E0     		b	.L481
 6664              	.LVL795:
 6665              	.L480:
4528:Core/Src/FAT/ff.c **** #if !FF_FS_READONLY
 6666              		.loc 1 4528 5 is_stmt 1 view .LVU2262
4528:Core/Src/FAT/ff.c **** #if !FF_FS_READONLY
 6667              		.loc 1 4528 10 is_stmt 0 view .LVU2263
 6668 005a A068     		ldr	r0, [r4, #8]
 6669              	.LVL796:
4530:Core/Src/FAT/ff.c **** 					clst = create_chain(&fp->obj, 0);
 6670              		.loc 1 4530 5 is_stmt 1 view .LVU2264
4530:Core/Src/FAT/ff.c **** 					clst = create_chain(&fp->obj, 0);
 6671              		.loc 1 4530 8 is_stmt 0 view .LVU2265
 6672 005c 30B3     		cbz	r0, .L502
 6673              	.L482:
4537:Core/Src/FAT/ff.c **** 			}
 6674              		.loc 1 4537 5 is_stmt 1 view .LVU2266
4537:Core/Src/FAT/ff.c **** 			}
 6675              		.loc 1 4537 15 is_stmt 0 view .LVU2267
 6676 005e A061     		str	r0, [r4, #24]
 6677 0060 2E46     		mov	r6, r5
 6678 0062 0546     		mov	r5, r0
 6679              	.LVL797:
 6680              	.L481:
4539:Core/Src/FAT/ff.c **** 				while (ofs > bcs) {						/* Cluster following loop */
 6681              		.loc 1 4539 4 is_stmt 1 view .LVU2268
4539:Core/Src/FAT/ff.c **** 				while (ofs > bcs) {						/* Cluster following loop */
 6682              		.loc 1 4539 7 is_stmt 0 view .LVU2269
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 255


 6683 0064 002D     		cmp	r5, #0
 6684 0066 45D1     		bne	.L485
 6685              	.LVL798:
 6686              	.L479:
4569:Core/Src/FAT/ff.c **** 			fp->obj.objsize = fp->fptr;
 6687              		.loc 1 4569 3 is_stmt 1 view .LVU2270
4569:Core/Src/FAT/ff.c **** 			fp->obj.objsize = fp->fptr;
 6688              		.loc 1 4569 28 is_stmt 0 view .LVU2271
 6689 0068 6369     		ldr	r3, [r4, #20]
4569:Core/Src/FAT/ff.c **** 			fp->obj.objsize = fp->fptr;
 6690              		.loc 1 4569 44 view .LVU2272
 6691 006a E268     		ldr	r2, [r4, #12]
4569:Core/Src/FAT/ff.c **** 			fp->obj.objsize = fp->fptr;
 6692              		.loc 1 4569 6 view .LVU2273
 6693 006c 9342     		cmp	r3, r2
 6694 006e 04D9     		bls	.L494
4570:Core/Src/FAT/ff.c **** 			fp->flag |= FA_MODIFIED;
 6695              		.loc 1 4570 4 is_stmt 1 view .LVU2274
4570:Core/Src/FAT/ff.c **** 			fp->flag |= FA_MODIFIED;
 6696              		.loc 1 4570 20 is_stmt 0 view .LVU2275
 6697 0070 E360     		str	r3, [r4, #12]
4571:Core/Src/FAT/ff.c **** 		}
 6698              		.loc 1 4571 4 is_stmt 1 view .LVU2276
4571:Core/Src/FAT/ff.c **** 		}
 6699              		.loc 1 4571 13 is_stmt 0 view .LVU2277
 6700 0072 227C     		ldrb	r2, [r4, #16]	@ zero_extendqisi2
 6701 0074 42F04002 		orr	r2, r2, #64
 6702 0078 2274     		strb	r2, [r4, #16]
 6703              	.L494:
4573:Core/Src/FAT/ff.c **** #if !FF_FS_TINY
 6704              		.loc 1 4573 3 is_stmt 1 view .LVU2278
4573:Core/Src/FAT/ff.c **** #if !FF_FS_TINY
 6705              		.loc 1 4573 16 is_stmt 0 view .LVU2279
 6706 007a C3F30803 		ubfx	r3, r3, #0, #9
4573:Core/Src/FAT/ff.c **** #if !FF_FS_TINY
 6707              		.loc 1 4573 6 view .LVU2280
 6708 007e 8BB1     		cbz	r3, .L477
4573:Core/Src/FAT/ff.c **** #if !FF_FS_TINY
 6709              		.loc 1 4573 39 discriminator 1 view .LVU2281
 6710 0080 E269     		ldr	r2, [r4, #28]
4573:Core/Src/FAT/ff.c **** #if !FF_FS_TINY
 6711              		.loc 1 4573 25 discriminator 1 view .LVU2282
 6712 0082 AA42     		cmp	r2, r5
 6713 0084 0ED0     		beq	.L477
4576:Core/Src/FAT/ff.c **** 				if (disk_write(fs->pdrv, fp->buf, fp->sect, 1) != RES_OK) ABORT(fs, FR_DISK_ERR);
 6714              		.loc 1 4576 4 is_stmt 1 view .LVU2283
4576:Core/Src/FAT/ff.c **** 				if (disk_write(fs->pdrv, fp->buf, fp->sect, 1) != RES_OK) ABORT(fs, FR_DISK_ERR);
 6715              		.loc 1 4576 8 is_stmt 0 view .LVU2284
 6716 0086 94F91030 		ldrsb	r3, [r4, #16]
4576:Core/Src/FAT/ff.c **** 				if (disk_write(fs->pdrv, fp->buf, fp->sect, 1) != RES_OK) ABORT(fs, FR_DISK_ERR);
 6717              		.loc 1 4576 7 view .LVU2285
 6718 008a 002B     		cmp	r3, #0
 6719 008c 63DB     		blt	.L503
 6720              	.L495:
4581:Core/Src/FAT/ff.c **** #endif
 6721              		.loc 1 4581 4 is_stmt 1 view .LVU2286
4581:Core/Src/FAT/ff.c **** #endif
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 256


 6722              		.loc 1 4581 8 is_stmt 0 view .LVU2287
 6723 008e 0123     		movs	r3, #1
 6724 0090 2A46     		mov	r2, r5
 6725 0092 04F12801 		add	r1, r4, #40
 6726 0096 0198     		ldr	r0, [sp, #4]
 6727 0098 4078     		ldrb	r0, [r0, #1]	@ zero_extendqisi2
 6728 009a FFF7FEFF 		bl	disk_read
 6729              	.LVL799:
4581:Core/Src/FAT/ff.c **** #endif
 6730              		.loc 1 4581 7 view .LVU2288
 6731 009e 0028     		cmp	r0, #0
 6732 00a0 6BD1     		bne	.L504
4581:Core/Src/FAT/ff.c **** #endif
 6733              		.loc 1 4581 80 is_stmt 1 discriminator 2 view .LVU2289
4583:Core/Src/FAT/ff.c **** 		}
 6734              		.loc 1 4583 4 discriminator 2 view .LVU2290
4583:Core/Src/FAT/ff.c **** 		}
 6735              		.loc 1 4583 13 is_stmt 0 discriminator 2 view .LVU2291
 6736 00a2 E561     		str	r5, [r4, #28]
 6737              	.LVL800:
 6738              	.L477:
4588:Core/Src/FAT/ff.c **** 
 6739              		.loc 1 4588 1 view .LVU2292
 6740 00a4 4046     		mov	r0, r8
 6741 00a6 02B0     		add	sp, sp, #8
 6742              	.LCFI62:
 6743              		.cfi_remember_state
 6744              		.cfi_def_cfa_offset 24
 6745              		@ sp needed
 6746 00a8 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 6747              	.LVL801:
 6748              	.L502:
 6749              	.LCFI63:
 6750              		.cfi_restore_state
4531:Core/Src/FAT/ff.c **** 					if (clst == 1) ABORT(fs, FR_INT_ERR);
 6751              		.loc 1 4531 6 is_stmt 1 view .LVU2293
4531:Core/Src/FAT/ff.c **** 					if (clst == 1) ABORT(fs, FR_INT_ERR);
 6752              		.loc 1 4531 13 is_stmt 0 view .LVU2294
 6753 00ac 0021     		movs	r1, #0
 6754 00ae 2046     		mov	r0, r4
 6755              	.LVL802:
4531:Core/Src/FAT/ff.c **** 					if (clst == 1) ABORT(fs, FR_INT_ERR);
 6756              		.loc 1 4531 13 view .LVU2295
 6757 00b0 FFF7FEFF 		bl	create_chain
 6758              	.LVL803:
4532:Core/Src/FAT/ff.c **** 					if (clst == 0xFFFFFFFF) ABORT(fs, FR_DISK_ERR);
 6759              		.loc 1 4532 6 is_stmt 1 view .LVU2296
4532:Core/Src/FAT/ff.c **** 					if (clst == 0xFFFFFFFF) ABORT(fs, FR_DISK_ERR);
 6760              		.loc 1 4532 9 is_stmt 0 view .LVU2297
 6761 00b4 0128     		cmp	r0, #1
 6762 00b6 04D0     		beq	.L505
4532:Core/Src/FAT/ff.c **** 					if (clst == 0xFFFFFFFF) ABORT(fs, FR_DISK_ERR);
 6763              		.loc 1 4532 42 is_stmt 1 discriminator 2 view .LVU2298
4533:Core/Src/FAT/ff.c **** 					fp->obj.sclust = clst;
 6764              		.loc 1 4533 6 discriminator 2 view .LVU2299
4533:Core/Src/FAT/ff.c **** 					fp->obj.sclust = clst;
 6765              		.loc 1 4533 9 is_stmt 0 discriminator 2 view .LVU2300
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 257


 6766 00b8 B0F1FF3F 		cmp	r0, #-1
 6767 00bc 06D0     		beq	.L506
4533:Core/Src/FAT/ff.c **** 					fp->obj.sclust = clst;
 6768              		.loc 1 4533 52 is_stmt 1 discriminator 2 view .LVU2301
4534:Core/Src/FAT/ff.c **** 				}
 6769              		.loc 1 4534 6 discriminator 2 view .LVU2302
4534:Core/Src/FAT/ff.c **** 				}
 6770              		.loc 1 4534 21 is_stmt 0 discriminator 2 view .LVU2303
 6771 00be A060     		str	r0, [r4, #8]
 6772 00c0 CDE7     		b	.L482
 6773              	.L505:
4532:Core/Src/FAT/ff.c **** 					if (clst == 0xFFFFFFFF) ABORT(fs, FR_DISK_ERR);
 6774              		.loc 1 4532 21 is_stmt 1 discriminator 1 view .LVU2304
 6775 00c2 4FF00208 		mov	r8, #2
 6776              	.LVL804:
4532:Core/Src/FAT/ff.c **** 					if (clst == 0xFFFFFFFF) ABORT(fs, FR_DISK_ERR);
 6777              		.loc 1 4532 21 is_stmt 0 discriminator 1 view .LVU2305
 6778 00c6 84F81180 		strb	r8, [r4, #17]
4532:Core/Src/FAT/ff.c **** 					if (clst == 0xFFFFFFFF) ABORT(fs, FR_DISK_ERR);
 6779              		.loc 1 4532 21 is_stmt 1 discriminator 1 view .LVU2306
 6780 00ca EBE7     		b	.L477
 6781              	.LVL805:
 6782              	.L506:
4533:Core/Src/FAT/ff.c **** 					fp->obj.sclust = clst;
 6783              		.loc 1 4533 30 discriminator 1 view .LVU2307
 6784 00cc 4FF00108 		mov	r8, #1
 6785              	.LVL806:
4533:Core/Src/FAT/ff.c **** 					fp->obj.sclust = clst;
 6786              		.loc 1 4533 30 is_stmt 0 discriminator 1 view .LVU2308
 6787 00d0 84F81180 		strb	r8, [r4, #17]
4533:Core/Src/FAT/ff.c **** 					fp->obj.sclust = clst;
 6788              		.loc 1 4533 30 is_stmt 1 discriminator 1 view .LVU2309
 6789 00d4 E6E7     		b	.L477
 6790              	.LVL807:
 6791              	.L486:
4555:Core/Src/FAT/ff.c **** 					}
 6792              		.loc 1 4555 7 view .LVU2310
4555:Core/Src/FAT/ff.c **** 					}
 6793              		.loc 1 4555 14 is_stmt 0 view .LVU2311
 6794 00d6 2946     		mov	r1, r5
 6795 00d8 2046     		mov	r0, r4
 6796 00da FFF7FEFF 		bl	get_fat
 6797              	.LVL808:
 6798 00de 0546     		mov	r5, r0
 6799              	.LVL809:
 6800              	.L488:
4557:Core/Src/FAT/ff.c **** 					if (clst <= 1 || clst >= fs->n_fatent) ABORT(fs, FR_INT_ERR);
 6801              		.loc 1 4557 6 is_stmt 1 view .LVU2312
4557:Core/Src/FAT/ff.c **** 					if (clst <= 1 || clst >= fs->n_fatent) ABORT(fs, FR_INT_ERR);
 6802              		.loc 1 4557 9 is_stmt 0 view .LVU2313
 6803 00e0 B5F1FF3F 		cmp	r5, #-1
 6804 00e4 26D0     		beq	.L507
4557:Core/Src/FAT/ff.c **** 					if (clst <= 1 || clst >= fs->n_fatent) ABORT(fs, FR_INT_ERR);
 6805              		.loc 1 4557 52 is_stmt 1 discriminator 2 view .LVU2314
4558:Core/Src/FAT/ff.c **** 					fp->clust = clst;
 6806              		.loc 1 4558 6 discriminator 2 view .LVU2315
4558:Core/Src/FAT/ff.c **** 					fp->clust = clst;
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 258


 6807              		.loc 1 4558 9 is_stmt 0 discriminator 2 view .LVU2316
 6808 00e6 012D     		cmp	r5, #1
 6809 00e8 29D9     		bls	.L490
4558:Core/Src/FAT/ff.c **** 					fp->clust = clst;
 6810              		.loc 1 4558 33 discriminator 2 view .LVU2317
 6811 00ea 019B     		ldr	r3, [sp, #4]
 6812 00ec 5B69     		ldr	r3, [r3, #20]
4558:Core/Src/FAT/ff.c **** 					fp->clust = clst;
 6813              		.loc 1 4558 20 discriminator 2 view .LVU2318
 6814 00ee AB42     		cmp	r3, r5
 6815 00f0 25D9     		bls	.L490
4558:Core/Src/FAT/ff.c **** 					fp->clust = clst;
 6816              		.loc 1 4558 66 is_stmt 1 discriminator 4 view .LVU2319
4559:Core/Src/FAT/ff.c **** 				}
 6817              		.loc 1 4559 6 discriminator 4 view .LVU2320
4559:Core/Src/FAT/ff.c **** 				}
 6818              		.loc 1 4559 16 is_stmt 0 discriminator 4 view .LVU2321
 6819 00f2 A561     		str	r5, [r4, #24]
 6820              	.LVL810:
 6821              	.L485:
4540:Core/Src/FAT/ff.c **** 					ofs -= bcs; fp->fptr += bcs;
 6822              		.loc 1 4540 11 is_stmt 1 view .LVU2322
 6823 00f4 BE42     		cmp	r6, r7
 6824 00f6 0FD9     		bls	.L487
4541:Core/Src/FAT/ff.c **** #if !FF_FS_READONLY
 6825              		.loc 1 4541 6 view .LVU2323
4541:Core/Src/FAT/ff.c **** #if !FF_FS_READONLY
 6826              		.loc 1 4541 10 is_stmt 0 view .LVU2324
 6827 00f8 F61B     		subs	r6, r6, r7
 6828              	.LVL811:
4541:Core/Src/FAT/ff.c **** #if !FF_FS_READONLY
 6829              		.loc 1 4541 18 is_stmt 1 view .LVU2325
4541:Core/Src/FAT/ff.c **** #if !FF_FS_READONLY
 6830              		.loc 1 4541 27 is_stmt 0 view .LVU2326
 6831 00fa 6369     		ldr	r3, [r4, #20]
 6832 00fc 3B44     		add	r3, r3, r7
 6833 00fe 6361     		str	r3, [r4, #20]
4543:Core/Src/FAT/ff.c **** 						if (FF_FS_EXFAT && fp->fptr > fp->obj.objsize) {	/* No FAT chain object needs correct objsize
 6834              		.loc 1 4543 6 is_stmt 1 view .LVU2327
4543:Core/Src/FAT/ff.c **** 						if (FF_FS_EXFAT && fp->fptr > fp->obj.objsize) {	/* No FAT chain object needs correct objsize
 6835              		.loc 1 4543 12 is_stmt 0 view .LVU2328
 6836 0100 237C     		ldrb	r3, [r4, #16]	@ zero_extendqisi2
4543:Core/Src/FAT/ff.c **** 						if (FF_FS_EXFAT && fp->fptr > fp->obj.objsize) {	/* No FAT chain object needs correct objsize
 6837              		.loc 1 4543 9 view .LVU2329
 6838 0102 13F0020F 		tst	r3, #2
 6839 0106 E6D0     		beq	.L486
4544:Core/Src/FAT/ff.c **** 							fp->obj.objsize = fp->fptr;
 6840              		.loc 1 4544 7 is_stmt 1 view .LVU2330
4548:Core/Src/FAT/ff.c **** 						if (clst == 0) {				/* Clip file size in case of disk full */
 6841              		.loc 1 4548 7 view .LVU2331
4548:Core/Src/FAT/ff.c **** 						if (clst == 0) {				/* Clip file size in case of disk full */
 6842              		.loc 1 4548 14 is_stmt 0 view .LVU2332
 6843 0108 2946     		mov	r1, r5
 6844 010a 2046     		mov	r0, r4
 6845 010c FFF7FEFF 		bl	create_chain
 6846              	.LVL812:
4549:Core/Src/FAT/ff.c **** 							ofs = 0; break;
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 259


 6847              		.loc 1 4549 7 is_stmt 1 view .LVU2333
4549:Core/Src/FAT/ff.c **** 							ofs = 0; break;
 6848              		.loc 1 4549 10 is_stmt 0 view .LVU2334
 6849 0110 0546     		mov	r5, r0
 6850 0112 0028     		cmp	r0, #0
 6851 0114 E4D1     		bne	.L488
4550:Core/Src/FAT/ff.c **** 						}
 6852              		.loc 1 4550 12 view .LVU2335
 6853 0116 0646     		mov	r6, r0
 6854              	.LVL813:
 6855              	.L487:
4561:Core/Src/FAT/ff.c **** 				if (ofs % SS(fs)) {
 6856              		.loc 1 4561 5 is_stmt 1 view .LVU2336
4561:Core/Src/FAT/ff.c **** 				if (ofs % SS(fs)) {
 6857              		.loc 1 4561 14 is_stmt 0 view .LVU2337
 6858 0118 6369     		ldr	r3, [r4, #20]
 6859 011a 3344     		add	r3, r3, r6
 6860 011c 6361     		str	r3, [r4, #20]
4562:Core/Src/FAT/ff.c **** 					nsect = clst2sect(fs, clst);	/* Current sector */
 6861              		.loc 1 4562 5 is_stmt 1 view .LVU2338
4562:Core/Src/FAT/ff.c **** 					nsect = clst2sect(fs, clst);	/* Current sector */
 6862              		.loc 1 4562 13 is_stmt 0 view .LVU2339
 6863 011e C6F30803 		ubfx	r3, r6, #0, #9
4562:Core/Src/FAT/ff.c **** 					nsect = clst2sect(fs, clst);	/* Current sector */
 6864              		.loc 1 4562 8 view .LVU2340
 6865 0122 B3B1     		cbz	r3, .L500
4563:Core/Src/FAT/ff.c **** 					if (nsect == 0) ABORT(fs, FR_INT_ERR);
 6866              		.loc 1 4563 6 is_stmt 1 view .LVU2341
4563:Core/Src/FAT/ff.c **** 					if (nsect == 0) ABORT(fs, FR_INT_ERR);
 6867              		.loc 1 4563 14 is_stmt 0 view .LVU2342
 6868 0124 2946     		mov	r1, r5
 6869 0126 0198     		ldr	r0, [sp, #4]
 6870 0128 FFF7FEFF 		bl	clst2sect
 6871              	.LVL814:
4564:Core/Src/FAT/ff.c **** 					nsect += (DWORD)(ofs / SS(fs));
 6872              		.loc 1 4564 6 is_stmt 1 view .LVU2343
4564:Core/Src/FAT/ff.c **** 					nsect += (DWORD)(ofs / SS(fs));
 6873              		.loc 1 4564 9 is_stmt 0 view .LVU2344
 6874 012c 60B1     		cbz	r0, .L508
4564:Core/Src/FAT/ff.c **** 					nsect += (DWORD)(ofs / SS(fs));
 6875              		.loc 1 4564 43 is_stmt 1 discriminator 2 view .LVU2345
4565:Core/Src/FAT/ff.c **** 				}
 6876              		.loc 1 4565 6 discriminator 2 view .LVU2346
4565:Core/Src/FAT/ff.c **** 				}
 6877              		.loc 1 4565 12 is_stmt 0 discriminator 2 view .LVU2347
 6878 012e 00EB5625 		add	r5, r0, r6, lsr #9
 6879              	.LVL815:
4565:Core/Src/FAT/ff.c **** 				}
 6880              		.loc 1 4565 12 discriminator 2 view .LVU2348
 6881 0132 99E7     		b	.L479
 6882              	.LVL816:
 6883              	.L507:
4557:Core/Src/FAT/ff.c **** 					if (clst <= 1 || clst >= fs->n_fatent) ABORT(fs, FR_INT_ERR);
 6884              		.loc 1 4557 30 is_stmt 1 discriminator 1 view .LVU2349
 6885 0134 4FF00108 		mov	r8, #1
 6886              	.LVL817:
4557:Core/Src/FAT/ff.c **** 					if (clst <= 1 || clst >= fs->n_fatent) ABORT(fs, FR_INT_ERR);
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 260


 6887              		.loc 1 4557 30 is_stmt 0 discriminator 1 view .LVU2350
 6888 0138 84F81180 		strb	r8, [r4, #17]
4557:Core/Src/FAT/ff.c **** 					if (clst <= 1 || clst >= fs->n_fatent) ABORT(fs, FR_INT_ERR);
 6889              		.loc 1 4557 30 is_stmt 1 discriminator 1 view .LVU2351
 6890 013c B2E7     		b	.L477
 6891              	.LVL818:
 6892              	.L490:
4558:Core/Src/FAT/ff.c **** 					fp->clust = clst;
 6893              		.loc 1 4558 45 discriminator 3 view .LVU2352
 6894 013e 4FF00208 		mov	r8, #2
 6895              	.LVL819:
4558:Core/Src/FAT/ff.c **** 					fp->clust = clst;
 6896              		.loc 1 4558 45 is_stmt 0 discriminator 3 view .LVU2353
 6897 0142 84F81180 		strb	r8, [r4, #17]
4558:Core/Src/FAT/ff.c **** 					fp->clust = clst;
 6898              		.loc 1 4558 45 is_stmt 1 discriminator 3 view .LVU2354
 6899 0146 ADE7     		b	.L477
 6900              	.LVL820:
 6901              	.L508:
4564:Core/Src/FAT/ff.c **** 					nsect += (DWORD)(ofs / SS(fs));
 6902              		.loc 1 4564 22 discriminator 1 view .LVU2355
 6903 0148 4FF00208 		mov	r8, #2
 6904              	.LVL821:
4564:Core/Src/FAT/ff.c **** 					nsect += (DWORD)(ofs / SS(fs));
 6905              		.loc 1 4564 22 is_stmt 0 discriminator 1 view .LVU2356
 6906 014c 84F81180 		strb	r8, [r4, #17]
4564:Core/Src/FAT/ff.c **** 					nsect += (DWORD)(ofs / SS(fs));
 6907              		.loc 1 4564 22 is_stmt 1 discriminator 1 view .LVU2357
 6908 0150 A8E7     		b	.L477
 6909              	.LVL822:
 6910              	.L500:
4519:Core/Src/FAT/ff.c **** 		if (ofs > 0) {
 6911              		.loc 1 4519 20 is_stmt 0 view .LVU2358
 6912 0152 1D46     		mov	r5, r3
 6913              	.LVL823:
4519:Core/Src/FAT/ff.c **** 		if (ofs > 0) {
 6914              		.loc 1 4519 20 view .LVU2359
 6915 0154 88E7     		b	.L479
 6916              	.LVL824:
 6917              	.L503:
4577:Core/Src/FAT/ff.c **** 				fp->flag &= (BYTE)~FA_DIRTY;
 6918              		.loc 1 4577 5 is_stmt 1 view .LVU2360
4577:Core/Src/FAT/ff.c **** 				fp->flag &= (BYTE)~FA_DIRTY;
 6919              		.loc 1 4577 9 is_stmt 0 view .LVU2361
 6920 0156 0123     		movs	r3, #1
 6921 0158 04F12801 		add	r1, r4, #40
 6922 015c 0198     		ldr	r0, [sp, #4]
 6923 015e 4078     		ldrb	r0, [r0, #1]	@ zero_extendqisi2
 6924 0160 FFF7FEFF 		bl	disk_write
 6925              	.LVL825:
4577:Core/Src/FAT/ff.c **** 				fp->flag &= (BYTE)~FA_DIRTY;
 6926              		.loc 1 4577 8 view .LVU2362
 6927 0164 20B9     		cbnz	r0, .L509
4577:Core/Src/FAT/ff.c **** 				fp->flag &= (BYTE)~FA_DIRTY;
 6928              		.loc 1 4577 85 is_stmt 1 discriminator 2 view .LVU2363
4578:Core/Src/FAT/ff.c **** 			}
 6929              		.loc 1 4578 5 discriminator 2 view .LVU2364
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 261


4578:Core/Src/FAT/ff.c **** 			}
 6930              		.loc 1 4578 14 is_stmt 0 discriminator 2 view .LVU2365
 6931 0166 237C     		ldrb	r3, [r4, #16]	@ zero_extendqisi2
 6932 0168 03F07F03 		and	r3, r3, #127
 6933 016c 2374     		strb	r3, [r4, #16]
 6934 016e 8EE7     		b	.L495
 6935              	.L509:
4577:Core/Src/FAT/ff.c **** 				fp->flag &= (BYTE)~FA_DIRTY;
 6936              		.loc 1 4577 63 is_stmt 1 discriminator 1 view .LVU2366
 6937 0170 4FF00108 		mov	r8, #1
 6938              	.LVL826:
4577:Core/Src/FAT/ff.c **** 				fp->flag &= (BYTE)~FA_DIRTY;
 6939              		.loc 1 4577 63 is_stmt 0 discriminator 1 view .LVU2367
 6940 0174 84F81180 		strb	r8, [r4, #17]
4577:Core/Src/FAT/ff.c **** 				fp->flag &= (BYTE)~FA_DIRTY;
 6941              		.loc 1 4577 63 is_stmt 1 discriminator 1 view .LVU2368
 6942 0178 94E7     		b	.L477
 6943              	.LVL827:
 6944              	.L504:
4581:Core/Src/FAT/ff.c **** #endif
 6945              		.loc 1 4581 58 discriminator 1 view .LVU2369
 6946 017a 4FF00108 		mov	r8, #1
 6947              	.LVL828:
4581:Core/Src/FAT/ff.c **** #endif
 6948              		.loc 1 4581 58 is_stmt 0 discriminator 1 view .LVU2370
 6949 017e 84F81180 		strb	r8, [r4, #17]
4581:Core/Src/FAT/ff.c **** #endif
 6950              		.loc 1 4581 58 is_stmt 1 discriminator 1 view .LVU2371
 6951 0182 8FE7     		b	.L477
 6952              		.cfi_endproc
 6953              	.LFE38:
 6955              		.section	.text.f_opendir,"ax",%progbits
 6956              		.align	1
 6957              		.global	f_opendir
 6958              		.syntax unified
 6959              		.thumb
 6960              		.thumb_func
 6962              	f_opendir:
 6963              	.LVL829:
 6964              	.LFB39:
4601:Core/Src/FAT/ff.c **** 	FRESULT res;
 6965              		.loc 1 4601 1 view -0
 6966              		.cfi_startproc
 6967              		@ args = 0, pretend = 0, frame = 16
 6968              		@ frame_needed = 0, uses_anonymous_args = 0
4601:Core/Src/FAT/ff.c **** 	FRESULT res;
 6969              		.loc 1 4601 1 is_stmt 0 view .LVU2373
 6970 0000 10B5     		push	{r4, lr}
 6971              	.LCFI64:
 6972              		.cfi_def_cfa_offset 8
 6973              		.cfi_offset 4, -8
 6974              		.cfi_offset 14, -4
 6975 0002 84B0     		sub	sp, sp, #16
 6976              	.LCFI65:
 6977              		.cfi_def_cfa_offset 24
 6978 0004 0191     		str	r1, [sp, #4]
4602:Core/Src/FAT/ff.c **** 	FATFS *fs;
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 262


 6979              		.loc 1 4602 2 is_stmt 1 view .LVU2374
4603:Core/Src/FAT/ff.c **** 	DEF_NAMBUF
 6980              		.loc 1 4603 2 view .LVU2375
4607:Core/Src/FAT/ff.c **** 
 6981              		.loc 1 4607 2 view .LVU2376
4607:Core/Src/FAT/ff.c **** 
 6982              		.loc 1 4607 5 is_stmt 0 view .LVU2377
 6983 0006 80B3     		cbz	r0, .L516
 6984 0008 0446     		mov	r4, r0
4610:Core/Src/FAT/ff.c **** 	if (res == FR_OK) {
 6985              		.loc 1 4610 2 is_stmt 1 view .LVU2378
4610:Core/Src/FAT/ff.c **** 	if (res == FR_OK) {
 6986              		.loc 1 4610 8 is_stmt 0 view .LVU2379
 6987 000a 0022     		movs	r2, #0
 6988 000c 03A9     		add	r1, sp, #12
 6989              	.LVL830:
4610:Core/Src/FAT/ff.c **** 	if (res == FR_OK) {
 6990              		.loc 1 4610 8 view .LVU2380
 6991 000e 01A8     		add	r0, sp, #4
 6992              	.LVL831:
4610:Core/Src/FAT/ff.c **** 	if (res == FR_OK) {
 6993              		.loc 1 4610 8 view .LVU2381
 6994 0010 FFF7FEFF 		bl	mount_volume
 6995              	.LVL832:
4611:Core/Src/FAT/ff.c **** 		dp->obj.fs = fs;
 6996              		.loc 1 4611 2 is_stmt 1 view .LVU2382
4611:Core/Src/FAT/ff.c **** 		dp->obj.fs = fs;
 6997              		.loc 1 4611 5 is_stmt 0 view .LVU2383
 6998 0014 0346     		mov	r3, r0
 6999 0016 28B1     		cbz	r0, .L520
 7000              	.L512:
4651:Core/Src/FAT/ff.c **** 
 7001              		.loc 1 4651 2 is_stmt 1 view .LVU2384
4651:Core/Src/FAT/ff.c **** 
 7002              		.loc 1 4651 5 is_stmt 0 view .LVU2385
 7003 0018 0BB1     		cbz	r3, .L511
 7004              	.L515:
4651:Core/Src/FAT/ff.c **** 
 7005              		.loc 1 4651 20 is_stmt 1 discriminator 1 view .LVU2386
4651:Core/Src/FAT/ff.c **** 
 7006              		.loc 1 4651 31 is_stmt 0 discriminator 1 view .LVU2387
 7007 001a 0022     		movs	r2, #0
 7008 001c 2260     		str	r2, [r4]
 7009              	.LVL833:
 7010              	.L511:
4654:Core/Src/FAT/ff.c **** 
 7011              		.loc 1 4654 1 view .LVU2388
 7012 001e 1846     		mov	r0, r3
 7013 0020 04B0     		add	sp, sp, #16
 7014              	.LCFI66:
 7015              		.cfi_remember_state
 7016              		.cfi_def_cfa_offset 8
 7017              		@ sp needed
 7018 0022 10BD     		pop	{r4, pc}
 7019              	.LVL834:
 7020              	.L520:
 7021              	.LCFI67:
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 263


 7022              		.cfi_restore_state
4612:Core/Src/FAT/ff.c **** 		INIT_NAMBUF(fs);
 7023              		.loc 1 4612 3 is_stmt 1 view .LVU2389
4612:Core/Src/FAT/ff.c **** 		INIT_NAMBUF(fs);
 7024              		.loc 1 4612 14 is_stmt 0 view .LVU2390
 7025 0024 039B     		ldr	r3, [sp, #12]
 7026 0026 2360     		str	r3, [r4]
4613:Core/Src/FAT/ff.c **** 		res = follow_path(dp, path);			/* Follow the path to the directory */
 7027              		.loc 1 4613 18 is_stmt 1 view .LVU2391
4614:Core/Src/FAT/ff.c **** 		if (res == FR_OK) {						/* Follow completed */
 7028              		.loc 1 4614 3 view .LVU2392
4614:Core/Src/FAT/ff.c **** 		if (res == FR_OK) {						/* Follow completed */
 7029              		.loc 1 4614 9 is_stmt 0 view .LVU2393
 7030 0028 0199     		ldr	r1, [sp, #4]
 7031 002a 2046     		mov	r0, r4
 7032 002c FFF7FEFF 		bl	follow_path
 7033              	.LVL835:
4615:Core/Src/FAT/ff.c **** 			if (!(dp->fn[NSFLAG] & NS_NONAME)) {	/* It is not the origin directory itself */
 7034              		.loc 1 4615 3 is_stmt 1 view .LVU2394
4615:Core/Src/FAT/ff.c **** 			if (!(dp->fn[NSFLAG] & NS_NONAME)) {	/* It is not the origin directory itself */
 7035              		.loc 1 4615 6 is_stmt 0 view .LVU2395
 7036 0030 0346     		mov	r3, r0
 7037 0032 A0B9     		cbnz	r0, .L513
4616:Core/Src/FAT/ff.c **** 				if (dp->obj.attr & AM_DIR) {		/* This object is a sub-directory */
 7038              		.loc 1 4616 4 is_stmt 1 view .LVU2396
4616:Core/Src/FAT/ff.c **** 				if (dp->obj.attr & AM_DIR) {		/* This object is a sub-directory */
 7039              		.loc 1 4616 8 is_stmt 0 view .LVU2397
 7040 0034 94F92B30 		ldrsb	r3, [r4, #43]
4616:Core/Src/FAT/ff.c **** 				if (dp->obj.attr & AM_DIR) {		/* This object is a sub-directory */
 7041              		.loc 1 4616 7 view .LVU2398
 7042 0038 002B     		cmp	r3, #0
 7043 003a 08DB     		blt	.L514
4617:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT
 7044              		.loc 1 4617 5 is_stmt 1 view .LVU2399
4617:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT
 7045              		.loc 1 4617 16 is_stmt 0 view .LVU2400
 7046 003c A379     		ldrb	r3, [r4, #6]	@ zero_extendqisi2
4617:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT
 7047              		.loc 1 4617 8 view .LVU2401
 7048 003e 13F0100F 		tst	r3, #16
 7049 0042 10D0     		beq	.L517
4627:Core/Src/FAT/ff.c **** 					}
 7050              		.loc 1 4627 7 is_stmt 1 view .LVU2402
4627:Core/Src/FAT/ff.c **** 					}
 7051              		.loc 1 4627 24 is_stmt 0 view .LVU2403
 7052 0044 E169     		ldr	r1, [r4, #28]
 7053 0046 0398     		ldr	r0, [sp, #12]
 7054 0048 FFF7FEFF 		bl	ld_clust
 7055              	.LVL836:
4627:Core/Src/FAT/ff.c **** 					}
 7056              		.loc 1 4627 22 view .LVU2404
 7057 004c A060     		str	r0, [r4, #8]
 7058              	.L514:
4633:Core/Src/FAT/ff.c **** 				dp->obj.id = fs->id;
 7059              		.loc 1 4633 4 is_stmt 1 view .LVU2405
4634:Core/Src/FAT/ff.c **** 				res = dir_sdi(dp, 0);			/* Rewind directory */
 7060              		.loc 1 4634 5 view .LVU2406
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 264


4634:Core/Src/FAT/ff.c **** 				res = dir_sdi(dp, 0);			/* Rewind directory */
 7061              		.loc 1 4634 20 is_stmt 0 view .LVU2407
 7062 004e 039B     		ldr	r3, [sp, #12]
 7063 0050 DB88     		ldrh	r3, [r3, #6]
4634:Core/Src/FAT/ff.c **** 				res = dir_sdi(dp, 0);			/* Rewind directory */
 7064              		.loc 1 4634 16 view .LVU2408
 7065 0052 A380     		strh	r3, [r4, #4]	@ movhi
4635:Core/Src/FAT/ff.c **** #if FF_FS_LOCK
 7066              		.loc 1 4635 5 is_stmt 1 view .LVU2409
4635:Core/Src/FAT/ff.c **** #if FF_FS_LOCK
 7067              		.loc 1 4635 11 is_stmt 0 view .LVU2410
 7068 0054 0021     		movs	r1, #0
 7069 0056 2046     		mov	r0, r4
 7070 0058 FFF7FEFF 		bl	dir_sdi
 7071              	.LVL837:
 7072 005c 0346     		mov	r3, r0
 7073              	.L513:
4648:Core/Src/FAT/ff.c **** 		if (res == FR_NO_FILE) res = FR_NO_PATH;
 7074              		.loc 1 4648 16 is_stmt 1 view .LVU2411
4649:Core/Src/FAT/ff.c **** 	}
 7075              		.loc 1 4649 3 view .LVU2412
4649:Core/Src/FAT/ff.c **** 	}
 7076              		.loc 1 4649 6 is_stmt 0 view .LVU2413
 7077 005e 042B     		cmp	r3, #4
 7078 0060 DAD1     		bne	.L512
 7079              	.LVL838:
4649:Core/Src/FAT/ff.c **** 	}
 7080              		.loc 1 4649 30 view .LVU2414
 7081 0062 0523     		movs	r3, #5
 7082 0064 D9E7     		b	.L515
 7083              	.LVL839:
 7084              	.L517:
4630:Core/Src/FAT/ff.c **** 				}
 7085              		.loc 1 4630 10 view .LVU2415
 7086 0066 0523     		movs	r3, #5
 7087 0068 F9E7     		b	.L513
 7088              	.LVL840:
 7089              	.L516:
4607:Core/Src/FAT/ff.c **** 
 7090              		.loc 1 4607 18 view .LVU2416
 7091 006a 0923     		movs	r3, #9
 7092 006c D7E7     		b	.L511
 7093              		.cfi_endproc
 7094              	.LFE39:
 7096              		.section	.text.f_closedir,"ax",%progbits
 7097              		.align	1
 7098              		.global	f_closedir
 7099              		.syntax unified
 7100              		.thumb
 7101              		.thumb_func
 7103              	f_closedir:
 7104              	.LVL841:
 7105              	.LFB40:
4666:Core/Src/FAT/ff.c **** 	FRESULT res;
 7106              		.loc 1 4666 1 is_stmt 1 view -0
 7107              		.cfi_startproc
 7108              		@ args = 0, pretend = 0, frame = 8
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 265


 7109              		@ frame_needed = 0, uses_anonymous_args = 0
4666:Core/Src/FAT/ff.c **** 	FRESULT res;
 7110              		.loc 1 4666 1 is_stmt 0 view .LVU2418
 7111 0000 10B5     		push	{r4, lr}
 7112              	.LCFI68:
 7113              		.cfi_def_cfa_offset 8
 7114              		.cfi_offset 4, -8
 7115              		.cfi_offset 14, -4
 7116 0002 82B0     		sub	sp, sp, #8
 7117              	.LCFI69:
 7118              		.cfi_def_cfa_offset 16
 7119 0004 0446     		mov	r4, r0
4667:Core/Src/FAT/ff.c **** 	FATFS *fs;
 7120              		.loc 1 4667 2 is_stmt 1 view .LVU2419
4668:Core/Src/FAT/ff.c **** 
 7121              		.loc 1 4668 2 view .LVU2420
4671:Core/Src/FAT/ff.c **** 	if (res == FR_OK) {
 7122              		.loc 1 4671 2 view .LVU2421
4671:Core/Src/FAT/ff.c **** 	if (res == FR_OK) {
 7123              		.loc 1 4671 8 is_stmt 0 view .LVU2422
 7124 0006 01A9     		add	r1, sp, #4
 7125 0008 FFF7FEFF 		bl	validate
 7126              	.LVL842:
4672:Core/Src/FAT/ff.c **** #if FF_FS_LOCK
 7127              		.loc 1 4672 2 is_stmt 1 view .LVU2423
4672:Core/Src/FAT/ff.c **** #if FF_FS_LOCK
 7128              		.loc 1 4672 5 is_stmt 0 view .LVU2424
 7129 000c 00B9     		cbnz	r0, .L522
4677:Core/Src/FAT/ff.c **** #endif
 7130              		.loc 1 4677 3 is_stmt 1 view .LVU2425
4677:Core/Src/FAT/ff.c **** #endif
 7131              		.loc 1 4677 14 is_stmt 0 view .LVU2426
 7132 000e 2060     		str	r0, [r4]
 7133              	.L522:
4683:Core/Src/FAT/ff.c **** }
 7134              		.loc 1 4683 2 is_stmt 1 view .LVU2427
4684:Core/Src/FAT/ff.c **** 
 7135              		.loc 1 4684 1 is_stmt 0 view .LVU2428
 7136 0010 02B0     		add	sp, sp, #8
 7137              	.LCFI70:
 7138              		.cfi_def_cfa_offset 8
 7139              		@ sp needed
 7140 0012 10BD     		pop	{r4, pc}
4684:Core/Src/FAT/ff.c **** 
 7141              		.loc 1 4684 1 view .LVU2429
 7142              		.cfi_endproc
 7143              	.LFE40:
 7145              		.section	.text.f_readdir,"ax",%progbits
 7146              		.align	1
 7147              		.global	f_readdir
 7148              		.syntax unified
 7149              		.thumb
 7150              		.thumb_func
 7152              	f_readdir:
 7153              	.LVL843:
 7154              	.LFB41:
4697:Core/Src/FAT/ff.c **** 	FRESULT res;
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 266


 7155              		.loc 1 4697 1 is_stmt 1 view -0
 7156              		.cfi_startproc
 7157              		@ args = 0, pretend = 0, frame = 8
 7158              		@ frame_needed = 0, uses_anonymous_args = 0
4697:Core/Src/FAT/ff.c **** 	FRESULT res;
 7159              		.loc 1 4697 1 is_stmt 0 view .LVU2431
 7160 0000 70B5     		push	{r4, r5, r6, lr}
 7161              	.LCFI71:
 7162              		.cfi_def_cfa_offset 16
 7163              		.cfi_offset 4, -16
 7164              		.cfi_offset 5, -12
 7165              		.cfi_offset 6, -8
 7166              		.cfi_offset 14, -4
 7167 0002 82B0     		sub	sp, sp, #8
 7168              	.LCFI72:
 7169              		.cfi_def_cfa_offset 24
 7170 0004 0446     		mov	r4, r0
 7171 0006 0D46     		mov	r5, r1
4698:Core/Src/FAT/ff.c **** 	FATFS *fs;
 7172              		.loc 1 4698 2 is_stmt 1 view .LVU2432
4699:Core/Src/FAT/ff.c **** 	DEF_NAMBUF
 7173              		.loc 1 4699 2 view .LVU2433
4703:Core/Src/FAT/ff.c **** 	if (res == FR_OK) {
 7174              		.loc 1 4703 2 view .LVU2434
4703:Core/Src/FAT/ff.c **** 	if (res == FR_OK) {
 7175              		.loc 1 4703 8 is_stmt 0 view .LVU2435
 7176 0008 01A9     		add	r1, sp, #4
 7177              	.LVL844:
4703:Core/Src/FAT/ff.c **** 	if (res == FR_OK) {
 7178              		.loc 1 4703 8 view .LVU2436
 7179 000a FFF7FEFF 		bl	validate
 7180              	.LVL845:
4704:Core/Src/FAT/ff.c **** 		if (!fno) {
 7181              		.loc 1 4704 2 is_stmt 1 view .LVU2437
4704:Core/Src/FAT/ff.c **** 		if (!fno) {
 7182              		.loc 1 4704 5 is_stmt 0 view .LVU2438
 7183 000e 0646     		mov	r6, r0
 7184 0010 C0B9     		cbnz	r0, .L525
4705:Core/Src/FAT/ff.c **** 			res = dir_sdi(dp, 0);		/* Rewind the directory object */
 7185              		.loc 1 4705 3 is_stmt 1 view .LVU2439
4705:Core/Src/FAT/ff.c **** 			res = dir_sdi(dp, 0);		/* Rewind the directory object */
 7186              		.loc 1 4705 6 is_stmt 0 view .LVU2440
 7187 0012 95B1     		cbz	r5, .L530
4708:Core/Src/FAT/ff.c **** 			res = DIR_READ_FILE(dp);		/* Read an item */
 7188              		.loc 1 4708 19 is_stmt 1 view .LVU2441
4709:Core/Src/FAT/ff.c **** 			if (res == FR_NO_FILE) res = FR_OK;	/* Ignore end of directory */
 7189              		.loc 1 4709 4 view .LVU2442
4709:Core/Src/FAT/ff.c **** 			if (res == FR_NO_FILE) res = FR_OK;	/* Ignore end of directory */
 7190              		.loc 1 4709 10 is_stmt 0 view .LVU2443
 7191 0014 0021     		movs	r1, #0
 7192 0016 2046     		mov	r0, r4
 7193              	.LVL846:
4709:Core/Src/FAT/ff.c **** 			if (res == FR_NO_FILE) res = FR_OK;	/* Ignore end of directory */
 7194              		.loc 1 4709 10 view .LVU2444
 7195 0018 FFF7FEFF 		bl	dir_read
 7196              	.LVL847:
4710:Core/Src/FAT/ff.c **** 			if (res == FR_OK) {				/* A valid entry is found */
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 267


 7197              		.loc 1 4710 4 is_stmt 1 view .LVU2445
4710:Core/Src/FAT/ff.c **** 			if (res == FR_OK) {				/* A valid entry is found */
 7198              		.loc 1 4710 7 is_stmt 0 view .LVU2446
 7199 001c 0428     		cmp	r0, #4
 7200 001e 00D0     		beq	.L527
4711:Core/Src/FAT/ff.c **** 				get_fileinfo(dp, fno);		/* Get the object information */
 7201              		.loc 1 4711 4 is_stmt 1 view .LVU2447
4711:Core/Src/FAT/ff.c **** 				get_fileinfo(dp, fno);		/* Get the object information */
 7202              		.loc 1 4711 7 is_stmt 0 view .LVU2448
 7203 0020 98B9     		cbnz	r0, .L528
 7204              	.L527:
 7205              	.LVL848:
4712:Core/Src/FAT/ff.c **** 				res = dir_next(dp, 0);		/* Increment index for next */
 7206              		.loc 1 4712 5 is_stmt 1 view .LVU2449
 7207 0022 2946     		mov	r1, r5
 7208 0024 2046     		mov	r0, r4
 7209 0026 FFF7FEFF 		bl	get_fileinfo
 7210              	.LVL849:
4713:Core/Src/FAT/ff.c **** 				if (res == FR_NO_FILE) res = FR_OK;	/* Ignore end of directory now */
 7211              		.loc 1 4713 5 view .LVU2450
4713:Core/Src/FAT/ff.c **** 				if (res == FR_NO_FILE) res = FR_OK;	/* Ignore end of directory now */
 7212              		.loc 1 4713 11 is_stmt 0 view .LVU2451
 7213 002a 0021     		movs	r1, #0
 7214 002c 2046     		mov	r0, r4
 7215 002e FFF7FEFF 		bl	dir_next
 7216              	.LVL850:
4714:Core/Src/FAT/ff.c **** 			}
 7217              		.loc 1 4714 5 is_stmt 1 view .LVU2452
4714:Core/Src/FAT/ff.c **** 			}
 7218              		.loc 1 4714 8 is_stmt 0 view .LVU2453
 7219 0032 0428     		cmp	r0, #4
 7220 0034 06D0     		beq	.L525
4713:Core/Src/FAT/ff.c **** 				if (res == FR_NO_FILE) res = FR_OK;	/* Ignore end of directory now */
 7221              		.loc 1 4713 11 view .LVU2454
 7222 0036 0646     		mov	r6, r0
 7223 0038 04E0     		b	.L525
 7224              	.L530:
4706:Core/Src/FAT/ff.c **** 		} else {
 7225              		.loc 1 4706 4 is_stmt 1 view .LVU2455
4706:Core/Src/FAT/ff.c **** 		} else {
 7226              		.loc 1 4706 10 is_stmt 0 view .LVU2456
 7227 003a 0021     		movs	r1, #0
 7228 003c 2046     		mov	r0, r4
 7229              	.LVL851:
4706:Core/Src/FAT/ff.c **** 		} else {
 7230              		.loc 1 4706 10 view .LVU2457
 7231 003e FFF7FEFF 		bl	dir_sdi
 7232              	.LVL852:
 7233 0042 0646     		mov	r6, r0
 7234              	.LVL853:
 7235              	.L525:
4716:Core/Src/FAT/ff.c **** 		}
 7236              		.loc 1 4716 17 is_stmt 1 view .LVU2458
4719:Core/Src/FAT/ff.c **** }
 7237              		.loc 1 4719 2 view .LVU2459
4720:Core/Src/FAT/ff.c **** 
 7238              		.loc 1 4720 1 is_stmt 0 view .LVU2460
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 268


 7239 0044 3046     		mov	r0, r6
 7240 0046 02B0     		add	sp, sp, #8
 7241              	.LCFI73:
 7242              		.cfi_remember_state
 7243              		.cfi_def_cfa_offset 16
 7244              		@ sp needed
 7245 0048 70BD     		pop	{r4, r5, r6, pc}
 7246              	.LVL854:
 7247              	.L528:
 7248              	.LCFI74:
 7249              		.cfi_restore_state
4709:Core/Src/FAT/ff.c **** 			if (res == FR_NO_FILE) res = FR_OK;	/* Ignore end of directory */
 7250              		.loc 1 4709 10 view .LVU2461
 7251 004a 0646     		mov	r6, r0
 7252 004c FAE7     		b	.L525
 7253              		.cfi_endproc
 7254              	.LFE41:
 7256              		.section	.text.f_stat,"ax",%progbits
 7257              		.align	1
 7258              		.global	f_stat
 7259              		.syntax unified
 7260              		.thumb
 7261              		.thumb_func
 7263              	f_stat:
 7264              	.LVL855:
 7265              	.LFB42:
4785:Core/Src/FAT/ff.c **** 	FRESULT res;
 7266              		.loc 1 4785 1 is_stmt 1 view -0
 7267              		.cfi_startproc
 7268              		@ args = 0, pretend = 0, frame = 56
 7269              		@ frame_needed = 0, uses_anonymous_args = 0
4785:Core/Src/FAT/ff.c **** 	FRESULT res;
 7270              		.loc 1 4785 1 is_stmt 0 view .LVU2463
 7271 0000 30B5     		push	{r4, r5, lr}
 7272              	.LCFI75:
 7273              		.cfi_def_cfa_offset 12
 7274              		.cfi_offset 4, -12
 7275              		.cfi_offset 5, -8
 7276              		.cfi_offset 14, -4
 7277 0002 8FB0     		sub	sp, sp, #60
 7278              	.LCFI76:
 7279              		.cfi_def_cfa_offset 72
 7280 0004 0190     		str	r0, [sp, #4]
 7281 0006 0C46     		mov	r4, r1
4786:Core/Src/FAT/ff.c **** 	DIR dj;
 7282              		.loc 1 4786 2 is_stmt 1 view .LVU2464
4787:Core/Src/FAT/ff.c **** 	DEF_NAMBUF
 7283              		.loc 1 4787 2 view .LVU2465
4792:Core/Src/FAT/ff.c **** 	if (res == FR_OK) {
 7284              		.loc 1 4792 2 view .LVU2466
4792:Core/Src/FAT/ff.c **** 	if (res == FR_OK) {
 7285              		.loc 1 4792 8 is_stmt 0 view .LVU2467
 7286 0008 0022     		movs	r2, #0
 7287 000a 03A9     		add	r1, sp, #12
 7288              	.LVL856:
4792:Core/Src/FAT/ff.c **** 	if (res == FR_OK) {
 7289              		.loc 1 4792 8 view .LVU2468
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 269


 7290 000c 01A8     		add	r0, sp, #4
 7291              	.LVL857:
4792:Core/Src/FAT/ff.c **** 	if (res == FR_OK) {
 7292              		.loc 1 4792 8 view .LVU2469
 7293 000e FFF7FEFF 		bl	mount_volume
 7294              	.LVL858:
4793:Core/Src/FAT/ff.c **** 		INIT_NAMBUF(dj.obj.fs);
 7295              		.loc 1 4793 2 is_stmt 1 view .LVU2470
4793:Core/Src/FAT/ff.c **** 		INIT_NAMBUF(dj.obj.fs);
 7296              		.loc 1 4793 5 is_stmt 0 view .LVU2471
 7297 0012 0546     		mov	r5, r0
 7298 0014 10B1     		cbz	r0, .L535
 7299              	.LVL859:
 7300              	.L532:
4803:Core/Src/FAT/ff.c **** 	}
 7301              		.loc 1 4803 16 is_stmt 1 view .LVU2472
4806:Core/Src/FAT/ff.c **** }
 7302              		.loc 1 4806 2 view .LVU2473
4807:Core/Src/FAT/ff.c **** 
 7303              		.loc 1 4807 1 is_stmt 0 view .LVU2474
 7304 0016 2846     		mov	r0, r5
 7305 0018 0FB0     		add	sp, sp, #60
 7306              	.LCFI77:
 7307              		.cfi_remember_state
 7308              		.cfi_def_cfa_offset 12
 7309              		@ sp needed
 7310 001a 30BD     		pop	{r4, r5, pc}
 7311              	.LVL860:
 7312              	.L535:
 7313              	.LCFI78:
 7314              		.cfi_restore_state
4794:Core/Src/FAT/ff.c **** 		res = follow_path(&dj, path);	/* Follow the file path */
 7315              		.loc 1 4794 25 is_stmt 1 view .LVU2475
4795:Core/Src/FAT/ff.c **** 		if (res == FR_OK) {				/* Follow completed */
 7316              		.loc 1 4795 3 view .LVU2476
4795:Core/Src/FAT/ff.c **** 		if (res == FR_OK) {				/* Follow completed */
 7317              		.loc 1 4795 9 is_stmt 0 view .LVU2477
 7318 001c 0199     		ldr	r1, [sp, #4]
 7319 001e 03A8     		add	r0, sp, #12
 7320              	.LVL861:
4795:Core/Src/FAT/ff.c **** 		if (res == FR_OK) {				/* Follow completed */
 7321              		.loc 1 4795 9 view .LVU2478
 7322 0020 FFF7FEFF 		bl	follow_path
 7323              	.LVL862:
4796:Core/Src/FAT/ff.c **** 			if (dj.fn[NSFLAG] & NS_NONAME) {	/* It is origin directory */
 7324              		.loc 1 4796 3 is_stmt 1 view .LVU2479
4796:Core/Src/FAT/ff.c **** 			if (dj.fn[NSFLAG] & NS_NONAME) {	/* It is origin directory */
 7325              		.loc 1 4796 6 is_stmt 0 view .LVU2480
 7326 0024 0546     		mov	r5, r0
 7327 0026 0028     		cmp	r0, #0
 7328 0028 F5D1     		bne	.L532
4797:Core/Src/FAT/ff.c **** 				res = FR_INVALID_NAME;
 7329              		.loc 1 4797 4 is_stmt 1 view .LVU2481
4797:Core/Src/FAT/ff.c **** 				res = FR_INVALID_NAME;
 7330              		.loc 1 4797 8 is_stmt 0 view .LVU2482
 7331 002a 9DF93730 		ldrsb	r3, [sp, #55]
4797:Core/Src/FAT/ff.c **** 				res = FR_INVALID_NAME;
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 270


 7332              		.loc 1 4797 7 view .LVU2483
 7333 002e 002B     		cmp	r3, #0
 7334 0030 06DB     		blt	.L533
4800:Core/Src/FAT/ff.c **** 			}
 7335              		.loc 1 4800 5 is_stmt 1 view .LVU2484
4800:Core/Src/FAT/ff.c **** 			}
 7336              		.loc 1 4800 8 is_stmt 0 view .LVU2485
 7337 0032 002C     		cmp	r4, #0
 7338 0034 EFD0     		beq	.L532
4800:Core/Src/FAT/ff.c **** 			}
 7339              		.loc 1 4800 14 is_stmt 1 discriminator 1 view .LVU2486
 7340 0036 2146     		mov	r1, r4
 7341 0038 03A8     		add	r0, sp, #12
 7342              	.LVL863:
4800:Core/Src/FAT/ff.c **** 			}
 7343              		.loc 1 4800 14 is_stmt 0 discriminator 1 view .LVU2487
 7344 003a FFF7FEFF 		bl	get_fileinfo
 7345              	.LVL864:
 7346 003e EAE7     		b	.L532
 7347              	.LVL865:
 7348              	.L533:
4798:Core/Src/FAT/ff.c **** 			} else {							/* Found an object */
 7349              		.loc 1 4798 9 view .LVU2488
 7350 0040 0625     		movs	r5, #6
 7351 0042 E8E7     		b	.L532
 7352              		.cfi_endproc
 7353              	.LFE42:
 7355              		.section	.text.f_getfree,"ax",%progbits
 7356              		.align	1
 7357              		.global	f_getfree
 7358              		.syntax unified
 7359              		.thumb
 7360              		.thumb_func
 7362              	f_getfree:
 7363              	.LVL866:
 7364              	.LFB43:
4821:Core/Src/FAT/ff.c **** 	FRESULT res;
 7365              		.loc 1 4821 1 is_stmt 1 view -0
 7366              		.cfi_startproc
 7367              		@ args = 0, pretend = 0, frame = 32
 7368              		@ frame_needed = 0, uses_anonymous_args = 0
4821:Core/Src/FAT/ff.c **** 	FRESULT res;
 7369              		.loc 1 4821 1 is_stmt 0 view .LVU2490
 7370 0000 2DE9F047 		push	{r4, r5, r6, r7, r8, r9, r10, lr}
 7371              	.LCFI79:
 7372              		.cfi_def_cfa_offset 32
 7373              		.cfi_offset 4, -32
 7374              		.cfi_offset 5, -28
 7375              		.cfi_offset 6, -24
 7376              		.cfi_offset 7, -20
 7377              		.cfi_offset 8, -16
 7378              		.cfi_offset 9, -12
 7379              		.cfi_offset 10, -8
 7380              		.cfi_offset 14, -4
 7381 0004 88B0     		sub	sp, sp, #32
 7382              	.LCFI80:
 7383              		.cfi_def_cfa_offset 64
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 271


 7384 0006 0190     		str	r0, [sp, #4]
 7385 0008 0F46     		mov	r7, r1
 7386 000a 1446     		mov	r4, r2
4822:Core/Src/FAT/ff.c **** 	FATFS *fs;
 7387              		.loc 1 4822 2 is_stmt 1 view .LVU2491
4823:Core/Src/FAT/ff.c **** 	DWORD nfree, clst, stat;
 7388              		.loc 1 4823 2 view .LVU2492
4824:Core/Src/FAT/ff.c **** 	LBA_t sect;
 7389              		.loc 1 4824 2 view .LVU2493
4825:Core/Src/FAT/ff.c **** 	UINT i;
 7390              		.loc 1 4825 2 view .LVU2494
4826:Core/Src/FAT/ff.c **** 	FFOBJID obj;
 7391              		.loc 1 4826 2 view .LVU2495
4827:Core/Src/FAT/ff.c **** 
 7392              		.loc 1 4827 2 view .LVU2496
4831:Core/Src/FAT/ff.c **** 	if (res == FR_OK) {
 7393              		.loc 1 4831 2 view .LVU2497
4831:Core/Src/FAT/ff.c **** 	if (res == FR_OK) {
 7394              		.loc 1 4831 8 is_stmt 0 view .LVU2498
 7395 000c 0022     		movs	r2, #0
 7396              	.LVL867:
4831:Core/Src/FAT/ff.c **** 	if (res == FR_OK) {
 7397              		.loc 1 4831 8 view .LVU2499
 7398 000e 07A9     		add	r1, sp, #28
 7399              	.LVL868:
4831:Core/Src/FAT/ff.c **** 	if (res == FR_OK) {
 7400              		.loc 1 4831 8 view .LVU2500
 7401 0010 01A8     		add	r0, sp, #4
 7402              	.LVL869:
4831:Core/Src/FAT/ff.c **** 	if (res == FR_OK) {
 7403              		.loc 1 4831 8 view .LVU2501
 7404 0012 FFF7FEFF 		bl	mount_volume
 7405              	.LVL870:
4832:Core/Src/FAT/ff.c **** 		*fatfs = fs;				/* Return ptr to the fs object */
 7406              		.loc 1 4832 2 is_stmt 1 view .LVU2502
4832:Core/Src/FAT/ff.c **** 		*fatfs = fs;				/* Return ptr to the fs object */
 7407              		.loc 1 4832 5 is_stmt 0 view .LVU2503
 7408 0016 8046     		mov	r8, r0
 7409 0018 38B9     		cbnz	r0, .L537
4833:Core/Src/FAT/ff.c **** 		/* If free_clst is valid, return it without full FAT scan */
 7410              		.loc 1 4833 3 is_stmt 1 view .LVU2504
4833:Core/Src/FAT/ff.c **** 		/* If free_clst is valid, return it without full FAT scan */
 7411              		.loc 1 4833 10 is_stmt 0 view .LVU2505
 7412 001a 079B     		ldr	r3, [sp, #28]
 7413 001c 2360     		str	r3, [r4]
4835:Core/Src/FAT/ff.c **** 			*nclst = fs->free_clst;
 7414              		.loc 1 4835 3 is_stmt 1 view .LVU2506
4835:Core/Src/FAT/ff.c **** 			*nclst = fs->free_clst;
 7415              		.loc 1 4835 9 is_stmt 0 view .LVU2507
 7416 001e 1A69     		ldr	r2, [r3, #16]
4835:Core/Src/FAT/ff.c **** 			*nclst = fs->free_clst;
 7417              		.loc 1 4835 26 view .LVU2508
 7418 0020 5D69     		ldr	r5, [r3, #20]
4835:Core/Src/FAT/ff.c **** 			*nclst = fs->free_clst;
 7419              		.loc 1 4835 37 view .LVU2509
 7420 0022 A91E     		subs	r1, r5, #2
4835:Core/Src/FAT/ff.c **** 			*nclst = fs->free_clst;
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 272


 7421              		.loc 1 4835 6 view .LVU2510
 7422 0024 8A42     		cmp	r2, r1
 7423 0026 04D8     		bhi	.L538
4836:Core/Src/FAT/ff.c **** 		} else {
 7424              		.loc 1 4836 4 is_stmt 1 view .LVU2511
4836:Core/Src/FAT/ff.c **** 		} else {
 7425              		.loc 1 4836 11 is_stmt 0 view .LVU2512
 7426 0028 3A60     		str	r2, [r7]
 7427              	.LVL871:
 7428              	.L537:
4902:Core/Src/FAT/ff.c **** }
 7429              		.loc 1 4902 2 is_stmt 1 view .LVU2513
4903:Core/Src/FAT/ff.c **** 
 7430              		.loc 1 4903 1 is_stmt 0 view .LVU2514
 7431 002a 4046     		mov	r0, r8
 7432 002c 08B0     		add	sp, sp, #32
 7433              	.LCFI81:
 7434              		.cfi_remember_state
 7435              		.cfi_def_cfa_offset 32
 7436              		@ sp needed
 7437 002e BDE8F087 		pop	{r4, r5, r6, r7, r8, r9, r10, pc}
 7438              	.LVL872:
 7439              	.L538:
 7440              	.LCFI82:
 7441              		.cfi_restore_state
4839:Core/Src/FAT/ff.c **** 			if (fs->fs_type == FS_FAT12) {	/* FAT12: Scan bit field FAT entries */
 7442              		.loc 1 4839 4 is_stmt 1 view .LVU2515
4840:Core/Src/FAT/ff.c **** 				clst = 2; obj.fs = fs;
 7443              		.loc 1 4840 4 view .LVU2516
4840:Core/Src/FAT/ff.c **** 				clst = 2; obj.fs = fs;
 7444              		.loc 1 4840 10 is_stmt 0 view .LVU2517
 7445 0032 93F80090 		ldrb	r9, [r3]	@ zero_extendqisi2
4840:Core/Src/FAT/ff.c **** 				clst = 2; obj.fs = fs;
 7446              		.loc 1 4840 7 view .LVU2518
 7447 0036 B9F1010F 		cmp	r9, #1
 7448 003a 04D0     		beq	.L552
4875:Core/Src/FAT/ff.c **** 					sect = fs->fatbase;		/* Top of the FAT */
 7449              		.loc 1 4875 6 is_stmt 1 view .LVU2519
 7450              	.LVL873:
4876:Core/Src/FAT/ff.c **** 					i = 0;					/* Offset in the sector */
 7451              		.loc 1 4876 6 view .LVU2520
4876:Core/Src/FAT/ff.c **** 					i = 0;					/* Offset in the sector */
 7452              		.loc 1 4876 11 is_stmt 0 view .LVU2521
 7453 003c D3F82090 		ldr	r9, [r3, #32]
 7454              	.LVL874:
4877:Core/Src/FAT/ff.c **** 					do {	/* Counts numbuer of entries with zero in the FAT */
 7455              		.loc 1 4877 6 is_stmt 1 view .LVU2522
4877:Core/Src/FAT/ff.c **** 					do {	/* Counts numbuer of entries with zero in the FAT */
 7456              		.loc 1 4877 8 is_stmt 0 view .LVU2523
 7457 0040 0024     		movs	r4, #0
 7458              	.LVL875:
4839:Core/Src/FAT/ff.c **** 			if (fs->fs_type == FS_FAT12) {	/* FAT12: Scan bit field FAT entries */
 7459              		.loc 1 4839 10 view .LVU2524
 7460 0042 2646     		mov	r6, r4
 7461 0044 2CE0     		b	.L548
 7462              	.LVL876:
 7463              	.L552:
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 273


4841:Core/Src/FAT/ff.c **** 				do {
 7464              		.loc 1 4841 5 is_stmt 1 view .LVU2525
4841:Core/Src/FAT/ff.c **** 				do {
 7465              		.loc 1 4841 15 view .LVU2526
4841:Core/Src/FAT/ff.c **** 				do {
 7466              		.loc 1 4841 22 is_stmt 0 view .LVU2527
 7467 0046 0393     		str	r3, [sp, #12]
4841:Core/Src/FAT/ff.c **** 				do {
 7468              		.loc 1 4841 10 view .LVU2528
 7469 0048 0224     		movs	r4, #2
 7470              	.LVL877:
4839:Core/Src/FAT/ff.c **** 			if (fs->fs_type == FS_FAT12) {	/* FAT12: Scan bit field FAT entries */
 7471              		.loc 1 4839 10 view .LVU2529
 7472 004a 0026     		movs	r6, #0
 7473 004c 04E0     		b	.L542
 7474              	.LVL878:
 7475              	.L541:
4851:Core/Src/FAT/ff.c **** 			} else {
 7476              		.loc 1 4851 13 is_stmt 1 view .LVU2530
4851:Core/Src/FAT/ff.c **** 			} else {
 7477              		.loc 1 4851 5 is_stmt 0 view .LVU2531
 7478 004e 0134     		adds	r4, r4, #1
 7479              	.LVL879:
4851:Core/Src/FAT/ff.c **** 			} else {
 7480              		.loc 1 4851 25 view .LVU2532
 7481 0050 079B     		ldr	r3, [sp, #28]
 7482 0052 5B69     		ldr	r3, [r3, #20]
4851:Core/Src/FAT/ff.c **** 			} else {
 7483              		.loc 1 4851 5 view .LVU2533
 7484 0054 A342     		cmp	r3, r4
 7485 0056 33D9     		bls	.L540
 7486              	.LVL880:
 7487              	.L542:
4842:Core/Src/FAT/ff.c **** 					stat = get_fat(&obj, clst);
 7488              		.loc 1 4842 5 is_stmt 1 view .LVU2534
4843:Core/Src/FAT/ff.c **** 					if (stat == 0xFFFFFFFF) {
 7489              		.loc 1 4843 6 view .LVU2535
4843:Core/Src/FAT/ff.c **** 					if (stat == 0xFFFFFFFF) {
 7490              		.loc 1 4843 13 is_stmt 0 view .LVU2536
 7491 0058 2146     		mov	r1, r4
 7492 005a 03A8     		add	r0, sp, #12
 7493 005c FFF7FEFF 		bl	get_fat
 7494              	.LVL881:
4844:Core/Src/FAT/ff.c **** 						res = FR_DISK_ERR; break;
 7495              		.loc 1 4844 6 is_stmt 1 view .LVU2537
4844:Core/Src/FAT/ff.c **** 						res = FR_DISK_ERR; break;
 7496              		.loc 1 4844 9 is_stmt 0 view .LVU2538
 7497 0060 B0F1FF3F 		cmp	r0, #-1
 7498 0064 2BD0     		beq	.L549
4847:Core/Src/FAT/ff.c **** 						res = FR_INT_ERR; break;
 7499              		.loc 1 4847 6 is_stmt 1 view .LVU2539
4847:Core/Src/FAT/ff.c **** 						res = FR_INT_ERR; break;
 7500              		.loc 1 4847 9 is_stmt 0 view .LVU2540
 7501 0066 0128     		cmp	r0, #1
 7502 0068 35D0     		beq	.L550
4850:Core/Src/FAT/ff.c **** 				} while (++clst < fs->n_fatent);
 7503              		.loc 1 4850 6 is_stmt 1 view .LVU2541
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 274


4850:Core/Src/FAT/ff.c **** 				} while (++clst < fs->n_fatent);
 7504              		.loc 1 4850 9 is_stmt 0 view .LVU2542
 7505 006a 0028     		cmp	r0, #0
 7506 006c EFD1     		bne	.L541
4850:Core/Src/FAT/ff.c **** 				} while (++clst < fs->n_fatent);
 7507              		.loc 1 4850 21 is_stmt 1 discriminator 1 view .LVU2543
4850:Core/Src/FAT/ff.c **** 				} while (++clst < fs->n_fatent);
 7508              		.loc 1 4850 26 is_stmt 0 discriminator 1 view .LVU2544
 7509 006e 0136     		adds	r6, r6, #1
 7510              	.LVL882:
4850:Core/Src/FAT/ff.c **** 				} while (++clst < fs->n_fatent);
 7511              		.loc 1 4850 26 discriminator 1 view .LVU2545
 7512 0070 EDE7     		b	.L541
 7513              	.LVL883:
 7514              	.L553:
4880:Core/Src/FAT/ff.c **** 							if (res != FR_OK) break;
 7515              		.loc 1 4880 8 is_stmt 1 view .LVU2546
4880:Core/Src/FAT/ff.c **** 							if (res != FR_OK) break;
 7516              		.loc 1 4880 14 is_stmt 0 view .LVU2547
 7517 0072 09F1010A 		add	r10, r9, #1
 7518              	.LVL884:
4880:Core/Src/FAT/ff.c **** 							if (res != FR_OK) break;
 7519              		.loc 1 4880 14 view .LVU2548
 7520 0076 4946     		mov	r1, r9
 7521 0078 0798     		ldr	r0, [sp, #28]
 7522 007a FFF7FEFF 		bl	move_window
 7523              	.LVL885:
4881:Core/Src/FAT/ff.c **** 						}
 7524              		.loc 1 4881 8 is_stmt 1 view .LVU2549
4881:Core/Src/FAT/ff.c **** 						}
 7525              		.loc 1 4881 11 is_stmt 0 view .LVU2550
 7526 007e 8046     		mov	r8, r0
 7527 0080 F0B9     		cbnz	r0, .L540
4880:Core/Src/FAT/ff.c **** 							if (res != FR_OK) break;
 7528              		.loc 1 4880 14 view .LVU2551
 7529 0082 D146     		mov	r9, r10
 7530 0084 0EE0     		b	.L543
 7531              	.LVL886:
 7532              	.L554:
4884:Core/Src/FAT/ff.c **** 							i += 2;
 7533              		.loc 1 4884 8 is_stmt 1 view .LVU2552
4884:Core/Src/FAT/ff.c **** 							i += 2;
 7534              		.loc 1 4884 20 is_stmt 0 view .LVU2553
 7535 0086 3030     		adds	r0, r0, #48
4884:Core/Src/FAT/ff.c **** 							i += 2;
 7536              		.loc 1 4884 12 view .LVU2554
 7537 0088 2044     		add	r0, r0, r4
 7538 008a FFF7FEFF 		bl	ld_word
 7539              	.LVL887:
4884:Core/Src/FAT/ff.c **** 							i += 2;
 7540              		.loc 1 4884 11 view .LVU2555
 7541 008e 00B9     		cbnz	r0, .L545
4884:Core/Src/FAT/ff.c **** 							i += 2;
 7542              		.loc 1 4884 39 is_stmt 1 discriminator 1 view .LVU2556
4884:Core/Src/FAT/ff.c **** 							i += 2;
 7543              		.loc 1 4884 44 is_stmt 0 discriminator 1 view .LVU2557
 7544 0090 0136     		adds	r6, r6, #1
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 275


 7545              	.LVL888:
 7546              	.L545:
4885:Core/Src/FAT/ff.c **** 						} else {
 7547              		.loc 1 4885 8 is_stmt 1 view .LVU2558
4885:Core/Src/FAT/ff.c **** 						} else {
 7548              		.loc 1 4885 10 is_stmt 0 view .LVU2559
 7549 0092 0234     		adds	r4, r4, #2
 7550              	.LVL889:
4885:Core/Src/FAT/ff.c **** 						} else {
 7551              		.loc 1 4885 10 view .LVU2560
 7552 0094 00E0     		b	.L546
 7553              	.L547:
4888:Core/Src/FAT/ff.c **** 						}
 7554              		.loc 1 4888 8 is_stmt 1 view .LVU2561
4888:Core/Src/FAT/ff.c **** 						}
 7555              		.loc 1 4888 10 is_stmt 0 view .LVU2562
 7556 0096 0434     		adds	r4, r4, #4
 7557              	.LVL890:
 7558              	.L546:
4890:Core/Src/FAT/ff.c **** 					} while (--clst);
 7559              		.loc 1 4890 7 is_stmt 1 view .LVU2563
4890:Core/Src/FAT/ff.c **** 					} while (--clst);
 7560              		.loc 1 4890 9 is_stmt 0 view .LVU2564
 7561 0098 C4F30804 		ubfx	r4, r4, #0, #9
 7562              	.LVL891:
4891:Core/Src/FAT/ff.c **** 				}
 7563              		.loc 1 4891 14 is_stmt 1 view .LVU2565
4891:Core/Src/FAT/ff.c **** 				}
 7564              		.loc 1 4891 6 is_stmt 0 view .LVU2566
 7565 009c 013D     		subs	r5, r5, #1
 7566              	.LVL892:
4891:Core/Src/FAT/ff.c **** 				}
 7567              		.loc 1 4891 6 view .LVU2567
 7568 009e 0FD0     		beq	.L540
 7569              	.LVL893:
 7570              	.L548:
4878:Core/Src/FAT/ff.c **** 						if (i == 0) {	/* New sector? */
 7571              		.loc 1 4878 6 is_stmt 1 view .LVU2568
4879:Core/Src/FAT/ff.c **** 							res = move_window(fs, sect++);
 7572              		.loc 1 4879 7 view .LVU2569
4879:Core/Src/FAT/ff.c **** 							res = move_window(fs, sect++);
 7573              		.loc 1 4879 10 is_stmt 0 view .LVU2570
 7574 00a0 002C     		cmp	r4, #0
 7575 00a2 E6D0     		beq	.L553
 7576              	.LVL894:
 7577              	.L543:
4883:Core/Src/FAT/ff.c **** 							if (ld_word(fs->win + i) == 0) nfree++;
 7578              		.loc 1 4883 7 is_stmt 1 view .LVU2571
4883:Core/Src/FAT/ff.c **** 							if (ld_word(fs->win + i) == 0) nfree++;
 7579              		.loc 1 4883 13 is_stmt 0 view .LVU2572
 7580 00a4 0798     		ldr	r0, [sp, #28]
 7581 00a6 0378     		ldrb	r3, [r0]	@ zero_extendqisi2
4883:Core/Src/FAT/ff.c **** 							if (ld_word(fs->win + i) == 0) nfree++;
 7582              		.loc 1 4883 10 view .LVU2573
 7583 00a8 022B     		cmp	r3, #2
 7584 00aa ECD0     		beq	.L554
4887:Core/Src/FAT/ff.c **** 							i += 4;
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 276


 7585              		.loc 1 4887 8 is_stmt 1 view .LVU2574
4887:Core/Src/FAT/ff.c **** 							i += 4;
 7586              		.loc 1 4887 22 is_stmt 0 view .LVU2575
 7587 00ac 3030     		adds	r0, r0, #48
4887:Core/Src/FAT/ff.c **** 							i += 4;
 7588              		.loc 1 4887 13 view .LVU2576
 7589 00ae 2044     		add	r0, r0, r4
 7590 00b0 FFF7FEFF 		bl	ld_dword
 7591              	.LVL895:
4887:Core/Src/FAT/ff.c **** 							i += 4;
 7592              		.loc 1 4887 11 view .LVU2577
 7593 00b4 30F07043 		bics	r3, r0, #-268435456
 7594 00b8 EDD1     		bne	.L547
4887:Core/Src/FAT/ff.c **** 							i += 4;
 7595              		.loc 1 4887 55 is_stmt 1 discriminator 1 view .LVU2578
4887:Core/Src/FAT/ff.c **** 							i += 4;
 7596              		.loc 1 4887 60 is_stmt 0 discriminator 1 view .LVU2579
 7597 00ba 0136     		adds	r6, r6, #1
 7598              	.LVL896:
4887:Core/Src/FAT/ff.c **** 							i += 4;
 7599              		.loc 1 4887 60 discriminator 1 view .LVU2580
 7600 00bc EBE7     		b	.L547
 7601              	.LVL897:
 7602              	.L549:
4845:Core/Src/FAT/ff.c **** 					}
 7603              		.loc 1 4845 11 view .LVU2581
 7604 00be C846     		mov	r8, r9
 7605              	.LVL898:
 7606              	.L540:
4894:Core/Src/FAT/ff.c **** 				*nclst = nfree;			/* Return the free clusters */
 7607              		.loc 1 4894 4 is_stmt 1 view .LVU2582
4894:Core/Src/FAT/ff.c **** 				*nclst = nfree;			/* Return the free clusters */
 7608              		.loc 1 4894 7 is_stmt 0 view .LVU2583
 7609 00c0 B8F1000F 		cmp	r8, #0
 7610 00c4 B1D1     		bne	.L537
4895:Core/Src/FAT/ff.c **** 				fs->free_clst = nfree;	/* Now free_clst is valid */
 7611              		.loc 1 4895 5 is_stmt 1 view .LVU2584
4895:Core/Src/FAT/ff.c **** 				fs->free_clst = nfree;	/* Now free_clst is valid */
 7612              		.loc 1 4895 12 is_stmt 0 view .LVU2585
 7613 00c6 3E60     		str	r6, [r7]
4896:Core/Src/FAT/ff.c **** 				fs->fsi_flag |= 1;		/* FAT32: FSInfo is to be updated */
 7614              		.loc 1 4896 5 is_stmt 1 view .LVU2586
4896:Core/Src/FAT/ff.c **** 				fs->fsi_flag |= 1;		/* FAT32: FSInfo is to be updated */
 7615              		.loc 1 4896 7 is_stmt 0 view .LVU2587
 7616 00c8 079B     		ldr	r3, [sp, #28]
4896:Core/Src/FAT/ff.c **** 				fs->fsi_flag |= 1;		/* FAT32: FSInfo is to be updated */
 7617              		.loc 1 4896 19 view .LVU2588
 7618 00ca 1E61     		str	r6, [r3, #16]
4897:Core/Src/FAT/ff.c **** 			}
 7619              		.loc 1 4897 5 is_stmt 1 view .LVU2589
4897:Core/Src/FAT/ff.c **** 			}
 7620              		.loc 1 4897 18 is_stmt 0 view .LVU2590
 7621 00cc 5A79     		ldrb	r2, [r3, #5]	@ zero_extendqisi2
 7622 00ce 42F00102 		orr	r2, r2, #1
 7623 00d2 5A71     		strb	r2, [r3, #5]
 7624 00d4 A9E7     		b	.L537
 7625              	.LVL899:
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 277


 7626              	.L550:
4848:Core/Src/FAT/ff.c **** 					}
 7627              		.loc 1 4848 11 view .LVU2591
 7628 00d6 4FF00208 		mov	r8, #2
 7629 00da F1E7     		b	.L540
 7630              		.cfi_endproc
 7631              	.LFE43:
 7633              		.section	.text.f_truncate,"ax",%progbits
 7634              		.align	1
 7635              		.global	f_truncate
 7636              		.syntax unified
 7637              		.thumb
 7638              		.thumb_func
 7640              	f_truncate:
 7641              	.LVL900:
 7642              	.LFB44:
4915:Core/Src/FAT/ff.c **** 	FRESULT res;
 7643              		.loc 1 4915 1 is_stmt 1 view -0
 7644              		.cfi_startproc
 7645              		@ args = 0, pretend = 0, frame = 8
 7646              		@ frame_needed = 0, uses_anonymous_args = 0
4915:Core/Src/FAT/ff.c **** 	FRESULT res;
 7647              		.loc 1 4915 1 is_stmt 0 view .LVU2593
 7648 0000 30B5     		push	{r4, r5, lr}
 7649              	.LCFI83:
 7650              		.cfi_def_cfa_offset 12
 7651              		.cfi_offset 4, -12
 7652              		.cfi_offset 5, -8
 7653              		.cfi_offset 14, -4
 7654 0002 83B0     		sub	sp, sp, #12
 7655              	.LCFI84:
 7656              		.cfi_def_cfa_offset 24
 7657 0004 0446     		mov	r4, r0
4916:Core/Src/FAT/ff.c **** 	FATFS *fs;
 7658              		.loc 1 4916 2 is_stmt 1 view .LVU2594
4917:Core/Src/FAT/ff.c **** 	DWORD ncl;
 7659              		.loc 1 4917 2 view .LVU2595
4918:Core/Src/FAT/ff.c **** 
 7660              		.loc 1 4918 2 view .LVU2596
4921:Core/Src/FAT/ff.c **** 	if (res != FR_OK || (res = (FRESULT)fp->err) != FR_OK) LEAVE_FF(fs, res);
 7661              		.loc 1 4921 2 view .LVU2597
4921:Core/Src/FAT/ff.c **** 	if (res != FR_OK || (res = (FRESULT)fp->err) != FR_OK) LEAVE_FF(fs, res);
 7662              		.loc 1 4921 8 is_stmt 0 view .LVU2598
 7663 0006 01A9     		add	r1, sp, #4
 7664 0008 FFF7FEFF 		bl	validate
 7665              	.LVL901:
4922:Core/Src/FAT/ff.c **** 	if (!(fp->flag & FA_WRITE)) LEAVE_FF(fs, FR_DENIED);	/* Check access mode */
 7666              		.loc 1 4922 2 is_stmt 1 view .LVU2599
4922:Core/Src/FAT/ff.c **** 	if (!(fp->flag & FA_WRITE)) LEAVE_FF(fs, FR_DENIED);	/* Check access mode */
 7667              		.loc 1 4922 5 is_stmt 0 view .LVU2600
 7668 000c 0546     		mov	r5, r0
 7669 000e E8B9     		cbnz	r0, .L558
4922:Core/Src/FAT/ff.c **** 	if (!(fp->flag & FA_WRITE)) LEAVE_FF(fs, FR_DENIED);	/* Check access mode */
 7670              		.loc 1 4922 27 discriminator 2 view .LVU2601
 7671 0010 657C     		ldrb	r5, [r4, #17]	@ zero_extendqisi2
 7672              	.LVL902:
4922:Core/Src/FAT/ff.c **** 	if (!(fp->flag & FA_WRITE)) LEAVE_FF(fs, FR_DENIED);	/* Check access mode */
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 278


 7673              		.loc 1 4922 19 discriminator 2 view .LVU2602
 7674 0012 DDB9     		cbnz	r5, .L558
4923:Core/Src/FAT/ff.c **** 
 7675              		.loc 1 4923 2 is_stmt 1 view .LVU2603
4923:Core/Src/FAT/ff.c **** 
 7676              		.loc 1 4923 10 is_stmt 0 view .LVU2604
 7677 0014 237C     		ldrb	r3, [r4, #16]	@ zero_extendqisi2
4923:Core/Src/FAT/ff.c **** 
 7678              		.loc 1 4923 5 view .LVU2605
 7679 0016 13F0020F 		tst	r3, #2
 7680 001a 45D0     		beq	.L564
4925:Core/Src/FAT/ff.c **** 		if (fp->fptr == 0) {	/* When set file size to zero, remove entire cluster chain */
 7681              		.loc 1 4925 2 is_stmt 1 view .LVU2606
4925:Core/Src/FAT/ff.c **** 		if (fp->fptr == 0) {	/* When set file size to zero, remove entire cluster chain */
 7682              		.loc 1 4925 8 is_stmt 0 view .LVU2607
 7683 001c 6369     		ldr	r3, [r4, #20]
4925:Core/Src/FAT/ff.c **** 		if (fp->fptr == 0) {	/* When set file size to zero, remove entire cluster chain */
 7684              		.loc 1 4925 24 view .LVU2608
 7685 001e E268     		ldr	r2, [r4, #12]
4925:Core/Src/FAT/ff.c **** 		if (fp->fptr == 0) {	/* When set file size to zero, remove entire cluster chain */
 7686              		.loc 1 4925 5 view .LVU2609
 7687 0020 9342     		cmp	r3, r2
 7688 0022 13D2     		bcs	.L558
4926:Core/Src/FAT/ff.c **** 			res = remove_chain(&fp->obj, fp->obj.sclust, 0);
 7689              		.loc 1 4926 3 is_stmt 1 view .LVU2610
4926:Core/Src/FAT/ff.c **** 			res = remove_chain(&fp->obj, fp->obj.sclust, 0);
 7690              		.loc 1 4926 6 is_stmt 0 view .LVU2611
 7691 0024 ABB9     		cbnz	r3, .L559
4927:Core/Src/FAT/ff.c **** 			fp->obj.sclust = 0;
 7692              		.loc 1 4927 4 is_stmt 1 view .LVU2612
4927:Core/Src/FAT/ff.c **** 			fp->obj.sclust = 0;
 7693              		.loc 1 4927 10 is_stmt 0 view .LVU2613
 7694 0026 0022     		movs	r2, #0
 7695 0028 A168     		ldr	r1, [r4, #8]
 7696 002a 2046     		mov	r0, r4
 7697 002c FFF7FEFF 		bl	remove_chain
 7698              	.LVL903:
 7699 0030 0546     		mov	r5, r0
 7700              	.LVL904:
4928:Core/Src/FAT/ff.c **** 		} else {				/* When truncate a part of the file, remove remaining clusters */
 7701              		.loc 1 4928 4 is_stmt 1 view .LVU2614
4928:Core/Src/FAT/ff.c **** 		} else {				/* When truncate a part of the file, remove remaining clusters */
 7702              		.loc 1 4928 19 is_stmt 0 view .LVU2615
 7703 0032 0023     		movs	r3, #0
 7704 0034 A360     		str	r3, [r4, #8]
 7705              	.LVL905:
 7706              	.L560:
4938:Core/Src/FAT/ff.c **** 		fp->flag |= FA_MODIFIED;
 7707              		.loc 1 4938 3 is_stmt 1 view .LVU2616
4938:Core/Src/FAT/ff.c **** 		fp->flag |= FA_MODIFIED;
 7708              		.loc 1 4938 23 is_stmt 0 view .LVU2617
 7709 0036 6369     		ldr	r3, [r4, #20]
4938:Core/Src/FAT/ff.c **** 		fp->flag |= FA_MODIFIED;
 7710              		.loc 1 4938 19 view .LVU2618
 7711 0038 E360     		str	r3, [r4, #12]
4939:Core/Src/FAT/ff.c **** #if !FF_FS_TINY
 7712              		.loc 1 4939 3 is_stmt 1 view .LVU2619
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 279


4939:Core/Src/FAT/ff.c **** #if !FF_FS_TINY
 7713              		.loc 1 4939 12 is_stmt 0 view .LVU2620
 7714 003a 237C     		ldrb	r3, [r4, #16]	@ zero_extendqisi2
 7715 003c 43F04003 		orr	r3, r3, #64
 7716 0040 2374     		strb	r3, [r4, #16]
4941:Core/Src/FAT/ff.c **** 			if (disk_write(fs->pdrv, fp->buf, fp->sect, 1) != RES_OK) {
 7717              		.loc 1 4941 3 is_stmt 1 view .LVU2621
4941:Core/Src/FAT/ff.c **** 			if (disk_write(fs->pdrv, fp->buf, fp->sect, 1) != RES_OK) {
 7718              		.loc 1 4941 6 is_stmt 0 view .LVU2622
 7719 0042 15B9     		cbnz	r5, .L562
4941:Core/Src/FAT/ff.c **** 			if (disk_write(fs->pdrv, fp->buf, fp->sect, 1) != RES_OK) {
 7720              		.loc 1 4941 20 discriminator 1 view .LVU2623
 7721 0044 13F0800F 		tst	r3, #128
 7722 0048 1DD1     		bne	.L569
 7723              	.L562:
4949:Core/Src/FAT/ff.c **** 	}
 7724              		.loc 1 4949 3 is_stmt 1 view .LVU2624
4949:Core/Src/FAT/ff.c **** 	}
 7725              		.loc 1 4949 6 is_stmt 0 view .LVU2625
 7726 004a 5DBB     		cbnz	r5, .L563
 7727              	.LVL906:
 7728              	.L558:
4953:Core/Src/FAT/ff.c **** 
 7729              		.loc 1 4953 1 view .LVU2626
 7730 004c 2846     		mov	r0, r5
 7731 004e 03B0     		add	sp, sp, #12
 7732              	.LCFI85:
 7733              		.cfi_remember_state
 7734              		.cfi_def_cfa_offset 12
 7735              		@ sp needed
 7736 0050 30BD     		pop	{r4, r5, pc}
 7737              	.LVL907:
 7738              	.L559:
 7739              	.LCFI86:
 7740              		.cfi_restore_state
4930:Core/Src/FAT/ff.c **** 			res = FR_OK;
 7741              		.loc 1 4930 4 is_stmt 1 view .LVU2627
4930:Core/Src/FAT/ff.c **** 			res = FR_OK;
 7742              		.loc 1 4930 10 is_stmt 0 view .LVU2628
 7743 0052 A169     		ldr	r1, [r4, #24]
 7744 0054 2046     		mov	r0, r4
 7745 0056 FFF7FEFF 		bl	get_fat
 7746              	.LVL908:
4931:Core/Src/FAT/ff.c **** 			if (ncl == 0xFFFFFFFF) res = FR_DISK_ERR;
 7747              		.loc 1 4931 4 is_stmt 1 view .LVU2629
4932:Core/Src/FAT/ff.c **** 			if (ncl == 1) res = FR_INT_ERR;
 7748              		.loc 1 4932 4 view .LVU2630
4932:Core/Src/FAT/ff.c **** 			if (ncl == 1) res = FR_INT_ERR;
 7749              		.loc 1 4932 7 is_stmt 0 view .LVU2631
 7750 005a B0F1FF3F 		cmp	r0, #-1
 7751 005e 0ED0     		beq	.L570
 7752              	.L561:
 7753              	.LVL909:
4933:Core/Src/FAT/ff.c **** 			if (res == FR_OK && ncl < fs->n_fatent) {
 7754              		.loc 1 4933 4 is_stmt 1 view .LVU2632
4933:Core/Src/FAT/ff.c **** 			if (res == FR_OK && ncl < fs->n_fatent) {
 7755              		.loc 1 4933 7 is_stmt 0 view .LVU2633
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 280


 7756 0060 0128     		cmp	r0, #1
 7757 0062 0ED0     		beq	.L566
4934:Core/Src/FAT/ff.c **** 				res = remove_chain(&fp->obj, ncl, fp->clust);
 7758              		.loc 1 4934 4 is_stmt 1 view .LVU2634
4934:Core/Src/FAT/ff.c **** 				res = remove_chain(&fp->obj, ncl, fp->clust);
 7759              		.loc 1 4934 7 is_stmt 0 view .LVU2635
 7760 0064 002D     		cmp	r5, #0
 7761 0066 E6D1     		bne	.L560
4934:Core/Src/FAT/ff.c **** 				res = remove_chain(&fp->obj, ncl, fp->clust);
 7762              		.loc 1 4934 32 discriminator 1 view .LVU2636
 7763 0068 019B     		ldr	r3, [sp, #4]
 7764 006a 5B69     		ldr	r3, [r3, #20]
4934:Core/Src/FAT/ff.c **** 				res = remove_chain(&fp->obj, ncl, fp->clust);
 7765              		.loc 1 4934 21 discriminator 1 view .LVU2637
 7766 006c 8342     		cmp	r3, r0
 7767 006e E2D9     		bls	.L560
4935:Core/Src/FAT/ff.c **** 			}
 7768              		.loc 1 4935 5 is_stmt 1 view .LVU2638
4935:Core/Src/FAT/ff.c **** 			}
 7769              		.loc 1 4935 11 is_stmt 0 view .LVU2639
 7770 0070 A269     		ldr	r2, [r4, #24]
 7771 0072 0146     		mov	r1, r0
 7772 0074 2046     		mov	r0, r4
 7773              	.LVL910:
4935:Core/Src/FAT/ff.c **** 			}
 7774              		.loc 1 4935 11 view .LVU2640
 7775 0076 FFF7FEFF 		bl	remove_chain
 7776              	.LVL911:
4935:Core/Src/FAT/ff.c **** 			}
 7777              		.loc 1 4935 11 view .LVU2641
 7778 007a 0546     		mov	r5, r0
 7779              	.LVL912:
4935:Core/Src/FAT/ff.c **** 			}
 7780              		.loc 1 4935 11 view .LVU2642
 7781 007c DBE7     		b	.L560
 7782              	.LVL913:
 7783              	.L570:
4932:Core/Src/FAT/ff.c **** 			if (ncl == 1) res = FR_INT_ERR;
 7784              		.loc 1 4932 31 view .LVU2643
 7785 007e 0125     		movs	r5, #1
 7786 0080 EEE7     		b	.L561
 7787              	.LVL914:
 7788              	.L566:
4933:Core/Src/FAT/ff.c **** 			if (res == FR_OK && ncl < fs->n_fatent) {
 7789              		.loc 1 4933 22 view .LVU2644
 7790 0082 0225     		movs	r5, #2
 7791              	.LVL915:
4933:Core/Src/FAT/ff.c **** 			if (res == FR_OK && ncl < fs->n_fatent) {
 7792              		.loc 1 4933 22 view .LVU2645
 7793 0084 D7E7     		b	.L560
 7794              	.LVL916:
 7795              	.L569:
4942:Core/Src/FAT/ff.c **** 				res = FR_DISK_ERR;
 7796              		.loc 1 4942 4 is_stmt 1 view .LVU2646
4942:Core/Src/FAT/ff.c **** 				res = FR_DISK_ERR;
 7797              		.loc 1 4942 8 is_stmt 0 view .LVU2647
 7798 0086 0123     		movs	r3, #1
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 281


 7799 0088 E269     		ldr	r2, [r4, #28]
 7800 008a 04F12801 		add	r1, r4, #40
 7801 008e 0198     		ldr	r0, [sp, #4]
 7802 0090 4078     		ldrb	r0, [r0, #1]	@ zero_extendqisi2
 7803 0092 FFF7FEFF 		bl	disk_write
 7804              	.LVL917:
4942:Core/Src/FAT/ff.c **** 				res = FR_DISK_ERR;
 7805              		.loc 1 4942 7 view .LVU2648
 7806 0096 20B9     		cbnz	r0, .L567
4945:Core/Src/FAT/ff.c **** 			}
 7807              		.loc 1 4945 5 is_stmt 1 view .LVU2649
4945:Core/Src/FAT/ff.c **** 			}
 7808              		.loc 1 4945 14 is_stmt 0 view .LVU2650
 7809 0098 237C     		ldrb	r3, [r4, #16]	@ zero_extendqisi2
 7810 009a 03F07F03 		and	r3, r3, #127
 7811 009e 2374     		strb	r3, [r4, #16]
 7812 00a0 D3E7     		b	.L562
 7813              	.L567:
4943:Core/Src/FAT/ff.c **** 			} else {
 7814              		.loc 1 4943 9 view .LVU2651
 7815 00a2 0125     		movs	r5, #1
 7816              	.LVL918:
 7817              	.L563:
4949:Core/Src/FAT/ff.c **** 	}
 7818              		.loc 1 4949 21 is_stmt 1 discriminator 1 view .LVU2652
 7819 00a4 6574     		strb	r5, [r4, #17]
4949:Core/Src/FAT/ff.c **** 	}
 7820              		.loc 1 4949 21 discriminator 1 view .LVU2653
 7821 00a6 D1E7     		b	.L558
 7822              	.LVL919:
 7823              	.L564:
4923:Core/Src/FAT/ff.c **** 
 7824              		.loc 1 4923 30 is_stmt 0 view .LVU2654
 7825 00a8 0725     		movs	r5, #7
 7826              	.LVL920:
4923:Core/Src/FAT/ff.c **** 
 7827              		.loc 1 4923 30 view .LVU2655
 7828 00aa CFE7     		b	.L558
 7829              		.cfi_endproc
 7830              	.LFE44:
 7832              		.section	.text.f_unlink,"ax",%progbits
 7833              		.align	1
 7834              		.global	f_unlink
 7835              		.syntax unified
 7836              		.thumb
 7837              		.thumb_func
 7839              	f_unlink:
 7840              	.LVL921:
 7841              	.LFB45:
4965:Core/Src/FAT/ff.c **** 	FRESULT res;
 7842              		.loc 1 4965 1 is_stmt 1 view -0
 7843              		.cfi_startproc
 7844              		@ args = 0, pretend = 0, frame = 104
 7845              		@ frame_needed = 0, uses_anonymous_args = 0
4965:Core/Src/FAT/ff.c **** 	FRESULT res;
 7846              		.loc 1 4965 1 is_stmt 0 view .LVU2657
 7847 0000 F0B5     		push	{r4, r5, r6, r7, lr}
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 282


 7848              	.LCFI87:
 7849              		.cfi_def_cfa_offset 20
 7850              		.cfi_offset 4, -20
 7851              		.cfi_offset 5, -16
 7852              		.cfi_offset 6, -12
 7853              		.cfi_offset 7, -8
 7854              		.cfi_offset 14, -4
 7855 0002 9BB0     		sub	sp, sp, #108
 7856              	.LCFI88:
 7857              		.cfi_def_cfa_offset 128
 7858 0004 0190     		str	r0, [sp, #4]
4966:Core/Src/FAT/ff.c **** 	FATFS *fs;
 7859              		.loc 1 4966 2 is_stmt 1 view .LVU2658
4967:Core/Src/FAT/ff.c **** 	DIR dj, sdj;
 7860              		.loc 1 4967 2 view .LVU2659
4968:Core/Src/FAT/ff.c **** 	DWORD dclst = 0;
 7861              		.loc 1 4968 2 view .LVU2660
4969:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT
 7862              		.loc 1 4969 2 view .LVU2661
 7863              	.LVL922:
4977:Core/Src/FAT/ff.c **** 	if (res == FR_OK) {
 7864              		.loc 1 4977 2 view .LVU2662
4977:Core/Src/FAT/ff.c **** 	if (res == FR_OK) {
 7865              		.loc 1 4977 8 is_stmt 0 view .LVU2663
 7866 0006 0222     		movs	r2, #2
 7867 0008 19A9     		add	r1, sp, #100
 7868 000a 01A8     		add	r0, sp, #4
 7869              	.LVL923:
4977:Core/Src/FAT/ff.c **** 	if (res == FR_OK) {
 7870              		.loc 1 4977 8 view .LVU2664
 7871 000c FFF7FEFF 		bl	mount_volume
 7872              	.LVL924:
4978:Core/Src/FAT/ff.c **** 		dj.obj.fs = fs;
 7873              		.loc 1 4978 2 is_stmt 1 view .LVU2665
4978:Core/Src/FAT/ff.c **** 		dj.obj.fs = fs;
 7874              		.loc 1 4978 5 is_stmt 0 view .LVU2666
 7875 0010 0446     		mov	r4, r0
 7876 0012 10B1     		cbz	r0, .L580
 7877              	.LVL925:
 7878              	.L572:
5043:Core/Src/FAT/ff.c **** 	}
 7879              		.loc 1 5043 16 is_stmt 1 view .LVU2667
5046:Core/Src/FAT/ff.c **** }
 7880              		.loc 1 5046 2 view .LVU2668
5047:Core/Src/FAT/ff.c **** 
 7881              		.loc 1 5047 1 is_stmt 0 view .LVU2669
 7882 0014 2046     		mov	r0, r4
 7883 0016 1BB0     		add	sp, sp, #108
 7884              	.LCFI89:
 7885              		.cfi_remember_state
 7886              		.cfi_def_cfa_offset 20
 7887              		@ sp needed
 7888 0018 F0BD     		pop	{r4, r5, r6, r7, pc}
 7889              	.LVL926:
 7890              	.L580:
 7891              	.LCFI90:
 7892              		.cfi_restore_state
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 283


4979:Core/Src/FAT/ff.c **** 		INIT_NAMBUF(fs);
 7893              		.loc 1 4979 3 is_stmt 1 view .LVU2670
4979:Core/Src/FAT/ff.c **** 		INIT_NAMBUF(fs);
 7894              		.loc 1 4979 13 is_stmt 0 view .LVU2671
 7895 001a 199B     		ldr	r3, [sp, #100]
 7896 001c 0E93     		str	r3, [sp, #56]
4980:Core/Src/FAT/ff.c **** 		res = follow_path(&dj, path);		/* Follow the file path */
 7897              		.loc 1 4980 18 is_stmt 1 view .LVU2672
4981:Core/Src/FAT/ff.c **** 		if (FF_FS_RPATH && res == FR_OK && (dj.fn[NSFLAG] & NS_DOT)) {
 7898              		.loc 1 4981 3 view .LVU2673
4981:Core/Src/FAT/ff.c **** 		if (FF_FS_RPATH && res == FR_OK && (dj.fn[NSFLAG] & NS_DOT)) {
 7899              		.loc 1 4981 9 is_stmt 0 view .LVU2674
 7900 001e 0199     		ldr	r1, [sp, #4]
 7901 0020 0EA8     		add	r0, sp, #56
 7902              	.LVL927:
4981:Core/Src/FAT/ff.c **** 		if (FF_FS_RPATH && res == FR_OK && (dj.fn[NSFLAG] & NS_DOT)) {
 7903              		.loc 1 4981 9 view .LVU2675
 7904 0022 FFF7FEFF 		bl	follow_path
 7905              	.LVL928:
4982:Core/Src/FAT/ff.c **** 			res = FR_INVALID_NAME;			/* Cannot remove dot entry */
 7906              		.loc 1 4982 3 is_stmt 1 view .LVU2676
4988:Core/Src/FAT/ff.c **** 			if (dj.fn[NSFLAG] & NS_NONAME) {
 7907              		.loc 1 4988 3 view .LVU2677
4988:Core/Src/FAT/ff.c **** 			if (dj.fn[NSFLAG] & NS_NONAME) {
 7908              		.loc 1 4988 6 is_stmt 0 view .LVU2678
 7909 0026 0446     		mov	r4, r0
 7910 0028 0028     		cmp	r0, #0
 7911 002a F3D1     		bne	.L572
4989:Core/Src/FAT/ff.c **** 				res = FR_INVALID_NAME;		/* Cannot remove the origin directory */
 7912              		.loc 1 4989 4 is_stmt 1 view .LVU2679
4989:Core/Src/FAT/ff.c **** 				res = FR_INVALID_NAME;		/* Cannot remove the origin directory */
 7913              		.loc 1 4989 8 is_stmt 0 view .LVU2680
 7914 002c 9DF96330 		ldrsb	r3, [sp, #99]
4989:Core/Src/FAT/ff.c **** 				res = FR_INVALID_NAME;		/* Cannot remove the origin directory */
 7915              		.loc 1 4989 7 view .LVU2681
 7916 0030 002B     		cmp	r3, #0
 7917 0032 1EDB     		blt	.L576
4992:Core/Src/FAT/ff.c **** 					res = FR_DENIED;		/* Cannot remove R/O object */
 7918              		.loc 1 4992 5 is_stmt 1 view .LVU2682
4992:Core/Src/FAT/ff.c **** 					res = FR_DENIED;		/* Cannot remove R/O object */
 7919              		.loc 1 4992 15 is_stmt 0 view .LVU2683
 7920 0034 9DF83E60 		ldrb	r6, [sp, #62]	@ zero_extendqisi2
4992:Core/Src/FAT/ff.c **** 					res = FR_DENIED;		/* Cannot remove R/O object */
 7921              		.loc 1 4992 8 view .LVU2684
 7922 0038 16F0010F 		tst	r6, #1
 7923 003c 2AD1     		bne	.L577
 7924              	.LVL929:
4996:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT
 7925              		.loc 1 4996 4 is_stmt 1 view .LVU2685
5005:Core/Src/FAT/ff.c **** 				}
 7926              		.loc 1 5005 6 view .LVU2686
5005:Core/Src/FAT/ff.c **** 				}
 7927              		.loc 1 5005 14 is_stmt 0 view .LVU2687
 7928 003e 199F     		ldr	r7, [sp, #100]
 7929 0040 1599     		ldr	r1, [sp, #84]
 7930 0042 3846     		mov	r0, r7
 7931 0044 FFF7FEFF 		bl	ld_clust
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 284


 7932              	.LVL930:
 7933 0048 0546     		mov	r5, r0
 7934              	.LVL931:
5007:Core/Src/FAT/ff.c **** #if FF_FS_RPATH != 0
 7935              		.loc 1 5007 5 is_stmt 1 view .LVU2688
5007:Core/Src/FAT/ff.c **** #if FF_FS_RPATH != 0
 7936              		.loc 1 5007 8 is_stmt 0 view .LVU2689
 7937 004a 16F0100F 		tst	r6, #16
 7938 004e 12D0     		beq	.L573
5014:Core/Src/FAT/ff.c **** 						sdj.obj.sclust = dclst;
 7939              		.loc 1 5014 7 is_stmt 1 view .LVU2690
5014:Core/Src/FAT/ff.c **** 						sdj.obj.sclust = dclst;
 7940              		.loc 1 5014 18 is_stmt 0 view .LVU2691
 7941 0050 0397     		str	r7, [sp, #12]
5015:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT
 7942              		.loc 1 5015 7 is_stmt 1 view .LVU2692
5015:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT
 7943              		.loc 1 5015 22 is_stmt 0 view .LVU2693
 7944 0052 0590     		str	r0, [sp, #20]
5022:Core/Src/FAT/ff.c **** 						if (res == FR_OK) {
 7945              		.loc 1 5022 7 is_stmt 1 view .LVU2694
5022:Core/Src/FAT/ff.c **** 						if (res == FR_OK) {
 7946              		.loc 1 5022 13 is_stmt 0 view .LVU2695
 7947 0054 0021     		movs	r1, #0
 7948 0056 03A8     		add	r0, sp, #12
 7949              	.LVL932:
5022:Core/Src/FAT/ff.c **** 						if (res == FR_OK) {
 7950              		.loc 1 5022 13 view .LVU2696
 7951 0058 FFF7FEFF 		bl	dir_sdi
 7952              	.LVL933:
5023:Core/Src/FAT/ff.c **** 							res = DIR_READ_FILE(&sdj);			/* Test if the directory is empty */
 7953              		.loc 1 5023 7 is_stmt 1 view .LVU2697
5023:Core/Src/FAT/ff.c **** 							res = DIR_READ_FILE(&sdj);			/* Test if the directory is empty */
 7954              		.loc 1 5023 10 is_stmt 0 view .LVU2698
 7955 005c 0446     		mov	r4, r0
 7956 005e 50B9     		cbnz	r0, .L573
5024:Core/Src/FAT/ff.c **** 							if (res == FR_OK) res = FR_DENIED;	/* Not empty? */
 7957              		.loc 1 5024 8 is_stmt 1 view .LVU2699
5024:Core/Src/FAT/ff.c **** 							if (res == FR_OK) res = FR_DENIED;	/* Not empty? */
 7958              		.loc 1 5024 14 is_stmt 0 view .LVU2700
 7959 0060 0021     		movs	r1, #0
 7960 0062 03A8     		add	r0, sp, #12
 7961              	.LVL934:
5024:Core/Src/FAT/ff.c **** 							if (res == FR_OK) res = FR_DENIED;	/* Not empty? */
 7962              		.loc 1 5024 14 view .LVU2701
 7963 0064 FFF7FEFF 		bl	dir_read
 7964              	.LVL935:
5025:Core/Src/FAT/ff.c **** 							if (res == FR_NO_FILE) res = FR_OK;	/* Empty? */
 7965              		.loc 1 5025 8 is_stmt 1 view .LVU2702
5025:Core/Src/FAT/ff.c **** 							if (res == FR_NO_FILE) res = FR_OK;	/* Empty? */
 7966              		.loc 1 5025 11 is_stmt 0 view .LVU2703
 7967 0068 0446     		mov	r4, r0
 7968 006a B0B1     		cbz	r0, .L578
5026:Core/Src/FAT/ff.c **** 						}
 7969              		.loc 1 5026 8 is_stmt 1 view .LVU2704
5026:Core/Src/FAT/ff.c **** 						}
 7970              		.loc 1 5026 11 is_stmt 0 view .LVU2705
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 285


 7971 006c 0428     		cmp	r0, #4
 7972 006e 02D1     		bne	.L573
 7973 0070 03E0     		b	.L574
 7974              	.LVL936:
 7975              	.L576:
4969:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT
 7976              		.loc 1 4969 8 view .LVU2706
 7977 0072 0025     		movs	r5, #0
4990:Core/Src/FAT/ff.c **** 			} else {
 7978              		.loc 1 4990 9 view .LVU2707
 7979 0074 0624     		movs	r4, #6
 7980              	.LVL937:
 7981              	.L573:
5031:Core/Src/FAT/ff.c **** 				res = dir_remove(&dj);			/* Remove the directory entry */
 7982              		.loc 1 5031 4 is_stmt 1 view .LVU2708
5031:Core/Src/FAT/ff.c **** 				res = dir_remove(&dj);			/* Remove the directory entry */
 7983              		.loc 1 5031 7 is_stmt 0 view .LVU2709
 7984 0076 002C     		cmp	r4, #0
 7985 0078 CCD1     		bne	.L572
 7986              	.LVL938:
 7987              	.L574:
5032:Core/Src/FAT/ff.c **** 				if (res == FR_OK && dclst != 0) {	/* Remove the cluster chain if exist */
 7988              		.loc 1 5032 5 is_stmt 1 view .LVU2710
5032:Core/Src/FAT/ff.c **** 				if (res == FR_OK && dclst != 0) {	/* Remove the cluster chain if exist */
 7989              		.loc 1 5032 11 is_stmt 0 view .LVU2711
 7990 007a 0EA8     		add	r0, sp, #56
 7991 007c FFF7FEFF 		bl	dir_remove
 7992              	.LVL939:
5033:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT
 7993              		.loc 1 5033 5 is_stmt 1 view .LVU2712
5033:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT
 7994              		.loc 1 5033 8 is_stmt 0 view .LVU2713
 7995 0080 0446     		mov	r4, r0
 7996 0082 00B9     		cbnz	r0, .L575
5033:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT
 7997              		.loc 1 5033 22 discriminator 1 view .LVU2714
 7998 0084 5DB9     		cbnz	r5, .L581
 7999              	.LVL940:
 8000              	.L575:
5040:Core/Src/FAT/ff.c **** 			}
 8001              		.loc 1 5040 5 is_stmt 1 view .LVU2715
5040:Core/Src/FAT/ff.c **** 			}
 8002              		.loc 1 5040 8 is_stmt 0 view .LVU2716
 8003 0086 002C     		cmp	r4, #0
 8004 0088 C4D1     		bne	.L572
5040:Core/Src/FAT/ff.c **** 			}
 8005              		.loc 1 5040 23 is_stmt 1 discriminator 1 view .LVU2717
5040:Core/Src/FAT/ff.c **** 			}
 8006              		.loc 1 5040 29 is_stmt 0 discriminator 1 view .LVU2718
 8007 008a 1998     		ldr	r0, [sp, #100]
 8008 008c FFF7FEFF 		bl	sync_fs
 8009              	.LVL941:
 8010 0090 0446     		mov	r4, r0
 8011              	.LVL942:
5040:Core/Src/FAT/ff.c **** 			}
 8012              		.loc 1 5040 29 discriminator 1 view .LVU2719
 8013 0092 BFE7     		b	.L572
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 286


 8014              	.LVL943:
 8015              	.L577:
4969:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT
 8016              		.loc 1 4969 8 view .LVU2720
 8017 0094 0025     		movs	r5, #0
4993:Core/Src/FAT/ff.c **** 				}
 8018              		.loc 1 4993 10 view .LVU2721
 8019 0096 0724     		movs	r4, #7
 8020 0098 EDE7     		b	.L573
 8021              	.LVL944:
 8022              	.L578:
5025:Core/Src/FAT/ff.c **** 							if (res == FR_NO_FILE) res = FR_OK;	/* Empty? */
 8023              		.loc 1 5025 30 view .LVU2722
 8024 009a 0724     		movs	r4, #7
 8025 009c EBE7     		b	.L573
 8026              	.LVL945:
 8027              	.L581:
5037:Core/Src/FAT/ff.c **** #endif
 8028              		.loc 1 5037 6 is_stmt 1 view .LVU2723
5037:Core/Src/FAT/ff.c **** #endif
 8029              		.loc 1 5037 12 is_stmt 0 view .LVU2724
 8030 009e 0022     		movs	r2, #0
 8031 00a0 2946     		mov	r1, r5
 8032 00a2 0EA8     		add	r0, sp, #56
 8033              	.LVL946:
5037:Core/Src/FAT/ff.c **** #endif
 8034              		.loc 1 5037 12 view .LVU2725
 8035 00a4 FFF7FEFF 		bl	remove_chain
 8036              	.LVL947:
 8037 00a8 0446     		mov	r4, r0
 8038              	.LVL948:
5037:Core/Src/FAT/ff.c **** #endif
 8039              		.loc 1 5037 12 view .LVU2726
 8040 00aa ECE7     		b	.L575
 8041              		.cfi_endproc
 8042              	.LFE45:
 8044              		.section	.text.f_mkdir,"ax",%progbits
 8045              		.align	1
 8046              		.global	f_mkdir
 8047              		.syntax unified
 8048              		.thumb
 8049              		.thumb_func
 8051              	f_mkdir:
 8052              	.LVL949:
 8053              	.LFB46:
5059:Core/Src/FAT/ff.c **** 	FRESULT res;
 8054              		.loc 1 5059 1 is_stmt 1 view -0
 8055              		.cfi_startproc
 8056              		@ args = 0, pretend = 0, frame = 72
 8057              		@ frame_needed = 0, uses_anonymous_args = 0
5059:Core/Src/FAT/ff.c **** 	FRESULT res;
 8058              		.loc 1 5059 1 is_stmt 0 view .LVU2728
 8059 0000 70B5     		push	{r4, r5, r6, lr}
 8060              	.LCFI91:
 8061              		.cfi_def_cfa_offset 16
 8062              		.cfi_offset 4, -16
 8063              		.cfi_offset 5, -12
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 287


 8064              		.cfi_offset 6, -8
 8065              		.cfi_offset 14, -4
 8066 0002 92B0     		sub	sp, sp, #72
 8067              	.LCFI92:
 8068              		.cfi_def_cfa_offset 88
 8069 0004 0190     		str	r0, [sp, #4]
5060:Core/Src/FAT/ff.c **** 	FATFS *fs;
 8070              		.loc 1 5060 2 is_stmt 1 view .LVU2729
5061:Core/Src/FAT/ff.c **** 	DIR dj;
 8071              		.loc 1 5061 2 view .LVU2730
5062:Core/Src/FAT/ff.c **** 	FFOBJID sobj;
 8072              		.loc 1 5062 2 view .LVU2731
5063:Core/Src/FAT/ff.c **** 	DWORD dcl, pcl, tm;
 8073              		.loc 1 5063 2 view .LVU2732
5064:Core/Src/FAT/ff.c **** 	DEF_NAMBUF
 8074              		.loc 1 5064 2 view .LVU2733
5068:Core/Src/FAT/ff.c **** 	if (res == FR_OK) {
 8075              		.loc 1 5068 2 view .LVU2734
5068:Core/Src/FAT/ff.c **** 	if (res == FR_OK) {
 8076              		.loc 1 5068 8 is_stmt 0 view .LVU2735
 8077 0006 0222     		movs	r2, #2
 8078 0008 11A9     		add	r1, sp, #68
 8079 000a 01A8     		add	r0, sp, #4
 8080              	.LVL950:
5068:Core/Src/FAT/ff.c **** 	if (res == FR_OK) {
 8081              		.loc 1 5068 8 view .LVU2736
 8082 000c FFF7FEFF 		bl	mount_volume
 8083              	.LVL951:
5069:Core/Src/FAT/ff.c **** 		dj.obj.fs = fs;
 8084              		.loc 1 5069 2 is_stmt 1 view .LVU2737
5069:Core/Src/FAT/ff.c **** 		dj.obj.fs = fs;
 8085              		.loc 1 5069 5 is_stmt 0 view .LVU2738
 8086 0010 0446     		mov	r4, r0
 8087 0012 10B1     		cbz	r0, .L595
 8088              	.LVL952:
 8089              	.L583:
5127:Core/Src/FAT/ff.c **** 	}
 8090              		.loc 1 5127 16 is_stmt 1 view .LVU2739
5130:Core/Src/FAT/ff.c **** }
 8091              		.loc 1 5130 2 view .LVU2740
5131:Core/Src/FAT/ff.c **** 
 8092              		.loc 1 5131 1 is_stmt 0 view .LVU2741
 8093 0014 2046     		mov	r0, r4
 8094 0016 12B0     		add	sp, sp, #72
 8095              	.LCFI93:
 8096              		.cfi_remember_state
 8097              		.cfi_def_cfa_offset 16
 8098              		@ sp needed
 8099 0018 70BD     		pop	{r4, r5, r6, pc}
 8100              	.LVL953:
 8101              	.L595:
 8102              	.LCFI94:
 8103              		.cfi_restore_state
5070:Core/Src/FAT/ff.c **** 		INIT_NAMBUF(fs);
 8104              		.loc 1 5070 3 is_stmt 1 view .LVU2742
5070:Core/Src/FAT/ff.c **** 		INIT_NAMBUF(fs);
 8105              		.loc 1 5070 13 is_stmt 0 view .LVU2743
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 288


 8106 001a 119B     		ldr	r3, [sp, #68]
 8107 001c 0693     		str	r3, [sp, #24]
5071:Core/Src/FAT/ff.c **** 		res = follow_path(&dj, path);			/* Follow the file path */
 8108              		.loc 1 5071 18 is_stmt 1 view .LVU2744
5072:Core/Src/FAT/ff.c **** 		if (res == FR_OK) res = FR_EXIST;		/* Name collision? */
 8109              		.loc 1 5072 3 view .LVU2745
5072:Core/Src/FAT/ff.c **** 		if (res == FR_OK) res = FR_EXIST;		/* Name collision? */
 8110              		.loc 1 5072 9 is_stmt 0 view .LVU2746
 8111 001e 0199     		ldr	r1, [sp, #4]
 8112 0020 06A8     		add	r0, sp, #24
 8113              	.LVL954:
5072:Core/Src/FAT/ff.c **** 		if (res == FR_OK) res = FR_EXIST;		/* Name collision? */
 8114              		.loc 1 5072 9 view .LVU2747
 8115 0022 FFF7FEFF 		bl	follow_path
 8116              	.LVL955:
5073:Core/Src/FAT/ff.c **** 		if (FF_FS_RPATH && res == FR_NO_FILE && (dj.fn[NSFLAG] & NS_DOT)) {	/* Invalid name? */
 8117              		.loc 1 5073 3 is_stmt 1 view .LVU2748
5073:Core/Src/FAT/ff.c **** 		if (FF_FS_RPATH && res == FR_NO_FILE && (dj.fn[NSFLAG] & NS_DOT)) {	/* Invalid name? */
 8118              		.loc 1 5073 6 is_stmt 0 view .LVU2749
 8119 0026 0028     		cmp	r0, #0
 8120 0028 77D0     		beq	.L589
5074:Core/Src/FAT/ff.c **** 			res = FR_INVALID_NAME;
 8121              		.loc 1 5074 3 is_stmt 1 view .LVU2750
5077:Core/Src/FAT/ff.c **** 			sobj.fs = fs;						/* New object id to create a new chain */
 8122              		.loc 1 5077 3 view .LVU2751
5077:Core/Src/FAT/ff.c **** 			sobj.fs = fs;						/* New object id to create a new chain */
 8123              		.loc 1 5077 6 is_stmt 0 view .LVU2752
 8124 002a 0428     		cmp	r0, #4
 8125 002c 01D0     		beq	.L596
5072:Core/Src/FAT/ff.c **** 		if (res == FR_OK) res = FR_EXIST;		/* Name collision? */
 8126              		.loc 1 5072 9 view .LVU2753
 8127 002e 0446     		mov	r4, r0
 8128 0030 F0E7     		b	.L583
 8129              	.L596:
5078:Core/Src/FAT/ff.c **** 			dcl = create_chain(&sobj, 0);		/* Allocate a cluster for the new directory */
 8130              		.loc 1 5078 4 is_stmt 1 view .LVU2754
5078:Core/Src/FAT/ff.c **** 			dcl = create_chain(&sobj, 0);		/* Allocate a cluster for the new directory */
 8131              		.loc 1 5078 12 is_stmt 0 view .LVU2755
 8132 0032 119B     		ldr	r3, [sp, #68]
 8133 0034 0293     		str	r3, [sp, #8]
5079:Core/Src/FAT/ff.c **** 			res = FR_OK;
 8134              		.loc 1 5079 4 is_stmt 1 view .LVU2756
5079:Core/Src/FAT/ff.c **** 			res = FR_OK;
 8135              		.loc 1 5079 10 is_stmt 0 view .LVU2757
 8136 0036 0021     		movs	r1, #0
 8137 0038 02A8     		add	r0, sp, #8
 8138              	.LVL956:
5079:Core/Src/FAT/ff.c **** 			res = FR_OK;
 8139              		.loc 1 5079 10 view .LVU2758
 8140 003a FFF7FEFF 		bl	create_chain
 8141              	.LVL957:
5080:Core/Src/FAT/ff.c **** 			if (dcl == 0) res = FR_DENIED;		/* No space to allocate a new cluster? */
 8142              		.loc 1 5080 4 is_stmt 1 view .LVU2759
5081:Core/Src/FAT/ff.c **** 			if (dcl == 1) res = FR_INT_ERR;		/* Any insanity? */
 8143              		.loc 1 5081 4 view .LVU2760
5081:Core/Src/FAT/ff.c **** 			if (dcl == 1) res = FR_INT_ERR;		/* Any insanity? */
 8144              		.loc 1 5081 7 is_stmt 0 view .LVU2761
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 289


 8145 003e 0546     		mov	r5, r0
 8146 0040 00B9     		cbnz	r0, .L584
5081:Core/Src/FAT/ff.c **** 			if (dcl == 1) res = FR_INT_ERR;		/* Any insanity? */
 8147              		.loc 1 5081 22 view .LVU2762
 8148 0042 0724     		movs	r4, #7
 8149              	.L584:
 8150              	.LVL958:
5082:Core/Src/FAT/ff.c **** 			if (dcl == 0xFFFFFFFF) res = FR_DISK_ERR;	/* Disk error? */
 8151              		.loc 1 5082 4 is_stmt 1 view .LVU2763
5082:Core/Src/FAT/ff.c **** 			if (dcl == 0xFFFFFFFF) res = FR_DISK_ERR;	/* Disk error? */
 8152              		.loc 1 5082 7 is_stmt 0 view .LVU2764
 8153 0044 012D     		cmp	r5, #1
 8154 0046 1CD0     		beq	.L597
 8155              	.LVL959:
 8156              	.L585:
5083:Core/Src/FAT/ff.c **** 			tm = GET_FATTIME();
 8157              		.loc 1 5083 4 is_stmt 1 view .LVU2765
5083:Core/Src/FAT/ff.c **** 			tm = GET_FATTIME();
 8158              		.loc 1 5083 7 is_stmt 0 view .LVU2766
 8159 0048 B5F1FF3F 		cmp	r5, #-1
 8160 004c 1BD0     		beq	.L598
 8161              	.LVL960:
 8162              	.L586:
5084:Core/Src/FAT/ff.c **** 			if (res == FR_OK) {
 8163              		.loc 1 5084 4 is_stmt 1 view .LVU2767
5084:Core/Src/FAT/ff.c **** 			if (res == FR_OK) {
 8164              		.loc 1 5084 9 is_stmt 0 view .LVU2768
 8165 004e FFF7FEFF 		bl	get_fattime
 8166              	.LVL961:
5084:Core/Src/FAT/ff.c **** 			if (res == FR_OK) {
 8167              		.loc 1 5084 9 view .LVU2769
 8168 0052 0646     		mov	r6, r0
 8169              	.LVL962:
5085:Core/Src/FAT/ff.c **** 				res = dir_clear(fs, dcl);		/* Clean up the new table */
 8170              		.loc 1 5085 4 is_stmt 1 view .LVU2770
5085:Core/Src/FAT/ff.c **** 				res = dir_clear(fs, dcl);		/* Clean up the new table */
 8171              		.loc 1 5085 7 is_stmt 0 view .LVU2771
 8172 0054 CCB1     		cbz	r4, .L599
 8173              	.LVL963:
 8174              	.L587:
5102:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT
 8175              		.loc 1 5102 4 is_stmt 1 view .LVU2772
5102:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT
 8176              		.loc 1 5102 7 is_stmt 0 view .LVU2773
 8177 0056 002C     		cmp	r4, #0
 8178 0058 59D1     		bne	.L588
5115:Core/Src/FAT/ff.c **** 					st_clust(fs, dj.dir, dcl);			/* Table start cluster */
 8179              		.loc 1 5115 6 is_stmt 1 view .LVU2774
 8180 005a 3146     		mov	r1, r6
 8181 005c 0D98     		ldr	r0, [sp, #52]
 8182 005e 1630     		adds	r0, r0, #22
 8183 0060 FFF7FEFF 		bl	st_dword
 8184              	.LVL964:
5116:Core/Src/FAT/ff.c **** 					dj.dir[DIR_Attr] = AM_DIR;			/* Attribute */
 8185              		.loc 1 5116 6 view .LVU2775
 8186 0064 2A46     		mov	r2, r5
 8187 0066 0D99     		ldr	r1, [sp, #52]
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 290


 8188 0068 1198     		ldr	r0, [sp, #68]
 8189 006a FFF7FEFF 		bl	st_clust
 8190              	.LVL965:
5117:Core/Src/FAT/ff.c **** 					fs->wflag = 1;
 8191              		.loc 1 5117 6 view .LVU2776
5117:Core/Src/FAT/ff.c **** 					fs->wflag = 1;
 8192              		.loc 1 5117 23 is_stmt 0 view .LVU2777
 8193 006e 0D9B     		ldr	r3, [sp, #52]
 8194 0070 1022     		movs	r2, #16
 8195 0072 DA72     		strb	r2, [r3, #11]
5118:Core/Src/FAT/ff.c **** 				}
 8196              		.loc 1 5118 6 is_stmt 1 view .LVU2778
5118:Core/Src/FAT/ff.c **** 				}
 8197              		.loc 1 5118 8 is_stmt 0 view .LVU2779
 8198 0074 1198     		ldr	r0, [sp, #68]
5118:Core/Src/FAT/ff.c **** 				}
 8199              		.loc 1 5118 16 view .LVU2780
 8200 0076 0123     		movs	r3, #1
 8201 0078 0371     		strb	r3, [r0, #4]
5120:Core/Src/FAT/ff.c **** 					res = sync_fs(fs);
 8202              		.loc 1 5120 5 is_stmt 1 view .LVU2781
5121:Core/Src/FAT/ff.c **** 				}
 8203              		.loc 1 5121 6 view .LVU2782
5121:Core/Src/FAT/ff.c **** 				}
 8204              		.loc 1 5121 12 is_stmt 0 view .LVU2783
 8205 007a FFF7FEFF 		bl	sync_fs
 8206              	.LVL966:
 8207 007e 0446     		mov	r4, r0
 8208              	.LVL967:
5121:Core/Src/FAT/ff.c **** 				}
 8209              		.loc 1 5121 12 view .LVU2784
 8210 0080 C8E7     		b	.L583
 8211              	.LVL968:
 8212              	.L597:
5082:Core/Src/FAT/ff.c **** 			if (dcl == 0xFFFFFFFF) res = FR_DISK_ERR;	/* Disk error? */
 8213              		.loc 1 5082 22 view .LVU2785
 8214 0082 0224     		movs	r4, #2
 8215              	.LVL969:
5082:Core/Src/FAT/ff.c **** 			if (dcl == 0xFFFFFFFF) res = FR_DISK_ERR;	/* Disk error? */
 8216              		.loc 1 5082 22 view .LVU2786
 8217 0084 E0E7     		b	.L585
 8218              	.LVL970:
 8219              	.L598:
5083:Core/Src/FAT/ff.c **** 			tm = GET_FATTIME();
 8220              		.loc 1 5083 31 view .LVU2787
 8221 0086 0124     		movs	r4, #1
 8222              	.LVL971:
5083:Core/Src/FAT/ff.c **** 			tm = GET_FATTIME();
 8223              		.loc 1 5083 31 view .LVU2788
 8224 0088 E1E7     		b	.L586
 8225              	.LVL972:
 8226              	.L599:
5086:Core/Src/FAT/ff.c **** 				if (res == FR_OK) {
 8227              		.loc 1 5086 5 is_stmt 1 view .LVU2789
5086:Core/Src/FAT/ff.c **** 				if (res == FR_OK) {
 8228              		.loc 1 5086 11 is_stmt 0 view .LVU2790
 8229 008a 2946     		mov	r1, r5
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 291


 8230 008c 1198     		ldr	r0, [sp, #68]
 8231              	.LVL973:
5086:Core/Src/FAT/ff.c **** 				if (res == FR_OK) {
 8232              		.loc 1 5086 11 view .LVU2791
 8233 008e FFF7FEFF 		bl	dir_clear
 8234              	.LVL974:
5087:Core/Src/FAT/ff.c **** 					if (!FF_FS_EXFAT || fs->fs_type != FS_EXFAT) {	/* Create dot entries (FAT only) */
 8235              		.loc 1 5087 5 is_stmt 1 view .LVU2792
5087:Core/Src/FAT/ff.c **** 					if (!FF_FS_EXFAT || fs->fs_type != FS_EXFAT) {	/* Create dot entries (FAT only) */
 8236              		.loc 1 5087 8 is_stmt 0 view .LVU2793
 8237 0092 0446     		mov	r4, r0
 8238 0094 0028     		cmp	r0, #0
 8239 0096 DED1     		bne	.L587
5088:Core/Src/FAT/ff.c **** 						memset(fs->win + DIR_Name, ' ', 11);	/* Create "." entry */
 8240              		.loc 1 5088 6 is_stmt 1 view .LVU2794
5089:Core/Src/FAT/ff.c **** 						fs->win[DIR_Name] = '.';
 8241              		.loc 1 5089 7 view .LVU2795
5089:Core/Src/FAT/ff.c **** 						fs->win[DIR_Name] = '.';
 8242              		.loc 1 5089 16 is_stmt 0 view .LVU2796
 8243 0098 1198     		ldr	r0, [sp, #68]
 8244              	.LVL975:
5089:Core/Src/FAT/ff.c **** 						fs->win[DIR_Name] = '.';
 8245              		.loc 1 5089 7 view .LVU2797
 8246 009a 4FF02033 		mov	r3, #538976288
 8247 009e 0363     		str	r3, [r0, #48]	@ unaligned
 8248 00a0 4363     		str	r3, [r0, #52]	@ unaligned
 8249 00a2 C0F83730 		str	r3, [r0, #55]	@ unaligned
5090:Core/Src/FAT/ff.c **** 						fs->win[DIR_Attr] = AM_DIR;
 8250              		.loc 1 5090 7 is_stmt 1 view .LVU2798
5090:Core/Src/FAT/ff.c **** 						fs->win[DIR_Attr] = AM_DIR;
 8251              		.loc 1 5090 25 is_stmt 0 view .LVU2799
 8252 00a6 2E24     		movs	r4, #46
 8253 00a8 80F83040 		strb	r4, [r0, #48]
5091:Core/Src/FAT/ff.c **** 						st_dword(fs->win + DIR_ModTime, tm);
 8254              		.loc 1 5091 7 is_stmt 1 view .LVU2800
5091:Core/Src/FAT/ff.c **** 						st_dword(fs->win + DIR_ModTime, tm);
 8255              		.loc 1 5091 25 is_stmt 0 view .LVU2801
 8256 00ac 1023     		movs	r3, #16
 8257 00ae 80F83B30 		strb	r3, [r0, #59]
5092:Core/Src/FAT/ff.c **** 						st_clust(fs, fs->win, dcl);
 8258              		.loc 1 5092 7 is_stmt 1 view .LVU2802
 8259 00b2 3146     		mov	r1, r6
 8260 00b4 4630     		adds	r0, r0, #70
 8261 00b6 FFF7FEFF 		bl	st_dword
 8262              	.LVL976:
5093:Core/Src/FAT/ff.c **** 						memcpy(fs->win + SZDIRE, fs->win, SZDIRE);	/* Create ".." entry */
 8263              		.loc 1 5093 7 view .LVU2803
 8264 00ba 1198     		ldr	r0, [sp, #68]
 8265 00bc 2A46     		mov	r2, r5
 8266 00be 00F13001 		add	r1, r0, #48
 8267 00c2 FFF7FEFF 		bl	st_clust
 8268              	.LVL977:
5094:Core/Src/FAT/ff.c **** 						fs->win[SZDIRE + 1] = '.'; pcl = dj.obj.sclust;
 8269              		.loc 1 5094 7 view .LVU2804
5094:Core/Src/FAT/ff.c **** 						fs->win[SZDIRE + 1] = '.'; pcl = dj.obj.sclust;
 8270              		.loc 1 5094 16 is_stmt 0 view .LVU2805
 8271 00c6 1198     		ldr	r0, [sp, #68]
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 292


5094:Core/Src/FAT/ff.c **** 						fs->win[SZDIRE + 1] = '.'; pcl = dj.obj.sclust;
 8272              		.loc 1 5094 7 view .LVU2806
 8273 00c8 D0F830C0 		ldr	ip, [r0, #48]	@ unaligned
 8274 00cc 416B     		ldr	r1, [r0, #52]	@ unaligned
 8275 00ce 826B     		ldr	r2, [r0, #56]	@ unaligned
 8276 00d0 C36B     		ldr	r3, [r0, #60]	@ unaligned
 8277 00d2 C0F850C0 		str	ip, [r0, #80]	@ unaligned
 8278 00d6 4165     		str	r1, [r0, #84]	@ unaligned
 8279 00d8 8265     		str	r2, [r0, #88]	@ unaligned
 8280 00da C365     		str	r3, [r0, #92]	@ unaligned
 8281 00dc D0F840C0 		ldr	ip, [r0, #64]	@ unaligned
 8282 00e0 416C     		ldr	r1, [r0, #68]	@ unaligned
 8283 00e2 826C     		ldr	r2, [r0, #72]	@ unaligned
 8284 00e4 C36C     		ldr	r3, [r0, #76]	@ unaligned
 8285 00e6 C0F860C0 		str	ip, [r0, #96]	@ unaligned
 8286 00ea 4166     		str	r1, [r0, #100]	@ unaligned
 8287 00ec 8266     		str	r2, [r0, #104]	@ unaligned
 8288 00ee C366     		str	r3, [r0, #108]	@ unaligned
5095:Core/Src/FAT/ff.c **** 						st_clust(fs, fs->win + SZDIRE, pcl);
 8289              		.loc 1 5095 7 is_stmt 1 view .LVU2807
5095:Core/Src/FAT/ff.c **** 						st_clust(fs, fs->win + SZDIRE, pcl);
 8290              		.loc 1 5095 27 is_stmt 0 view .LVU2808
 8291 00f0 80F85140 		strb	r4, [r0, #81]
5095:Core/Src/FAT/ff.c **** 						st_clust(fs, fs->win + SZDIRE, pcl);
 8292              		.loc 1 5095 34 is_stmt 1 view .LVU2809
 8293              	.LVL978:
5096:Core/Src/FAT/ff.c **** 						fs->wflag = 1;
 8294              		.loc 1 5096 7 view .LVU2810
 8295 00f4 089A     		ldr	r2, [sp, #32]
 8296 00f6 00F15001 		add	r1, r0, #80
 8297 00fa FFF7FEFF 		bl	st_clust
 8298              	.LVL979:
5097:Core/Src/FAT/ff.c **** 					}
 8299              		.loc 1 5097 7 view .LVU2811
5097:Core/Src/FAT/ff.c **** 					}
 8300              		.loc 1 5097 17 is_stmt 0 view .LVU2812
 8301 00fe 119B     		ldr	r3, [sp, #68]
 8302 0100 0122     		movs	r2, #1
 8303 0102 1A71     		strb	r2, [r3, #4]
5099:Core/Src/FAT/ff.c **** 				}
 8304              		.loc 1 5099 6 is_stmt 1 view .LVU2813
5099:Core/Src/FAT/ff.c **** 				}
 8305              		.loc 1 5099 12 is_stmt 0 view .LVU2814
 8306 0104 06A8     		add	r0, sp, #24
 8307 0106 FFF7FEFF 		bl	dir_register
 8308              	.LVL980:
 8309 010a 0446     		mov	r4, r0
 8310              	.LVL981:
5099:Core/Src/FAT/ff.c **** 				}
 8311              		.loc 1 5099 12 view .LVU2815
 8312 010c A3E7     		b	.L587
 8313              	.L588:
5124:Core/Src/FAT/ff.c **** 			}
 8314              		.loc 1 5124 5 is_stmt 1 view .LVU2816
 8315 010e 0022     		movs	r2, #0
 8316 0110 2946     		mov	r1, r5
 8317 0112 02A8     		add	r0, sp, #8
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 293


 8318 0114 FFF7FEFF 		bl	remove_chain
 8319              	.LVL982:
 8320 0118 7CE7     		b	.L583
 8321              	.LVL983:
 8322              	.L589:
5073:Core/Src/FAT/ff.c **** 		if (FF_FS_RPATH && res == FR_NO_FILE && (dj.fn[NSFLAG] & NS_DOT)) {	/* Invalid name? */
 8323              		.loc 1 5073 25 is_stmt 0 view .LVU2817
 8324 011a 0824     		movs	r4, #8
 8325 011c 7AE7     		b	.L583
 8326              		.cfi_endproc
 8327              	.LFE46:
 8329              		.section	.text.f_rename,"ax",%progbits
 8330              		.align	1
 8331              		.global	f_rename
 8332              		.syntax unified
 8333              		.thumb
 8334              		.thumb_func
 8336              	f_rename:
 8337              	.LVL984:
 8338              	.LFB47:
5144:Core/Src/FAT/ff.c **** 	FRESULT res;
 8339              		.loc 1 5144 1 is_stmt 1 view -0
 8340              		.cfi_startproc
 8341              		@ args = 0, pretend = 0, frame = 136
 8342              		@ frame_needed = 0, uses_anonymous_args = 0
5144:Core/Src/FAT/ff.c **** 	FRESULT res;
 8343              		.loc 1 5144 1 is_stmt 0 view .LVU2819
 8344 0000 30B5     		push	{r4, r5, lr}
 8345              	.LCFI95:
 8346              		.cfi_def_cfa_offset 12
 8347              		.cfi_offset 4, -12
 8348              		.cfi_offset 5, -8
 8349              		.cfi_offset 14, -4
 8350 0002 A3B0     		sub	sp, sp, #140
 8351              	.LCFI96:
 8352              		.cfi_def_cfa_offset 152
 8353 0004 0190     		str	r0, [sp, #4]
 8354 0006 0091     		str	r1, [sp]
5145:Core/Src/FAT/ff.c **** 	FATFS *fs;
 8355              		.loc 1 5145 2 is_stmt 1 view .LVU2820
5146:Core/Src/FAT/ff.c **** 	DIR djo, djn;
 8356              		.loc 1 5146 2 view .LVU2821
5147:Core/Src/FAT/ff.c **** 	BYTE buf[FF_FS_EXFAT ? SZDIRE * 2 : SZDIRE], *dir;
 8357              		.loc 1 5147 2 view .LVU2822
5148:Core/Src/FAT/ff.c **** 	LBA_t sect;
 8358              		.loc 1 5148 2 view .LVU2823
5149:Core/Src/FAT/ff.c **** 	DEF_NAMBUF
 8359              		.loc 1 5149 2 view .LVU2824
5153:Core/Src/FAT/ff.c **** 	res = mount_volume(&path_old, &fs, FA_WRITE);	/* Get logical drive of the old object */
 8360              		.loc 1 5153 2 view .LVU2825
 8361 0008 6846     		mov	r0, sp
 8362              	.LVL985:
5153:Core/Src/FAT/ff.c **** 	res = mount_volume(&path_old, &fs, FA_WRITE);	/* Get logical drive of the old object */
 8363              		.loc 1 5153 2 is_stmt 0 view .LVU2826
 8364 000a FFF7FEFF 		bl	get_ldnumber
 8365              	.LVL986:
5154:Core/Src/FAT/ff.c **** 	if (res == FR_OK) {
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 294


 8366              		.loc 1 5154 2 is_stmt 1 view .LVU2827
5154:Core/Src/FAT/ff.c **** 	if (res == FR_OK) {
 8367              		.loc 1 5154 8 is_stmt 0 view .LVU2828
 8368 000e 0222     		movs	r2, #2
 8369 0010 21A9     		add	r1, sp, #132
 8370 0012 01A8     		add	r0, sp, #4
 8371 0014 FFF7FEFF 		bl	mount_volume
 8372              	.LVL987:
5155:Core/Src/FAT/ff.c **** 		djo.obj.fs = fs;
 8373              		.loc 1 5155 2 is_stmt 1 view .LVU2829
5155:Core/Src/FAT/ff.c **** 		djo.obj.fs = fs;
 8374              		.loc 1 5155 5 is_stmt 0 view .LVU2830
 8375 0018 0446     		mov	r4, r0
 8376 001a 10B1     		cbz	r0, .L611
 8377              	.LVL988:
 8378              	.L601:
5232:Core/Src/FAT/ff.c **** 	}
 8379              		.loc 1 5232 16 is_stmt 1 view .LVU2831
5235:Core/Src/FAT/ff.c **** }
 8380              		.loc 1 5235 2 view .LVU2832
5236:Core/Src/FAT/ff.c **** 
 8381              		.loc 1 5236 1 is_stmt 0 view .LVU2833
 8382 001c 2046     		mov	r0, r4
 8383 001e 23B0     		add	sp, sp, #140
 8384              	.LCFI97:
 8385              		.cfi_remember_state
 8386              		.cfi_def_cfa_offset 12
 8387              		@ sp needed
 8388 0020 30BD     		pop	{r4, r5, pc}
 8389              	.LVL989:
 8390              	.L611:
 8391              	.LCFI98:
 8392              		.cfi_restore_state
5156:Core/Src/FAT/ff.c **** 		INIT_NAMBUF(fs);
 8393              		.loc 1 5156 3 is_stmt 1 view .LVU2834
5156:Core/Src/FAT/ff.c **** 		INIT_NAMBUF(fs);
 8394              		.loc 1 5156 14 is_stmt 0 view .LVU2835
 8395 0022 219B     		ldr	r3, [sp, #132]
 8396 0024 1693     		str	r3, [sp, #88]
5157:Core/Src/FAT/ff.c **** 		res = follow_path(&djo, path_old);			/* Check old object */
 8397              		.loc 1 5157 18 is_stmt 1 view .LVU2836
5158:Core/Src/FAT/ff.c **** 		if (res == FR_OK && (djo.fn[NSFLAG] & (NS_DOT | NS_NONAME))) res = FR_INVALID_NAME;	/* Check vali
 8398              		.loc 1 5158 3 view .LVU2837
5158:Core/Src/FAT/ff.c **** 		if (res == FR_OK && (djo.fn[NSFLAG] & (NS_DOT | NS_NONAME))) res = FR_INVALID_NAME;	/* Check vali
 8399              		.loc 1 5158 9 is_stmt 0 view .LVU2838
 8400 0026 0199     		ldr	r1, [sp, #4]
 8401 0028 16A8     		add	r0, sp, #88
 8402              	.LVL990:
5158:Core/Src/FAT/ff.c **** 		if (res == FR_OK && (djo.fn[NSFLAG] & (NS_DOT | NS_NONAME))) res = FR_INVALID_NAME;	/* Check vali
 8403              		.loc 1 5158 9 view .LVU2839
 8404 002a FFF7FEFF 		bl	follow_path
 8405              	.LVL991:
5159:Core/Src/FAT/ff.c **** #if FF_FS_LOCK
 8406              		.loc 1 5159 3 is_stmt 1 view .LVU2840
5159:Core/Src/FAT/ff.c **** #if FF_FS_LOCK
 8407              		.loc 1 5159 6 is_stmt 0 view .LVU2841
 8408 002e 0446     		mov	r4, r0
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 295


 8409 0030 28B9     		cbnz	r0, .L602
5159:Core/Src/FAT/ff.c **** #if FF_FS_LOCK
 8410              		.loc 1 5159 30 discriminator 1 view .LVU2842
 8411 0032 9DF88330 		ldrb	r3, [sp, #131]	@ zero_extendqisi2
5159:Core/Src/FAT/ff.c **** #if FF_FS_LOCK
 8412              		.loc 1 5159 20 discriminator 1 view .LVU2843
 8413 0036 13F0A00F 		tst	r3, #160
 8414 003a 40F08D80 		bne	.L607
 8415              	.L602:
 8416              	.LVL992:
5165:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT
 8417              		.loc 1 5165 3 is_stmt 1 view .LVU2844
5165:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT
 8418              		.loc 1 5165 6 is_stmt 0 view .LVU2845
 8419 003e 002C     		cmp	r4, #0
 8420 0040 ECD1     		bne	.L601
5193:Core/Src/FAT/ff.c **** 				memcpy(&djn, &djo, sizeof (DIR));		/* Duplicate the directory object */
 8421              		.loc 1 5193 5 is_stmt 1 view .LVU2846
5193:Core/Src/FAT/ff.c **** 				memcpy(&djn, &djo, sizeof (DIR));		/* Duplicate the directory object */
 8422              		.loc 1 5193 20 is_stmt 0 view .LVU2847
 8423 0042 1D9D     		ldr	r5, [sp, #116]
5193:Core/Src/FAT/ff.c **** 				memcpy(&djn, &djo, sizeof (DIR));		/* Duplicate the directory object */
 8424              		.loc 1 5193 5 view .LVU2848
 8425 0044 03AC     		add	r4, sp, #12
 8426              	.LVL993:
5193:Core/Src/FAT/ff.c **** 				memcpy(&djn, &djo, sizeof (DIR));		/* Duplicate the directory object */
 8427              		.loc 1 5193 5 view .LVU2849
 8428 0046 2868     		ldr	r0, [r5]	@ unaligned
 8429 0048 6968     		ldr	r1, [r5, #4]	@ unaligned
 8430 004a AA68     		ldr	r2, [r5, #8]	@ unaligned
 8431 004c EB68     		ldr	r3, [r5, #12]	@ unaligned
 8432 004e 0FC4     		stmia	r4!, {r0, r1, r2, r3}
 8433 0050 2869     		ldr	r0, [r5, #16]	@ unaligned
 8434 0052 6969     		ldr	r1, [r5, #20]	@ unaligned
 8435 0054 AA69     		ldr	r2, [r5, #24]	@ unaligned
 8436 0056 EB69     		ldr	r3, [r5, #28]	@ unaligned
 8437 0058 0FC4     		stmia	r4!, {r0, r1, r2, r3}
5194:Core/Src/FAT/ff.c **** 				res = follow_path(&djn, path_new);		/* Make sure if new object name is not in use */
 8438              		.loc 1 5194 5 is_stmt 1 view .LVU2850
 8439 005a 0DF1580C 		add	ip, sp, #88
 8440 005e BCE80F00 		ldmia	ip!, {r0, r1, r2, r3}
 8441 0062 0FC4     		stmia	r4!, {r0, r1, r2, r3}
 8442 0064 BCE80F00 		ldmia	ip!, {r0, r1, r2, r3}
 8443 0068 0FC4     		stmia	r4!, {r0, r1, r2, r3}
 8444 006a 9CE80700 		ldm	ip, {r0, r1, r2}
 8445 006e 84E80700 		stm	r4, {r0, r1, r2}
5195:Core/Src/FAT/ff.c **** 				if (res == FR_OK) {						/* Is new name already in use by any other object? */
 8446              		.loc 1 5195 5 view .LVU2851
5195:Core/Src/FAT/ff.c **** 				if (res == FR_OK) {						/* Is new name already in use by any other object? */
 8447              		.loc 1 5195 11 is_stmt 0 view .LVU2852
 8448 0072 0099     		ldr	r1, [sp]
 8449 0074 0BA8     		add	r0, sp, #44
 8450 0076 FFF7FEFF 		bl	follow_path
 8451              	.LVL994:
5196:Core/Src/FAT/ff.c **** 					res = (djn.obj.sclust == djo.obj.sclust && djn.dptr == djo.dptr) ? FR_NO_FILE : FR_EXIST;
 8452              		.loc 1 5196 5 is_stmt 1 view .LVU2853
5196:Core/Src/FAT/ff.c **** 					res = (djn.obj.sclust == djo.obj.sclust && djn.dptr == djo.dptr) ? FR_NO_FILE : FR_EXIST;
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 296


 8453              		.loc 1 5196 8 is_stmt 0 view .LVU2854
 8454 007a 0446     		mov	r4, r0
 8455 007c 58B9     		cbnz	r0, .L603
5197:Core/Src/FAT/ff.c **** 				}
 8456              		.loc 1 5197 6 is_stmt 1 view .LVU2855
5197:Core/Src/FAT/ff.c **** 				}
 8457              		.loc 1 5197 84 is_stmt 0 view .LVU2856
 8458 007e 0D9A     		ldr	r2, [sp, #52]
 8459 0080 189B     		ldr	r3, [sp, #96]
 8460 0082 9A42     		cmp	r2, r3
 8461 0084 01D0     		beq	.L612
 8462 0086 0824     		movs	r4, #8
 8463 0088 07E0     		b	.L604
 8464              	.L612:
5197:Core/Src/FAT/ff.c **** 				}
 8465              		.loc 1 5197 46 discriminator 1 view .LVU2857
 8466 008a 0F9A     		ldr	r2, [sp, #60]
 8467 008c 1A9B     		ldr	r3, [sp, #104]
 8468 008e 9A42     		cmp	r2, r3
 8469 0090 10D0     		beq	.L605
5197:Core/Src/FAT/ff.c **** 				}
 8470              		.loc 1 5197 84 view .LVU2858
 8471 0092 0824     		movs	r4, #8
 8472 0094 01E0     		b	.L604
 8473              	.L603:
5199:Core/Src/FAT/ff.c **** 					res = dir_register(&djn);			/* Register the new entry */
 8474              		.loc 1 5199 5 is_stmt 1 view .LVU2859
5199:Core/Src/FAT/ff.c **** 					res = dir_register(&djn);			/* Register the new entry */
 8475              		.loc 1 5199 8 is_stmt 0 view .LVU2860
 8476 0096 0428     		cmp	r0, #4
 8477 0098 0CD0     		beq	.L605
 8478              	.LVL995:
 8479              	.L604:
5224:Core/Src/FAT/ff.c **** 				res = dir_remove(&djo);		/* Remove old entry */
 8480              		.loc 1 5224 4 is_stmt 1 view .LVU2861
5224:Core/Src/FAT/ff.c **** 				res = dir_remove(&djo);		/* Remove old entry */
 8481              		.loc 1 5224 7 is_stmt 0 view .LVU2862
 8482 009a 002C     		cmp	r4, #0
 8483 009c BED1     		bne	.L601
5225:Core/Src/FAT/ff.c **** 				if (res == FR_OK) {
 8484              		.loc 1 5225 5 is_stmt 1 view .LVU2863
5225:Core/Src/FAT/ff.c **** 				if (res == FR_OK) {
 8485              		.loc 1 5225 11 is_stmt 0 view .LVU2864
 8486 009e 16A8     		add	r0, sp, #88
 8487 00a0 FFF7FEFF 		bl	dir_remove
 8488              	.LVL996:
5226:Core/Src/FAT/ff.c **** 					res = sync_fs(fs);
 8489              		.loc 1 5226 5 is_stmt 1 view .LVU2865
5226:Core/Src/FAT/ff.c **** 					res = sync_fs(fs);
 8490              		.loc 1 5226 8 is_stmt 0 view .LVU2866
 8491 00a4 0446     		mov	r4, r0
 8492 00a6 0028     		cmp	r0, #0
 8493 00a8 B8D1     		bne	.L601
5227:Core/Src/FAT/ff.c **** 				}
 8494              		.loc 1 5227 6 is_stmt 1 view .LVU2867
5227:Core/Src/FAT/ff.c **** 				}
 8495              		.loc 1 5227 12 is_stmt 0 view .LVU2868
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 297


 8496 00aa 2198     		ldr	r0, [sp, #132]
 8497              	.LVL997:
5227:Core/Src/FAT/ff.c **** 				}
 8498              		.loc 1 5227 12 view .LVU2869
 8499 00ac FFF7FEFF 		bl	sync_fs
 8500              	.LVL998:
 8501 00b0 0446     		mov	r4, r0
 8502              	.LVL999:
5227:Core/Src/FAT/ff.c **** 				}
 8503              		.loc 1 5227 12 view .LVU2870
 8504 00b2 B3E7     		b	.L601
 8505              	.LVL1000:
 8506              	.L605:
5200:Core/Src/FAT/ff.c **** 					if (res == FR_OK) {
 8507              		.loc 1 5200 6 is_stmt 1 view .LVU2871
5200:Core/Src/FAT/ff.c **** 					if (res == FR_OK) {
 8508              		.loc 1 5200 12 is_stmt 0 view .LVU2872
 8509 00b4 0BA8     		add	r0, sp, #44
 8510 00b6 FFF7FEFF 		bl	dir_register
 8511              	.LVL1001:
5201:Core/Src/FAT/ff.c **** 						dir = djn.dir;					/* Copy directory entry of the object except name */
 8512              		.loc 1 5201 6 is_stmt 1 view .LVU2873
5201:Core/Src/FAT/ff.c **** 						dir = djn.dir;					/* Copy directory entry of the object except name */
 8513              		.loc 1 5201 9 is_stmt 0 view .LVU2874
 8514 00ba 0446     		mov	r4, r0
 8515 00bc 0028     		cmp	r0, #0
 8516 00be ECD1     		bne	.L604
5202:Core/Src/FAT/ff.c **** 						memcpy(dir + 13, buf + 13, SZDIRE - 13);
 8517              		.loc 1 5202 7 is_stmt 1 view .LVU2875
5202:Core/Src/FAT/ff.c **** 						memcpy(dir + 13, buf + 13, SZDIRE - 13);
 8518              		.loc 1 5202 11 is_stmt 0 view .LVU2876
 8519 00c0 1299     		ldr	r1, [sp, #72]
 8520              	.LVL1002:
5203:Core/Src/FAT/ff.c **** 						dir[DIR_Attr] = buf[DIR_Attr];
 8521              		.loc 1 5203 7 is_stmt 1 view .LVU2877
 8522 00c2 DDF81950 		ldr	r5, [sp, #25]	@ unaligned
 8523 00c6 DDF81D00 		ldr	r0, [sp, #29]	@ unaligned
 8524              	.LVL1003:
5203:Core/Src/FAT/ff.c **** 						dir[DIR_Attr] = buf[DIR_Attr];
 8525              		.loc 1 5203 7 is_stmt 0 view .LVU2878
 8526 00ca DDF82120 		ldr	r2, [sp, #33]	@ unaligned
 8527 00ce DDF82530 		ldr	r3, [sp, #37]	@ unaligned
 8528 00d2 C1F80D50 		str	r5, [r1, #13]	@ unaligned
 8529 00d6 C1F81100 		str	r0, [r1, #17]	@ unaligned
 8530 00da C1F81520 		str	r2, [r1, #21]	@ unaligned
 8531 00de C1F81930 		str	r3, [r1, #25]	@ unaligned
 8532 00e2 BDF82920 		ldrh	r2, [sp, #41]	@ unaligned
 8533 00e6 9DF82B30 		ldrb	r3, [sp, #43]	@ zero_extendqisi2
 8534 00ea A1F81D20 		strh	r2, [r1, #29]	@ unaligned
 8535 00ee CB77     		strb	r3, [r1, #31]
5204:Core/Src/FAT/ff.c **** 						if (!(dir[DIR_Attr] & AM_DIR)) dir[DIR_Attr] |= AM_ARC;	/* Set archive attribute if it is a f
 8536              		.loc 1 5204 7 is_stmt 1 view .LVU2879
5204:Core/Src/FAT/ff.c **** 						if (!(dir[DIR_Attr] & AM_DIR)) dir[DIR_Attr] |= AM_ARC;	/* Set archive attribute if it is a f
 8537              		.loc 1 5204 26 is_stmt 0 view .LVU2880
 8538 00f0 9DF81730 		ldrb	r3, [sp, #23]	@ zero_extendqisi2
5204:Core/Src/FAT/ff.c **** 						if (!(dir[DIR_Attr] & AM_DIR)) dir[DIR_Attr] |= AM_ARC;	/* Set archive attribute if it is a f
 8539              		.loc 1 5204 21 view .LVU2881
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 298


 8540 00f4 CB72     		strb	r3, [r1, #11]
5205:Core/Src/FAT/ff.c **** 						fs->wflag = 1;
 8541              		.loc 1 5205 7 is_stmt 1 view .LVU2882
5205:Core/Src/FAT/ff.c **** 						fs->wflag = 1;
 8542              		.loc 1 5205 10 is_stmt 0 view .LVU2883
 8543 00f6 13F0100F 		tst	r3, #16
 8544 00fa 02D1     		bne	.L606
5205:Core/Src/FAT/ff.c **** 						fs->wflag = 1;
 8545              		.loc 1 5205 38 is_stmt 1 discriminator 1 view .LVU2884
5205:Core/Src/FAT/ff.c **** 						fs->wflag = 1;
 8546              		.loc 1 5205 52 is_stmt 0 discriminator 1 view .LVU2885
 8547 00fc 43F02003 		orr	r3, r3, #32
 8548 0100 CB72     		strb	r3, [r1, #11]
 8549              	.L606:
5206:Core/Src/FAT/ff.c **** 						if ((dir[DIR_Attr] & AM_DIR) && djo.obj.sclust != djn.obj.sclust) {	/* Update .. entry in the
 8550              		.loc 1 5206 7 is_stmt 1 view .LVU2886
5206:Core/Src/FAT/ff.c **** 						if ((dir[DIR_Attr] & AM_DIR) && djo.obj.sclust != djn.obj.sclust) {	/* Update .. entry in the
 8551              		.loc 1 5206 9 is_stmt 0 view .LVU2887
 8552 0102 219D     		ldr	r5, [sp, #132]
5206:Core/Src/FAT/ff.c **** 						if ((dir[DIR_Attr] & AM_DIR) && djo.obj.sclust != djn.obj.sclust) {	/* Update .. entry in the
 8553              		.loc 1 5206 17 view .LVU2888
 8554 0104 0123     		movs	r3, #1
 8555 0106 2B71     		strb	r3, [r5, #4]
5207:Core/Src/FAT/ff.c **** 							sect = clst2sect(fs, ld_clust(fs, dir));
 8556              		.loc 1 5207 7 is_stmt 1 view .LVU2889
5207:Core/Src/FAT/ff.c **** 							sect = clst2sect(fs, ld_clust(fs, dir));
 8557              		.loc 1 5207 15 is_stmt 0 view .LVU2890
 8558 0108 CB7A     		ldrb	r3, [r1, #11]	@ zero_extendqisi2
5207:Core/Src/FAT/ff.c **** 							sect = clst2sect(fs, ld_clust(fs, dir));
 8559              		.loc 1 5207 10 view .LVU2891
 8560 010a 13F0100F 		tst	r3, #16
 8561 010e C4D0     		beq	.L604
5207:Core/Src/FAT/ff.c **** 							sect = clst2sect(fs, ld_clust(fs, dir));
 8562              		.loc 1 5207 36 discriminator 1 view .LVU2892
 8563 0110 189A     		ldr	r2, [sp, #96]
 8564 0112 0D9B     		ldr	r3, [sp, #52]
 8565 0114 9A42     		cmp	r2, r3
 8566 0116 C0D0     		beq	.L604
5208:Core/Src/FAT/ff.c **** 							if (sect == 0) {
 8567              		.loc 1 5208 8 is_stmt 1 view .LVU2893
5208:Core/Src/FAT/ff.c **** 							if (sect == 0) {
 8568              		.loc 1 5208 15 is_stmt 0 view .LVU2894
 8569 0118 2846     		mov	r0, r5
 8570 011a FFF7FEFF 		bl	ld_clust
 8571              	.LVL1004:
5208:Core/Src/FAT/ff.c **** 							if (sect == 0) {
 8572              		.loc 1 5208 15 view .LVU2895
 8573 011e 0146     		mov	r1, r0
 8574 0120 2846     		mov	r0, r5
 8575 0122 FFF7FEFF 		bl	clst2sect
 8576              	.LVL1005:
5209:Core/Src/FAT/ff.c **** 								res = FR_INT_ERR;
 8577              		.loc 1 5209 8 is_stmt 1 view .LVU2896
5209:Core/Src/FAT/ff.c **** 								res = FR_INT_ERR;
 8578              		.loc 1 5209 11 is_stmt 0 view .LVU2897
 8579 0126 0146     		mov	r1, r0
 8580 0128 08B9     		cbnz	r0, .L613
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 299


5210:Core/Src/FAT/ff.c **** 							} else {
 8581              		.loc 1 5210 13 view .LVU2898
 8582 012a 0224     		movs	r4, #2
 8583 012c 76E7     		b	.L601
 8584              	.L613:
5213:Core/Src/FAT/ff.c **** 								dir = fs->win + SZDIRE * 1;	/* Ptr to .. entry */
 8585              		.loc 1 5213 9 is_stmt 1 view .LVU2899
5213:Core/Src/FAT/ff.c **** 								dir = fs->win + SZDIRE * 1;	/* Ptr to .. entry */
 8586              		.loc 1 5213 15 is_stmt 0 view .LVU2900
 8587 012e 2846     		mov	r0, r5
 8588              	.LVL1006:
5213:Core/Src/FAT/ff.c **** 								dir = fs->win + SZDIRE * 1;	/* Ptr to .. entry */
 8589              		.loc 1 5213 15 view .LVU2901
 8590 0130 FFF7FEFF 		bl	move_window
 8591              	.LVL1007:
5214:Core/Src/FAT/ff.c **** 								if (res == FR_OK && dir[1] == '.') {
 8592              		.loc 1 5214 9 is_stmt 1 view .LVU2902
5214:Core/Src/FAT/ff.c **** 								if (res == FR_OK && dir[1] == '.') {
 8593              		.loc 1 5214 17 is_stmt 0 view .LVU2903
 8594 0134 219B     		ldr	r3, [sp, #132]
5214:Core/Src/FAT/ff.c **** 								if (res == FR_OK && dir[1] == '.') {
 8595              		.loc 1 5214 13 view .LVU2904
 8596 0136 03F15001 		add	r1, r3, #80
 8597              	.LVL1008:
5215:Core/Src/FAT/ff.c **** 									st_clust(fs, dir, djn.obj.sclust);
 8598              		.loc 1 5215 9 is_stmt 1 view .LVU2905
5215:Core/Src/FAT/ff.c **** 									st_clust(fs, dir, djn.obj.sclust);
 8599              		.loc 1 5215 12 is_stmt 0 view .LVU2906
 8600 013a 0446     		mov	r4, r0
 8601 013c 0028     		cmp	r0, #0
 8602 013e ACD1     		bne	.L604
5215:Core/Src/FAT/ff.c **** 									st_clust(fs, dir, djn.obj.sclust);
 8603              		.loc 1 5215 32 discriminator 1 view .LVU2907
 8604 0140 93F85120 		ldrb	r2, [r3, #81]	@ zero_extendqisi2
5215:Core/Src/FAT/ff.c **** 									st_clust(fs, dir, djn.obj.sclust);
 8605              		.loc 1 5215 26 discriminator 1 view .LVU2908
 8606 0144 2E2A     		cmp	r2, #46
 8607 0146 A8D1     		bne	.L604
5216:Core/Src/FAT/ff.c **** 									fs->wflag = 1;
 8608              		.loc 1 5216 10 is_stmt 1 view .LVU2909
 8609 0148 0D9A     		ldr	r2, [sp, #52]
 8610 014a 1846     		mov	r0, r3
 8611              	.LVL1009:
5216:Core/Src/FAT/ff.c **** 									fs->wflag = 1;
 8612              		.loc 1 5216 10 is_stmt 0 view .LVU2910
 8613 014c FFF7FEFF 		bl	st_clust
 8614              	.LVL1010:
5217:Core/Src/FAT/ff.c **** 								}
 8615              		.loc 1 5217 10 is_stmt 1 view .LVU2911
5217:Core/Src/FAT/ff.c **** 								}
 8616              		.loc 1 5217 20 is_stmt 0 view .LVU2912
 8617 0150 219B     		ldr	r3, [sp, #132]
 8618 0152 0122     		movs	r2, #1
 8619 0154 1A71     		strb	r2, [r3, #4]
 8620 0156 A0E7     		b	.L604
 8621              	.LVL1011:
 8622              	.L607:
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 300


5159:Core/Src/FAT/ff.c **** #if FF_FS_LOCK
 8623              		.loc 1 5159 68 view .LVU2913
 8624 0158 0624     		movs	r4, #6
 8625 015a 5FE7     		b	.L601
 8626              		.cfi_endproc
 8627              	.LFE47:
 8629              		.section	.rodata.f_mkfs.str1.4,"aMS",%progbits,1
 8630              		.align	2
 8631              	.LC2:
 8632 0000 EBFE904D 		.ascii	"\353\376\220MSDOS5.0\000"
 8632      53444F53 
 8632      352E3000 
 8633              		.align	2
 8634              	.LC3:
 8635 000c 4E4F204E 		.ascii	"NO NAME    FAT32   \000"
 8635      414D4520 
 8635      20202046 
 8635      41543332 
 8635      20202000 
 8636              		.align	2
 8637              	.LC4:
 8638 0020 4E4F204E 		.ascii	"NO NAME    FAT     \000"
 8638      414D4520 
 8638      20202046 
 8638      41542020 
 8638      20202000 
 8639              		.section	.text.f_mkfs,"ax",%progbits
 8640              		.align	1
 8641              		.global	f_mkfs
 8642              		.syntax unified
 8643              		.thumb
 8644              		.thumb_func
 8646              	f_mkfs:
 8647              	.LVL1012:
 8648              	.LFB49:
5879:Core/Src/FAT/ff.c **** 
5880:Core/Src/FAT/ff.c **** 
5881:Core/Src/FAT/ff.c **** 
5882:Core/Src/FAT/ff.c **** FRESULT f_mkfs (
5883:Core/Src/FAT/ff.c **** 	const TCHAR* path,		/* Logical drive number */
5884:Core/Src/FAT/ff.c **** 	const MKFS_PARM* opt,	/* Format options */
5885:Core/Src/FAT/ff.c **** 	void* work,				/* Pointer to working buffer (null: use len bytes of heap memory) */
5886:Core/Src/FAT/ff.c **** 	UINT len				/* Size of working buffer [byte] */
5887:Core/Src/FAT/ff.c **** )
5888:Core/Src/FAT/ff.c **** {
 8649              		.loc 1 5888 1 is_stmt 1 view -0
 8650              		.cfi_startproc
 8651              		@ args = 0, pretend = 0, frame = 64
 8652              		@ frame_needed = 0, uses_anonymous_args = 0
 8653              		.loc 1 5888 1 is_stmt 0 view .LVU2915
 8654 0000 2DE9F04F 		push	{r4, r5, r6, r7, r8, r9, r10, fp, lr}
 8655              	.LCFI99:
 8656              		.cfi_def_cfa_offset 36
 8657              		.cfi_offset 4, -36
 8658              		.cfi_offset 5, -32
 8659              		.cfi_offset 6, -28
 8660              		.cfi_offset 7, -24
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 301


 8661              		.cfi_offset 8, -20
 8662              		.cfi_offset 9, -16
 8663              		.cfi_offset 10, -12
 8664              		.cfi_offset 11, -8
 8665              		.cfi_offset 14, -4
 8666 0004 91B0     		sub	sp, sp, #68
 8667              	.LCFI100:
 8668              		.cfi_def_cfa_offset 104
 8669 0006 0B90     		str	r0, [sp, #44]
 8670 0008 0D46     		mov	r5, r1
 8671 000a 0292     		str	r2, [sp, #8]
 8672 000c 0193     		str	r3, [sp, #4]
5889:Core/Src/FAT/ff.c **** 	static const WORD cst[] = {1, 4, 16, 64, 256, 512, 0};	/* Cluster size boundary for FAT volume (4K
 8673              		.loc 1 5889 2 is_stmt 1 view .LVU2916
5890:Core/Src/FAT/ff.c **** 	static const WORD cst32[] = {1, 2, 4, 8, 16, 32, 0};	/* Cluster size boundary for FAT32 volume (12
 8674              		.loc 1 5890 2 view .LVU2917
5891:Core/Src/FAT/ff.c **** 	static const MKFS_PARM defopt = {FM_ANY, 0, 0, 0, 0};	/* Default parameter */
 8675              		.loc 1 5891 2 view .LVU2918
5892:Core/Src/FAT/ff.c **** 	BYTE fsopt, fsty, sys, pdrv, ipart;
 8676              		.loc 1 5892 2 view .LVU2919
5893:Core/Src/FAT/ff.c **** 	BYTE *buf;
 8677              		.loc 1 5893 2 view .LVU2920
5894:Core/Src/FAT/ff.c **** 	BYTE *pte;
 8678              		.loc 1 5894 2 view .LVU2921
5895:Core/Src/FAT/ff.c **** 	WORD ss;	/* Sector size */
 8679              		.loc 1 5895 2 view .LVU2922
5896:Core/Src/FAT/ff.c **** 	DWORD sz_buf, sz_blk, n_clst, pau, nsect, n, vsn;
 8680              		.loc 1 5896 2 view .LVU2923
5897:Core/Src/FAT/ff.c **** 	LBA_t sz_vol, b_vol, b_fat, b_data;		/* Size of volume, Base LBA of volume, fat, data */
 8681              		.loc 1 5897 2 view .LVU2924
5898:Core/Src/FAT/ff.c **** 	LBA_t sect, lba[2];
 8682              		.loc 1 5898 2 view .LVU2925
5899:Core/Src/FAT/ff.c **** 	DWORD sz_rsv, sz_fat, sz_dir, sz_au;	/* Size of reserved, fat, dir, data, cluster */
 8683              		.loc 1 5899 2 view .LVU2926
5900:Core/Src/FAT/ff.c **** 	UINT n_fat, n_root, i;					/* Index, Number of FATs and Number of roor dir entries */
 8684              		.loc 1 5900 2 view .LVU2927
5901:Core/Src/FAT/ff.c **** 	int vol;
 8685              		.loc 1 5901 2 view .LVU2928
5902:Core/Src/FAT/ff.c **** 	DSTATUS ds;
 8686              		.loc 1 5902 2 view .LVU2929
5903:Core/Src/FAT/ff.c **** 	FRESULT res;
 8687              		.loc 1 5903 2 view .LVU2930
5904:Core/Src/FAT/ff.c **** 
5905:Core/Src/FAT/ff.c **** 
5906:Core/Src/FAT/ff.c **** 	/* Check mounted drive and clear work area */
5907:Core/Src/FAT/ff.c **** 	vol = get_ldnumber(&path);					/* Get target logical drive */
 8688              		.loc 1 5907 2 view .LVU2931
 8689              		.loc 1 5907 8 is_stmt 0 view .LVU2932
 8690 000e 0BA8     		add	r0, sp, #44
 8691              	.LVL1013:
 8692              		.loc 1 5907 8 view .LVU2933
 8693 0010 FFF7FEFF 		bl	get_ldnumber
 8694              	.LVL1014:
5908:Core/Src/FAT/ff.c **** 	if (vol < 0) return FR_INVALID_DRIVE;
 8695              		.loc 1 5908 2 is_stmt 1 view .LVU2934
 8696              		.loc 1 5908 5 is_stmt 0 view .LVU2935
 8697 0014 0028     		cmp	r0, #0
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 302


 8698              		.loc 1 5908 5 view .LVU2936
 8699 0016 C0F2EB82 		blt	.L665
5909:Core/Src/FAT/ff.c **** 	if (FatFs[vol]) FatFs[vol]->fs_type = 0;	/* Clear the fs object if mounted */
 8700              		.loc 1 5909 2 is_stmt 1 view .LVU2937
 8701              		.loc 1 5909 11 is_stmt 0 view .LVU2938
 8702 001a A34B     		ldr	r3, .L718
 8703 001c 53F82030 		ldr	r3, [r3, r0, lsl #2]
 8704              		.loc 1 5909 5 view .LVU2939
 8705 0020 0BB1     		cbz	r3, .L616
 8706              		.loc 1 5909 18 is_stmt 1 discriminator 1 view .LVU2940
 8707              		.loc 1 5909 38 is_stmt 0 discriminator 1 view .LVU2941
 8708 0022 0022     		movs	r2, #0
 8709 0024 1A70     		strb	r2, [r3]
 8710              	.L616:
5910:Core/Src/FAT/ff.c **** 	pdrv = LD2PD(vol);		/* Hosting physical drive */
 8711              		.loc 1 5910 2 is_stmt 1 view .LVU2942
 8712              		.loc 1 5910 7 is_stmt 0 view .LVU2943
 8713 0026 C4B2     		uxtb	r4, r0
 8714              	.LVL1015:
5911:Core/Src/FAT/ff.c **** 	ipart = LD2PT(vol);		/* Hosting partition (0:create as new, 1..:existing partition) */
 8715              		.loc 1 5911 2 is_stmt 1 view .LVU2944
5912:Core/Src/FAT/ff.c **** 
5913:Core/Src/FAT/ff.c **** 	/* Initialize the hosting physical drive */
5914:Core/Src/FAT/ff.c **** 	ds = disk_initialize(pdrv);
 8716              		.loc 1 5914 2 view .LVU2945
 8717              		.loc 1 5914 7 is_stmt 0 view .LVU2946
 8718 0028 2046     		mov	r0, r4
 8719              	.LVL1016:
 8720              		.loc 1 5914 7 view .LVU2947
 8721 002a FFF7FEFF 		bl	disk_initialize
 8722              	.LVL1017:
5915:Core/Src/FAT/ff.c **** 	if (ds & STA_NOINIT) return FR_NOT_READY;
 8723              		.loc 1 5915 2 is_stmt 1 view .LVU2948
 8724              		.loc 1 5915 5 is_stmt 0 view .LVU2949
 8725 002e 10F0010F 		tst	r0, #1
 8726 0032 40F0DF82 		bne	.L666
5916:Core/Src/FAT/ff.c **** 	if (ds & STA_PROTECT) return FR_WRITE_PROTECTED;
 8727              		.loc 1 5916 2 is_stmt 1 view .LVU2950
 8728              		.loc 1 5916 5 is_stmt 0 view .LVU2951
 8729 0036 10F0040F 		tst	r0, #4
 8730 003a 40F0DF82 		bne	.L667
5917:Core/Src/FAT/ff.c **** 
5918:Core/Src/FAT/ff.c **** 	/* Get physical drive parameters (sz_drv, sz_blk and ss) */
5919:Core/Src/FAT/ff.c **** 	if (!opt) opt = &defopt;	/* Use default parameter if it is not given */
 8731              		.loc 1 5919 2 is_stmt 1 view .LVU2952
 8732              		.loc 1 5919 5 is_stmt 0 view .LVU2953
 8733 003e 05B3     		cbz	r5, .L704
 8734              	.LVL1018:
 8735              	.L617:
5920:Core/Src/FAT/ff.c **** 	sz_blk = opt->align;
 8736              		.loc 1 5920 2 is_stmt 1 view .LVU2954
 8737              		.loc 1 5920 14 is_stmt 0 view .LVU2955
 8738 0040 6B68     		ldr	r3, [r5, #4]
 8739              		.loc 1 5920 9 view .LVU2956
 8740 0042 0F93     		str	r3, [sp, #60]
5921:Core/Src/FAT/ff.c **** 	if (sz_blk == 0) disk_ioctl(pdrv, GET_BLOCK_SIZE, &sz_blk);					/* Block size from the paramter or
 8741              		.loc 1 5921 2 is_stmt 1 view .LVU2957
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 303


 8742              		.loc 1 5921 5 is_stmt 0 view .LVU2958
 8743 0044 FBB1     		cbz	r3, .L705
 8744              	.LVL1019:
 8745              	.L618:
5922:Core/Src/FAT/ff.c ****  	if (sz_blk == 0 || sz_blk > 0x8000 || (sz_blk & (sz_blk - 1))) sz_blk = 1;	/* Use default if the 
 8746              		.loc 1 5922 3 is_stmt 1 view .LVU2959
 8747              		.loc 1 5922 19 is_stmt 0 view .LVU2960
 8748 0046 0F9A     		ldr	r2, [sp, #60]
 8749 0048 531E     		subs	r3, r2, #1
 8750              		.loc 1 5922 6 view .LVU2961
 8751 004a B3F5004F 		cmp	r3, #32768
 8752 004e 01D2     		bcs	.L619
 8753              		.loc 1 5922 38 discriminator 2 view .LVU2962
 8754 0050 1A42     		tst	r2, r3
 8755 0052 01D0     		beq	.L620
 8756              	.L619:
 8757              		.loc 1 5922 66 is_stmt 1 discriminator 3 view .LVU2963
 8758              		.loc 1 5922 73 is_stmt 0 discriminator 3 view .LVU2964
 8759 0054 0123     		movs	r3, #1
 8760 0056 0F93     		str	r3, [sp, #60]
 8761              	.L620:
5923:Core/Src/FAT/ff.c **** #if FF_MAX_SS != FF_MIN_SS
5924:Core/Src/FAT/ff.c **** 	if (disk_ioctl(pdrv, GET_SECTOR_SIZE, &ss) != RES_OK) return FR_DISK_ERR;
5925:Core/Src/FAT/ff.c **** 	if (ss > FF_MAX_SS || ss < FF_MIN_SS || (ss & (ss - 1))) return FR_DISK_ERR;
5926:Core/Src/FAT/ff.c **** #else
5927:Core/Src/FAT/ff.c **** 	ss = FF_MAX_SS;
 8762              		.loc 1 5927 2 is_stmt 1 view .LVU2965
 8763              	.LVL1020:
5928:Core/Src/FAT/ff.c **** #endif
5929:Core/Src/FAT/ff.c **** 
5930:Core/Src/FAT/ff.c **** 	/* Options for FAT sub-type and FAT parameters */
5931:Core/Src/FAT/ff.c **** 	fsopt = opt->fmt & (FM_ANY | FM_SFD);
 8764              		.loc 1 5931 2 view .LVU2966
 8765              		.loc 1 5931 13 is_stmt 0 view .LVU2967
 8766 0058 2E78     		ldrb	r6, [r5]	@ zero_extendqisi2
 8767              	.LVL1021:
5932:Core/Src/FAT/ff.c **** 	n_fat = (opt->n_fat >= 1 && opt->n_fat <= 2) ? opt->n_fat : 1;
 8768              		.loc 1 5932 2 is_stmt 1 view .LVU2968
 8769              		.loc 1 5932 14 is_stmt 0 view .LVU2969
 8770 005a 6A78     		ldrb	r2, [r5, #1]	@ zero_extendqisi2
 8771              		.loc 1 5932 27 view .LVU2970
 8772 005c 531E     		subs	r3, r2, #1
 8773 005e DBB2     		uxtb	r3, r3
 8774              		.loc 1 5932 60 view .LVU2971
 8775 0060 012B     		cmp	r3, #1
 8776 0062 16D9     		bls	.L706
 8777 0064 4FF0010B 		mov	fp, #1
 8778              	.L621:
 8779              	.LVL1022:
5933:Core/Src/FAT/ff.c **** 	n_root = (opt->n_root >= 1 && opt->n_root <= 32768 && (opt->n_root % (ss / SZDIRE)) == 0) ? opt->n
 8780              		.loc 1 5933 2 is_stmt 1 discriminator 4 view .LVU2972
 8781              		.loc 1 5933 15 is_stmt 0 discriminator 4 view .LVU2973
 8782 0068 D5F80890 		ldr	r9, [r5, #8]
 8783              		.loc 1 5933 29 discriminator 4 view .LVU2974
 8784 006c 09F1FF33 		add	r3, r9, #-1
 8785              		.loc 1 5933 106 discriminator 4 view .LVU2975
 8786 0070 B3F5004F 		cmp	r3, #32768
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 304


 8787 0074 0FD2     		bcs	.L670
 8788              		.loc 1 5933 53 discriminator 1 view .LVU2976
 8789 0076 19F00F0F 		tst	r9, #15
 8790 007a 0ED0     		beq	.L622
 8791              		.loc 1 5933 106 view .LVU2977
 8792 007c 4FF40079 		mov	r9, #512
 8793 0080 0BE0     		b	.L622
 8794              	.LVL1023:
 8795              	.L704:
5919:Core/Src/FAT/ff.c **** 	sz_blk = opt->align;
 8796              		.loc 1 5919 16 view .LVU2978
 8797 0082 8A4D     		ldr	r5, .L718+4
 8798              	.LVL1024:
5919:Core/Src/FAT/ff.c **** 	sz_blk = opt->align;
 8799              		.loc 1 5919 16 view .LVU2979
 8800 0084 DCE7     		b	.L617
 8801              	.LVL1025:
 8802              	.L705:
5921:Core/Src/FAT/ff.c ****  	if (sz_blk == 0 || sz_blk > 0x8000 || (sz_blk & (sz_blk - 1))) sz_blk = 1;	/* Use default if the 
 8803              		.loc 1 5921 19 is_stmt 1 discriminator 1 view .LVU2980
 8804 0086 0FAA     		add	r2, sp, #60
 8805 0088 0321     		movs	r1, #3
 8806 008a 2046     		mov	r0, r4
 8807              	.LVL1026:
5921:Core/Src/FAT/ff.c ****  	if (sz_blk == 0 || sz_blk > 0x8000 || (sz_blk & (sz_blk - 1))) sz_blk = 1;	/* Use default if the 
 8808              		.loc 1 5921 19 is_stmt 0 discriminator 1 view .LVU2981
 8809 008c FFF7FEFF 		bl	disk_ioctl
 8810              	.LVL1027:
 8811 0090 D9E7     		b	.L618
 8812              	.LVL1028:
 8813              	.L706:
5932:Core/Src/FAT/ff.c **** 	n_root = (opt->n_root >= 1 && opt->n_root <= 32768 && (opt->n_root % (ss / SZDIRE)) == 0) ? opt->n
 8814              		.loc 1 5932 60 discriminator 1 view .LVU2982
 8815 0092 9346     		mov	fp, r2
 8816 0094 E8E7     		b	.L621
 8817              	.LVL1029:
 8818              	.L670:
 8819              		.loc 1 5933 106 view .LVU2983
 8820 0096 4FF40079 		mov	r9, #512
 8821              	.L622:
 8822              	.LVL1030:
5934:Core/Src/FAT/ff.c **** 	sz_au = (opt->au_size <= 0x1000000 && (opt->au_size & (opt->au_size - 1)) == 0) ? opt->au_size : 0
 8823              		.loc 1 5934 2 is_stmt 1 discriminator 6 view .LVU2984
 8824              		.loc 1 5934 14 is_stmt 0 discriminator 6 view .LVU2985
 8825 009a ED68     		ldr	r5, [r5, #12]
 8826              	.LVL1031:
 8827              		.loc 1 5934 97 discriminator 6 view .LVU2986
 8828 009c B5F1807F 		cmp	r5, #16777216
 8829 00a0 04D8     		bhi	.L671
 8830              		.loc 1 5934 70 discriminator 1 view .LVU2987
 8831 00a2 6B1E     		subs	r3, r5, #1
 8832              		.loc 1 5934 37 discriminator 1 view .LVU2988
 8833 00a4 1D42     		tst	r5, r3
 8834 00a6 02D0     		beq	.L623
 8835              		.loc 1 5934 97 view .LVU2989
 8836 00a8 0025     		movs	r5, #0
 8837 00aa 00E0     		b	.L623
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 305


 8838              	.L671:
 8839 00ac 0025     		movs	r5, #0
 8840              	.L623:
 8841              	.LVL1032:
5935:Core/Src/FAT/ff.c **** 	sz_au /= ss;	/* Byte --> Sector */
 8842              		.loc 1 5935 2 is_stmt 1 discriminator 6 view .LVU2990
 8843              		.loc 1 5935 8 is_stmt 0 discriminator 6 view .LVU2991
 8844 00ae 4FEA5528 		lsr	r8, r5, #9
 8845              	.LVL1033:
5936:Core/Src/FAT/ff.c **** 
5937:Core/Src/FAT/ff.c **** 	/* Get working buffer */
5938:Core/Src/FAT/ff.c **** 	sz_buf = len / ss;		/* Size of working buffer [sector] */
 8846              		.loc 1 5938 2 is_stmt 1 discriminator 6 view .LVU2992
 8847              		.loc 1 5938 9 is_stmt 0 discriminator 6 view .LVU2993
 8848 00b2 019B     		ldr	r3, [sp, #4]
 8849 00b4 5A0A     		lsrs	r2, r3, #9
 8850 00b6 0492     		str	r2, [sp, #16]
 8851              	.LVL1034:
5939:Core/Src/FAT/ff.c **** 	if (sz_buf == 0) return FR_NOT_ENOUGH_CORE;
 8852              		.loc 1 5939 2 is_stmt 1 discriminator 6 view .LVU2994
 8853              		.loc 1 5939 5 is_stmt 0 discriminator 6 view .LVU2995
 8854 00b8 B3F5007F 		cmp	r3, #512
 8855 00bc C0F0A082 		bcc	.L672
5940:Core/Src/FAT/ff.c **** 	buf = (BYTE*)work;		/* Working buffer */
 8856              		.loc 1 5940 2 is_stmt 1 view .LVU2996
 8857              	.LVL1035:
5941:Core/Src/FAT/ff.c **** #if FF_USE_LFN == 3
5942:Core/Src/FAT/ff.c **** 	if (!buf) buf = ff_memalloc(sz_buf * ss);	/* Use heap memory for working buffer */
5943:Core/Src/FAT/ff.c **** #endif
5944:Core/Src/FAT/ff.c **** 	if (!buf) return FR_NOT_ENOUGH_CORE;
 8858              		.loc 1 5944 2 view .LVU2997
 8859              		.loc 1 5944 5 is_stmt 0 view .LVU2998
 8860 00c0 029B     		ldr	r3, [sp, #8]
 8861 00c2 002B     		cmp	r3, #0
 8862 00c4 00F09E82 		beq	.L673
5945:Core/Src/FAT/ff.c **** 
5946:Core/Src/FAT/ff.c **** 	/* Determine where the volume to be located (b_vol, sz_vol) */
5947:Core/Src/FAT/ff.c **** 	b_vol = sz_vol = 0;
 8863              		.loc 1 5947 2 is_stmt 1 view .LVU2999
 8864              		.loc 1 5947 17 is_stmt 0 view .LVU3000
 8865 00c8 0023     		movs	r3, #0
 8866 00ca 0E93     		str	r3, [sp, #56]
 8867              	.LVL1036:
5948:Core/Src/FAT/ff.c **** 	if (FF_MULTI_PARTITION && ipart != 0) {	/* Is the volume associated with any specific partition? *
 8868              		.loc 1 5948 2 is_stmt 1 view .LVU3001
5949:Core/Src/FAT/ff.c **** 		/* Get partition location from the existing partition table */
5950:Core/Src/FAT/ff.c **** 		if (disk_read(pdrv, buf, 0, 1) != RES_OK) LEAVE_MKFS(FR_DISK_ERR);	/* Load MBR */
5951:Core/Src/FAT/ff.c **** 		if (ld_word(buf + BS_55AA) != 0xAA55) LEAVE_MKFS(FR_MKFS_ABORTED);	/* Check if MBR is valid */
5952:Core/Src/FAT/ff.c **** #if FF_LBA64
5953:Core/Src/FAT/ff.c **** 		if (buf[MBR_Table + PTE_System] == 0xEE) {	/* GPT protective MBR? */
5954:Core/Src/FAT/ff.c **** 			DWORD n_ent, ofs;
5955:Core/Src/FAT/ff.c **** 			QWORD pt_lba;
5956:Core/Src/FAT/ff.c **** 
5957:Core/Src/FAT/ff.c **** 			/* Get the partition location from GPT */
5958:Core/Src/FAT/ff.c **** 			if (disk_read(pdrv, buf, 1, 1) != RES_OK) LEAVE_MKFS(FR_DISK_ERR);	/* Load GPT header sector (ne
5959:Core/Src/FAT/ff.c **** 			if (!test_gpt_header(buf)) LEAVE_MKFS(FR_MKFS_ABORTED);	/* Check if GPT header is valid */
5960:Core/Src/FAT/ff.c **** 			n_ent = ld_dword(buf + GPTH_PtNum);		/* Number of entries */
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 306


5961:Core/Src/FAT/ff.c **** 			pt_lba = ld_qword(buf + GPTH_PtOfs);	/* Table start sector */
5962:Core/Src/FAT/ff.c **** 			ofs = i = 0;
5963:Core/Src/FAT/ff.c **** 			while (n_ent) {		/* Find MS Basic partition with order of ipart */
5964:Core/Src/FAT/ff.c **** 				if (ofs == 0 && disk_read(pdrv, buf, pt_lba++, 1) != RES_OK) LEAVE_MKFS(FR_DISK_ERR);	/* Get PT
5965:Core/Src/FAT/ff.c **** 				if (!memcmp(buf + ofs + GPTE_PtGuid, GUID_MS_Basic, 16) && ++i == ipart) {	/* MS basic data par
5966:Core/Src/FAT/ff.c **** 					b_vol = ld_qword(buf + ofs + GPTE_FstLba);
5967:Core/Src/FAT/ff.c **** 					sz_vol = ld_qword(buf + ofs + GPTE_LstLba) - b_vol + 1;
5968:Core/Src/FAT/ff.c **** 					break;
5969:Core/Src/FAT/ff.c **** 				}
5970:Core/Src/FAT/ff.c **** 				n_ent--; ofs = (ofs + SZ_GPTE) % ss;	/* Next entry */
5971:Core/Src/FAT/ff.c **** 			}
5972:Core/Src/FAT/ff.c **** 			if (n_ent == 0) LEAVE_MKFS(FR_MKFS_ABORTED);	/* Partition not found */
5973:Core/Src/FAT/ff.c **** 			fsopt |= 0x80;	/* Partitioning is in GPT */
5974:Core/Src/FAT/ff.c **** 		} else
5975:Core/Src/FAT/ff.c **** #endif
5976:Core/Src/FAT/ff.c **** 		{	/* Get the partition location from MBR partition table */
5977:Core/Src/FAT/ff.c **** 			pte = buf + (MBR_Table + (ipart - 1) * SZ_PTE);
5978:Core/Src/FAT/ff.c **** 			if (ipart > 4 || pte[PTE_System] == 0) LEAVE_MKFS(FR_MKFS_ABORTED);	/* No partition? */
5979:Core/Src/FAT/ff.c **** 			b_vol = ld_dword(pte + PTE_StLba);		/* Get volume start sector */
5980:Core/Src/FAT/ff.c **** 			sz_vol = ld_dword(pte + PTE_SizLba);	/* Get volume size */
5981:Core/Src/FAT/ff.c **** 		}
5982:Core/Src/FAT/ff.c **** 	} else {	/* The volume is associated with a physical drive */
5983:Core/Src/FAT/ff.c **** 		if (disk_ioctl(pdrv, GET_SECTOR_COUNT, &sz_vol) != RES_OK) LEAVE_MKFS(FR_DISK_ERR);
 8869              		.loc 1 5983 3 view .LVU3002
 8870              		.loc 1 5983 7 is_stmt 0 view .LVU3003
 8871 00cc 0EAA     		add	r2, sp, #56
 8872              	.LVL1037:
 8873              		.loc 1 5983 7 view .LVU3004
 8874 00ce 0121     		movs	r1, #1
 8875 00d0 2046     		mov	r0, r4
 8876 00d2 FFF7FEFF 		bl	disk_ioctl
 8877              	.LVL1038:
 8878              		.loc 1 5983 6 view .LVU3005
 8879 00d6 0028     		cmp	r0, #0
 8880 00d8 40F09682 		bne	.L674
5984:Core/Src/FAT/ff.c **** 		if (!(fsopt & FM_SFD)) {	/* To be partitioned? */
 8881              		.loc 1 5984 3 is_stmt 1 view .LVU3006
 8882              		.loc 1 5984 6 is_stmt 0 view .LVU3007
 8883 00dc 16F00803 		ands	r3, r6, #8
 8884 00e0 0693     		str	r3, [sp, #24]
 8885 00e2 07D1     		bne	.L675
5985:Core/Src/FAT/ff.c **** 			/* Create a single-partition on the drive in this function */
5986:Core/Src/FAT/ff.c **** #if FF_LBA64
5987:Core/Src/FAT/ff.c **** 			if (sz_vol >= FF_MIN_GPT) {	/* Which partition type to create, MBR or GPT? */
5988:Core/Src/FAT/ff.c **** 				fsopt |= 0x80;		/* Partitioning is in GPT */
5989:Core/Src/FAT/ff.c **** 				b_vol = GPT_ALIGN / ss; sz_vol -= b_vol + GPT_ITEMS * SZ_GPTE / ss + 1;	/* Estimated partition 
5990:Core/Src/FAT/ff.c **** 			} else
5991:Core/Src/FAT/ff.c **** #endif
5992:Core/Src/FAT/ff.c **** 			{	/* Partitioning is in MBR */
5993:Core/Src/FAT/ff.c **** 				if (sz_vol > N_SEC_TRACK) {
 8886              		.loc 1 5993 5 is_stmt 1 view .LVU3008
 8887              		.loc 1 5993 16 is_stmt 0 view .LVU3009
 8888 00e4 0E9B     		ldr	r3, [sp, #56]
 8889              		.loc 1 5993 8 view .LVU3010
 8890 00e6 3F2B     		cmp	r3, #63
 8891 00e8 7CD9     		bls	.L676
5994:Core/Src/FAT/ff.c **** 					b_vol = N_SEC_TRACK; sz_vol -= b_vol;	/* Estimated partition offset and size */
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 307


 8892              		.loc 1 5994 6 is_stmt 1 view .LVU3011
 8893              	.LVL1039:
 8894              		.loc 1 5994 27 view .LVU3012
 8895              		.loc 1 5994 34 is_stmt 0 view .LVU3013
 8896 00ea 3F3B     		subs	r3, r3, #63
 8897 00ec 0E93     		str	r3, [sp, #56]
 8898              		.loc 1 5994 12 view .LVU3014
 8899 00ee 3F23     		movs	r3, #63
 8900 00f0 0393     		str	r3, [sp, #12]
 8901 00f2 01E0     		b	.L624
 8902              	.LVL1040:
 8903              	.L675:
5947:Core/Src/FAT/ff.c **** 	if (FF_MULTI_PARTITION && ipart != 0) {	/* Is the volume associated with any specific partition? *
 8904              		.loc 1 5947 8 view .LVU3015
 8905 00f4 0023     		movs	r3, #0
 8906 00f6 0393     		str	r3, [sp, #12]
 8907              	.LVL1041:
 8908              	.L624:
5995:Core/Src/FAT/ff.c **** 				}
5996:Core/Src/FAT/ff.c **** 			}
5997:Core/Src/FAT/ff.c **** 		}
5998:Core/Src/FAT/ff.c **** 	}
5999:Core/Src/FAT/ff.c **** 	if (sz_vol < 128) LEAVE_MKFS(FR_MKFS_ABORTED);	/* Check if volume size is >=128s */
 8909              		.loc 1 5999 2 is_stmt 1 view .LVU3016
 8910              		.loc 1 5999 13 is_stmt 0 view .LVU3017
 8911 00f8 0E9B     		ldr	r3, [sp, #56]
 8912              		.loc 1 5999 5 view .LVU3018
 8913 00fa 7F2B     		cmp	r3, #127
 8914 00fc 40F28682 		bls	.L677
6000:Core/Src/FAT/ff.c **** 
6001:Core/Src/FAT/ff.c **** 	/* Now start to create an FAT volume at b_vol and sz_vol */
6002:Core/Src/FAT/ff.c **** 
6003:Core/Src/FAT/ff.c **** 	do {	/* Pre-determine the FAT type */
 8915              		.loc 1 6003 2 is_stmt 1 view .LVU3019
6004:Core/Src/FAT/ff.c **** 		if (FF_FS_EXFAT && (fsopt & FM_EXFAT)) {	/* exFAT possible? */
 8916              		.loc 1 6004 3 view .LVU3020
6005:Core/Src/FAT/ff.c **** 			if ((fsopt & FM_ANY) == FM_EXFAT || sz_vol >= 0x4000000 || sz_au > 128) {	/* exFAT only, vol >= 
6006:Core/Src/FAT/ff.c **** 				fsty = FS_EXFAT; break;
6007:Core/Src/FAT/ff.c **** 			}
6008:Core/Src/FAT/ff.c **** 		}
6009:Core/Src/FAT/ff.c **** #if FF_LBA64
6010:Core/Src/FAT/ff.c **** 		if (sz_vol >= 0x100000000) LEAVE_MKFS(FR_MKFS_ABORTED);	/* Too large volume for FAT/FAT32 */
6011:Core/Src/FAT/ff.c **** #endif
6012:Core/Src/FAT/ff.c **** 		if (sz_au > 128) sz_au = 128;	/* Invalid AU for FAT/FAT32? */
 8917              		.loc 1 6012 3 view .LVU3021
 8918              		.loc 1 6012 6 is_stmt 0 view .LVU3022
 8919 0100 B5F5813F 		cmp	r5, #66048
 8920 0104 01D3     		bcc	.L625
 8921              		.loc 1 6012 26 view .LVU3023
 8922 0106 4FF08008 		mov	r8, #128
 8923              	.LVL1042:
 8924              	.L625:
6013:Core/Src/FAT/ff.c **** 		if (fsopt & FM_FAT32) {	/* FAT32 possible? */
 8925              		.loc 1 6013 3 is_stmt 1 view .LVU3024
 8926              		.loc 1 6013 6 is_stmt 0 view .LVU3025
 8927 010a 16F00203 		ands	r3, r6, #2
 8928 010e 0593     		str	r3, [sp, #20]
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 308


 8929 0110 02D0     		beq	.L626
6014:Core/Src/FAT/ff.c **** 			if (!(fsopt & FM_FAT)) {	/* no-FAT? */
 8930              		.loc 1 6014 4 is_stmt 1 view .LVU3026
 8931              		.loc 1 6014 7 is_stmt 0 view .LVU3027
 8932 0112 16F0010F 		tst	r6, #1
 8933 0116 68D0     		beq	.L679
 8934              	.L626:
6015:Core/Src/FAT/ff.c **** 				fsty = FS_FAT32; break;
6016:Core/Src/FAT/ff.c **** 			}
6017:Core/Src/FAT/ff.c **** 		}
6018:Core/Src/FAT/ff.c **** 		if (!(fsopt & FM_FAT)) LEAVE_MKFS(FR_INVALID_PARAMETER);	/* no-FAT? */
 8935              		.loc 1 6018 3 is_stmt 1 view .LVU3028
 8936              		.loc 1 6018 6 is_stmt 0 view .LVU3029
 8937 0118 16F0010F 		tst	r6, #1
 8938 011c 00F07882 		beq	.L680
6019:Core/Src/FAT/ff.c **** 		fsty = FS_FAT16;
 8939              		.loc 1 6019 8 view .LVU3030
 8940 0120 4FF0020A 		mov	r10, #2
 8941              	.L627:
 8942              	.LVL1043:
6020:Core/Src/FAT/ff.c **** 	} while (0);
 8943              		.loc 1 6020 10 is_stmt 1 view .LVU3031
6021:Core/Src/FAT/ff.c **** 
6022:Core/Src/FAT/ff.c **** 	vsn = (DWORD)sz_vol + GET_FATTIME();	/* VSN generated from current time and partitiion size */
 8944              		.loc 1 6022 2 view .LVU3032
 8945              		.loc 1 6022 24 is_stmt 0 view .LVU3033
 8946 0124 FFF7FEFF 		bl	get_fattime
 8947              	.LVL1044:
 8948              		.loc 1 6022 8 view .LVU3034
 8949 0128 0E99     		ldr	r1, [sp, #56]
 8950              		.loc 1 6022 6 view .LVU3035
 8951 012a 4318     		adds	r3, r0, r1
 8952 012c 0793     		str	r3, [sp, #28]
 8953              	.LVL1045:
 8954              		.loc 1 6022 6 view .LVU3036
 8955 012e 4046     		mov	r0, r8
 8956              	.LVL1046:
 8957              	.L628:
6023:Core/Src/FAT/ff.c **** 
6024:Core/Src/FAT/ff.c **** #if FF_FS_EXFAT
6025:Core/Src/FAT/ff.c **** 	if (fsty == FS_EXFAT) {	/* Create an exFAT volume */
6026:Core/Src/FAT/ff.c **** 		DWORD szb_bit, szb_case, sum, nbit, clu, clen[3];
6027:Core/Src/FAT/ff.c **** 		WCHAR ch, si;
6028:Core/Src/FAT/ff.c **** 		UINT j, st;
6029:Core/Src/FAT/ff.c **** 
6030:Core/Src/FAT/ff.c **** 		if (sz_vol < 0x1000) LEAVE_MKFS(FR_MKFS_ABORTED);	/* Too small volume for exFAT? */
6031:Core/Src/FAT/ff.c **** #if FF_USE_TRIM
6032:Core/Src/FAT/ff.c **** 		lba[0] = b_vol; lba[1] = b_vol + sz_vol - 1;	/* Inform storage device that the volume area may be
6033:Core/Src/FAT/ff.c **** 		disk_ioctl(pdrv, CTRL_TRIM, lba);
6034:Core/Src/FAT/ff.c **** #endif
6035:Core/Src/FAT/ff.c **** 		/* Determine FAT location, data location and number of clusters */
6036:Core/Src/FAT/ff.c **** 		if (sz_au == 0) {	/* AU auto-selection */
6037:Core/Src/FAT/ff.c **** 			sz_au = 8;
6038:Core/Src/FAT/ff.c **** 			if (sz_vol >= 0x80000) sz_au = 64;		/* >= 512Ks */
6039:Core/Src/FAT/ff.c **** 			if (sz_vol >= 0x4000000) sz_au = 256;	/* >= 64Ms */
6040:Core/Src/FAT/ff.c **** 		}
6041:Core/Src/FAT/ff.c **** 		b_fat = b_vol + 32;										/* FAT start at offset 32 */
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 309


6042:Core/Src/FAT/ff.c **** 		sz_fat = (DWORD)((sz_vol / sz_au + 2) * 4 + ss - 1) / ss;	/* Number of FAT sectors */
6043:Core/Src/FAT/ff.c **** 		b_data = (b_fat + sz_fat + sz_blk - 1) & ~((LBA_t)sz_blk - 1);	/* Align data area to the erase bl
6044:Core/Src/FAT/ff.c **** 		if (b_data - b_vol >= sz_vol / 2) LEAVE_MKFS(FR_MKFS_ABORTED);	/* Too small volume? */
6045:Core/Src/FAT/ff.c **** 		n_clst = (DWORD)((sz_vol - (b_data - b_vol)) / sz_au);	/* Number of clusters */
6046:Core/Src/FAT/ff.c **** 		if (n_clst <16) LEAVE_MKFS(FR_MKFS_ABORTED);			/* Too few clusters? */
6047:Core/Src/FAT/ff.c **** 		if (n_clst > MAX_EXFAT) LEAVE_MKFS(FR_MKFS_ABORTED);	/* Too many clusters? */
6048:Core/Src/FAT/ff.c **** 
6049:Core/Src/FAT/ff.c **** 		szb_bit = (n_clst + 7) / 8;								/* Size of allocation bitmap */
6050:Core/Src/FAT/ff.c **** 		clen[0] = (szb_bit + sz_au * ss - 1) / (sz_au * ss);	/* Number of allocation bitmap clusters */
6051:Core/Src/FAT/ff.c **** 
6052:Core/Src/FAT/ff.c **** 		/* Create a compressed up-case table */
6053:Core/Src/FAT/ff.c **** 		sect = b_data + sz_au * clen[0];	/* Table start sector */
6054:Core/Src/FAT/ff.c **** 		sum = 0;							/* Table checksum to be stored in the 82 entry */
6055:Core/Src/FAT/ff.c **** 		st = 0; si = 0; i = 0; j = 0; szb_case = 0;
6056:Core/Src/FAT/ff.c **** 		do {
6057:Core/Src/FAT/ff.c **** 			switch (st) {
6058:Core/Src/FAT/ff.c **** 			case 0:
6059:Core/Src/FAT/ff.c **** 				ch = (WCHAR)ff_wtoupper(si);	/* Get an up-case char */
6060:Core/Src/FAT/ff.c **** 				if (ch != si) {
6061:Core/Src/FAT/ff.c **** 					si++; break;		/* Store the up-case char if exist */
6062:Core/Src/FAT/ff.c **** 				}
6063:Core/Src/FAT/ff.c **** 				for (j = 1; (WCHAR)(si + j) && (WCHAR)(si + j) == ff_wtoupper((WCHAR)(si + j)); j++) ;	/* Get r
6064:Core/Src/FAT/ff.c **** 				if (j >= 128) {
6065:Core/Src/FAT/ff.c **** 					ch = 0xFFFF; st = 2; break;	/* Compress the no-case block if run is >= 128 chars */
6066:Core/Src/FAT/ff.c **** 				}
6067:Core/Src/FAT/ff.c **** 				st = 1;			/* Do not compress short run */
6068:Core/Src/FAT/ff.c **** 				/* FALLTHROUGH */
6069:Core/Src/FAT/ff.c **** 			case 1:
6070:Core/Src/FAT/ff.c **** 				ch = si++;		/* Fill the short run */
6071:Core/Src/FAT/ff.c **** 				if (--j == 0) st = 0;
6072:Core/Src/FAT/ff.c **** 				break;
6073:Core/Src/FAT/ff.c **** 
6074:Core/Src/FAT/ff.c **** 			default:
6075:Core/Src/FAT/ff.c **** 				ch = (WCHAR)j; si += (WCHAR)j;	/* Number of chars to skip */
6076:Core/Src/FAT/ff.c **** 				st = 0;
6077:Core/Src/FAT/ff.c **** 			}
6078:Core/Src/FAT/ff.c **** 			sum = xsum32(buf[i + 0] = (BYTE)ch, sum);	/* Put it into the write buffer */
6079:Core/Src/FAT/ff.c **** 			sum = xsum32(buf[i + 1] = (BYTE)(ch >> 8), sum);
6080:Core/Src/FAT/ff.c **** 			i += 2; szb_case += 2;
6081:Core/Src/FAT/ff.c **** 			if (si == 0 || i == sz_buf * ss) {		/* Write buffered data when buffer full or end of process */
6082:Core/Src/FAT/ff.c **** 				n = (i + ss - 1) / ss;
6083:Core/Src/FAT/ff.c **** 				if (disk_write(pdrv, buf, sect, n) != RES_OK) LEAVE_MKFS(FR_DISK_ERR);
6084:Core/Src/FAT/ff.c **** 				sect += n; i = 0;
6085:Core/Src/FAT/ff.c **** 			}
6086:Core/Src/FAT/ff.c **** 		} while (si);
6087:Core/Src/FAT/ff.c **** 		clen[1] = (szb_case + sz_au * ss - 1) / (sz_au * ss);	/* Number of up-case table clusters */
6088:Core/Src/FAT/ff.c **** 		clen[2] = 1;	/* Number of root dir clusters */
6089:Core/Src/FAT/ff.c **** 
6090:Core/Src/FAT/ff.c **** 		/* Initialize the allocation bitmap */
6091:Core/Src/FAT/ff.c **** 		sect = b_data; nsect = (szb_bit + ss - 1) / ss;	/* Start of bitmap and number of bitmap sectors *
6092:Core/Src/FAT/ff.c **** 		nbit = clen[0] + clen[1] + clen[2];				/* Number of clusters in-use by system (bitmap, up-case an
6093:Core/Src/FAT/ff.c **** 		do {
6094:Core/Src/FAT/ff.c **** 			memset(buf, 0, sz_buf * ss);				/* Initialize bitmap buffer */
6095:Core/Src/FAT/ff.c **** 			for (i = 0; nbit != 0 && i / 8 < sz_buf * ss; buf[i / 8] |= 1 << (i % 8), i++, nbit--) ;	/* Mark
6096:Core/Src/FAT/ff.c **** 			n = (nsect > sz_buf) ? sz_buf : nsect;		/* Write the buffered data */
6097:Core/Src/FAT/ff.c **** 			if (disk_write(pdrv, buf, sect, n) != RES_OK) LEAVE_MKFS(FR_DISK_ERR);
6098:Core/Src/FAT/ff.c **** 			sect += n; nsect -= n;
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 310


6099:Core/Src/FAT/ff.c **** 		} while (nsect);
6100:Core/Src/FAT/ff.c **** 
6101:Core/Src/FAT/ff.c **** 		/* Initialize the FAT */
6102:Core/Src/FAT/ff.c **** 		sect = b_fat; nsect = sz_fat;	/* Start of FAT and number of FAT sectors */
6103:Core/Src/FAT/ff.c **** 		j = nbit = clu = 0;
6104:Core/Src/FAT/ff.c **** 		do {
6105:Core/Src/FAT/ff.c **** 			memset(buf, 0, sz_buf * ss); i = 0;	/* Clear work area and reset write offset */
6106:Core/Src/FAT/ff.c **** 			if (clu == 0) {	/* Initialize FAT [0] and FAT[1] */
6107:Core/Src/FAT/ff.c **** 				st_dword(buf + i, 0xFFFFFFF8); i += 4; clu++;
6108:Core/Src/FAT/ff.c **** 				st_dword(buf + i, 0xFFFFFFFF); i += 4; clu++;
6109:Core/Src/FAT/ff.c **** 			}
6110:Core/Src/FAT/ff.c **** 			do {			/* Create chains of bitmap, up-case and root dir */
6111:Core/Src/FAT/ff.c **** 				while (nbit != 0 && i < sz_buf * ss) {	/* Create a chain */
6112:Core/Src/FAT/ff.c **** 					st_dword(buf + i, (nbit > 1) ? clu + 1 : 0xFFFFFFFF);
6113:Core/Src/FAT/ff.c **** 					i += 4; clu++; nbit--;
6114:Core/Src/FAT/ff.c **** 				}
6115:Core/Src/FAT/ff.c **** 				if (nbit == 0 && j < 3) nbit = clen[j++];	/* Get next chain length */
6116:Core/Src/FAT/ff.c **** 			} while (nbit != 0 && i < sz_buf * ss);
6117:Core/Src/FAT/ff.c **** 			n = (nsect > sz_buf) ? sz_buf : nsect;	/* Write the buffered data */
6118:Core/Src/FAT/ff.c **** 			if (disk_write(pdrv, buf, sect, n) != RES_OK) LEAVE_MKFS(FR_DISK_ERR);
6119:Core/Src/FAT/ff.c **** 			sect += n; nsect -= n;
6120:Core/Src/FAT/ff.c **** 		} while (nsect);
6121:Core/Src/FAT/ff.c **** 
6122:Core/Src/FAT/ff.c **** 		/* Initialize the root directory */
6123:Core/Src/FAT/ff.c **** 		memset(buf, 0, sz_buf * ss);
6124:Core/Src/FAT/ff.c **** 		buf[SZDIRE * 0 + 0] = ET_VLABEL;				/* Volume label entry (no label) */
6125:Core/Src/FAT/ff.c **** 		buf[SZDIRE * 1 + 0] = ET_BITMAP;				/* Bitmap entry */
6126:Core/Src/FAT/ff.c **** 		st_dword(buf + SZDIRE * 1 + 20, 2);				/*  cluster */
6127:Core/Src/FAT/ff.c **** 		st_dword(buf + SZDIRE * 1 + 24, szb_bit);		/*  size */
6128:Core/Src/FAT/ff.c **** 		buf[SZDIRE * 2 + 0] = ET_UPCASE;				/* Up-case table entry */
6129:Core/Src/FAT/ff.c **** 		st_dword(buf + SZDIRE * 2 + 4, sum);			/*  sum */
6130:Core/Src/FAT/ff.c **** 		st_dword(buf + SZDIRE * 2 + 20, 2 + clen[0]);	/*  cluster */
6131:Core/Src/FAT/ff.c **** 		st_dword(buf + SZDIRE * 2 + 24, szb_case);		/*  size */
6132:Core/Src/FAT/ff.c **** 		sect = b_data + sz_au * (clen[0] + clen[1]); nsect = sz_au;	/* Start of the root directory and nu
6133:Core/Src/FAT/ff.c **** 		do {	/* Fill root directory sectors */
6134:Core/Src/FAT/ff.c **** 			n = (nsect > sz_buf) ? sz_buf : nsect;
6135:Core/Src/FAT/ff.c **** 			if (disk_write(pdrv, buf, sect, n) != RES_OK) LEAVE_MKFS(FR_DISK_ERR);
6136:Core/Src/FAT/ff.c **** 			memset(buf, 0, ss);	/* Rest of entries are filled with zero */
6137:Core/Src/FAT/ff.c **** 			sect += n; nsect -= n;
6138:Core/Src/FAT/ff.c **** 		} while (nsect);
6139:Core/Src/FAT/ff.c **** 
6140:Core/Src/FAT/ff.c **** 		/* Create two set of the exFAT VBR blocks */
6141:Core/Src/FAT/ff.c **** 		sect = b_vol;
6142:Core/Src/FAT/ff.c **** 		for (n = 0; n < 2; n++) {
6143:Core/Src/FAT/ff.c **** 			/* Main record (+0) */
6144:Core/Src/FAT/ff.c **** 			memset(buf, 0, ss);
6145:Core/Src/FAT/ff.c **** 			memcpy(buf + BS_JmpBoot, "\xEB\x76\x90" "EXFAT   ", 11);	/* Boot jump code (x86), OEM name */
6146:Core/Src/FAT/ff.c **** 			st_qword(buf + BPB_VolOfsEx, b_vol);					/* Volume offset in the physical drive [sector] */
6147:Core/Src/FAT/ff.c **** 			st_qword(buf + BPB_TotSecEx, sz_vol);					/* Volume size [sector] */
6148:Core/Src/FAT/ff.c **** 			st_dword(buf + BPB_FatOfsEx, (DWORD)(b_fat - b_vol));	/* FAT offset [sector] */
6149:Core/Src/FAT/ff.c **** 			st_dword(buf + BPB_FatSzEx, sz_fat);					/* FAT size [sector] */
6150:Core/Src/FAT/ff.c **** 			st_dword(buf + BPB_DataOfsEx, (DWORD)(b_data - b_vol));	/* Data offset [sector] */
6151:Core/Src/FAT/ff.c **** 			st_dword(buf + BPB_NumClusEx, n_clst);					/* Number of clusters */
6152:Core/Src/FAT/ff.c **** 			st_dword(buf + BPB_RootClusEx, 2 + clen[0] + clen[1]);	/* Root dir cluster # */
6153:Core/Src/FAT/ff.c **** 			st_dword(buf + BPB_VolIDEx, vsn);						/* VSN */
6154:Core/Src/FAT/ff.c **** 			st_word(buf + BPB_FSVerEx, 0x100);						/* Filesystem version (1.00) */
6155:Core/Src/FAT/ff.c **** 			for (buf[BPB_BytsPerSecEx] = 0, i = ss; i >>= 1; buf[BPB_BytsPerSecEx]++) ;	/* Log2 of sector si
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 311


6156:Core/Src/FAT/ff.c **** 			for (buf[BPB_SecPerClusEx] = 0, i = sz_au; i >>= 1; buf[BPB_SecPerClusEx]++) ;	/* Log2 of cluste
6157:Core/Src/FAT/ff.c **** 			buf[BPB_NumFATsEx] = 1;					/* Number of FATs */
6158:Core/Src/FAT/ff.c **** 			buf[BPB_DrvNumEx] = 0x80;				/* Drive number (for int13) */
6159:Core/Src/FAT/ff.c **** 			st_word(buf + BS_BootCodeEx, 0xFEEB);	/* Boot code (x86) */
6160:Core/Src/FAT/ff.c **** 			st_word(buf + BS_55AA, 0xAA55);			/* Signature (placed here regardless of sector size) */
6161:Core/Src/FAT/ff.c **** 			for (i = sum = 0; i < ss; i++) {		/* VBR checksum */
6162:Core/Src/FAT/ff.c **** 				if (i != BPB_VolFlagEx && i != BPB_VolFlagEx + 1 && i != BPB_PercInUseEx) sum = xsum32(buf[i], 
6163:Core/Src/FAT/ff.c **** 			}
6164:Core/Src/FAT/ff.c **** 			if (disk_write(pdrv, buf, sect++, 1) != RES_OK) LEAVE_MKFS(FR_DISK_ERR);
6165:Core/Src/FAT/ff.c **** 			/* Extended bootstrap record (+1..+8) */
6166:Core/Src/FAT/ff.c **** 			memset(buf, 0, ss);
6167:Core/Src/FAT/ff.c **** 			st_word(buf + ss - 2, 0xAA55);	/* Signature (placed at end of sector) */
6168:Core/Src/FAT/ff.c **** 			for (j = 1; j < 9; j++) {
6169:Core/Src/FAT/ff.c **** 				for (i = 0; i < ss; sum = xsum32(buf[i++], sum)) ;	/* VBR checksum */
6170:Core/Src/FAT/ff.c **** 				if (disk_write(pdrv, buf, sect++, 1) != RES_OK) LEAVE_MKFS(FR_DISK_ERR);
6171:Core/Src/FAT/ff.c **** 			}
6172:Core/Src/FAT/ff.c **** 			/* OEM/Reserved record (+9..+10) */
6173:Core/Src/FAT/ff.c **** 			memset(buf, 0, ss);
6174:Core/Src/FAT/ff.c **** 			for ( ; j < 11; j++) {
6175:Core/Src/FAT/ff.c **** 				for (i = 0; i < ss; sum = xsum32(buf[i++], sum)) ;	/* VBR checksum */
6176:Core/Src/FAT/ff.c **** 				if (disk_write(pdrv, buf, sect++, 1) != RES_OK) LEAVE_MKFS(FR_DISK_ERR);
6177:Core/Src/FAT/ff.c **** 			}
6178:Core/Src/FAT/ff.c **** 			/* Sum record (+11) */
6179:Core/Src/FAT/ff.c **** 			for (i = 0; i < ss; i += 4) st_dword(buf + i, sum);		/* Fill with checksum value */
6180:Core/Src/FAT/ff.c **** 			if (disk_write(pdrv, buf, sect++, 1) != RES_OK) LEAVE_MKFS(FR_DISK_ERR);
6181:Core/Src/FAT/ff.c **** 		}
6182:Core/Src/FAT/ff.c **** 
6183:Core/Src/FAT/ff.c **** 	} else
6184:Core/Src/FAT/ff.c **** #endif	/* FF_FS_EXFAT */
6185:Core/Src/FAT/ff.c **** 	{	/* Create an FAT/FAT32 volume */
6186:Core/Src/FAT/ff.c **** 		do {
 8958              		.loc 1 6186 3 is_stmt 1 view .LVU3037
6187:Core/Src/FAT/ff.c **** 			pau = sz_au;
 8959              		.loc 1 6187 4 view .LVU3038
6188:Core/Src/FAT/ff.c **** 			/* Pre-determine number of clusters and FAT sub-type */
6189:Core/Src/FAT/ff.c **** 			if (fsty == FS_FAT32) {	/* FAT32 volume */
 8960              		.loc 1 6189 4 view .LVU3039
 8961              		.loc 1 6189 7 is_stmt 0 view .LVU3040
 8962 0130 BAF1030F 		cmp	r10, #3
 8963 0134 60D0     		beq	.L647
6190:Core/Src/FAT/ff.c **** 				if (pau == 0) {	/* AU auto-selection */
6191:Core/Src/FAT/ff.c **** 					n = (DWORD)sz_vol / 0x20000;	/* Volume size in unit of 128KS */
6192:Core/Src/FAT/ff.c **** 					for (i = 0, pau = 1; cst32[i] && cst32[i] <= n; i++, pau <<= 1) ;	/* Get from table */
6193:Core/Src/FAT/ff.c **** 				}
6194:Core/Src/FAT/ff.c **** 				n_clst = (DWORD)sz_vol / pau;	/* Number of clusters */
6195:Core/Src/FAT/ff.c **** 				sz_fat = (n_clst * 4 + 8 + ss - 1) / ss;	/* FAT size [sector] */
6196:Core/Src/FAT/ff.c **** 				sz_rsv = 32;	/* Number of reserved sectors */
6197:Core/Src/FAT/ff.c **** 				sz_dir = 0;		/* No static directory */
6198:Core/Src/FAT/ff.c **** 				if (n_clst <= MAX_FAT16 || n_clst > MAX_FAT32) LEAVE_MKFS(FR_MKFS_ABORTED);
6199:Core/Src/FAT/ff.c **** 			} else {				/* FAT volume */
6200:Core/Src/FAT/ff.c **** 				if (pau == 0) {	/* au auto-selection */
 8964              		.loc 1 6200 5 is_stmt 1 view .LVU3041
 8965              		.loc 1 6200 8 is_stmt 0 view .LVU3042
 8966 0136 0028     		cmp	r0, #0
 8967 0138 00F08180 		beq	.L707
 8968 013c 0646     		mov	r6, r0
 8969              	.LVL1047:
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 312


 8970              	.L634:
6201:Core/Src/FAT/ff.c **** 					n = (DWORD)sz_vol / 0x1000;	/* Volume size in unit of 4KS */
6202:Core/Src/FAT/ff.c **** 					for (i = 0, pau = 1; cst[i] && cst[i] <= n; i++, pau <<= 1) ;	/* Get from table */
6203:Core/Src/FAT/ff.c **** 				}
6204:Core/Src/FAT/ff.c **** 				n_clst = (DWORD)sz_vol / pau;
 8971              		.loc 1 6204 5 is_stmt 1 view .LVU3043
 8972              		.loc 1 6204 12 is_stmt 0 view .LVU3044
 8973 013e B1FBF6F3 		udiv	r3, r1, r6
 8974              	.LVL1048:
6205:Core/Src/FAT/ff.c **** 				if (n_clst > MAX_FAT12) {
 8975              		.loc 1 6205 5 is_stmt 1 view .LVU3045
 8976              		.loc 1 6205 8 is_stmt 0 view .LVU3046
 8977 0142 40F6F572 		movw	r2, #4085
 8978 0146 9342     		cmp	r3, r2
 8979 0148 40F28880 		bls	.L637
6206:Core/Src/FAT/ff.c **** 					n = n_clst * 2 + 4;		/* FAT size [byte] */
 8980              		.loc 1 6206 6 is_stmt 1 view .LVU3047
 8981              		.loc 1 6206 21 is_stmt 0 view .LVU3048
 8982 014c 9D1C     		adds	r5, r3, #2
 8983              		.loc 1 6206 8 view .LVU3049
 8984 014e 6D00     		lsls	r5, r5, #1
 8985              	.LVL1049:
 8986              	.L638:
6207:Core/Src/FAT/ff.c **** 				} else {
6208:Core/Src/FAT/ff.c **** 					fsty = FS_FAT12;
6209:Core/Src/FAT/ff.c **** 					n = (n_clst * 3 + 1) / 2 + 3;	/* FAT size [byte] */
6210:Core/Src/FAT/ff.c **** 				}
6211:Core/Src/FAT/ff.c **** 				sz_fat = (n + ss - 1) / ss;		/* FAT size [sector] */
 8987              		.loc 1 6211 5 is_stmt 1 view .LVU3050
 8988              		.loc 1 6211 22 is_stmt 0 view .LVU3051
 8989 0150 05F2FF15 		addw	r5, r5, #511
 8990              	.LVL1050:
 8991              		.loc 1 6211 12 view .LVU3052
 8992 0154 6D0A     		lsrs	r5, r5, #9
 8993              	.LVL1051:
6212:Core/Src/FAT/ff.c **** 				sz_rsv = 1;						/* Number of reserved sectors */
 8994              		.loc 1 6212 5 is_stmt 1 view .LVU3053
6213:Core/Src/FAT/ff.c **** 				sz_dir = (DWORD)n_root * SZDIRE / ss;	/* Root dir size [sector] */
 8995              		.loc 1 6213 5 view .LVU3054
 8996              		.loc 1 6213 12 is_stmt 0 view .LVU3055
 8997 0156 C9F31618 		ubfx	r8, r9, #4, #23
 8998              	.LVL1052:
6212:Core/Src/FAT/ff.c **** 				sz_rsv = 1;						/* Number of reserved sectors */
 8999              		.loc 1 6212 12 view .LVU3056
 9000 015a 4FF0010C 		mov	ip, #1
 9001              	.LVL1053:
 9002              	.L633:
6214:Core/Src/FAT/ff.c **** 			}
6215:Core/Src/FAT/ff.c **** 			b_fat = b_vol + sz_rsv;						/* FAT base */
 9003              		.loc 1 6215 4 is_stmt 1 view .LVU3057
 9004              		.loc 1 6215 10 is_stmt 0 view .LVU3058
 9005 015e 039B     		ldr	r3, [sp, #12]
 9006 0160 0CEB030E 		add	lr, ip, r3
 9007              	.LVL1054:
6216:Core/Src/FAT/ff.c **** 			b_data = b_fat + sz_fat * n_fat + sz_dir;	/* Data base */
 9008              		.loc 1 6216 4 is_stmt 1 view .LVU3059
 9009              		.loc 1 6216 19 is_stmt 0 view .LVU3060
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 313


 9010 0164 0BFB05E2 		mla	r2, fp, r5, lr
 9011              		.loc 1 6216 11 view .LVU3061
 9012 0168 4244     		add	r2, r2, r8
 9013              	.LVL1055:
6217:Core/Src/FAT/ff.c **** 
6218:Core/Src/FAT/ff.c **** 			/* Align data area to erase block boundary (for flash memory media) */
6219:Core/Src/FAT/ff.c **** 			n = (DWORD)(((b_data + sz_blk - 1) & ~(sz_blk - 1)) - b_data);	/* Sectors to next nearest from c
 9014              		.loc 1 6219 4 is_stmt 1 view .LVU3062
 9015              		.loc 1 6219 25 is_stmt 0 view .LVU3063
 9016 016a 0F9F     		ldr	r7, [sp, #60]
 9017 016c BB18     		adds	r3, r7, r2
 9018              		.loc 1 6219 34 view .LVU3064
 9019 016e 013B     		subs	r3, r3, #1
 9020              		.loc 1 6219 41 view .LVU3065
 9021 0170 7F42     		rsbs	r7, r7, #0
 9022              		.loc 1 6219 39 view .LVU3066
 9023 0172 3B40     		ands	r3, r3, r7
 9024              		.loc 1 6219 6 view .LVU3067
 9025 0174 9B1A     		subs	r3, r3, r2
 9026              	.LVL1056:
6220:Core/Src/FAT/ff.c **** 			if (fsty == FS_FAT32) {		/* FAT32: Move FAT */
 9027              		.loc 1 6220 4 is_stmt 1 view .LVU3068
 9028              		.loc 1 6220 7 is_stmt 0 view .LVU3069
 9029 0176 BAF1030F 		cmp	r10, #3
 9030 017a 77D0     		beq	.L708
6221:Core/Src/FAT/ff.c **** 				sz_rsv += n; b_fat += n;
6222:Core/Src/FAT/ff.c **** 			} else {					/* FAT: Expand FAT */
6223:Core/Src/FAT/ff.c **** 				if (n % n_fat) {	/* Adjust fractional error if needed */
 9031              		.loc 1 6223 5 is_stmt 1 view .LVU3070
 9032              		.loc 1 6223 11 is_stmt 0 view .LVU3071
 9033 017c B3FBFBF7 		udiv	r7, r3, fp
 9034 0180 0BFB1737 		mls	r7, fp, r7, r3
 9035              		.loc 1 6223 8 view .LVU3072
 9036 0184 27B1     		cbz	r7, .L641
6224:Core/Src/FAT/ff.c **** 					n--; sz_rsv++; b_fat++;
 9037              		.loc 1 6224 6 is_stmt 1 view .LVU3073
 9038              		.loc 1 6224 7 is_stmt 0 view .LVU3074
 9039 0186 013B     		subs	r3, r3, #1
 9040              	.LVL1057:
 9041              		.loc 1 6224 11 is_stmt 1 view .LVU3075
 9042              		.loc 1 6224 17 is_stmt 0 view .LVU3076
 9043 0188 0CF1010C 		add	ip, ip, #1
 9044              	.LVL1058:
 9045              		.loc 1 6224 21 is_stmt 1 view .LVU3077
 9046              		.loc 1 6224 26 is_stmt 0 view .LVU3078
 9047 018c 0EF1010E 		add	lr, lr, #1
 9048              	.LVL1059:
 9049              	.L641:
6225:Core/Src/FAT/ff.c **** 				}
6226:Core/Src/FAT/ff.c **** 				sz_fat += n / n_fat;
 9050              		.loc 1 6226 5 is_stmt 1 view .LVU3079
 9051              		.loc 1 6226 17 is_stmt 0 view .LVU3080
 9052 0190 B3FBFBF3 		udiv	r3, r3, fp
 9053              	.LVL1060:
 9054              		.loc 1 6226 12 view .LVU3081
 9055 0194 1D44     		add	r5, r5, r3
 9056              	.LVL1061:
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 314


 9057              	.L640:
6227:Core/Src/FAT/ff.c **** 			}
6228:Core/Src/FAT/ff.c **** 
6229:Core/Src/FAT/ff.c **** 			/* Determine number of clusters and final check of validity of the FAT sub-type */
6230:Core/Src/FAT/ff.c **** 			if (sz_vol < b_data + pau * 16 - b_vol) LEAVE_MKFS(FR_MKFS_ABORTED);	/* Too small volume? */
 9058              		.loc 1 6230 4 is_stmt 1 view .LVU3082
 9059              		.loc 1 6230 24 is_stmt 0 view .LVU3083
 9060 0196 02EB0612 		add	r2, r2, r6, lsl #4
 9061              	.LVL1062:
 9062              		.loc 1 6230 35 view .LVU3084
 9063 019a 039B     		ldr	r3, [sp, #12]
 9064 019c D21A     		subs	r2, r2, r3
 9065              		.loc 1 6230 7 view .LVU3085
 9066 019e 9142     		cmp	r1, r2
 9067 01a0 C0F04682 		bcc	.L684
6231:Core/Src/FAT/ff.c **** 			n_clst = ((DWORD)sz_vol - sz_rsv - sz_fat * n_fat - sz_dir) / pau;
 9068              		.loc 1 6231 4 is_stmt 1 view .LVU3086
 9069              		.loc 1 6231 28 is_stmt 0 view .LVU3087
 9070 01a4 A1EB0C07 		sub	r7, r1, ip
 9071              		.loc 1 6231 37 view .LVU3088
 9072 01a8 0BFB1577 		mls	r7, fp, r5, r7
 9073              		.loc 1 6231 54 view .LVU3089
 9074 01ac A7EB0807 		sub	r7, r7, r8
 9075              		.loc 1 6231 11 view .LVU3090
 9076 01b0 B7FBF6F7 		udiv	r7, r7, r6
 9077              	.LVL1063:
6232:Core/Src/FAT/ff.c **** 			if (fsty == FS_FAT32) {
 9078              		.loc 1 6232 4 is_stmt 1 view .LVU3091
 9079              		.loc 1 6232 7 is_stmt 0 view .LVU3092
 9080 01b4 BAF1030F 		cmp	r10, #3
 9081 01b8 5BD0     		beq	.L709
 9082              	.L642:
6233:Core/Src/FAT/ff.c **** 				if (n_clst <= MAX_FAT16) {	/* Too few clusters for FAT32? */
6234:Core/Src/FAT/ff.c **** 					if (sz_au == 0 && (sz_au = pau / 2) != 0) continue;	/* Adjust cluster size and retry */
6235:Core/Src/FAT/ff.c **** 					LEAVE_MKFS(FR_MKFS_ABORTED);
6236:Core/Src/FAT/ff.c **** 				}
6237:Core/Src/FAT/ff.c **** 			}
6238:Core/Src/FAT/ff.c **** 			if (fsty == FS_FAT16) {
 9083              		.loc 1 6238 4 is_stmt 1 view .LVU3093
 9084              		.loc 1 6238 7 is_stmt 0 view .LVU3094
 9085 01ba BAF1020F 		cmp	r10, #2
 9086 01be 7DD1     		bne	.L644
6239:Core/Src/FAT/ff.c **** 				if (n_clst > MAX_FAT16) {	/* Too many clusters for FAT16 */
 9087              		.loc 1 6239 5 is_stmt 1 view .LVU3095
 9088              		.loc 1 6239 8 is_stmt 0 view .LVU3096
 9089 01c0 4FF6F573 		movw	r3, #65525
 9090 01c4 9F42     		cmp	r7, r3
 9091 01c6 61D9     		bls	.L645
6240:Core/Src/FAT/ff.c **** 					if (sz_au == 0 && (pau * 2) <= 64) {
 9092              		.loc 1 6240 6 is_stmt 1 view .LVU3097
 9093              		.loc 1 6240 9 is_stmt 0 view .LVU3098
 9094 01c8 10B9     		cbnz	r0, .L646
 9095              		.loc 1 6240 29 discriminator 1 view .LVU3099
 9096 01ca 7300     		lsls	r3, r6, #1
 9097              		.loc 1 6240 21 discriminator 1 view .LVU3100
 9098 01cc 402B     		cmp	r3, #64
 9099 01ce 0FD9     		bls	.L686
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 315


 9100              	.L646:
6241:Core/Src/FAT/ff.c **** 						sz_au = pau * 2; continue;	/* Adjust cluster size and retry */
6242:Core/Src/FAT/ff.c **** 					}
6243:Core/Src/FAT/ff.c **** 					if ((fsopt & FM_FAT32)) {
 9101              		.loc 1 6243 6 is_stmt 1 view .LVU3101
 9102              		.loc 1 6243 9 is_stmt 0 view .LVU3102
 9103 01d0 059B     		ldr	r3, [sp, #20]
 9104 01d2 7BB9     		cbnz	r3, .L687
6244:Core/Src/FAT/ff.c **** 						fsty = FS_FAT32; continue;	/* Switch type to FAT32 and retry */
6245:Core/Src/FAT/ff.c **** 					}
6246:Core/Src/FAT/ff.c **** 					if (sz_au == 0 && (sz_au = pau * 2) <= 128) continue;	/* Adjust cluster size and retry */
 9105              		.loc 1 6246 6 is_stmt 1 view .LVU3103
 9106              		.loc 1 6246 9 is_stmt 0 view .LVU3104
 9107 01d4 0028     		cmp	r0, #0
 9108 01d6 40F02F82 		bne	.L688
 9109              		.loc 1 6246 31 discriminator 1 view .LVU3105
 9110 01da 7000     		lsls	r0, r6, #1
 9111              	.LVL1064:
 9112              		.loc 1 6246 21 discriminator 1 view .LVU3106
 9113 01dc 8028     		cmp	r0, #128
 9114 01de A7D9     		bls	.L628
6247:Core/Src/FAT/ff.c **** 					LEAVE_MKFS(FR_MKFS_ABORTED);
 9115              		.loc 1 6247 6 view .LVU3107
 9116 01e0 0E20     		movs	r0, #14
 9117              	.LVL1065:
 9118              		.loc 1 6247 6 view .LVU3108
 9119 01e2 08E2     		b	.L615
 9120              	.LVL1066:
 9121              	.L676:
5947:Core/Src/FAT/ff.c **** 	if (FF_MULTI_PARTITION && ipart != 0) {	/* Is the volume associated with any specific partition? *
 9122              		.loc 1 5947 8 view .LVU3109
 9123 01e4 0023     		movs	r3, #0
 9124 01e6 0393     		str	r3, [sp, #12]
 9125 01e8 86E7     		b	.L624
 9126              	.LVL1067:
 9127              	.L679:
6015:Core/Src/FAT/ff.c **** 			}
 9128              		.loc 1 6015 10 view .LVU3110
 9129 01ea 4FF0030A 		mov	r10, #3
 9130 01ee 99E7     		b	.L627
 9131              	.LVL1068:
 9132              	.L686:
6241:Core/Src/FAT/ff.c **** 					}
 9133              		.loc 1 6241 13 view .LVU3111
 9134 01f0 1846     		mov	r0, r3
 9135 01f2 9DE7     		b	.L628
 9136              	.L687:
6244:Core/Src/FAT/ff.c **** 					}
 9137              		.loc 1 6244 12 view .LVU3112
 9138 01f4 4FF0030A 		mov	r10, #3
 9139              	.LVL1069:
 9140              	.L647:
6190:Core/Src/FAT/ff.c **** 					n = (DWORD)sz_vol / 0x20000;	/* Volume size in unit of 128KS */
 9141              		.loc 1 6190 5 is_stmt 1 view .LVU3113
6190:Core/Src/FAT/ff.c **** 					n = (DWORD)sz_vol / 0x20000;	/* Volume size in unit of 128KS */
 9142              		.loc 1 6190 8 is_stmt 0 view .LVU3114
 9143 01f8 98B1     		cbz	r0, .L710
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 316


 9144 01fa 0646     		mov	r6, r0
 9145              	.L630:
 9146              	.LVL1070:
6194:Core/Src/FAT/ff.c **** 				sz_fat = (n_clst * 4 + 8 + ss - 1) / ss;	/* FAT size [sector] */
 9147              		.loc 1 6194 5 is_stmt 1 view .LVU3115
6194:Core/Src/FAT/ff.c **** 				sz_fat = (n_clst * 4 + 8 + ss - 1) / ss;	/* FAT size [sector] */
 9148              		.loc 1 6194 12 is_stmt 0 view .LVU3116
 9149 01fc B1FBF6F3 		udiv	r3, r1, r6
 9150              	.LVL1071:
6195:Core/Src/FAT/ff.c **** 				sz_rsv = 32;	/* Number of reserved sectors */
 9151              		.loc 1 6195 5 is_stmt 1 view .LVU3117
6195:Core/Src/FAT/ff.c **** 				sz_rsv = 32;	/* Number of reserved sectors */
 9152              		.loc 1 6195 26 is_stmt 0 view .LVU3118
 9153 0200 9D1C     		adds	r5, r3, #2
 9154 0202 AD00     		lsls	r5, r5, #2
6195:Core/Src/FAT/ff.c **** 				sz_rsv = 32;	/* Number of reserved sectors */
 9155              		.loc 1 6195 35 view .LVU3119
 9156 0204 05F2FF15 		addw	r5, r5, #511
6195:Core/Src/FAT/ff.c **** 				sz_rsv = 32;	/* Number of reserved sectors */
 9157              		.loc 1 6195 12 view .LVU3120
 9158 0208 6D0A     		lsrs	r5, r5, #9
 9159              	.LVL1072:
6196:Core/Src/FAT/ff.c **** 				sz_dir = 0;		/* No static directory */
 9160              		.loc 1 6196 5 is_stmt 1 view .LVU3121
6197:Core/Src/FAT/ff.c **** 				if (n_clst <= MAX_FAT16 || n_clst > MAX_FAT32) LEAVE_MKFS(FR_MKFS_ABORTED);
 9161              		.loc 1 6197 5 view .LVU3122
6198:Core/Src/FAT/ff.c **** 			} else {				/* FAT volume */
 9162              		.loc 1 6198 5 view .LVU3123
6198:Core/Src/FAT/ff.c **** 			} else {				/* FAT volume */
 9163              		.loc 1 6198 29 is_stmt 0 view .LVU3124
 9164 020a A3F57F43 		sub	r3, r3, #65280
 9165              	.LVL1073:
6198:Core/Src/FAT/ff.c **** 			} else {				/* FAT volume */
 9166              		.loc 1 6198 29 view .LVU3125
 9167 020e F63B     		subs	r3, r3, #246
 9168              	.LVL1074:
6198:Core/Src/FAT/ff.c **** 			} else {				/* FAT volume */
 9169              		.loc 1 6198 8 view .LVU3126
 9170 0210 274A     		ldr	r2, .L718+8
 9171 0212 9342     		cmp	r3, r2
 9172 0214 00F2FE81 		bhi	.L682
6197:Core/Src/FAT/ff.c **** 				if (n_clst <= MAX_FAT16 || n_clst > MAX_FAT32) LEAVE_MKFS(FR_MKFS_ABORTED);
 9173              		.loc 1 6197 12 view .LVU3127
 9174 0218 4FF00008 		mov	r8, #0
6196:Core/Src/FAT/ff.c **** 				sz_dir = 0;		/* No static directory */
 9175              		.loc 1 6196 12 view .LVU3128
 9176 021c 4FF0200C 		mov	ip, #32
 9177 0220 9DE7     		b	.L633
 9178              	.LVL1075:
 9179              	.L710:
6191:Core/Src/FAT/ff.c **** 					for (i = 0, pau = 1; cst32[i] && cst32[i] <= n; i++, pau <<= 1) ;	/* Get from table */
 9180              		.loc 1 6191 6 is_stmt 1 view .LVU3129
6191:Core/Src/FAT/ff.c **** 					for (i = 0, pau = 1; cst32[i] && cst32[i] <= n; i++, pau <<= 1) ;	/* Get from table */
 9181              		.loc 1 6191 8 is_stmt 0 view .LVU3130
 9182 0222 4D0C     		lsrs	r5, r1, #17
 9183              	.LVL1076:
6192:Core/Src/FAT/ff.c **** 				}
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 317


 9184              		.loc 1 6192 6 is_stmt 1 view .LVU3131
6192:Core/Src/FAT/ff.c **** 				}
 9185              		.loc 1 6192 13 is_stmt 0 view .LVU3132
 9186 0224 0246     		mov	r2, r0
6192:Core/Src/FAT/ff.c **** 				}
 9187              		.loc 1 6192 22 view .LVU3133
 9188 0226 0126     		movs	r6, #1
6192:Core/Src/FAT/ff.c **** 				}
 9189              		.loc 1 6192 6 view .LVU3134
 9190 0228 01E0     		b	.L631
 9191              	.LVL1077:
 9192              	.L632:
6192:Core/Src/FAT/ff.c **** 				}
 9193              		.loc 1 6192 70 is_stmt 1 discriminator 4 view .LVU3135
6192:Core/Src/FAT/ff.c **** 				}
 9194              		.loc 1 6192 54 discriminator 4 view .LVU3136
6192:Core/Src/FAT/ff.c **** 				}
 9195              		.loc 1 6192 55 is_stmt 0 discriminator 4 view .LVU3137
 9196 022a 0132     		adds	r2, r2, #1
 9197              	.LVL1078:
6192:Core/Src/FAT/ff.c **** 				}
 9198              		.loc 1 6192 63 discriminator 4 view .LVU3138
 9199 022c 7600     		lsls	r6, r6, #1
 9200              	.LVL1079:
 9201              	.L631:
6192:Core/Src/FAT/ff.c **** 				}
 9202              		.loc 1 6192 27 is_stmt 1 discriminator 1 view .LVU3139
6192:Core/Src/FAT/ff.c **** 				}
 9203              		.loc 1 6192 32 is_stmt 0 discriminator 1 view .LVU3140
 9204 022e 214B     		ldr	r3, .L718+12
 9205 0230 33F81230 		ldrh	r3, [r3, r2, lsl #1]
6192:Core/Src/FAT/ff.c **** 				}
 9206              		.loc 1 6192 6 discriminator 1 view .LVU3141
 9207 0234 002B     		cmp	r3, #0
 9208 0236 E1D0     		beq	.L630
6192:Core/Src/FAT/ff.c **** 				}
 9209              		.loc 1 6192 36 discriminator 3 view .LVU3142
 9210 0238 AB42     		cmp	r3, r5
 9211 023a F6D9     		bls	.L632
 9212 023c DEE7     		b	.L630
 9213              	.LVL1080:
 9214              	.L707:
6201:Core/Src/FAT/ff.c **** 					for (i = 0, pau = 1; cst[i] && cst[i] <= n; i++, pau <<= 1) ;	/* Get from table */
 9215              		.loc 1 6201 6 is_stmt 1 view .LVU3143
6201:Core/Src/FAT/ff.c **** 					for (i = 0, pau = 1; cst[i] && cst[i] <= n; i++, pau <<= 1) ;	/* Get from table */
 9216              		.loc 1 6201 8 is_stmt 0 view .LVU3144
 9217 023e 0D0B     		lsrs	r5, r1, #12
 9218              	.LVL1081:
6202:Core/Src/FAT/ff.c **** 				}
 9219              		.loc 1 6202 6 is_stmt 1 view .LVU3145
6202:Core/Src/FAT/ff.c **** 				}
 9220              		.loc 1 6202 13 is_stmt 0 view .LVU3146
 9221 0240 0246     		mov	r2, r0
6202:Core/Src/FAT/ff.c **** 				}
 9222              		.loc 1 6202 22 view .LVU3147
 9223 0242 0126     		movs	r6, #1
 9224              	.LVL1082:
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 318


 9225              	.L635:
6202:Core/Src/FAT/ff.c **** 				}
 9226              		.loc 1 6202 27 is_stmt 1 discriminator 1 view .LVU3148
6202:Core/Src/FAT/ff.c **** 				}
 9227              		.loc 1 6202 30 is_stmt 0 discriminator 1 view .LVU3149
 9228 0244 1C4B     		ldr	r3, .L718+16
 9229 0246 33F81230 		ldrh	r3, [r3, r2, lsl #1]
6202:Core/Src/FAT/ff.c **** 				}
 9230              		.loc 1 6202 6 discriminator 1 view .LVU3150
 9231 024a 002B     		cmp	r3, #0
 9232 024c 3FF477AF 		beq	.L634
6202:Core/Src/FAT/ff.c **** 				}
 9233              		.loc 1 6202 34 discriminator 3 view .LVU3151
 9234 0250 AB42     		cmp	r3, r5
 9235 0252 3FF674AF 		bhi	.L634
6202:Core/Src/FAT/ff.c **** 				}
 9236              		.loc 1 6202 66 is_stmt 1 discriminator 4 view .LVU3152
6202:Core/Src/FAT/ff.c **** 				}
 9237              		.loc 1 6202 50 discriminator 4 view .LVU3153
6202:Core/Src/FAT/ff.c **** 				}
 9238              		.loc 1 6202 51 is_stmt 0 discriminator 4 view .LVU3154
 9239 0256 0132     		adds	r2, r2, #1
 9240              	.LVL1083:
6202:Core/Src/FAT/ff.c **** 				}
 9241              		.loc 1 6202 59 discriminator 4 view .LVU3155
 9242 0258 7600     		lsls	r6, r6, #1
 9243              	.LVL1084:
6202:Core/Src/FAT/ff.c **** 				}
 9244              		.loc 1 6202 59 discriminator 4 view .LVU3156
 9245 025a F3E7     		b	.L635
 9246              	.LVL1085:
 9247              	.L637:
6208:Core/Src/FAT/ff.c **** 					n = (n_clst * 3 + 1) / 2 + 3;	/* FAT size [byte] */
 9248              		.loc 1 6208 6 is_stmt 1 view .LVU3157
6209:Core/Src/FAT/ff.c **** 				}
 9249              		.loc 1 6209 6 view .LVU3158
6209:Core/Src/FAT/ff.c **** 				}
 9250              		.loc 1 6209 18 is_stmt 0 view .LVU3159
 9251 025c 03EB4305 		add	r5, r3, r3, lsl #1
6209:Core/Src/FAT/ff.c **** 				}
 9252              		.loc 1 6209 22 view .LVU3160
 9253 0260 0135     		adds	r5, r5, #1
6209:Core/Src/FAT/ff.c **** 				}
 9254              		.loc 1 6209 27 view .LVU3161
 9255 0262 6D08     		lsrs	r5, r5, #1
6209:Core/Src/FAT/ff.c **** 				}
 9256              		.loc 1 6209 8 view .LVU3162
 9257 0264 0335     		adds	r5, r5, #3
 9258              	.LVL1086:
6208:Core/Src/FAT/ff.c **** 					n = (n_clst * 3 + 1) / 2 + 3;	/* FAT size [byte] */
 9259              		.loc 1 6208 11 view .LVU3163
 9260 0266 4FF0010A 		mov	r10, #1
 9261 026a 71E7     		b	.L638
 9262              	.LVL1087:
 9263              	.L708:
6221:Core/Src/FAT/ff.c **** 			} else {					/* FAT: Expand FAT */
 9264              		.loc 1 6221 5 is_stmt 1 view .LVU3164
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 319


6221:Core/Src/FAT/ff.c **** 			} else {					/* FAT: Expand FAT */
 9265              		.loc 1 6221 12 is_stmt 0 view .LVU3165
 9266 026c 9C44     		add	ip, ip, r3
 9267              	.LVL1088:
6221:Core/Src/FAT/ff.c **** 			} else {					/* FAT: Expand FAT */
 9268              		.loc 1 6221 18 is_stmt 1 view .LVU3166
6221:Core/Src/FAT/ff.c **** 			} else {					/* FAT: Expand FAT */
 9269              		.loc 1 6221 24 is_stmt 0 view .LVU3167
 9270 026e 9E44     		add	lr, lr, r3
 9271              	.LVL1089:
6221:Core/Src/FAT/ff.c **** 			} else {					/* FAT: Expand FAT */
 9272              		.loc 1 6221 24 view .LVU3168
 9273 0270 91E7     		b	.L640
 9274              	.LVL1090:
 9275              	.L709:
6233:Core/Src/FAT/ff.c **** 					if (sz_au == 0 && (sz_au = pau / 2) != 0) continue;	/* Adjust cluster size and retry */
 9276              		.loc 1 6233 5 is_stmt 1 view .LVU3169
6233:Core/Src/FAT/ff.c **** 					if (sz_au == 0 && (sz_au = pau / 2) != 0) continue;	/* Adjust cluster size and retry */
 9277              		.loc 1 6233 8 is_stmt 0 view .LVU3170
 9278 0272 4FF6F573 		movw	r3, #65525
 9279 0276 9F42     		cmp	r7, r3
 9280 0278 9FD8     		bhi	.L642
6234:Core/Src/FAT/ff.c **** 					LEAVE_MKFS(FR_MKFS_ABORTED);
 9281              		.loc 1 6234 6 is_stmt 1 view .LVU3171
6234:Core/Src/FAT/ff.c **** 					LEAVE_MKFS(FR_MKFS_ABORTED);
 9282              		.loc 1 6234 9 is_stmt 0 view .LVU3172
 9283 027a 0028     		cmp	r0, #0
 9284 027c 40F0DA81 		bne	.L685
6234:Core/Src/FAT/ff.c **** 					LEAVE_MKFS(FR_MKFS_ABORTED);
 9285              		.loc 1 6234 31 discriminator 1 view .LVU3173
 9286 0280 7008     		lsrs	r0, r6, #1
 9287              	.LVL1091:
6234:Core/Src/FAT/ff.c **** 					LEAVE_MKFS(FR_MKFS_ABORTED);
 9288              		.loc 1 6234 21 discriminator 1 view .LVU3174
 9289 0282 012E     		cmp	r6, #1
 9290 0284 3FF654AF 		bhi	.L628
6235:Core/Src/FAT/ff.c **** 				}
 9291              		.loc 1 6235 6 view .LVU3175
 9292 0288 0E20     		movs	r0, #14
 9293              	.LVL1092:
6235:Core/Src/FAT/ff.c **** 				}
 9294              		.loc 1 6235 6 view .LVU3176
 9295 028a B4E1     		b	.L615
 9296              	.LVL1093:
 9297              	.L645:
6248:Core/Src/FAT/ff.c **** 				}
6249:Core/Src/FAT/ff.c **** 				if  (n_clst <= MAX_FAT12) {	/* Too few clusters for FAT16 */
 9298              		.loc 1 6249 5 is_stmt 1 view .LVU3177
 9299              		.loc 1 6249 9 is_stmt 0 view .LVU3178
 9300 028c 40F6F573 		movw	r3, #4085
 9301 0290 9F42     		cmp	r7, r3
 9302 0292 13D8     		bhi	.L644
6250:Core/Src/FAT/ff.c **** 					if (sz_au == 0 && (sz_au = pau * 2) <= 128) continue;	/* Adjust cluster size and retry */
 9303              		.loc 1 6250 6 is_stmt 1 view .LVU3179
 9304              		.loc 1 6250 9 is_stmt 0 view .LVU3180
 9305 0294 0028     		cmp	r0, #0
 9306 0296 40F0D181 		bne	.L689
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 320


 9307              		.loc 1 6250 31 discriminator 1 view .LVU3181
 9308 029a 7000     		lsls	r0, r6, #1
 9309              	.LVL1094:
 9310              		.loc 1 6250 21 discriminator 1 view .LVU3182
 9311 029c 8028     		cmp	r0, #128
 9312 029e 7FF647AF 		bls	.L628
6251:Core/Src/FAT/ff.c **** 					LEAVE_MKFS(FR_MKFS_ABORTED);
 9313              		.loc 1 6251 6 view .LVU3183
 9314 02a2 0E20     		movs	r0, #14
 9315              	.LVL1095:
 9316              		.loc 1 6251 6 view .LVU3184
 9317 02a4 A7E1     		b	.L615
 9318              	.L719:
 9319 02a6 00BF     		.align	2
 9320              	.L718:
 9321 02a8 00000000 		.word	.LANCHOR0
 9322 02ac 00000000 		.word	.LANCHOR2
 9323 02b0 FFFFFE0F 		.word	268369919
 9324 02b4 00000000 		.word	.LANCHOR3
 9325 02b8 00000000 		.word	.LANCHOR4
 9326              	.LVL1096:
 9327              	.L644:
6252:Core/Src/FAT/ff.c **** 				}
6253:Core/Src/FAT/ff.c **** 			}
6254:Core/Src/FAT/ff.c **** 			if (fsty == FS_FAT12 && n_clst > MAX_FAT12) LEAVE_MKFS(FR_MKFS_ABORTED);	/* Too many clusters fo
 9328              		.loc 1 6254 7 view .LVU3185
 9329 02bc CDF820C0 		str	ip, [sp, #32]
 9330 02c0 CDF814E0 		str	lr, [sp, #20]
 9331 02c4 CDF82480 		str	r8, [sp, #36]
 9332 02c8 0A97     		str	r7, [sp, #40]
 9333              		.loc 1 6254 4 is_stmt 1 view .LVU3186
 9334              		.loc 1 6254 7 is_stmt 0 view .LVU3187
 9335 02ca BAF1010F 		cmp	r10, #1
 9336 02ce 04D1     		bne	.L648
 9337              		.loc 1 6254 25 discriminator 1 view .LVU3188
 9338 02d0 40F6F573 		movw	r3, #4085
 9339 02d4 9F42     		cmp	r7, r3
 9340 02d6 00F2B381 		bhi	.L690
 9341              	.L648:
6255:Core/Src/FAT/ff.c **** 
6256:Core/Src/FAT/ff.c **** 			/* Ok, it is the valid cluster configuration */
6257:Core/Src/FAT/ff.c **** 			break;
 9342              		.loc 1 6257 4 is_stmt 1 view .LVU3189
6258:Core/Src/FAT/ff.c **** 		} while (1);
6259:Core/Src/FAT/ff.c **** 
6260:Core/Src/FAT/ff.c **** #if FF_USE_TRIM
6261:Core/Src/FAT/ff.c **** 		lba[0] = b_vol; lba[1] = b_vol + sz_vol - 1;	/* Inform storage device that the volume area may be
6262:Core/Src/FAT/ff.c **** 		disk_ioctl(pdrv, CTRL_TRIM, lba);
6263:Core/Src/FAT/ff.c **** #endif
6264:Core/Src/FAT/ff.c **** 		/* Create FAT VBR */
6265:Core/Src/FAT/ff.c **** 		memset(buf, 0, ss);
 9343              		.loc 1 6265 3 view .LVU3190
 9344 02da 4FF40078 		mov	r8, #512
 9345              	.LVL1097:
 9346              		.loc 1 6265 3 is_stmt 0 view .LVU3191
 9347 02de 4246     		mov	r2, r8
 9348 02e0 0021     		movs	r1, #0
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 321


 9349 02e2 029F     		ldr	r7, [sp, #8]
 9350              	.LVL1098:
 9351              		.loc 1 6265 3 view .LVU3192
 9352 02e4 3846     		mov	r0, r7
 9353 02e6 FFF7FEFF 		bl	memset
 9354              	.LVL1099:
6266:Core/Src/FAT/ff.c **** 		memcpy(buf + BS_JmpBoot, "\xEB\xFE\x90" "MSDOS5.0", 11);	/* Boot jump code (x86), OEM name */
 9355              		.loc 1 6266 3 is_stmt 1 view .LVU3193
 9356 02ea CB4B     		ldr	r3, .L720
 9357 02ec 03CB     		ldmia	r3!, {r0, r1}
 9358 02ee 3860     		str	r0, [r7]	@ unaligned
 9359 02f0 3846     		mov	r0, r7
 9360 02f2 7960     		str	r1, [r7, #4]	@ unaligned
 9361 02f4 1A88     		ldrh	r2, [r3]	@ unaligned
 9362 02f6 9B78     		ldrb	r3, [r3, #2]	@ zero_extendqisi2
 9363 02f8 3A81     		strh	r2, [r7, #8]	@ unaligned
 9364 02fa BB72     		strb	r3, [r7, #10]
6267:Core/Src/FAT/ff.c **** 		st_word(buf + BPB_BytsPerSec, ss);				/* Sector size [byte] */
 9365              		.loc 1 6267 3 view .LVU3194
 9366 02fc 4146     		mov	r1, r8
 9367 02fe 0B30     		adds	r0, r0, #11
 9368 0300 FFF7FEFF 		bl	st_word
 9369              	.LVL1100:
6268:Core/Src/FAT/ff.c **** 		buf[BPB_SecPerClus] = (BYTE)pau;				/* Cluster size [sector] */
 9370              		.loc 1 6268 3 view .LVU3195
 9371              		.loc 1 6268 23 is_stmt 0 view .LVU3196
 9372 0304 3846     		mov	r0, r7
 9373 0306 7E73     		strb	r6, [r7, #13]
6269:Core/Src/FAT/ff.c **** 		st_word(buf + BPB_RsvdSecCnt, (WORD)sz_rsv);	/* Size of reserved area */
 9374              		.loc 1 6269 3 is_stmt 1 view .LVU3197
 9375 0308 BDF82010 		ldrh	r1, [sp, #32]
 9376 030c 0E30     		adds	r0, r0, #14
 9377 030e FFF7FEFF 		bl	st_word
 9378              	.LVL1101:
6270:Core/Src/FAT/ff.c **** 		buf[BPB_NumFATs] = (BYTE)n_fat;					/* Number of FATs */
 9379              		.loc 1 6270 3 view .LVU3198
 9380              		.loc 1 6270 20 is_stmt 0 view .LVU3199
 9381 0312 3846     		mov	r0, r7
 9382 0314 87F810B0 		strb	fp, [r7, #16]
6271:Core/Src/FAT/ff.c **** 		st_word(buf + BPB_RootEntCnt, (WORD)((fsty == FS_FAT32) ? 0 : n_root));	/* Number of root directo
 9383              		.loc 1 6271 3 is_stmt 1 view .LVU3200
 9384 0318 1130     		adds	r0, r0, #17
 9385 031a BAF1030F 		cmp	r10, #3
 9386 031e 00F09C80 		beq	.L691
 9387              		.loc 1 6271 3 is_stmt 0 discriminator 1 view .LVU3201
 9388 0322 1FFA89F1 		uxth	r1, r9
 9389              	.L649:
 9390              		.loc 1 6271 3 discriminator 4 view .LVU3202
 9391 0326 FFF7FEFF 		bl	st_word
 9392              	.LVL1102:
6272:Core/Src/FAT/ff.c **** 		if (sz_vol < 0x10000) {
 9393              		.loc 1 6272 3 is_stmt 1 discriminator 4 view .LVU3203
 9394              		.loc 1 6272 14 is_stmt 0 discriminator 4 view .LVU3204
 9395 032a 0E99     		ldr	r1, [sp, #56]
 9396              		.loc 1 6272 6 discriminator 4 view .LVU3205
 9397 032c B1F5803F 		cmp	r1, #65536
 9398 0330 80F09580 		bcs	.L650
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 322


6273:Core/Src/FAT/ff.c **** 			st_word(buf + BPB_TotSec16, (WORD)sz_vol);	/* Volume size in 16-bit LBA */
 9399              		.loc 1 6273 4 is_stmt 1 view .LVU3206
 9400 0334 89B2     		uxth	r1, r1
 9401 0336 029B     		ldr	r3, [sp, #8]
 9402 0338 03F11300 		add	r0, r3, #19
 9403 033c FFF7FEFF 		bl	st_word
 9404              	.LVL1103:
 9405              	.L651:
6274:Core/Src/FAT/ff.c **** 		} else {
6275:Core/Src/FAT/ff.c **** 			st_dword(buf + BPB_TotSec32, (DWORD)sz_vol);	/* Volume size in 32-bit LBA */
6276:Core/Src/FAT/ff.c **** 		}
6277:Core/Src/FAT/ff.c **** 		buf[BPB_Media] = 0xF8;							/* Media descriptor byte */
 9406              		.loc 1 6277 3 view .LVU3207
 9407              		.loc 1 6277 18 is_stmt 0 view .LVU3208
 9408 0340 F823     		movs	r3, #248
 9409 0342 029F     		ldr	r7, [sp, #8]
 9410 0344 7B75     		strb	r3, [r7, #21]
6278:Core/Src/FAT/ff.c **** 		st_word(buf + BPB_SecPerTrk, 63);				/* Number of sectors per track (for int13) */
 9411              		.loc 1 6278 3 is_stmt 1 view .LVU3209
 9412 0346 3F21     		movs	r1, #63
 9413 0348 07F11800 		add	r0, r7, #24
 9414 034c FFF7FEFF 		bl	st_word
 9415              	.LVL1104:
6279:Core/Src/FAT/ff.c **** 		st_word(buf + BPB_NumHeads, 255);				/* Number of heads (for int13) */
 9416              		.loc 1 6279 3 view .LVU3210
 9417 0350 FF21     		movs	r1, #255
 9418 0352 07F11A00 		add	r0, r7, #26
 9419 0356 FFF7FEFF 		bl	st_word
 9420              	.LVL1105:
6280:Core/Src/FAT/ff.c **** 		st_dword(buf + BPB_HiddSec, (DWORD)b_vol);		/* Volume offset in the physical drive [sector] */
 9421              		.loc 1 6280 3 view .LVU3211
 9422 035a 0399     		ldr	r1, [sp, #12]
 9423 035c 07F11C00 		add	r0, r7, #28
 9424 0360 FFF7FEFF 		bl	st_dword
 9425              	.LVL1106:
6281:Core/Src/FAT/ff.c **** 		if (fsty == FS_FAT32) {
 9426              		.loc 1 6281 3 view .LVU3212
 9427              		.loc 1 6281 6 is_stmt 0 view .LVU3213
 9428 0364 BAF1030F 		cmp	r10, #3
 9429 0368 7FD0     		beq	.L711
6282:Core/Src/FAT/ff.c **** 			st_dword(buf + BS_VolID32, vsn);			/* VSN */
6283:Core/Src/FAT/ff.c **** 			st_dword(buf + BPB_FATSz32, sz_fat);		/* FAT size [sector] */
6284:Core/Src/FAT/ff.c **** 			st_dword(buf + BPB_RootClus32, 2);			/* Root directory cluster # (2) */
6285:Core/Src/FAT/ff.c **** 			st_word(buf + BPB_FSInfo32, 1);				/* Offset of FSINFO sector (VBR + 1) */
6286:Core/Src/FAT/ff.c **** 			st_word(buf + BPB_BkBootSec32, 6);			/* Offset of backup VBR (VBR + 6) */
6287:Core/Src/FAT/ff.c **** 			buf[BS_DrvNum32] = 0x80;					/* Drive number (for int13) */
6288:Core/Src/FAT/ff.c **** 			buf[BS_BootSig32] = 0x29;					/* Extended boot signature */
6289:Core/Src/FAT/ff.c **** 			memcpy(buf + BS_VolLab32, "NO NAME    " "FAT32   ", 19);	/* Volume label, FAT signature */
6290:Core/Src/FAT/ff.c **** 		} else {
6291:Core/Src/FAT/ff.c **** 			st_dword(buf + BS_VolID, vsn);				/* VSN */
 9430              		.loc 1 6291 4 is_stmt 1 view .LVU3214
 9431 036a 0799     		ldr	r1, [sp, #28]
 9432 036c 029F     		ldr	r7, [sp, #8]
 9433 036e 07F12700 		add	r0, r7, #39
 9434 0372 FFF7FEFF 		bl	st_dword
 9435              	.LVL1107:
6292:Core/Src/FAT/ff.c **** 			st_word(buf + BPB_FATSz16, (WORD)sz_fat);	/* FAT size [sector] */
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 323


 9436              		.loc 1 6292 4 view .LVU3215
 9437 0376 A9B2     		uxth	r1, r5
 9438 0378 07F11600 		add	r0, r7, #22
 9439 037c FFF7FEFF 		bl	st_word
 9440              	.LVL1108:
6293:Core/Src/FAT/ff.c **** 			buf[BS_DrvNum] = 0x80;						/* Drive number (for int13) */
 9441              		.loc 1 6293 4 view .LVU3216
 9442              		.loc 1 6293 19 is_stmt 0 view .LVU3217
 9443 0380 8023     		movs	r3, #128
 9444 0382 87F82430 		strb	r3, [r7, #36]
6294:Core/Src/FAT/ff.c **** 			buf[BS_BootSig] = 0x29;						/* Extended boot signature */
 9445              		.loc 1 6294 4 is_stmt 1 view .LVU3218
 9446              		.loc 1 6294 20 is_stmt 0 view .LVU3219
 9447 0386 2923     		movs	r3, #41
 9448 0388 87F82630 		strb	r3, [r7, #38]
6295:Core/Src/FAT/ff.c **** 			memcpy(buf + BS_VolLab, "NO NAME    " "FAT     ", 19);	/* Volume label, FAT signature */
 9449              		.loc 1 6295 4 is_stmt 1 view .LVU3220
 9450 038c DFF898C2 		ldr	ip, .L720+16
 9451 0390 BCE80F00 		ldmia	ip!, {r0, r1, r2, r3}
 9452 0394 C7F82B00 		str	r0, [r7, #43]	@ unaligned
 9453 0398 C7F82F10 		str	r1, [r7, #47]	@ unaligned
 9454 039c C7F83320 		str	r2, [r7, #51]	@ unaligned
 9455 03a0 C7F83730 		str	r3, [r7, #55]	@ unaligned
 9456 03a4 BCF80020 		ldrh	r2, [ip]	@ unaligned
 9457 03a8 9CF80230 		ldrb	r3, [ip, #2]	@ zero_extendqisi2
 9458 03ac A7F83B20 		strh	r2, [r7, #59]	@ unaligned
 9459 03b0 87F83D30 		strb	r3, [r7, #61]
 9460              	.L653:
6296:Core/Src/FAT/ff.c **** 		}
6297:Core/Src/FAT/ff.c **** 		st_word(buf + BS_55AA, 0xAA55);					/* Signature (offset is fixed here regardless of sector size)
 9461              		.loc 1 6297 3 view .LVU3221
 9462 03b4 029F     		ldr	r7, [sp, #8]
 9463 03b6 07F5FF78 		add	r8, r7, #510
 9464 03ba 4AF65521 		movw	r1, #43605
 9465 03be 4046     		mov	r0, r8
 9466 03c0 FFF7FEFF 		bl	st_word
 9467              	.LVL1109:
6298:Core/Src/FAT/ff.c **** 		if (disk_write(pdrv, buf, b_vol, 1) != RES_OK) LEAVE_MKFS(FR_DISK_ERR);	/* Write it to the VBR se
 9468              		.loc 1 6298 3 view .LVU3222
 9469              		.loc 1 6298 7 is_stmt 0 view .LVU3223
 9470 03c4 0123     		movs	r3, #1
 9471 03c6 039A     		ldr	r2, [sp, #12]
 9472 03c8 3946     		mov	r1, r7
 9473 03ca 2046     		mov	r0, r4
 9474 03cc FFF7FEFF 		bl	disk_write
 9475              	.LVL1110:
 9476              		.loc 1 6298 6 view .LVU3224
 9477 03d0 0028     		cmp	r0, #0
 9478 03d2 40F03781 		bne	.L692
6299:Core/Src/FAT/ff.c **** 
6300:Core/Src/FAT/ff.c **** 		/* Create FSINFO record if needed */
6301:Core/Src/FAT/ff.c **** 		if (fsty == FS_FAT32) {
 9479              		.loc 1 6301 3 is_stmt 1 view .LVU3225
 9480              		.loc 1 6301 6 is_stmt 0 view .LVU3226
 9481 03d6 BAF1030F 		cmp	r10, #3
 9482 03da 7BD0     		beq	.L712
 9483              	.L654:
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 324


6302:Core/Src/FAT/ff.c **** 			disk_write(pdrv, buf, b_vol + 6, 1);		/* Write backup VBR (VBR + 6) */
6303:Core/Src/FAT/ff.c **** 			memset(buf, 0, ss);
6304:Core/Src/FAT/ff.c **** 			st_dword(buf + FSI_LeadSig, 0x41615252);
6305:Core/Src/FAT/ff.c **** 			st_dword(buf + FSI_StrucSig, 0x61417272);
6306:Core/Src/FAT/ff.c **** 			st_dword(buf + FSI_Free_Count, n_clst - 1);	/* Number of free clusters */
6307:Core/Src/FAT/ff.c **** 			st_dword(buf + FSI_Nxt_Free, 2);			/* Last allocated cluster# */
6308:Core/Src/FAT/ff.c **** 			st_word(buf + BS_55AA, 0xAA55);
6309:Core/Src/FAT/ff.c **** 			disk_write(pdrv, buf, b_vol + 7, 1);		/* Write backup FSINFO (VBR + 7) */
6310:Core/Src/FAT/ff.c **** 			disk_write(pdrv, buf, b_vol + 1, 1);		/* Write original FSINFO (VBR + 1) */
6311:Core/Src/FAT/ff.c **** 		}
6312:Core/Src/FAT/ff.c **** 
6313:Core/Src/FAT/ff.c **** 		/* Initialize FAT area */
6314:Core/Src/FAT/ff.c **** 		memset(buf, 0, sz_buf * ss);
 9484              		.loc 1 6314 3 is_stmt 1 view .LVU3227
 9485 03dc 019B     		ldr	r3, [sp, #4]
 9486 03de 23F4FF72 		bic	r2, r3, #510
 9487 03e2 22F00102 		bic	r2, r2, #1
 9488 03e6 0021     		movs	r1, #0
 9489 03e8 DDF80880 		ldr	r8, [sp, #8]
 9490 03ec 4046     		mov	r0, r8
 9491 03ee FFF7FEFF 		bl	memset
 9492              	.LVL1111:
6315:Core/Src/FAT/ff.c **** 		sect = b_fat;		/* FAT start sector */
 9493              		.loc 1 6315 3 view .LVU3228
6316:Core/Src/FAT/ff.c **** 		for (i = 0; i < n_fat; i++) {			/* Initialize FATs each */
 9494              		.loc 1 6316 3 view .LVU3229
 9495              		.loc 1 6316 10 is_stmt 0 view .LVU3230
 9496 03f2 4FF00009 		mov	r9, #0
 9497              	.LVL1112:
 9498              		.loc 1 6316 10 view .LVU3231
 9499 03f6 059F     		ldr	r7, [sp, #20]
 9500 03f8 0796     		str	r6, [sp, #28]
 9501              	.LVL1113:
 9502              		.loc 1 6316 10 view .LVU3232
 9503 03fa 0395     		str	r5, [sp, #12]
 9504              	.LVL1114:
 9505              		.loc 1 6316 10 view .LVU3233
 9506 03fc CDF804B0 		str	fp, [sp, #4]
 9507              	.LVL1115:
 9508              		.loc 1 6316 10 view .LVU3234
 9509 0400 DDF810B0 		ldr	fp, [sp, #16]
 9510              	.LVL1116:
 9511              	.L655:
 9512              		.loc 1 6316 15 is_stmt 1 discriminator 1 view .LVU3235
 9513              		.loc 1 6316 3 is_stmt 0 discriminator 1 view .LVU3236
 9514 0404 019B     		ldr	r3, [sp, #4]
 9515 0406 9945     		cmp	r9, r3
 9516 0408 80F0AE80 		bcs	.L713
6317:Core/Src/FAT/ff.c **** 			if (fsty == FS_FAT32) {
 9517              		.loc 1 6317 4 is_stmt 1 view .LVU3237
 9518              		.loc 1 6317 7 is_stmt 0 view .LVU3238
 9519 040c BAF1030F 		cmp	r10, #3
 9520 0410 00F09680 		beq	.L714
6318:Core/Src/FAT/ff.c **** 				st_dword(buf + 0, 0xFFFFFFF8);	/* FAT[0] */
6319:Core/Src/FAT/ff.c **** 				st_dword(buf + 4, 0xFFFFFFFF);	/* FAT[1] */
6320:Core/Src/FAT/ff.c **** 				st_dword(buf + 8, 0x0FFFFFFF);	/* FAT[2] (root directory) */
6321:Core/Src/FAT/ff.c **** 			} else {
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 325


6322:Core/Src/FAT/ff.c **** 				st_dword(buf + 0, (fsty == FS_FAT12) ? 0xFFFFF8 : 0xFFFFFFF8);	/* FAT[0] and FAT[1] */
 9521              		.loc 1 6322 5 is_stmt 1 view .LVU3239
 9522 0414 BAF1010F 		cmp	r10, #1
 9523 0418 00F0A480 		beq	.L715
 9524 041c 6FF00701 		mvn	r1, #7
 9525              	.L658:
 9526              		.loc 1 6322 5 is_stmt 0 discriminator 4 view .LVU3240
 9527 0420 4046     		mov	r0, r8
 9528 0422 FFF7FEFF 		bl	st_dword
 9529              	.LVL1117:
 9530              	.L657:
 9531              		.loc 1 6322 5 view .LVU3241
 9532 0426 039E     		ldr	r6, [sp, #12]
 9533              	.L659:
 9534              	.LVL1118:
6323:Core/Src/FAT/ff.c **** 			}
6324:Core/Src/FAT/ff.c **** 			nsect = sz_fat;		/* Number of FAT sectors */
6325:Core/Src/FAT/ff.c **** 			do {	/* Fill FAT sectors */
 9535              		.loc 1 6325 4 is_stmt 1 view .LVU3242
6326:Core/Src/FAT/ff.c **** 				n = (nsect > sz_buf) ? sz_buf : nsect;
 9536              		.loc 1 6326 5 view .LVU3243
 9537              		.loc 1 6326 7 is_stmt 0 view .LVU3244
 9538 0428 3546     		mov	r5, r6
 9539 042a 5E45     		cmp	r6, fp
 9540 042c 28BF     		it	cs
 9541 042e 5D46     		movcs	r5, fp
 9542              	.LVL1119:
6327:Core/Src/FAT/ff.c **** 				if (disk_write(pdrv, buf, sect, (UINT)n) != RES_OK) LEAVE_MKFS(FR_DISK_ERR);
 9543              		.loc 1 6327 5 is_stmt 1 view .LVU3245
 9544              		.loc 1 6327 9 is_stmt 0 view .LVU3246
 9545 0430 EBB2     		uxtb	r3, r5
 9546 0432 3A46     		mov	r2, r7
 9547 0434 4146     		mov	r1, r8
 9548 0436 2046     		mov	r0, r4
 9549 0438 FFF7FEFF 		bl	disk_write
 9550              	.LVL1120:
 9551              		.loc 1 6327 8 view .LVU3247
 9552 043c 0028     		cmp	r0, #0
 9553 043e 40F00381 		bne	.L694
6328:Core/Src/FAT/ff.c **** 				memset(buf, 0, ss);	/* Rest of FAT all are cleared */
 9554              		.loc 1 6328 5 is_stmt 1 view .LVU3248
 9555 0442 4FF40072 		mov	r2, #512
 9556 0446 0021     		movs	r1, #0
 9557 0448 4046     		mov	r0, r8
 9558 044a FFF7FEFF 		bl	memset
 9559              	.LVL1121:
6329:Core/Src/FAT/ff.c **** 				sect += n; nsect -= n;
 9560              		.loc 1 6329 5 view .LVU3249
 9561              		.loc 1 6329 10 is_stmt 0 view .LVU3250
 9562 044e 2F44     		add	r7, r7, r5
 9563              	.LVL1122:
 9564              		.loc 1 6329 16 is_stmt 1 view .LVU3251
6330:Core/Src/FAT/ff.c **** 			} while (nsect);
 9565              		.loc 1 6330 12 view .LVU3252
 9566              		.loc 1 6330 4 is_stmt 0 view .LVU3253
 9567 0450 761B     		subs	r6, r6, r5
 9568              	.LVL1123:
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 326


 9569              		.loc 1 6330 4 view .LVU3254
 9570 0452 E9D1     		bne	.L659
6316:Core/Src/FAT/ff.c **** 			if (fsty == FS_FAT32) {
 9571              		.loc 1 6316 26 is_stmt 1 discriminator 2 view .LVU3255
6316:Core/Src/FAT/ff.c **** 			if (fsty == FS_FAT32) {
 9572              		.loc 1 6316 27 is_stmt 0 discriminator 2 view .LVU3256
 9573 0454 09F10109 		add	r9, r9, #1
 9574              	.LVL1124:
6316:Core/Src/FAT/ff.c **** 			if (fsty == FS_FAT32) {
 9575              		.loc 1 6316 27 discriminator 2 view .LVU3257
 9576 0458 D4E7     		b	.L655
 9577              	.LVL1125:
 9578              	.L691:
6271:Core/Src/FAT/ff.c **** 		if (sz_vol < 0x10000) {
 9579              		.loc 1 6271 3 view .LVU3258
 9580 045a 0021     		movs	r1, #0
 9581 045c 63E7     		b	.L649
 9582              	.L650:
6275:Core/Src/FAT/ff.c **** 		}
 9583              		.loc 1 6275 4 is_stmt 1 view .LVU3259
 9584 045e 029B     		ldr	r3, [sp, #8]
 9585 0460 03F12000 		add	r0, r3, #32
 9586 0464 FFF7FEFF 		bl	st_dword
 9587              	.LVL1126:
 9588 0468 6AE7     		b	.L651
 9589              	.L711:
6282:Core/Src/FAT/ff.c **** 			st_dword(buf + BPB_FATSz32, sz_fat);		/* FAT size [sector] */
 9590              		.loc 1 6282 4 view .LVU3260
 9591 046a 0799     		ldr	r1, [sp, #28]
 9592 046c 029F     		ldr	r7, [sp, #8]
 9593 046e 07F14300 		add	r0, r7, #67
 9594 0472 FFF7FEFF 		bl	st_dword
 9595              	.LVL1127:
6283:Core/Src/FAT/ff.c **** 			st_dword(buf + BPB_RootClus32, 2);			/* Root directory cluster # (2) */
 9596              		.loc 1 6283 4 view .LVU3261
 9597 0476 2946     		mov	r1, r5
 9598 0478 07F12400 		add	r0, r7, #36
 9599 047c FFF7FEFF 		bl	st_dword
 9600              	.LVL1128:
6284:Core/Src/FAT/ff.c **** 			st_word(buf + BPB_FSInfo32, 1);				/* Offset of FSINFO sector (VBR + 1) */
 9601              		.loc 1 6284 4 view .LVU3262
 9602 0480 0221     		movs	r1, #2
 9603 0482 07F12C00 		add	r0, r7, #44
 9604 0486 FFF7FEFF 		bl	st_dword
 9605              	.LVL1129:
6285:Core/Src/FAT/ff.c **** 			st_word(buf + BPB_BkBootSec32, 6);			/* Offset of backup VBR (VBR + 6) */
 9606              		.loc 1 6285 4 view .LVU3263
 9607 048a 0121     		movs	r1, #1
 9608 048c 07F13000 		add	r0, r7, #48
 9609 0490 FFF7FEFF 		bl	st_word
 9610              	.LVL1130:
6286:Core/Src/FAT/ff.c **** 			buf[BS_DrvNum32] = 0x80;					/* Drive number (for int13) */
 9611              		.loc 1 6286 4 view .LVU3264
 9612 0494 0621     		movs	r1, #6
 9613 0496 07F13200 		add	r0, r7, #50
 9614 049a FFF7FEFF 		bl	st_word
 9615              	.LVL1131:
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 327


6287:Core/Src/FAT/ff.c **** 			buf[BS_BootSig32] = 0x29;					/* Extended boot signature */
 9616              		.loc 1 6287 4 view .LVU3265
6287:Core/Src/FAT/ff.c **** 			buf[BS_BootSig32] = 0x29;					/* Extended boot signature */
 9617              		.loc 1 6287 21 is_stmt 0 view .LVU3266
 9618 049e 8023     		movs	r3, #128
 9619 04a0 87F84030 		strb	r3, [r7, #64]
6288:Core/Src/FAT/ff.c **** 			memcpy(buf + BS_VolLab32, "NO NAME    " "FAT32   ", 19);	/* Volume label, FAT signature */
 9620              		.loc 1 6288 4 is_stmt 1 view .LVU3267
6288:Core/Src/FAT/ff.c **** 			memcpy(buf + BS_VolLab32, "NO NAME    " "FAT32   ", 19);	/* Volume label, FAT signature */
 9621              		.loc 1 6288 22 is_stmt 0 view .LVU3268
 9622 04a4 2923     		movs	r3, #41
 9623 04a6 87F84230 		strb	r3, [r7, #66]
6289:Core/Src/FAT/ff.c **** 		} else {
 9624              		.loc 1 6289 4 is_stmt 1 view .LVU3269
 9625 04aa DFF880C1 		ldr	ip, .L720+20
 9626 04ae BCE80F00 		ldmia	ip!, {r0, r1, r2, r3}
 9627 04b2 C7F84700 		str	r0, [r7, #71]	@ unaligned
 9628 04b6 C7F84B10 		str	r1, [r7, #75]	@ unaligned
 9629 04ba C7F84F20 		str	r2, [r7, #79]	@ unaligned
 9630 04be C7F85330 		str	r3, [r7, #83]	@ unaligned
 9631 04c2 BCF80020 		ldrh	r2, [ip]	@ unaligned
 9632 04c6 9CF80230 		ldrb	r3, [ip, #2]	@ zero_extendqisi2
 9633 04ca A7F85720 		strh	r2, [r7, #87]	@ unaligned
 9634 04ce 87F85930 		strb	r3, [r7, #89]
 9635 04d2 6FE7     		b	.L653
 9636              	.L712:
6302:Core/Src/FAT/ff.c **** 			memset(buf, 0, ss);
 9637              		.loc 1 6302 4 view .LVU3270
 9638 04d4 0123     		movs	r3, #1
 9639 04d6 039A     		ldr	r2, [sp, #12]
 9640 04d8 0632     		adds	r2, r2, #6
 9641 04da 029F     		ldr	r7, [sp, #8]
 9642 04dc 3946     		mov	r1, r7
 9643 04de 2046     		mov	r0, r4
 9644 04e0 FFF7FEFF 		bl	disk_write
 9645              	.LVL1132:
6303:Core/Src/FAT/ff.c **** 			st_dword(buf + FSI_LeadSig, 0x41615252);
 9646              		.loc 1 6303 4 view .LVU3271
 9647 04e4 4FF40072 		mov	r2, #512
 9648 04e8 0021     		movs	r1, #0
 9649 04ea 3846     		mov	r0, r7
 9650 04ec FFF7FEFF 		bl	memset
 9651              	.LVL1133:
6304:Core/Src/FAT/ff.c **** 			st_dword(buf + FSI_StrucSig, 0x61417272);
 9652              		.loc 1 6304 4 view .LVU3272
 9653 04f0 4A49     		ldr	r1, .L720+4
 9654 04f2 3846     		mov	r0, r7
 9655 04f4 FFF7FEFF 		bl	st_dword
 9656              	.LVL1134:
6305:Core/Src/FAT/ff.c **** 			st_dword(buf + FSI_Free_Count, n_clst - 1);	/* Number of free clusters */
 9657              		.loc 1 6305 4 view .LVU3273
 9658 04f8 4949     		ldr	r1, .L720+8
 9659 04fa 07F5F270 		add	r0, r7, #484
 9660 04fe FFF7FEFF 		bl	st_dword
 9661              	.LVL1135:
6306:Core/Src/FAT/ff.c **** 			st_dword(buf + FSI_Nxt_Free, 2);			/* Last allocated cluster# */
 9662              		.loc 1 6306 4 view .LVU3274
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 328


 9663 0502 0A9B     		ldr	r3, [sp, #40]
 9664 0504 591E     		subs	r1, r3, #1
 9665 0506 07F5F470 		add	r0, r7, #488
 9666 050a FFF7FEFF 		bl	st_dword
 9667              	.LVL1136:
6307:Core/Src/FAT/ff.c **** 			st_word(buf + BS_55AA, 0xAA55);
 9668              		.loc 1 6307 4 view .LVU3275
 9669 050e 0221     		movs	r1, #2
 9670 0510 07F5F670 		add	r0, r7, #492
 9671 0514 FFF7FEFF 		bl	st_dword
 9672              	.LVL1137:
6308:Core/Src/FAT/ff.c **** 			disk_write(pdrv, buf, b_vol + 7, 1);		/* Write backup FSINFO (VBR + 7) */
 9673              		.loc 1 6308 4 view .LVU3276
 9674 0518 4AF65521 		movw	r1, #43605
 9675 051c 4046     		mov	r0, r8
 9676 051e FFF7FEFF 		bl	st_word
 9677              	.LVL1138:
6309:Core/Src/FAT/ff.c **** 			disk_write(pdrv, buf, b_vol + 1, 1);		/* Write original FSINFO (VBR + 1) */
 9678              		.loc 1 6309 4 view .LVU3277
 9679 0522 0123     		movs	r3, #1
 9680 0524 039A     		ldr	r2, [sp, #12]
 9681 0526 0732     		adds	r2, r2, #7
 9682 0528 3946     		mov	r1, r7
 9683 052a 2046     		mov	r0, r4
 9684 052c FFF7FEFF 		bl	disk_write
 9685              	.LVL1139:
6310:Core/Src/FAT/ff.c **** 		}
 9686              		.loc 1 6310 4 view .LVU3278
 9687 0530 0123     		movs	r3, #1
 9688 0532 039A     		ldr	r2, [sp, #12]
 9689 0534 1A44     		add	r2, r2, r3
 9690 0536 3946     		mov	r1, r7
 9691 0538 2046     		mov	r0, r4
 9692 053a FFF7FEFF 		bl	disk_write
 9693              	.LVL1140:
 9694 053e 4DE7     		b	.L654
 9695              	.LVL1141:
 9696              	.L714:
6318:Core/Src/FAT/ff.c **** 				st_dword(buf + 4, 0xFFFFFFFF);	/* FAT[1] */
 9697              		.loc 1 6318 5 view .LVU3279
 9698 0540 6FF00701 		mvn	r1, #7
 9699 0544 4046     		mov	r0, r8
 9700 0546 FFF7FEFF 		bl	st_dword
 9701              	.LVL1142:
6319:Core/Src/FAT/ff.c **** 				st_dword(buf + 8, 0x0FFFFFFF);	/* FAT[2] (root directory) */
 9702              		.loc 1 6319 5 view .LVU3280
 9703 054a 4FF0FF31 		mov	r1, #-1
 9704 054e 08F10400 		add	r0, r8, #4
 9705 0552 FFF7FEFF 		bl	st_dword
 9706              	.LVL1143:
6320:Core/Src/FAT/ff.c **** 			} else {
 9707              		.loc 1 6320 5 view .LVU3281
 9708 0556 6FF07041 		mvn	r1, #-268435456
 9709 055a 08F10800 		add	r0, r8, #8
 9710 055e FFF7FEFF 		bl	st_dword
 9711              	.LVL1144:
 9712 0562 60E7     		b	.L657
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 329


 9713              	.L715:
6322:Core/Src/FAT/ff.c **** 			}
 9714              		.loc 1 6322 5 is_stmt 0 view .LVU3282
 9715 0564 2F49     		ldr	r1, .L720+12
 9716 0566 5BE7     		b	.L658
 9717              	.L713:
6331:Core/Src/FAT/ff.c **** 		}
6332:Core/Src/FAT/ff.c **** 
6333:Core/Src/FAT/ff.c **** 		/* Initialize root directory (fill with zero) */
6334:Core/Src/FAT/ff.c **** 		nsect = (fsty == FS_FAT32) ? pau : sz_dir;	/* Number of root directory sectors */
 9718              		.loc 1 6334 36 view .LVU3283
 9719 0568 0597     		str	r7, [sp, #20]
 9720              	.LVL1145:
 9721              		.loc 1 6334 36 view .LVU3284
 9722 056a 079E     		ldr	r6, [sp, #28]
 9723              		.loc 1 6334 3 is_stmt 1 view .LVU3285
 9724              		.loc 1 6334 36 is_stmt 0 view .LVU3286
 9725 056c BAF1030F 		cmp	r10, #3
 9726 0570 20D0     		beq	.L716
 9727              		.loc 1 6334 36 view .LVU3287
 9728 0572 059F     		ldr	r7, [sp, #20]
 9729              	.LVL1146:
 9730              		.loc 1 6334 36 view .LVU3288
 9731 0574 099E     		ldr	r6, [sp, #36]
 9732 0576 DDF81080 		ldr	r8, [sp, #16]
 9733 057a DDF80890 		ldr	r9, [sp, #8]
 9734              	.LVL1147:
 9735              	.L662:
6335:Core/Src/FAT/ff.c **** 		do {
 9736              		.loc 1 6335 3 is_stmt 1 view .LVU3289
6336:Core/Src/FAT/ff.c **** 			n = (nsect > sz_buf) ? sz_buf : nsect;
 9737              		.loc 1 6336 4 view .LVU3290
 9738              		.loc 1 6336 6 is_stmt 0 view .LVU3291
 9739 057e 3546     		mov	r5, r6
 9740 0580 4645     		cmp	r6, r8
 9741 0582 28BF     		it	cs
 9742 0584 4546     		movcs	r5, r8
 9743              	.LVL1148:
6337:Core/Src/FAT/ff.c **** 			if (disk_write(pdrv, buf, sect, (UINT)n) != RES_OK) LEAVE_MKFS(FR_DISK_ERR);
 9744              		.loc 1 6337 4 is_stmt 1 view .LVU3292
 9745              		.loc 1 6337 8 is_stmt 0 view .LVU3293
 9746 0586 EBB2     		uxtb	r3, r5
 9747 0588 3A46     		mov	r2, r7
 9748 058a 4946     		mov	r1, r9
 9749 058c 2046     		mov	r0, r4
 9750 058e FFF7FEFF 		bl	disk_write
 9751              	.LVL1149:
 9752              		.loc 1 6337 7 view .LVU3294
 9753 0592 0028     		cmp	r0, #0
 9754 0594 5AD1     		bne	.L695
6338:Core/Src/FAT/ff.c **** 			sect += n; nsect -= n;
 9755              		.loc 1 6338 4 is_stmt 1 view .LVU3295
 9756              		.loc 1 6338 9 is_stmt 0 view .LVU3296
 9757 0596 2F44     		add	r7, r7, r5
 9758              	.LVL1150:
 9759              		.loc 1 6338 15 is_stmt 1 view .LVU3297
6339:Core/Src/FAT/ff.c **** 		} while (nsect);
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 330


 9760              		.loc 1 6339 11 view .LVU3298
 9761              		.loc 1 6339 3 is_stmt 0 view .LVU3299
 9762 0598 761B     		subs	r6, r6, r5
 9763              	.LVL1151:
 9764              		.loc 1 6339 3 view .LVU3300
 9765 059a F0D1     		bne	.L662
6340:Core/Src/FAT/ff.c **** 	}
6341:Core/Src/FAT/ff.c **** 
6342:Core/Src/FAT/ff.c **** 	/* A FAT volume has been created here */
6343:Core/Src/FAT/ff.c **** 
6344:Core/Src/FAT/ff.c **** 	/* Determine system ID in the MBR partition table */
6345:Core/Src/FAT/ff.c **** 	if (FF_FS_EXFAT && fsty == FS_EXFAT) {
 9766              		.loc 1 6345 2 is_stmt 1 view .LVU3301
6346:Core/Src/FAT/ff.c **** 		sys = 0x07;		/* exFAT */
6347:Core/Src/FAT/ff.c **** 	} else if (fsty == FS_FAT32) {
 9767              		.loc 1 6347 9 view .LVU3302
 9768              		.loc 1 6347 12 is_stmt 0 view .LVU3303
 9769 059c BAF1030F 		cmp	r10, #3
 9770 05a0 0FD0     		beq	.L696
6348:Core/Src/FAT/ff.c **** 		sys = 0x0C;		/* FAT32X */
6349:Core/Src/FAT/ff.c **** 	} else if (sz_vol >= 0x10000) {
 9771              		.loc 1 6349 9 is_stmt 1 view .LVU3304
 9772              		.loc 1 6349 20 is_stmt 0 view .LVU3305
 9773 05a2 0E9B     		ldr	r3, [sp, #56]
 9774              		.loc 1 6349 12 view .LVU3306
 9775 05a4 B3F5803F 		cmp	r3, #65536
 9776 05a8 20D2     		bcs	.L697
6350:Core/Src/FAT/ff.c **** 		sys = 0x06;		/* FAT12/16 (large) */
6351:Core/Src/FAT/ff.c **** 	} else if (fsty == FS_FAT16) {
 9777              		.loc 1 6351 9 is_stmt 1 view .LVU3307
 9778              		.loc 1 6351 12 is_stmt 0 view .LVU3308
 9779 05aa BAF1020F 		cmp	r10, #2
 9780 05ae 06D0     		beq	.L717
6352:Core/Src/FAT/ff.c **** 		sys = 0x04;		/* FAT16 */
6353:Core/Src/FAT/ff.c **** 	} else {
6354:Core/Src/FAT/ff.c **** 		sys = 0x01;		/* FAT12 */
 9781              		.loc 1 6354 7 view .LVU3309
 9782 05b0 0122     		movs	r2, #1
 9783 05b2 07E0     		b	.L663
 9784              	.LVL1152:
 9785              	.L716:
6334:Core/Src/FAT/ff.c **** 		do {
 9786              		.loc 1 6334 36 view .LVU3310
 9787 05b4 DDF81080 		ldr	r8, [sp, #16]
 9788 05b8 DDF80890 		ldr	r9, [sp, #8]
 9789              	.LVL1153:
6334:Core/Src/FAT/ff.c **** 		do {
 9790              		.loc 1 6334 36 view .LVU3311
 9791 05bc DFE7     		b	.L662
 9792              	.LVL1154:
 9793              	.L717:
6352:Core/Src/FAT/ff.c **** 		sys = 0x04;		/* FAT16 */
 9794              		.loc 1 6352 7 view .LVU3312
 9795 05be 0422     		movs	r2, #4
 9796 05c0 00E0     		b	.L663
 9797              	.L696:
6348:Core/Src/FAT/ff.c **** 	} else if (sz_vol >= 0x10000) {
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 331


 9798              		.loc 1 6348 7 view .LVU3313
 9799 05c2 0C22     		movs	r2, #12
 9800              	.L663:
 9801              	.LVL1155:
6355:Core/Src/FAT/ff.c **** 	}
6356:Core/Src/FAT/ff.c **** 
6357:Core/Src/FAT/ff.c **** 	/* Update partition information */
6358:Core/Src/FAT/ff.c **** 	if (FF_MULTI_PARTITION && ipart != 0) {	/* Volume is in the existing partition */
 9802              		.loc 1 6358 2 is_stmt 1 view .LVU3314
6359:Core/Src/FAT/ff.c **** 		if (!FF_LBA64 || !(fsopt & 0x80)) {	/* Is the partition in MBR? */
6360:Core/Src/FAT/ff.c **** 			/* Update system ID in the partition table */
6361:Core/Src/FAT/ff.c **** 			if (disk_read(pdrv, buf, 0, 1) != RES_OK) LEAVE_MKFS(FR_DISK_ERR);	/* Read the MBR */
6362:Core/Src/FAT/ff.c **** 			buf[MBR_Table + (ipart - 1) * SZ_PTE + PTE_System] = sys;			/* Set system ID */
6363:Core/Src/FAT/ff.c **** 			if (disk_write(pdrv, buf, 0, 1) != RES_OK) LEAVE_MKFS(FR_DISK_ERR);	/* Write it back to the MBR 
6364:Core/Src/FAT/ff.c **** 		}
6365:Core/Src/FAT/ff.c **** 	} else {								/* Volume as a new single partition */
6366:Core/Src/FAT/ff.c **** 		if (!(fsopt & FM_SFD)) {			/* Create partition table if not in SFD format */
 9803              		.loc 1 6366 3 view .LVU3315
 9804              		.loc 1 6366 6 is_stmt 0 view .LVU3316
 9805 05c4 069B     		ldr	r3, [sp, #24]
 9806 05c6 4BB9     		cbnz	r3, .L664
6367:Core/Src/FAT/ff.c **** 			lba[0] = sz_vol; lba[1] = 0;
 9807              		.loc 1 6367 4 is_stmt 1 view .LVU3317
 9808              		.loc 1 6367 11 is_stmt 0 view .LVU3318
 9809 05c8 0E9B     		ldr	r3, [sp, #56]
 9810 05ca 0C93     		str	r3, [sp, #48]
 9811              		.loc 1 6367 21 is_stmt 1 view .LVU3319
 9812              		.loc 1 6367 28 is_stmt 0 view .LVU3320
 9813 05cc 0023     		movs	r3, #0
 9814 05ce 0D93     		str	r3, [sp, #52]
6368:Core/Src/FAT/ff.c **** 			res = create_partition(pdrv, lba, sys, buf);
 9815              		.loc 1 6368 4 is_stmt 1 view .LVU3321
 9816              		.loc 1 6368 10 is_stmt 0 view .LVU3322
 9817 05d0 029B     		ldr	r3, [sp, #8]
 9818 05d2 0CA9     		add	r1, sp, #48
 9819 05d4 2046     		mov	r0, r4
 9820 05d6 FFF7FEFF 		bl	create_partition
 9821              	.LVL1156:
6369:Core/Src/FAT/ff.c **** 			if (res != FR_OK) LEAVE_MKFS(res);
 9822              		.loc 1 6369 4 is_stmt 1 view .LVU3323
 9823              		.loc 1 6369 7 is_stmt 0 view .LVU3324
 9824 05da 60B9     		cbnz	r0, .L615
 9825              	.LVL1157:
 9826              	.L664:
6370:Core/Src/FAT/ff.c **** 		}
6371:Core/Src/FAT/ff.c **** 	}
6372:Core/Src/FAT/ff.c **** 
6373:Core/Src/FAT/ff.c **** 	if (disk_ioctl(pdrv, CTRL_SYNC, 0) != RES_OK) LEAVE_MKFS(FR_DISK_ERR);
 9827              		.loc 1 6373 2 is_stmt 1 view .LVU3325
 9828              		.loc 1 6373 6 is_stmt 0 view .LVU3326
 9829 05dc 0022     		movs	r2, #0
 9830 05de 1146     		mov	r1, r2
 9831 05e0 2046     		mov	r0, r4
 9832 05e2 FFF7FEFF 		bl	disk_ioctl
 9833              	.LVL1158:
 9834              		.loc 1 6373 5 view .LVU3327
 9835 05e6 30B1     		cbz	r0, .L615
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 332


 9836              		.loc 1 6373 48 view .LVU3328
 9837 05e8 0120     		movs	r0, #1
 9838 05ea 04E0     		b	.L615
 9839              	.L697:
6350:Core/Src/FAT/ff.c **** 	} else if (fsty == FS_FAT16) {
 9840              		.loc 1 6350 7 view .LVU3329
 9841 05ec 0622     		movs	r2, #6
 9842 05ee E9E7     		b	.L663
 9843              	.LVL1159:
 9844              	.L665:
5908:Core/Src/FAT/ff.c **** 	if (FatFs[vol]) FatFs[vol]->fs_type = 0;	/* Clear the fs object if mounted */
 9845              		.loc 1 5908 22 view .LVU3330
 9846 05f0 0B20     		movs	r0, #11
 9847              	.LVL1160:
5908:Core/Src/FAT/ff.c **** 	if (FatFs[vol]) FatFs[vol]->fs_type = 0;	/* Clear the fs object if mounted */
 9848              		.loc 1 5908 22 view .LVU3331
 9849 05f2 00E0     		b	.L615
 9850              	.LVL1161:
 9851              	.L666:
5915:Core/Src/FAT/ff.c **** 	if (ds & STA_PROTECT) return FR_WRITE_PROTECTED;
 9852              		.loc 1 5915 30 view .LVU3332
 9853 05f4 0320     		movs	r0, #3
 9854              	.LVL1162:
 9855              	.L615:
6374:Core/Src/FAT/ff.c **** 
6375:Core/Src/FAT/ff.c **** 	LEAVE_MKFS(FR_OK);
6376:Core/Src/FAT/ff.c **** }
 9856              		.loc 1 6376 1 view .LVU3333
 9857 05f6 11B0     		add	sp, sp, #68
 9858              	.LCFI101:
 9859              		.cfi_remember_state
 9860              		.cfi_def_cfa_offset 36
 9861              		@ sp needed
 9862 05f8 BDE8F08F 		pop	{r4, r5, r6, r7, r8, r9, r10, fp, pc}
 9863              	.LVL1163:
 9864              	.L667:
 9865              	.LCFI102:
 9866              		.cfi_restore_state
5916:Core/Src/FAT/ff.c **** 
 9867              		.loc 1 5916 31 view .LVU3334
 9868 05fc 0A20     		movs	r0, #10
 9869              	.LVL1164:
5916:Core/Src/FAT/ff.c **** 
 9870              		.loc 1 5916 31 view .LVU3335
 9871 05fe FAE7     		b	.L615
 9872              	.LVL1165:
 9873              	.L672:
5939:Core/Src/FAT/ff.c **** 	buf = (BYTE*)work;		/* Working buffer */
 9874              		.loc 1 5939 26 view .LVU3336
 9875 0600 1120     		movs	r0, #17
 9876 0602 F8E7     		b	.L615
 9877              	.LVL1166:
 9878              	.L673:
5944:Core/Src/FAT/ff.c **** 
 9879              		.loc 1 5944 19 view .LVU3337
 9880 0604 1120     		movs	r0, #17
 9881 0606 F6E7     		b	.L615
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 333


 9882              	.LVL1167:
 9883              	.L674:
5983:Core/Src/FAT/ff.c **** 		if (!(fsopt & FM_SFD)) {	/* To be partitioned? */
 9884              		.loc 1 5983 62 view .LVU3338
 9885 0608 0120     		movs	r0, #1
 9886 060a F4E7     		b	.L615
 9887              	.LVL1168:
 9888              	.L677:
5999:Core/Src/FAT/ff.c **** 
 9889              		.loc 1 5999 20 view .LVU3339
 9890 060c 0E20     		movs	r0, #14
 9891 060e F2E7     		b	.L615
 9892              	.L680:
6018:Core/Src/FAT/ff.c **** 		fsty = FS_FAT16;
 9893              		.loc 1 6018 26 view .LVU3340
 9894 0610 1320     		movs	r0, #19
 9895 0612 F0E7     		b	.L615
 9896              	.LVL1169:
 9897              	.L682:
6198:Core/Src/FAT/ff.c **** 			} else {				/* FAT volume */
 9898              		.loc 1 6198 52 view .LVU3341
 9899 0614 0E20     		movs	r0, #14
 9900 0616 EEE7     		b	.L615
 9901              	.L721:
 9902              		.align	2
 9903              	.L720:
 9904 0618 00000000 		.word	.LC2
 9905 061c 52526141 		.word	1096897106
 9906 0620 72724161 		.word	1631679090
 9907 0624 F8FFFF00 		.word	16777208
 9908 0628 20000000 		.word	.LC4
 9909 062c 0C000000 		.word	.LC3
 9910              	.LVL1170:
 9911              	.L684:
6230:Core/Src/FAT/ff.c **** 			n_clst = ((DWORD)sz_vol - sz_rsv - sz_fat * n_fat - sz_dir) / pau;
 9912              		.loc 1 6230 44 view .LVU3342
 9913 0630 0E20     		movs	r0, #14
 9914 0632 E0E7     		b	.L615
 9915              	.LVL1171:
 9916              	.L685:
6235:Core/Src/FAT/ff.c **** 				}
 9917              		.loc 1 6235 6 view .LVU3343
 9918 0634 0E20     		movs	r0, #14
 9919 0636 DEE7     		b	.L615
 9920              	.L688:
6247:Core/Src/FAT/ff.c **** 				}
 9921              		.loc 1 6247 6 view .LVU3344
 9922 0638 0E20     		movs	r0, #14
 9923 063a DCE7     		b	.L615
 9924              	.L689:
6251:Core/Src/FAT/ff.c **** 				}
 9925              		.loc 1 6251 6 view .LVU3345
 9926 063c 0E20     		movs	r0, #14
 9927 063e DAE7     		b	.L615
 9928              	.L690:
6254:Core/Src/FAT/ff.c **** 
 9929              		.loc 1 6254 48 view .LVU3346
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 334


 9930 0640 0E20     		movs	r0, #14
 9931 0642 D8E7     		b	.L615
 9932              	.LVL1172:
 9933              	.L692:
6298:Core/Src/FAT/ff.c **** 
 9934              		.loc 1 6298 50 view .LVU3347
 9935 0644 0120     		movs	r0, #1
 9936 0646 D6E7     		b	.L615
 9937              	.LVL1173:
 9938              	.L694:
6327:Core/Src/FAT/ff.c **** 				memset(buf, 0, ss);	/* Rest of FAT all are cleared */
 9939              		.loc 1 6327 57 view .LVU3348
 9940 0648 0120     		movs	r0, #1
 9941 064a D4E7     		b	.L615
 9942              	.LVL1174:
 9943              	.L695:
6337:Core/Src/FAT/ff.c **** 			sect += n; nsect -= n;
 9944              		.loc 1 6337 56 view .LVU3349
 9945 064c 0120     		movs	r0, #1
 9946 064e D2E7     		b	.L615
 9947              		.cfi_endproc
 9948              	.LFE49:
 9950              		.section	.bss.FatFs,"aw",%nobits
 9951              		.align	2
 9952              		.set	.LANCHOR0,. + 0
 9955              	FatFs:
 9956 0000 00000000 		.space	4
 9957              		.section	.bss.Fsid,"aw",%nobits
 9958              		.align	1
 9959              		.set	.LANCHOR1,. + 0
 9962              	Fsid:
 9963 0000 0000     		.space	2
 9964              		.section	.rodata.cst.0,"a"
 9965              		.align	2
 9966              		.set	.LANCHOR4,. + 0
 9969              	cst.0:
 9970 0000 0100     		.short	1
 9971 0002 0400     		.short	4
 9972 0004 1000     		.short	16
 9973 0006 4000     		.short	64
 9974 0008 0001     		.short	256
 9975 000a 0002     		.short	512
 9976 000c 0000     		.short	0
 9977              		.section	.rodata.cst32.1,"a"
 9978              		.align	2
 9979              		.set	.LANCHOR3,. + 0
 9982              	cst32.1:
 9983 0000 0100     		.short	1
 9984 0002 0200     		.short	2
 9985 0004 0400     		.short	4
 9986 0006 0800     		.short	8
 9987 0008 1000     		.short	16
 9988 000a 2000     		.short	32
 9989 000c 0000     		.short	0
 9990              		.section	.rodata.defopt.2,"a"
 9991              		.align	2
 9992              		.set	.LANCHOR2,. + 0
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 335


 9995              	defopt.2:
 9996 0000 07       		.byte	7
 9997 0001 00       		.byte	0
 9998 0002 0000     		.space	2
 9999 0004 00000000 		.word	0
 10000 0008 00000000 		.word	0
 10001 000c 00000000 		.word	0
 10002              		.text
 10003              	.Letext0:
 10004              		.file 2 "c:\\program files (x86)\\gnu arm embedded toolchain\\10 2021.10\\arm-none-eabi\\include\\
 10005              		.file 3 "c:\\program files (x86)\\gnu arm embedded toolchain\\10 2021.10\\arm-none-eabi\\include\\
 10006              		.file 4 "Core/Src/FAT/ff.h"
 10007              		.file 5 "Core/Src/FAT/diskio.h"
 10008              		.file 6 "<built-in>"
 10009              		.file 7 "c:\\program files (x86)\\gnu arm embedded toolchain\\10 2021.10\\arm-none-eabi\\include\\
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 336


DEFINED SYMBOLS
                            *ABS*:00000000 ff.c
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:20     .text.ld_word:00000000 $t
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:25     .text.ld_word:00000000 ld_word
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:53     .text.ld_dword:00000000 $t
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:58     .text.ld_dword:00000000 ld_dword
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:97     .text.st_word:00000000 $t
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:102    .text.st_word:00000000 st_word
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:127    .text.st_dword:00000000 $t
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:132    .text.st_dword:00000000 st_dword
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:171    .text.dbc_1st:00000000 $t
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:176    .text.dbc_1st:00000000 dbc_1st
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:236    .text.dbc_2nd:00000000 $t
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:241    .text.dbc_2nd:00000000 dbc_2nd
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:305    .text.clst2sect:00000000 $t
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:310    .text.clst2sect:00000000 clst2sect
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:350    .text.ld_clust:00000000 $t
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:355    .text.ld_clust:00000000 ld_clust
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:411    .text.st_clust:00000000 $t
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:416    .text.st_clust:00000000 st_clust
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:465    .text.get_fileinfo:00000000 $t
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:470    .text.get_fileinfo:00000000 get_fileinfo
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:614    .text.get_ldnumber:00000000 $t
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:619    .text.get_ldnumber:00000000 get_ldnumber
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:733    .text.validate:00000000 $t
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:738    .text.validate:00000000 validate
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:847    .text.sync_window:00000000 $t
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:852    .text.sync_window:00000000 sync_window
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:937    .text.move_window:00000000 $t
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:942    .text.move_window:00000000 move_window
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:1013   .rodata.check_fs.str1.4:00000000 $d
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:1017   .text.check_fs:00000000 $t
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:1022   .text.check_fs:00000000 check_fs
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:1201   .text.check_fs:000000d0 $d
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:1206   .text.find_volume:00000000 $t
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:1211   .text.find_volume:00000000 find_volume
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:1340   .text.mount_volume:00000000 $t
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:1345   .text.mount_volume:00000000 mount_volume
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:1915   .text.mount_volume:00000294 $d
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:1924   .text.put_fat:00000000 $t
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:1929   .text.put_fat:00000000 put_fat
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:2185   .text.get_fat:00000000 $t
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:2190   .text.get_fat:00000000 get_fat
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:2407   .text.dir_sdi:00000000 $t
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:2412   .text.dir_sdi:00000000 dir_sdi
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:2610   .text.create_chain:00000000 $t
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:2615   .text.create_chain:00000000 create_chain
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:2917   .text.remove_chain:00000000 $t
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:2922   .text.remove_chain:00000000 remove_chain
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:3083   .text.dir_remove:00000000 $t
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:3088   .text.dir_remove:00000000 dir_remove
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:3139   .text.dir_clear:00000000 $t
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:3144   .text.dir_clear:00000000 dir_clear
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:3247   .text.dir_next:00000000 $t
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:3252   .text.dir_next:00000000 dir_next
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:3492   .text.dir_find:00000000 $t
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:3497   .text.dir_find:00000000 dir_find
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 337


C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:3604   .text.dir_alloc:00000000 $t
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:3609   .text.dir_alloc:00000000 dir_alloc
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:3725   .text.dir_read:00000000 $t
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:3730   .text.dir_read:00000000 dir_read
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:3853   .rodata.create_name.str1.4:00000000 $d
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:3857   .text.create_name:00000000 $t
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:3862   .text.create_name:00000000 create_name
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:4147   .text.create_name:00000104 $d
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:4152   .text.follow_path:00000000 $t
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:4157   .text.follow_path:00000000 follow_path
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:4320   .text.dir_register:00000000 $t
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:4325   .text.dir_register:00000000 dir_register
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:4405   .text.sync_fs:00000000 $t
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:4410   .text.sync_fs:00000000 sync_fs
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:4524   .text.sync_fs:00000084 $d
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:4530   .text.create_partition:00000000 $t
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:4535   .text.create_partition:00000000 create_partition
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:4841   .text.create_partition:00000134 $d
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:4847   .text.f_mount:00000000 $t
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:4853   .text.f_mount:00000000 f_mount
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:4966   .text.f_mount:00000054 $d
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:4971   .text.f_open:00000000 $t
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:4977   .text.f_open:00000000 f_open
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:5474   .text.f_read:00000000 $t
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:5480   .text.f_read:00000000 f_read
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:5874   .text.f_write:00000000 $t
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:5880   .text.f_write:00000000 f_write
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:6327   .text.f_sync:00000000 $t
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:6333   .text.f_sync:00000000 f_sync
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:6481   .text.f_close:00000000 $t
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:6487   .text.f_close:00000000 f_close
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:6545   .text.f_lseek:00000000 $t
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:6551   .text.f_lseek:00000000 f_lseek
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:6956   .text.f_opendir:00000000 $t
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:6962   .text.f_opendir:00000000 f_opendir
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:7097   .text.f_closedir:00000000 $t
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:7103   .text.f_closedir:00000000 f_closedir
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:7146   .text.f_readdir:00000000 $t
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:7152   .text.f_readdir:00000000 f_readdir
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:7257   .text.f_stat:00000000 $t
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:7263   .text.f_stat:00000000 f_stat
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:7356   .text.f_getfree:00000000 $t
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:7362   .text.f_getfree:00000000 f_getfree
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:7634   .text.f_truncate:00000000 $t
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:7640   .text.f_truncate:00000000 f_truncate
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:7833   .text.f_unlink:00000000 $t
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:7839   .text.f_unlink:00000000 f_unlink
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:8045   .text.f_mkdir:00000000 $t
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:8051   .text.f_mkdir:00000000 f_mkdir
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:8330   .text.f_rename:00000000 $t
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:8336   .text.f_rename:00000000 f_rename
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:8630   .rodata.f_mkfs.str1.4:00000000 $d
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:8640   .text.f_mkfs:00000000 $t
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:8646   .text.f_mkfs:00000000 f_mkfs
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:9321   .text.f_mkfs:000002a8 $d
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:9329   .text.f_mkfs:000002bc $t
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:9904   .text.f_mkfs:00000618 $d
ARM GAS  C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s 			page 338


C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:9913   .text.f_mkfs:00000630 $t
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:9951   .bss.FatFs:00000000 $d
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:9955   .bss.FatFs:00000000 FatFs
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:9958   .bss.Fsid:00000000 $d
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:9962   .bss.Fsid:00000000 Fsid
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:9965   .rodata.cst.0:00000000 $d
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:9969   .rodata.cst.0:00000000 cst.0
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:9978   .rodata.cst32.1:00000000 $d
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:9982   .rodata.cst32.1:00000000 cst32.1
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:9991   .rodata.defopt.2:00000000 $d
C:\Users\HP-Admin\AppData\Local\Temp\ccY0w7x3.s:9995   .rodata.defopt.2:00000000 defopt.2

UNDEFINED SYMBOLS
disk_status
disk_write
disk_read
memcmp
disk_initialize
memset
strchr
disk_ioctl
get_fattime
memcpy
